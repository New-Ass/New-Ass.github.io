<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>《一天》：11:31 p.m. ~ 6:07 a.m.</title>
      <link href="/2022/12/09/yi-tian-4/"/>
      <url>/2022/12/09/yi-tian-4/</url>
      
        <content type="html"><![CDATA[<h1 id="11-31-p-m-6-07-a-m"><a href="#11-31-p-m-6-07-a-m" class="headerlink" title="11:31 p.m. ~ 6:07 a.m."></a>11:31 p.m. ~ 6:07 a.m.</h1><p>有人敲门。并非是推销员那种“无论屋里有没有人，我只是例行公事”的敲法。当然，半夜11也不可能有什么人上门推销。不管是谁敲门，我都无动于衷地让自己深陷沙发里。我没有开灯，好让自己感觉自己正躺在夜空中。总之，没有起身的打算。<br>门外的人一个劲地敲门，光听敲门声就知道他(她)有多急躁。似乎下一秒他(她)就会起脚踹门。转身一踢，防盗门应声倒下，拍电影一样。“来了来了！别再敲了。”<br>我不耐烦地打开门，“怎么是你？”跟中午吃饭时不同，她现在穿了一件黑色T恤，米老鼠的偌大的头像静静地待在她的胸前。很难想象她喜欢米老鼠，我总觉得她是一个酷酷的女人，米老鼠怎么也不符合她的气质。她没有戴鸭舌帽，染色失败的头发披散在肩头，像是海啸之后留在陆地上的无所适从的海草。<br>“不请我进去？”她一开口扑面而来的全是酒气。天知道她喝了多少。<br>“哦哦。”我闪出身位把她让了进来。<br>“你家的灯该换了啊，这么暗！”<br>“这就去开灯。小心点，别撞着什么东西。鞋子就别脱了，直接踩进来吧。”<br>我打开灯，看见她整个人蜷缩在沙发里，跟牡蛎一样。我坐到她对面接着看《克苏鲁神话》。<br>“有酒吗？”<br>“啊？”<br>她接着说道：“你知道吧，我可是把你当成很好很好的朋友，不然也不可能现在来找你。”<br>“唔。”<br>等我意识到的时候她已经哭成泪人了，我赶紧跑到厨房把东西递给她，“喏，给你。少喝点啊，看你都醉成什么样了。”<br>“嗯。”她接过瓶子没有任何反应就保持着手臂平举的姿势，像是雕塑，“你这是让我对瓶吹？”<br>“哦哦。”我又回到厨房拿了个玻璃杯给她。她跟欣赏稀世珍宝一般盯着手里的瓶子，“这是什么酒？我怎么从来没见过。”<br>“我也不知道。我一个朋友从冰岛带来给我的，好像是威士忌的一种。度数还挺高的，你少喝点。”我把面巾纸推到她面前，“呐，擦擦脸，都哭成大花猫了。”<br>“这酒应该挺贵吧！”<br>“不知道，我对酒可没什么研究。”<br>她说着却又毫不客气地给自己到上慢慢一玻璃杯，“朋友送你的？我看是你的顾客吧。”<br>“朋友也好顾客也罢，又没什么差别。”<br>她将玻璃杯里的液体一饮而尽，突然对我吼道：“他妈的，那我算什么？”<br>“啊？”<br>她砸吧砸吧嘴，“你这什么酒，一点味道都没有，假的吧！”<br>“我怎么知道，我又没喝过。”<br>“喂，”她又为自己倒满一杯，“你就不问问我为什么喝得烂醉？亏我把你当好朋友。”<br>“哦。那么你为什么要把自己灌醉呢？”<br>她没有回答，反而用力地踹了一脚茶几，“顾问！你他妈什么意思，便秘啊，半天放不出一个屁，我说一句你说一句，你他妈什么意思，有病啊！”<br>我算看出来了，她今天到我这就是来撒酒疯的。“我跟你讲啊，从前啊——”<br>她又踹了茶几一脚，“谁要听你讲故事！我算是想明白了，你是知道这件事的，是吧？合着你们把我当什么了，是不是看我被骗你们很爽啊！”<br>“你说什么啊，我都不知道你什么意思。”<br>“砰！”她一把把玻璃杯摔在地上，“你们男的没一个好东西。”<br>看样子和他吵架了，“你知道吗？绝望里乐观，亦是个情操。”<br>“什么意思？”摔了玻璃杯的她开始不管不顾地对瓶吹了。<br>“不知道。只是句歌词，突然想到了而已。”我继续看我的《克苏鲁神话》。她看见我这样气就不打一处来，又是对我一通大骂。我知道她平日里最反感说脏话，今晚算是我认识她以来见她最不文明的一次了。或许是不说脏话的缘故，她翻来复去骂的就那么几句，而且大多数时候骂的还不是我。太文明的结果就是骂人的时候反而会得到被骂者的同情。<br>看我一点反应都没有，许是感觉太无聊了，她也慢慢止住了话头，开始一个人喝闷酒。<br>等我再抬起头时她已经蜷缩成一团躺在沙发里睡着了。她的姿势让我想到了冬日里同样蜷缩着一团躺在垃圾桶边上熟睡的流浪猫。T恤上的米老鼠仍然瞪着圆滚滚的双眼看着我，好像在问我为什么一言不发。<br>“我们大家喜欢的口令<br>MIC·KEY·MOUSE。”<br>我这样回答它。</p><hr><p>“唔”，她有些难受地捂着自己的脑袋，错愕地看着茶几上的空瓶子。<br>“你醒了。知道自己在哪吗？”<br>“唔，知道。”她仍然死死盯着茶几上的空瓶子。<br>“看样子没喝傻。说实话我真怕你酒精中毒猝死了。”<br>“酒精中毒？”她面色古怪地重复了一遍。<br>无言的沉默。她僵硬地抬起头，“昨天晚上我没说什么吧！”<br>“嗯，其实说了挺多的，不过我都忘了。你知道的，我这人记忆力不太好。”<br>“真的一句都想不起来了？”<br>“唔，”我皱紧眉头假装思考，“我只记得一句，好像是什么‘绝望中乐观，亦是个情操’。我也记不太清了。”<br>“这话谁说的？”<br>“黄伟文。”<br>“那个香港的填词人？”<br>“嗯。”<br>“我会记住的，谢谢了。”<br>“哦，小心碎玻璃。”<br>“嗯，真是谢谢了。”<br>她打开门，“对了，酒钱我哪天再给你。”<br>“不用了，反正不值多少钱。”<br>“想不到你这人还挺大气的。”她对我挤出了一个表情，我想她大概是在笑吧。<br>还没等我回答她就把门关上了，只留下一句“那是，毕竟只是一瓶矿泉水”在空中徘徊。<br>我伸伸懒腰，准备睡觉，之后还得去一趟医院。再睁开眼，希望一切会有变化。</p>]]></content>
      
      
      <categories>
          
          <category> 小说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《一天》：7:36 p.m. ~ 9:03 p.m.</title>
      <link href="/2022/12/09/yi-tian-3/"/>
      <url>/2022/12/09/yi-tian-3/</url>
      
        <content type="html"><![CDATA[<h1 id="7-36-p-m-9-03-p-m"><a href="#7-36-p-m-9-03-p-m" class="headerlink" title="7:36 p.m. ~ 9:03 p.m."></a>7:36 p.m. ~ 9:03 p.m.</h1><p>当我推开“木头马尾”的门走进嘈杂喧闹的世界时我就像往常一样后悔。我不知道这里有多少人跟我一样，每次发誓以后都不会再来这里浪费时间了，可还是一次次地来然后再一次次立誓又一次次地后悔。我想这种人大概十个人里就会有十一个。<br>我从一个个打扮得花枝招展的蝴蝶身边挤过。走到吧台前还未开口酒保就递给我一瓶冰啤。我小口地喝着啤酒，蝴蝶们对着酒吧驻唱的音色酷似陈奕迅的小伙大声尖叫。足以掀翻屋顶的声浪。</p><p><strong>“陈奕迅的确是独一个，<br>卖力地唱使你起身拍和。”<br>(《如果我是陈奕迅》)</strong></p><p>其实也不是非得是陈奕迅，随便来几个唱歌不跑调的人台下的尖叫也不会减弱多少。就算是换成大猩猩我想也不遑多让。当然让大猩猩唱歌可不行，不过只要让它表演计算“1+1”，台下的人保管叫得更加激烈。<br>归根结蒂，大家的尖叫从来都不是为别人叫的，全都是自我宣泄。<br>我也不是说我比他们更优越，做人最要不得的就是优越感。正所谓“明月装饰了你的窗子，而你装饰了别人的梦”。退一步说，说不定你看不起的失态的美女帅哥全都是身家百万的成功人士。<br>“人人平等”这话可谓至理，特别是在这样的世界里。世界不过是动物园，我们自顾自地尖叫、看书，一幅旁若无人的模样。实际也是如此，这里哪有别人，不过是自己一个人和一个坚固无比的笼子，谁也触摸不到谁。我们发出无人可懂的叫声看着无人可破译的文字。<br>没有异常，我收回目光将注意力重新集中到手中的《克苏鲁神话》上。跑到哪里的酒保重新回来，“喏，你的开心果。”<br>我微不可微地点点头表示感谢，“我还以为你忘记了。”<br>“刚才有些忙，就把这件事放到最后做了。忘记了说不定还是好事，帮老板省了不少钱，不是吗？”<br>“你怎么知道老板没把这些从我的工资里扣除了。”<br>“他有这么抠门？”<br>“百分之二百。”</p><hr><p>我到酒吧看书不是因为我有这方面的怪癖，我到酒吧是因为这是我工作的一部分。当然不是每个酒吧的老板都会雇一个干着和我一样工作的人，但“木头马尾”的老板坚信店里有我这样的人会少很多麻烦，或者说原本属于他的麻烦会找上我。<br>简单来说我的工作就是以个人的名义解决酒吧的麻烦。听上去好像跟黑社会收取保护费一样，但其实现实生活哪有那么夸张，我做这个工作也有三四年了，也没遇上过什么打群架的情况，最多也就是有人喝多耍酒疯而已。<br>按理来讲，喝多耍酒疯也不是什么大不了的事，但做这一行总会遇上一些喝酒喝断片的人——自己东西没了不去找就全赖在酒吧的头上。所以“木头马尾”的老板就想到找我来当替罪羊。遇上这种情况其实我也大为头疼，但我在警局还是有几个熟人的，所以我也就勉勉强强接受了这份兼职。<br>被人污蔑偷了对方的财产还不是最糟的，我至今还记得上次那位耍酒疯的女士。走错厕所什么的也就算了，谁知她把我当成了她刚劈腿的男朋友把我按到墙上就是一通强吻。被强吻这事也很难说清我和她到底谁吃亏了，但随后她又在吐了我一身的情况下把满口异味的嘴凑到我面前问我到底是什么意思。<br>要我说这就是谈了一场不是恋爱的恋爱的后果——害人害己。我不是多管闲事的人，也懒得叫她赔偿道歉，把她送到派出所就完事了。反正这些损失老板都会报销。如果不是看在方孔铜钱的面子上，谁会干这么一份吃力不讨好的工作。<br>“唉，你可真厉害，这样都还能津津有味地看书。”酒保说着往高脚杯哈了一口气，娴熟而无奈地擦拭着高脚杯。<br>“所以暂时将你眼睛闭了起来……”又是爆炸一般的大合唱。<br>“哪里，常常看了这句忘了上一句话，不过我有的是时间，大不了花些时间把上面的内容再看一遍。打发时间嘛。”<br>“话是如此，但叫我在这里看书我可做不到。”<br>“叫我向你一样不厌其烦地擦拭高脚杯我也做不到啊，各有各打发无聊的方式。”<br>“你看的什么书啊，回头我也买本来看看。”<br>“没什么好看的，不过是精神病作者的自言自语。”<br>“唔，那还是算了吧。唉，你觉不觉得他们兴奋得有些离谱啊，我可不觉得咱们酒吧有什么出众的地方，怎么个个都叫得这么大声？”<br>“不知道。可能是因为咱们这里像水池？他们尖叫是在放水，我们则是在接水，然后他们为我们的接水服务付钱？”<br>“有趣的理论。好了，不打扰你看书了。”酒保放下高脚杯跑到哪里去招待客人。<br>从《如果我是陈奕迅》到《last dance》再到《we will rock you》，也实在搞不懂“木头马尾”是一个什么风格的酒吧。不管是什么歌，反响都极其热烈。前奏时的寂静，开口时的尖叫，副歌时的全场大合唱。好像演唱会一样。无论是快歌还是慢歌，闭上眼睛听感觉台上的小伙都在一刻不停地扫着吉它，暴风雨般的演奏，似乎不把自己的手指扫断便不罢休。<br>或许酒吧的核心在于氛围，就像酒吧的目的是让人发泄一样。酒吧有没有生意可与我无关，我要做的不过是来到“事故”现场解决异常，视情况打电话给110，然后回到吧台看书。左手递出解决方案，右手收钱。酒吧如何营业，顾客为何打开欲望的水龙头，老板又是如何把一酒吧的欲望换成钱……这些事我可不感兴趣。拿多少钱就出多少力。就像我经常跟我的顾客说的那样，“就告诉我已经发生的客观事实，别告诉我你的想法你的预测，特别是，如果你有违法行为，哪怕是闯红灯这种小事也千万别告诉我。我可不想惹上一身的麻烦。”<br>现在又变成了《we are the champions》，以前可看不出这小伙子是皇后乐队的粉丝啊。看这样子，今天又是坐着赚钱的一天。<br>看来话说得太早了。酒保有些着急地赶过来，“顾问顾问，有人在厕所晕倒了！”酒保的脸有些苍白，看来他觉得对方可能是上厕所的时候猝死了。“别急，我去看看。对了，去找根湿毛巾给我。”我起身朝厕所走去，他们并不知道有人晕倒了仍然在台下放声高歌。不管是什么情况，事情都还不算太糟。其实他们知道也没什么，类似的事情他们肯定都见怪不怪了，当然，老板肯定不希望他们知道，我的工作就是这个——解决可能影响酒吧生意的麻烦。<br>我赶到的时候她正安静地躺在卫生间盥洗池的地板上。安静得像熟睡的小动物。看样子她是在洗手的时候晕倒的。她运气不太好，倒下的时候头撞到了盥洗池的沿。我接过酒保的湿毛巾帮她止血。在这期间有不少人进出，虽然他们都是径直走过没有任何反应，我还是叫酒保先离开了。<br>她长得挺漂亮的，是大家常说的“网红脸”——挺好看的，可以说乍看之下很是惊艳，但一转眼就忘了到底长什么样。我不太确定她的脸是不是天然纯污染，因为在她的右耳耳前有一道从鬓角到下巴的疤痕，看上去像是整形手术中意外留下的。这条疤痕比较浅，不凑近看其实看不出来。说实话这道疤并没有破坏她脸的美感，反而比她的脸更能让人留下难忘的印象。<br>趁着帮她止血，我给她脸上的疤拍了张照片。这不是因为我有什么变态的嗜好，而是为了防止她醒后倒打一耙。<br>过了大概五分钟她的伤口结痂了，我把毛巾还给酒保，扶着昏倒的她走出酒吧。此时全场大合唱的是《恋爱ing》。叫人捉摸不透的选曲风格。<br>我扶着她走进酒吧旁边的弄堂里。小心翼翼地避免她的伤口二次创伤，然后把她摔在垃圾桶边上。原本已经休息的苍蝇“嗡”得一声散开。她好像有所感觉地“哼”了一声。我等了大概四五秒，看她没有醒来的迹象，才开始接下来的动作。<br>接下来的事情就简单多了，比思考明天早上吃什么还要省力。<br>“喂，顾问。不是我说啊，我都下班了，有什么事直接打110。”<br>“木头马尾边上的弄堂里有个女人躺在垃圾桶边上睡着了。”<br>“你可真行，天天碰上有人在垃圾桶边睡觉。我说了，我下班了，打110去。”<br>“好像你不是为人民服务的民警一样。我可不想被他们问这问那的。你不管就算了，反正真出什么事你也不是不知情。”<br>“我是服了你了。喂，你那边怎么这么吵啊？”<br>“我在酒吧啊。”<br>“木头马尾？”<br>“嗯。”<br>“不对，那个女人呢？”<br>“说了，在垃圾桶边睡着了！”<br>“你现在就出去在她边上看着，我这叫人去你那里。”<br>“快点啊。”<br>再回到酒吧，音乐又变成了披头士的《love me do》。我已经对摸清他们的音乐风格不抱丝毫希望了，“再给我瓶啤酒。怎么，吓坏了？”<br>酒保重重地放下啤酒，“她，没事吧？”<br>“放心吧，只是皮外伤。明天又可以活蹦乱跳地来喝酒了。”<br>“我以前的高中同学在打了三个小时篮球后喝了两瓶冰水心脏就骤停了。等送到医院的时候人冰得跟什么似的。你能理解吧，我刚才真是吓坏了。”<br>“唔，”我小口喝着啤酒，“这种事是好是坏谁也不清楚，姑且观之。”<br>“开玩笑吧，你？”<br>“没。”<br>“唔。”酒保没再说话，我就更懒得说什么了。<br>类似的事情我见的不算少，但今天我却没有像往常一样很快地冷静下来重新把注意力集中到书上。或许是和酒保刚才说的他高中同学的事有关。说老实话，这种事实在叫人看不懂，不想走的人走了，想走的人怎么也走不了。<br>我突然又想到了那个女人脸上的疤了，很像是电影里用来易容的皮和真实的脸接触的一道缝隙。在那易容过的脸下面到底隐藏着什么？<br>唔，开始对别人有好奇心可不是什么好事，我将手里的啤酒一饮而尽，准备去厕所洗把脸冷静冷静。</p>]]></content>
      
      
      <categories>
          
          <category> 小说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《一天》：12:17 p.m.  ~  12:54 p.m</title>
      <link href="/2022/12/09/yi-tian-2/"/>
      <url>/2022/12/09/yi-tian-2/</url>
      
        <content type="html"><![CDATA[<h1 id="12-17-p-m-12-54-p-m"><a href="#12-17-p-m-12-54-p-m" class="headerlink" title="12:17 p.m.  ~  12:54 p.m"></a>12:17 p.m.  ~  12:54 p.m</h1><p>我走进店里时发现她早就到了并且坐在位置上无聊地用筷子敲碗。我花了三秒钟试图确定这人是不是她，得出的结论是这个人大概是她。<br>“大概”的意思是“不确定”，这就是说我说这个人是她仅仅是因为这个人的背影像她。不能通过背影判断一个人的情况在我身上发生是非常少见的。这当然不是什么值得称道的事，我能掌握这项技能也不过是因为上学时想要和别人打成一片却又不知从何入手，只好通过他们的背影来认识他们罢了。若要说这其中没有天赋的原因我是不太同意的，不然我也做不了这行。<br>然而我现在只能判断那人大概是她。她穿着一件白衬衫，下半身是褪色得恰到好处的淡蓝色牛仔裤。衬衫的下摆塞进牛仔裤，完美地勾勒出她苗条柔美的腰肢的轮廓。就穿衣风格而言，这确实是她的风格，但这人只能大概是她。<br>那人戴着一顶鸭舌帽，我知道她也有一顶一模一样的帽子。但就算如此，我也不能断定那人是她。因为那人没有过肩的长发，我知道她无法接受头发短于肩膀的高度，所以这人只能大概是她。<br>她仍然百无聊赖地敲着碗沿，也幸好现在是午餐时间，敲碗的声音被人声的嘈杂所掩盖，不然她肯定得遭受店家的白眼。<br>“家里的大人没教过你吃饭的时候不要敲碗吗？”我笑着坐在她的对面。<br>“这不是无聊吗？”她放下筷子，“你迟到了。”<br>“其实我早就到了，花了好长的时间才认出你。让我想想，嗯，我大概花了半个小时才认出你。”<br>她白了我一眼，“怎么？去了一趟自贡，眼里就留在那里看美女了？”<br>我把一片鱼片送进我的血盆大口，指了指她的帽子，“不开玩笑，你这副假小子的打扮我还真不敢认。怎么突然心血来潮想剃平头呢？受什么刺激了？”<br>她硬挤出一个比哭还难看的笑容，“我可没有打算剃平头，染发的时候出了点小问题。”<br>吃了一会儿，她像突然想起什么似的摘下帽子，“喏，就像这样。”<br>她确实没有剪平头，只是用鸭舌帽罩住了丸子头。我猜她大概是想把头发染成淡绿色，但结果确实不太理想，现在她的头发就像是因为长时间没有理会而长满霉菌的面包一样。<br>“看样子确实是出了点小问题。”<br>她重新戴上帽子，“要笑你就笑吧，我有心理准备。”<br>“没，其实还好啦，不骗你。”<br>她恶狠狠地咀嚼着嘴里的食物，“我真是谢谢您嘞，你的安慰能不能再敷衍一点？”<br>我耸了耸肩，“说谎话鼻子会变长的。”<br>“呵！”她赌气地将锅里的鱼搅得稀碎。酸菜鱼的碎尸像抗议她分尸的行为一般浮上汤面，然后又无奈地沉入锅底。<br>“说实话，这酸菜鱼的味道挺好的，你不多吃点？”<br>“你都把它分尸了，我夹什么吃啊？再说，刚从医院回来，没什么胃口。”<br>“医院？你在自贡不是连那人的半点影子都没找到吗？哦，我知道了，一定是你骚扰了哪个美女，然后叫人教训了一顿。啧啧啧，不得了啊，顾问！”<br>“哪里，我爸来了，他到医院有点事。”<br>“唔，”她显得有些尴尬，“不好意思啊。”<br>我摇摇头表示没事。<br>她筷子拿起又放下。“有什么事就说吧，咱俩什么关系啊！”<br>“所以你不在医院陪你爸，反倒在这里请我吃饭，真没关系？”<br>“这不是有个词叫‘劳逸结合’吗？再说，医院一股消毒水的味道，你看，这里医院够远了吧，可我还是能闻到消毒水的味道，一点味口都没有。要是一直待在医院，我爸还没好我可能就先倒了，这可就是‘得不偿失’了。”<br>“谁会喜欢医院啊，不都是没办法的事嘛。”她大有深意地看了我一眼。<br>“话是如此，但……不是，这锅里的鱼就全被你粉身碎骨了？我这还没吃多少呢！”<br>“哪里？”她夹起一片鱼送进自己嘴里，“你看这不就是吗？不过你怎么会突然想起来请我吃饭？这可不是你的作风啊。”<br>“那在你看来怎样才算是我的作风？合着我就不能请别人吃饭？”<br>“不清楚。反正这么大方可不像你。”<br>“再笑，再笑眼睛都笑没了。不是吧，我怎么连一片鱼都夹不到？”<br>“人品呗！哪有请别人吃饭自己也要大吃特吃的？”<br>我白了她一眼，“好像我很想请你吃饭一样。这不是感谢你照顾吉祥吗？哦对了，我请你吃饭他不会多想吧。”<br>“这你问我啊，你跟他都认识多少年了，他是什么样的人你还不清楚啊。”<br>“这，爱情有时候可不能按常理来揣摩。”<br>“放心吧，我就从来没见过他吃醋。真不知道他是怎么想的。”<br>“你可真是得了便宜还卖乖，我要是你，做梦都能笑醒。”<br>“这可不是爱情啊。”她说着又把筷子伸进锅里。<br>“喂，粉身碎骨还不够吗？你要是再挫骨扬灰我吃什么啊！”<br>听了我的话，她像叛逆期的孩子一样反而加快了用筷子搅拌的速度，搅得汤汁四溅。<br>“对了，吉祥没给你添什么麻烦吧。”<br>“麻烦？哪里会有什么麻烦，吉祥乖得就像芭比娃娃一样，要我说没有我它肯定也可以照顾好自己。”<br>“如果它能自己打开橱柜撕开猫粮的包装，那么下次出差的时候我就会好好考虑你的建议。嗯，还能省一顿饭钱。”<br>“我现在大概明白吉祥为什么会这样叫人放心了。”<br>“哦，什么意思？”<br>“‘穷苦的孩子早当家’。吉祥摊上你这样一个主人想不照顾自己都难。”<br>“那如果要这么说你以后肯定是一位尽职尽责的好母亲。”<br>她深深地看了我一眼，似乎是想弄明白我到底是在夸奖她还是在损她。<br>“不过有件事我不太能确定正不正常。就是吉祥对冲水马桶的反应不太对劲，我也说不清它是对冲水马桶感兴趣还是对马桶恐惧。”<br>“啊，你说这个啊，”我小幅度地缩了缩脑袋，“这你不用担心，对它来说这是正常反应。”<br>“真的？”她看我一脸做贼心虚，像想到了什么，“你不会虐猫吧？”<br>“想象力真丰富。”不过她还是死死盯着我一直在等我的解释。真是的，平时也没见她表现得有多富有爱心。<br>“好吧，好吧，我解释一下。别担心，不是你想的那样。对了，你以前应该没有养过猫吧。”见她疑惑地摇摇头，我接着说道，“一般来说，猫没有在猫砂方便的习惯。所以这种事情就得由主人来训练猫。我不知道别人是怎么训练的，反正我是用类似巴甫洛夫训练狗的方法训练它的。一开始我不管它，它肯定是随地大小便，然后我就开始惩罚它。”她有些厌恶地皱起眉头，我赶紧补充道，“说是惩罚，其实也没什么。简单来说，只要它随地排泄我就把它拎起来揉脸，然后指指它的排泄物再指指猫砂。这样一来二去它就学会怎么使用猫砂了。”<br>“嗯，那这又和冲水马桶有什么关系？”<br>“不是，你确定要在吃饭的时候聊这些？”<br>“怕什么，我反正吃得差不多了。怎么，准备扯开话题？”<br>“哪有。吉祥学会用猫砂之后，我又突发奇想要教它使用冲水马桶。不过事实证明冲水马桶设计出来就不是为了给猫用的。”<br>“真的？那吉祥可真是可怜。”<br>“我骗你干什么，有钱赚不成？不是，我们认识了也有三年了，你才照顾吉祥多久，这就无条件站在它这边了？”<br>“吉祥可不会说谎。”<br>“它也得先会说话才行。”我小声嘀咕。<br>“唉，我都想养猫了。”<br>“想养就去养一只呗。”<br>“像吉祥这么乖的猫应该不多见吧。要不你把吉祥送我吧！”<br>“那还是算了吧，我可是还等着吉祥为我养老送终呢！”<br>“怎么，打算孤独终老了？”<br>“那还不，跟吉祥一样乖的对象我这辈子应该是找不到了。”<br>她抢下锅里最后一片没被她挫骨扬灰的鱼，“唉，你不是吃饱了吗？”<br>“所以我才说吉祥不会像某人一样说谎啊！”她甚至有些夸张地吧唧吧唧嘴，好像在向我夸耀。<br>   “啊？这什么意思，我是真没听懂。”<br>“很简单啊，你为什么选这家店？这离医院、你家和我家都挺远的。”<br>“能有什么理由啊，还不是因为这里的酸菜鱼好吃。”<br>“咖啡馆。”<br>我心头一跳，“我可没说要请你喝咖啡啊。”<br>“你前面不是问我什么意思吗？我的意思是说你请我到这里吃饭是因为对面的咖啡馆。”<br>“你怎么知道这件事的？”<br>“还能怎么知道的？当然是他跟我讲的。”<br>“说谎。这件事我可没跟他说过。”<br>“这样啊，”她尴尬地扯了扯嘴角，“其实是刚才店里的老板跟我提了一嘴，他好像把我当成你女朋友了。你不会生气了吧。”<br>“没有。你别跟别人说就行了。”<br>“首先我也得有人说才行。”<br>“我就怕万一，万一你认识她，万一你的朋友认识她呢？我可不想给她添麻烦。”<br>“放心吧，保证守口如瓶。”说着她做了一个把自己的嘴用拉链拉上的动作，“别怪我多管闲事，我听老板说你经常来这吃饭。你既然对她痴心一片，为什么不去挽救一下，说不定就复合了。”<br>“没打算打扰她，也没有麻烦别人的打算。”<br>“这可不是爱情啊。”她摇摇食指，就像上学时老师说“这是重点，要记住”一样。<br>“或许。”我不置可否。</p><hr><p>“我嘛，如果有可能，希望开一家咖啡馆。”我们正趴在教室外走廊的栏杆上，冬日的暖阳缓缓撒下金光，她盯着自己阳光下的双手像在欣赏做工精致的艺术品。周围的同学对我俩早已见怪不怪，一个劲地嬉笑打闹。她说话时音量不大，语速也是慢条斯理的，但她总有抓住一个人注意力的魔力，所以不论周围多么吵闹，我总能一词不落地听到她说的话。<br>她说话时总不看我的眼睛，准确的说，自从我们确定男女朋友的关系后她说话时就总是低下头。一开始我觉得这是因为她有些害羞，可在毕业后的许多年里，我愈发觉得她不看我时说的话或许不是说给我听的，她不看我也仅仅是因为“不想看我”。应该说当时她的脑海里就没有纠结过“想不想”。往后的岁月里我总有这样的感觉，而且随着年纪的增长，我甚至觉得只能是这个解释，别的选项在我脑海里连一闪而过的资格都没有。<br>但当时我不这样想，我的脑海里只有我身边的女孩和阳光洒在她脸上忽明忽暗闪烁的模样。“为什么会想着开一家咖啡馆呢？”<br>“因为能遇上各式各样的人啊，说不定还能遇上情侣求婚呢！”她说话的时候还是没看我，我顺着她的视线看过去，她还是盯着自己的手背，好像发现了以前不曾发现的东西。<br>我没有马上接话，好像在想像她说的话的画面。其实我什么都没在想，只是看着她那和羽绒服相比略显娇小的手，恨不得将它死死攥在手心。“是啊，好浪漫。”<br>她没说话，只是双手环抱栏杆下巴顶在手上慵懒地晒着太阳。她还是没看我。我总想说些什么打破这沉闷的无言，但站在她身边连思绪都变慢了。好容易想到了什么，刚要开口，上课铃又响了。也说不清这铃声是不合时宜还是让我俩如释重负。<br>我对她是早有预谋，但我写的情书却没有真正送到过她的手中。所以在我和她在一起这件事上发挥作用的不是我那些自我感觉良好的情书，而是半包面巾纸。<br>当时她因为某件事正趴在栏杆上独自流泪。我很想上前安慰却不知以何身份开口更不知如何开口，只好叫她的闺蜜转交一包面巾纸给她，然后做贼心虚地跑回教室。<br>当某次我送她礼物时，她才告诉我她是在我递给她面巾纸的一瞬喜欢上我的。她还说希望我以后不要再送她礼物了，因为她觉得我们该是精神上互相关心的恋人，就像那天我给她递面巾纸一样。我不清楚她是什么意思，但在之后的十年里，我愈发觉得她想要的和我当时想要的全然是两个不同的东西，哪个是爱情倒不好说，唯一可以确定的是我到现在都不清楚她哪天为什么哭。这大概就是她说的精神上的关心吧，一言不发地递给她一包面巾纸，然后一言不发地离开，不问“为什么又哭了？”，酷是挺酷，但和我当时想要的可谓是南辕北辙。<br>我当时并没有想那么多，但也觉得事情这样发展不太对劲。王家卫说：“世上所有东西都有保质期，爱情也不例外。”我想她当时也应该有类似的感觉，就像我们可以清楚地感受到鞋子里的小石子一样。<br>但我们谁也没有点破这一点，仍然以一种对待信仰的态度对待我们的爱情。冬日暖阳点缀的走廊，不合时宜却又让人如释重负的上课铃，阎王打更似的下课铃……一言不发地走进教室，又一言不发地走回教室。酷破天际，但又酷得不像爱情。<br>最后还是分开了。说是分开但其实上对我们两人也没多大影响，反而少了不少麻烦，比如说两人都没必要再强装着有兴趣的样子趴在栏杆上了，而且还少了他们对我们的调侃。甚至分手对我俩来说竟还有松了一口气的感觉，其实说是分手都有些过分了，我们无非是把相对无言从走廊这个特定地点扩展到全世界这个范围罢了。<br>尽管我仍然不明白为什么她说话时总不看我，也不明白她所说的“精神上的关心”是指什么，但在之后的十年里我已经知道我当时错的有多离谱了。有些爱而不得的变成了朱砂痣和白月光，而我高中时的“面巾纸爱情”变成了我的一杯咖啡。<br>一个偶然的机会我知道了她在这里开了一家咖啡馆。那时我已然知道自己大错特错，所以并没有打扰她，只是偶尔到这家饭店吃饭，出神地看着对街的咖啡馆，固执地把咖啡馆柔和的光当做咀嚼悔意的药引。这大概才是爱情吧。<br>说话时不看你就不看你呗，又没有什么大不了的，如果实在无法理解就想这些话就算不是专门讲给你听的但好歹也没避着你好了；至于精神上的关心，她只接受你的面巾纸难道还不够吗？又何必非得去刨根问底呢？无事一身轻不好吗？<br>相比较于无话不说我想这才应该是爱情本身的样子吧。所以我才会说她有一个不知道吃醋的男朋友是身在福中不知福。我想这话加缪是一定会同意的。<br>可我知道的实在是太晚了，所以我现在只能看着对街咖啡馆的光一遍一遍不知疲倦地反刍我和她之间的面巾纸爱情。</p><hr><p>“对了，”离开餐馆时她突然把我叫住，“这话可能有些多管闲事了，但我还是要说，谁都不喜欢医院，所以病人才更需要照顾啊。”<br>“再看吧。”</p>]]></content>
      
      
      <categories>
          
          <category> 小说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>《一天》：9:42 a.m.  ~  10:27 a.m.</title>
      <link href="/2022/12/09/yi-tian-1/"/>
      <url>/2022/12/09/yi-tian-1/</url>
      
        <content type="html"><![CDATA[<h1 id="9-42-a-m-10-27-a-m"><a href="#9-42-a-m-10-27-a-m" class="headerlink" title="9:42 a.m.  ~  10:27 a.m."></a>9:42 a.m.  ~  10:27 a.m.</h1><p>杭州。<br>如果忽略此时候车室门外恰到好处的阳光，叫我闭上眼睛低声默念“杭州”并想象她的模样，那么我的杭州一定是遍布公寓的城市。杭州方正有序的公寓像事先商量好似的都长得一般高，没有谁比谁高一头，也没有谁比谁矮一截。公寓前面是刚浇上柏油画着崭新斑马线的马路，马路上车辆川流不息，就是织女也找不到可以插针的缝隙。柏油难闻的气味在空中飘荡，叫人无处躲藏。如果气味也是有颜色的，那么柏油的气味的颜色一定和杭州的天空一样是灰蒙蒙的。杭州的天空永远是一幅生气的模样，灰蒙蒙的像是暴风雨来临前的海面，无时无刻不散发出一股无可救药的悲哀气息。站在杭州的公寓前你看不到一个人，也找不见一盏红绿灯，要想穿过马路，唯一的办法就是等待。可面前是川流不息连一丝缝隙都没有的车流，上方是患有抑郁症的老天爷，它满眼悲怆地看着试图穿越马路的我。等待，等待，等待……够了！我受不了忧郁的天气，也受够了从不放慢脚步的汽车，我决心穿越马路。可连续的车流就像电脑数据矩阵一样，无时无刻不在流动，叫人分不清何为起点，何为终点。汽车没有减速将我撞倒，从我身上碾过，除了轮胎碾过我血肉的声音，你什么都听不到，最后连这点微弱的声音也消失了……抑郁缠身的老天爷无悲无喜地看着这里发生的一切，看着我的血肉消散，与柏油路融为一体。这里没有红色，只有柏油的黑。一阵风经过，将柏油的恶臭带向全世界。只有恶臭。老天爷满意地收回目光，再次躲进自己重重的保护壳，车辆依然川流不止，好像我从未出现。无可救药的悲哀，哪里都去不了……<br>我想离开杭州，可离开之后我又该去哪呢？其实去哪里都一样。如果我身上真有什么值得称道的东西，或许这就是其中之一，不，准确的说这是我身上唯一值得称道的地方了。其实这也没什么好称道的，如果举办“值得称道”大赛，或许我才仅仅拥有参赛资格而已，比我厉害的大有人在。简单来说，我知道“其实去哪都一样”不算什么，知道这一点并且不想着逃离的人才真叫人佩服呢！<br>我大学室友就是这样的人，他说这些都是他从军营里学到的。<br>“顾问，你知道吧，其实哪里都是一样的。”<br>“啊？什么意思？”<br>“别这么多抱怨，其实都一样，抱怨来抱怨去都无济于事，哪里都一样。”<br>“你在说什么啊！”我开始考虑要不要把这件事报告给心理委员了。<br>“不管军营也好学校也罢，都是一个样。”<br>“怎么会一样？就我所知，军营和学校的差别就像金星和火星的区别一样大。随便说说我都能说出一大箩筐，军营里有手机有电脑吗？在军营你可以天天见到女孩子吗？亏你还是服完兵役回来的，我看你准是脑子发昏了！”<br>他似笑非笑地看着我，“这样吧，我们做个实验，你闭上眼睛想象一下杭州的模样。不用告诉我你的杭州是什么样的，只用想就行了。”<br>我半信半疑地闭上眼睛，想象杭州的轮廓。低矮的候车站被直插云霄的高楼大厦包围，像是与父母失散的小孩。鳞次栉比的高楼大厦反射着耀眼的光，好像在叫试图靠近它的人莫要再上前一步。形形色色的人在路上走着，谁也不说话，偶尔传出的声音也不过是人与人相撞后的道歉。像是藏在暗处的闹钟响了，反射着惨烈的光的高楼大厦里传出一阵闷响，路人们都有意无意地避开大厦的双开门。但仍然有几位避之不及的路人被提着公文包从大厦里鱼贯而出的西装革履撞倒。“对不起，先生，我没看到你，真是对不起。”西装革履像是没听到这话一样自顾自地往前走，他们像摩西一样一言不发地分开原本井然有序的人流。路人们向西装革履投以羡艳的注目礼，他们羡艳的不是公文包也不是笔挺合身的西装，而是高楼大厦。西装革履是高楼大厦的化身。杭州，人来人往，唯有欲望和高楼大厦永存。<br>“脑子里有杭州的形状了？”<br>“嗯。”<br>“那里天气怎么样？”<br>“天气？唔，大概是晴天。”<br>“大概？”<br>“是的，大概。不是那种斩钉截铁百分之百的确定。大概的意思是说根据我的想象推理，我的杭州应该是晴天。”<br>“那么就是说你的杭州其实是没有天气的，是吧？唉，你还是不懂，天气才是一个城市的名片。当然，这不过是一张空白的名片，也不是什么大不了的东西，但看不到这个你就不会明白。”<br>“看到天气就什么都明白了”，真是好样的！就算现在我早已明白了这个道理，但当我每次想起这句话时，我还是忍不住想向全世界宣布：“其实哪里都一样！”唉，我还差的远呢！我应该多向我室友学习，明明什么都一清二楚却又不动声色默默忍受，这才叫明白“其实哪里都一样”哩！<br>可惜当时他跟我讲这些话的时候我并没有意识到这句话的力量，相反我觉得他是有什么心理问题还把这件事告诉了辅导员。接下来就是无穷无尽的心理辅导，各种各样的老师谈话。不过他从没有一句抱怨，好像什么都没有发生过一样，也没有怪罪过我。真不知道我什么时候才能像他一样。<br>毕业后一次偶然的机会我在4S店碰到了他，那时候他已经是4S店的经理了，而我，也早已明白了当时他说的话的力量，所以再见到他时，我悻悻然地走上前为我当年不成熟的行为道歉。<br>“你说那件事啊！没什么大不了的，心理咨询也罢老师谈话也罢，你的误解也好，有没有都一个样。”<br>“可是这件事一定给你造成了不算小的麻烦吧。”<br>“所以说你还是不明白啊！喏，如果心里还过意不去，那就买一辆车当作对我的补偿好了。”<br>“唔，其实我今天到这里不是来买车的。”<br>“嗯。”<br>“因为工作的缘故我才会到这里，我对车其实没什么研究。”<br>“嗯。”<br>“你呢？大学的时候我可看不出你有多喜欢汽车。我实在想象不出你向顾客推销汽车的样子，感觉你不是这样的人。”<br>他露出职业性的拒人千里的笑容：“你以为对着顾客侃侃而谈，不厌其烦地讲解一切的推销员才是优秀的推销员？”<br>“难道不是吗？没有热爱必定一事无成，只有热爱才能够侃侃而谈。”<br>他的笑容从30°扩展到45°，“所以说你还是不明白啊。买车的人不过是图一个新鲜感而已。百度百科式的讲解也不过是把新鲜感转换成数据和语言而已。你们以为优秀的推销员就该侃侃而谈，可实际上大多数时候讲得越少越能吸引顾客。‘这辆车到底好在哪里？又是什么原因导致推销员三缄其口？我要不要买一辆试试？’，大概就是这么一回事。人们以为买房买车可以让自己的生活焕然一新，怎么可能，房子也好汽车也罢，它们跟彩票没有任何区别——没中奖自然谈不上改变，可中奖了就有改变了？没钱的想暴富，暴富的怕破产，有没有都一个样。”<br>我摇摇头表示无法理解：“别人怎么想我不清楚，我也代表不了大多数人的想法，可如果是我，我大概不会买推销员不称赞的车。”<br>“所以你并不是完全明白，”他竖起手指表示否定，“买彩票的心理也是各有千秋，100元有100元的买法，1亿元又有1亿元的买法。仅此而已。”</p><hr><p>“你还是不明白”，所以我不明白的到底是什么？我已经知道了“其实哪里都一样”，同时我也知道我只是明白而已，因为我并没有把这句话奉为圭臬。我比大多数人知道的要多一些，当然和我的室友相比仍是相去甚远，不过我不是不知道自己差在哪里，那么我还有什么应该明白却不明白的呢？<br>我重新睁开双眼，回到阳光灿烂的杭州。男人熟悉的身影进入我的眼帘。西装，皮鞋，内套一件格子衬衫，还是老三样。这身打扮再加上他本就稀疏的头发，一幅成功人士的模样，至少也该是比较成功的经理人。大概一般人对他的第一印象都是这样的吧，可如果观察得再仔细一些，他那略显慌张的眼神就会将他穿着的骗局揭穿。他站在出口处，左手拉着行李箱，不知道该往哪里走——他知道自己的穿着会造成什么样的错觉，他需要这样的错觉保护自己，所以从他站在出口处起，他就必须从容不迫地做着一切，至少不该犯成功人士不该犯的错误。可他不知道成功人士基本不坐大巴远行，也不会站在车站出口不知所措，就像他从来都意识不到自己的眼神会将自己出卖一样。当然，他扮演的，或者说他希望人们看到的是一位乘坐大巴的成功人士也说不定。准确的说，是他眼里的成功人士。<br>“行李箱给我吧，”我试着接过他手里的行李箱，“今天大巴还挺快的。”<br>“嗯，是挺快的，主要高速公路上没堵车。”他将行李箱递给我，像微服私访的皇帝巡视江山一般环顾四周，“杭州这几年变化真是大啊，我都要认不出来了。我现在是眼睛都不敢眨一下，生怕下一秒连自己站在哪里都不清楚！”<br>我没有揭穿他的谎话，准确的说我是懒得揭穿他。没记错的话，这是他第一次到杭州，既然这样又为什么要说自己已经认不出杭州了呢？难道在我面前他也要装成功人士吗？话说回来，我一直都不清楚在他眼里我到底是他的儿子还是成功人士的秘书，是他可以向他人炫耀的物品也说不定，就像收藏家总是喜形于色地向拜访者展示的收藏品一样。当然怎么想都是他的问题，换句话说，他怎么想关我什么事？<br>我接过行李箱，闻到了他身上浓郁的钢铁的冰冷气味。如果机器、钢铁也是有生命的，那么他现在肯定因为自己身上的气味被它们包围，就像父母被嗷嗷待哺的孩子围住一样。他大半辈子都在捣鼓他的机器和钢铁，最后终于变成了他捣鼓的东西。我并没有嫌弃他的意思，不过是实话实说而已。毕竟没有他我能不能站在这里都未可知呢。不过也仅此而已。等到我适应了他身上浓郁的钢铁的冰冷气味后，我又闻到了隐藏在钢铁气味下的冲水马桶漂白粉的气味和属于垃圾填埋场的腐烂的气味。这些味道本不应该出现在他身上的，它们应该留在温州。或许是因为他待在温州的时间太长了，以至于温州不得不在他的身上留下极为明显的标记。<br>准确地说，冲水马桶漂白粉的气味并不该贴上温州的标签，它的影响力还没有这么大，这只不过是属于他的三十平米的出租房的气味。如果不是有独立的卫生间，这间出租房大概不至于要一个月600元的租金。可问题是，这间出租屋似乎只有卫生间。客观的说，其实还有一间小厨房，一张床，几张小桌子。但只要你在这里生活过，不用多久，只消一天（或许一天都太久了），你就会点头如捣蒜般无比同意我说的话。<br>一走进屋子，你就会闻到浓郁的漂白粉的气味。这味道其实称不上有多恶心，但就是让人感到不舒服。刚开始你还会告诉自己“没事没事，会习惯的”。可每当你以为自己已经习惯时，那熟悉的气味就会打破你的幻想。这还不算最糟的，每天早上在这样的屋子里醒来才是折磨。迎接新一天的愉悦心情还没来得及舒展她傲人的曲线就被厕所里漂白粉的气味掐死了。或许是愉悦心情离开得太快的缘故，每次醒来我都不知道自己身处何处，直到闻见了厕所里让人极为不舒服的气味，我才无可奈何地记起自己在哪，“哦，原来我哪里也没去！”我在这间屋子里大概住了半个月，结果是我花了两个月才克服了离开之后对厕所的恐惧。所以我对他能在这样的屋子里住上几年佩服不已。再说一遍，我绝没有嫌弃他的意思。<br>只有垃圾填埋场腐烂的气味才是真正属于温州的气味，是每个生活在温州的人身上都会有的标记。对温州来说，气味和天气一样，都是他的明信片。跟杭州不同的是，我的温州永远都是艳阳高照晴空万里。这样的天气就比杭州患有抑郁症的天气好吗？如果你在两个城市都生活过的话你就会知道两者是半斤八两，都一个样。说白了，天气无非是空白的名片。温州也不是非得叫温州不可。想当然地说，晴天或许不错，但不是永远不错。漂亮帅气的人肯定喜欢聚光灯，因为他们希望有更多的人能欣赏他们的美：可丑陋的人就不会这么想，因为他们害怕别人的讥讽。<br>温州就是后者。<br>温州的马路上全都是坑坑洼洼，像是荒芜的月亮上的环形山。行驶在温州的马路上，你完全不用担心自己会睡着，就是脾气最平和的司机，在温州的马路上行驶也难免要破口大骂。对乘客而言，屁股像是乒乓球一样颠来颠去其实也不算太糟，就我所知，经常有人骑着电瓶车在马路上行驶时出现人车分离的情况。<br>就像我们受不了温州的路况一样，温州的马路也不希望人们一直关注他们脸上的坑坑洼洼。如果温州的老天爷患有抑郁症就好了，这样马路大可将它们脸上的不足藏在阴影里。可温州永远艳阳高照叫它们无处可躲。马路总怀疑温州的老天爷是一位以嘲笑他人缺点为乐的变态。其实这真是误解温州的老天爷了，它不过是一张明信片。<br>温州的马路只是对新来者不太友好，只要你在温州生活的年够久，就算对这些路况不是了如指掌，但面对路上数不尽的坑洼，也就有了心理准备而不至于手忙脚乱，不就是剧烈的颠簸嘛，没什么大不了的！但不论在温州生活多少年，他们从来都不能对温州的天气和它的气味保持一颗平常心。<br>我敢保证世上没有哪里的人会比我的温州的人更加讨厌晴天了，哪怕你生活在撒哈拉沙漠也不会比他们更厌恶晴天。温州的晴天不是以嘲笑他人为乐的变态，但也绝不是什么善者。杭州的老天爷是抑郁缠身的自私鬼，温州的老天爷则是笑里藏刀的大奸贼。其实哪里都一样——刚来到温州时你可能会觉得晴天不错，天天将笑容挂在嘴角，但很快你就会发现自己哪里都去不了，温州的晴天更像是老天爷对你的无情嘲笑。<br>要想在我的温州生活，你就必须明白“生活就像扔硬币，你永远都不会知道时候是正面”。行走在我的温州的街道，你永远不知道经过这个转角自己遇见的是什么，是可以大口呼吸的新鲜空气还是无孔不入的腐臭味。<br>在温州，你看到的永远都是纤尘不染的街道，唯一让人感到不舒服的也仅仅是马路上的坑洼而已。不过这也只是无伤大雅的不舒服。可不管你在哪里，只要在温州，你就永远也逃不过垃圾的腐臭味，好像在腐烂的不是垃圾而是城市本身。不论多么外向活泼——哪怕只要在房间里待上一秒就会浑身不舒服——的人到最后都会变成不折不扣的宅男宅女。人们待在阴冷得仿佛要滴水的房间里，满眼羡慕地看着窗外耀眼的阳光，洁净的街道。要是没有腐臭味就好了。跟温州的马路一样，住在温州的人们也怀疑温州的老天爷是以嘲笑别人为乐的死变态。<br>阳光不过是催化剂，它在不经意间让温州某个角落里的垃圾腐烂。久而久之，我的温州就变成了一座经过只能捏紧鼻子快步走远的城市。既然这样，为什么不离开呢？这个问题很简单，因为温州到处都是工厂。就这么简单，只要有工厂，哪管这里是纤尘不染的城市还是肮脏不堪的垃圾场，迟早都会变成人们的聚居地。抑郁的杭州有高楼大厦，腐臭的温州有工厂，就是这么简单。哪里都一样。<br>我拖着行李箱领着他向出口走去，就像领着大顾客进入办公室的秘书。或许这就是他想要的，相比较于作为儿子的我，他可能更需要作为他的成功西装上的装饰品的我。<br>“出租车？”他像刚发现新大陆的哥伦布一样惊呼。<br>“是的。我的车出了点小问题，送到店里维修了。这也是没有办法的事。”<br>“那要不我们还是坐公交车好了，应该不远吧。”<br>“远倒是不远，就是很麻烦。你知道吧，公交车就是这样，中途总是要停站，没办法。再说，你的事还是挺急的，不然坐公交车也不是不行。”<br>“好吧，好吧。唉，出租车应该……”<br>我没有耐心继续听下去，“师傅，临安送吗？”<br>“送。行李放后备箱，按一下车标就行。两个人是吗？”<br>“安全带系好。嗯，第一次来杭州？”<br>“嗯，不是。”<br>“哦，对了，去临安要过高速，ETC的费用要你们出的。”<br>“你前面可没说。”<br>司机没说话，车速倒是慢慢降了下来，好像力竭的长跑选手。我膝盖撞了撞他，他才像想起什么似的，“好吧好吧。来回ETC的费用我们来出。”<br>司机通过后视镜看了我们一眼，“您可别说我杀生客。您在街上随便问一个出租车司机跑不跑临安，可不会有几个人像我一样爽快答应。我们杭州起步价13元，临安起步价7元，我们从临安回来根本拉不到生意。我们也得吃饭，收你们ETC的费用也是没有办法的事情。”<br>“如果不是有急事，我们本来是要坐公交车的。”<br>“公交车？幸好你们没坐公交，先不说公交要等多久，它可不上高速，速度慢了不少，再加上中间还要靠边停站，这要把人折磨死哩。真不是第一次来杭州？”<br>“我刚才听你说‘杭州’和‘临安’，难道不是‘杭州市临安区’吗？”<br>“你说这个啊，唉，原来可不是杭州市临安区。临安是几年前才划到杭州市的。跟你说实话，临安这地方本来就是农村一样的地方，可谁知道上面这样一弄，现在好了，临安的房价一个劲地往上涨，跟坐上了火箭一样。今天这里开发，明天那里建设，大变样喽。”<br>“那赶紧在临安买套房啊，也不用这样劳累地在街上跑来跑去了！”他脸上露出自信的微笑。<br>“你看，你又胡说了，”话一出口司机就意识到了自己语句中的不善，赶紧换了一种更为平和的语气，“这都是年前的事了，现在临安的房价早就饱和了，没什么上升空间。哪有什么大钱可赚啊。不过你还别说，我有个朋友，他在临安有三套房。我以前还笑他在这么偏僻的地方买房，现在一看，他可真有先见之明，现在靠房租都可以养活一大家子了。生意更是想跑就跑，不像我，唉……”<br>“啊，这样的吗？”他讪讪地笑了笑，没再说什么反倒是略有深意地看了我一眼。我像是没看到一样将脸转向窗外。千篇一律的建筑从眼前疾驰倒退。哪里都一样，无非是拥挤的人群、从一个模子里倒腾出来的高耸入云的建筑……唔，还有臭烘烘的动物园。<br>我还记得初中看过的一本书里写到：“你知道巴黎、伦敦、伊斯坦布尔并不代表你的世界真有这么大，你的世界不过是你去过的地方的集合。”我当时对它是惊为天人，并当着它的面许下“以后一定要在全世界留下脚印”的宏伟愿望。但到现在我才明白这些话全是胡说八道，好像巴黎、伦敦、伊斯坦布尔就燕肥环瘦，各有各的风韵一样。其实杭州、温州也好，四川自贡也罢，从照片上看倒是各有千秋，但身处其中你才会发现哪里的人都是如丧考妣的模样，在千篇一律的建筑间进出。不论在哪都是原地踏步。<br>内卷。我突然想到了这个最近很是热门的词语。内卷。不过我不喜欢这个词，这倒不是因为这个词指出了我们的努力全都是无用功，反正有没有这个词这都是事实。我不喜欢“内卷”是因为这个词总让我想到把人对半向内折这件事。这么说吧，《蒙娜丽莎》够漂亮了吧，但当我们把它从中间左右对称再拼在一起，这幅闻名世界的“卢浮宫三宝”之一的作品就会变得不似人样，反而像是科幻电影里的外星人。“内卷”总让我想到这些东西，所以我不喜欢它。<br>他看我一直装傻似的看向窗外看了大概有五六秒才颇为无奈地收回大有深意的目光。我当然知道他是什么意思，无非是怪我没有在临安买房。我也懒得跟他解释，准确的说我在避免争吵。因为他从来都听不进我的话。在他看来，合理的父子关系就该是儿子无条件地听从父亲，这也就是说他让你辩解已经是给足了你面子，如果你一个劲地劝他不要这样不要那样就是给脸不要脸了，因为他一定是对的。比如说，因为他待在温州，所以温州比任何地方都好；他能想到的点子你一定要实现，否则就是你不动脑子……反正在他看来他能做到的你一定可以做到，他做不到的，很抱歉，在他看来没有什么是他做不到的。他甚至说过“如果我是美国总统，说不定做得会比特朗普要好”这种话。所以我不打算解释什么，特别是在他看来很容易的买房这件事情上。<br>说“买房”容易，倒不是说他很有钱，就我所知，他当时买房也是折腾来折腾去才凑齐首付的。但“当时经历是艰难，往后回忆最平淡”，所以他也就觉得买房是易如反掌的一件事了，好像自己当时买房时有一掷千金的豪气一样。<br>记得网上有一个段子是这么说的，“为什么有些男生明明很普通，却又一幅很自信的样子？”。我不确定这话有没有普世的意义，不过用来形容他倒是最合适不过了。至于我是不是这样的人，我就说不清了，因为孩子看父母往往比父母看自己要透彻，所以这个问题该由我的孩子来回答。但很不幸，我没有孩子，其实连女朋友都没有，准确的说连可能成为女朋友的女性朋友都没有。唔，可能成为女朋友的女性朋友，对，没有……应该没有……吧。<br>“带自己老爸到临安玩？”司机突然的提问将我的思绪打断。我看了一眼面无表情的他，“嗯，算是吧。”<br>司机没再说话，似乎是在等待我的下文。不过我可没有向别人解释私事的习惯，我不知道和陌生人陷入热聊的方法，但掌握的杀死谈话的方法倒是不下于一百三十七种。<br>犹豫的沉默略显尴尬地挤进出租车。我重新将头转向窗外。建筑疾驰倒退，偶尔穿插着的未完工的建筑骨架就像博物馆里的恐龙完整骨骼一样弥足珍贵，但很快它们就会变成城里普通的一幢建筑。其实城市跟医院一个样，区别不过是规模大小、人员能力而已。</p>]]></content>
      
      
      <categories>
          
          <category> 小说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>小说or散文?——《上岸》</title>
      <link href="/2022/12/09/xiao-shuo-or-san-wen-shang-an/"/>
      <url>/2022/12/09/xiao-shuo-or-san-wen-shang-an/</url>
      
        <content type="html"><![CDATA[<h1 id="上岸"><a href="#上岸" class="headerlink" title="上岸"></a>上岸</h1><h2 id="01"><a href="#01" class="headerlink" title="01."></a>01.</h2><p>狄更斯说，这是最好的时代。但我们都知道未来会更好。无人驾驶，纳米机器人，人造器官，永葆青春……这就是未来，未来只会更好。可实际上这句话很可疑，其可疑程度就像“世上没有绝对的真理”一样，因为如果这句话是正确的，那么“世上没有绝对的真理”就应该是不易至理。同样，什么是“未来”？未来就是不可能到来的明天，它应该发生在永恒之后，可又有什么可以在永恒之后存在呢？<br>所以相比较于说“未来会更好”的人，我更喜欢活在过去的人，当然抱有这种想法的是很久以前的我，现在的我可不这样——这些连时代潮流都跟不上的人可不值得我爱。所以我现在怎么也不敢相信自己以前竟然会喜欢她。我不在这里点出她的名字，因为如果看到我写的东西，她一定会把菜刀架在我的脖子上。</p><h2 id="02"><a href="#02" class="headerlink" title="02."></a>02.</h2><p>我说她活在过去绝不是空穴来风。她不用手机，也不知道电脑为何物，在她不知道被什么东西填满的脑子里，电脑就是要被放在一间可以装下几头非洲象的房间里才行。在她看来，手机和电脑是21世纪的产物，至少她认为这两样东西是在21世纪才飞速发展的。<br>她和于谦好有一比，这就是说她也有三大爱好——抽烟，纹身，打耳洞。她说她在自己的胸前纹了一条蛇，这我是看不到的，所以我不可能拍着胸脯对天发誓说她身上有纹身。如果你要问我的想法，我想我是不相信她的话的，因为我们住的村是县里最穷的村，而我们的县又是全市最穷的县，同时我们所在的市又是全省最穷的市。如果在这里有人会纹身，而且敢给未成年人纹身，就是把我打死我也不信。<br>我告诉她纹身和打耳洞也是在21世纪才发展起来的。“至少这些千奇百怪的技术、设计都是在21世纪才发展起来的。”<br>“胡说八道。难道以前就没有纹身和打耳洞的？”<br>难道以前就没有手机和电脑的？不过我没有反驳。因为她的拳头比我的硬。谁的拳头硬谁就有话语权，从古至今都是如此。</p><h2 id="03"><a href="#03" class="headerlink" title="03."></a>03.</h2><p>我和她第一次见面是在2002年，那年我十三岁。她见到我的时候我正坐在河岸边掉眼泪。小时候就是这样，总是为一些莫名其妙的事情流泪，过后完全不记得为什么要哭。她见到我的时候我就是处于这样的状态。<br>她走到我身边坐下，可我并不认识她，只好往旁边挪一挪。<br>她好像没有看到我的这个动作，或许她看到了却假装没看见。总之她很自来熟地递给我一根烟，“抽吗？心情会好很多。”<br>我看了她一眼，她的年纪跟我一般大，戴了一顶鸭舌帽，左耳打了耳洞。活脱脱叛逆少女的模样。她话说得不容置疑好像她本人是有多年吸烟经历并深知其中美妙滋味的老烟枪。可实际上她那时候还不会抽烟，只不过是一天到晚叼着不点燃的烟罢了。这很好理解，那时候老师越禁止什么我们就越喜欢什么。<br>看到她递到我面前的香烟，我只是摇摇头表示拒绝。那时候很是羞涩，不会说“不”，只会摇头。现在年纪大了，脸皮是比之前不知道厚了多少，但说来可笑，我现在连头都不会摇了，只会一个劲地点头，“yes,yes.of course.”<br>她很没意思地收回递给我的烟叼在自己的嘴上。我扭过头去不看她，我不想让一个陌生人看见我的眼泪。现在想想，当时的自尊心可真是奇怪。她也没看我，只是叼着烟目视前方，好像她只是来看风景的。<br>我知道她其实没有在欣赏风景，她一直在想怎么安慰我。可我不稀罕她的安慰，因为谁都不希望被一个撞见自己难堪的陌生人安慰。然而事与愿违，她还是用肘撞了撞我:“喂，你说这云像什么？”<br>“不知道。”<br>“不知道？你可是全班第一啊，连这么简单的比喻都不会？”<br>“我们认识？”我诧异地看了她一眼。<br>“喂喂，好歹是同班同学啊！”<br>“这样吗？”我又重新转过头去，因为我不想让她看见我的眼泪。<br>“还想哭？”<br>“你这叫什么话！”<br>“既然不想哭，就回答我，这云像什么？”<br>“不知道。”<br>“我说你这人是有什么毛病吧！”说着她就来揪我的耳朵。<br>“喂，你才有毛病吧！”我甩开她的手。<br>“你真不知道？随便说说，这连我都知道，云像棉花嘛。”<br>“这不是我说的，我就不说。”<br>听到这句话，她气就不打一处来，使劲地把烟甩到我的脸上，“真不要脸！你做的满分卷子不都有参考答案吗？你有种也别做！”<br>她的这句话说得我哑口无言，直到几个月后我才想到怎么反驳她:“只有非原创才会孕育出原创。我们可以学习非原创，但不应该把它挂在嘴边，那不过是人云亦云罢了。”<br>听了我的话，她冷笑道:“哪有那么多原创？如果你要原创，你别说话得了。”我当时还对她的话嗤之以鼻，但现在我才算明白这世上确实是普通人居多，也实在没必要坚持原创。</p><h2 id="04"><a href="#04" class="headerlink" title="04."></a>04.</h2><p>我和她是同班同学。认识她以后我才知道这件事，但我绝不是故意的，这跟老师经常说的“真希望你不是我的学生”完全是两码事。当时我在学校里只认识老师和我的同桌，而且如果我的同桌不是我的同桌，我也不会记住他。说白了，学校是学习的地方，哪有什么时间交朋友，再说，只要足够优秀，你迟早会拥有自己的朋友。可惜当我意识到这一点时，我已经从学校毕业好多年了。<br>我不认识她，但她却认识我，这不仅仅是因为我是全班第一，更是因为我长相奇特，我长得就像是两个西瓜和四根萝卜的组合体。<br>她是全班公认的叛逆少女，这是在我认识她以后才知道的。后来我又知道这里的“叛逆”没有任何贬义，因为她是我们班的英雄。<br>我们班女多男少，就是在这些为数不多的男生里面还有人骨瘦如柴，有人像我一样胖得走路都走不稳，还有些矮的可以当墩子。所以你不难理解我们班常被其他班的人欺负。<br>这时候她就会挺身而出。比如说她会和其他班的男生在操场约架。在赴约之前，她会在口袋里装满小石子，在书包里装上一两块砖头，只要谈判破裂，她二话不说抡起书包就往对面男生的脸上砸。不管这一击中不中，她扭头就跑，边跑还边从口袋里拿出石头往追兵身上丢。听到这个故事，我就想象她像琼英一样用飞石把追兵打得落荒而逃。实际却不是这样的，她的飞石雷声大雨点小，跟琼英完全没法比，她能毫发无损地逃脱都是因为她的两条大长腿。她跑步很快，三年级的时候就打破了全校的六百米记录。也不知道是叛逆造就了她的跑步还是跑步让她的叛逆更有底气。<br>认识她没多久我就加入了她的团伙。我跟她混的一个重要原因是她每次被老师骂，总有几个男生帮她求情。你要是以为他们这是对她表示感激，那你就是大错特错了，如果她不够漂亮谁会替他求情？同样，如果她不够漂亮，我也不会入伙。其实上当时有很多人都想入伙，但她只挑选了我一个，这让我高兴了好一会儿。<br>我很快就高兴不起来了，因为她说她拉我入伙是因为我很适合做武器，这就是说她准备把我当保龄球一样推出去。<br>“喂，这就是你让我入伙的原因？”我瞬间就急了。<br>“不然你觉得你有什么用？”<br>“我又不是全班最胖的，你还不如找那谁去？”<br>“生气了？你可真逗，我拉你入伙是因为你有原创力。没有原创力怎么能让他们害怕呢？”<br>她的这句话让我很受用，于是我绞尽脑汁想出了两个方法:一个是我叫她在跑的时候跑慢一点让他们觉得自己可以追得上，然后又叫她在路上拉直一根皮筋拌他们；再一个就是叫她在晚上扮鬼吓他们。<br>前一个办法很快就被我们放弃了，因为她总会忘记这一点把自己绊倒。所以我们选择后一种方法，晚上在他们的窗前扮鬼吓人。这种方法很有效，一个星期后他们都不敢欺负我们班人了，因为他们发现如果自己不欺负我们他们窗前就不会闹鬼。<br>本来一直这样也挺好的，我就像是革命时期的地下党一样躲在幕后为她出谋划策。但不知道是哪个杀千刀的告密，我们这个犯罪小团伙就这样暴露了。<br>老师觉得我是天真无邪不谙世事才会被她的甜言蜜语骗到，所以老师不仅找我谈过话，还找我的外婆谈了谈心。老师拿出了自己的杀手锏，向我的外婆暗示我可能跟她谈恋爱了。不过老师万万没想到我外婆十二岁结婚，十三岁生孩子，外婆听了老师的暗示，露出孩子一般的笑容:“老师，这可是好事啊！这说明我们家顾问有出息啊！”<br>我以为老师这是在推卸责任，如果老师上的课比她还好看，我又怎么会跟她混呢？<br>这件事就这样不了了之了，但对她来说就不是那么简单，再见面的时候她的胳膊上满是一条条的红痕。她坐在河边岸上，嘴里叼着一根烟。我想她会哭，这样我就可以安慰她了。不过她没哭。<br>“你家里人没骂你？怎么不哭了？”<br>“我外婆不管这个的，只要我成绩够好她就不会说什么。”<br>“那你上次为什么哭？”<br>“忘了。哦，好像是因为晚上没被蚊子咬，怕它们饿死。”<br>“又说胡话了。看，我爸打的。”<br>“很痛吧。”<br>“习惯了。”<br>“如果可以的话，真希望把我外婆给你。”其实这句话算是我跟她的表白，那时候以为表白就是这样。谁也听不懂。也幸好她没听懂，不然我现在肯定后悔死。<br>“哎，你说云到底像什么？”<br>“不知道。”<br>她这次没用烟丢我，而是凑过来扭我的脸。“说，到底像什么？”<br>“不知道。”这次是真不知道，当时我满脑子都是她身上沐浴露的味道。</p><h2 id="05"><a href="#05" class="headerlink" title="05."></a>05.</h2><p>她最喜欢的电影是《猜火车》，她看了这部电影兴奋得连觉都睡不着，整天跟我说“要不是弄不到毒品，我一定要吸毒”。这就叫我很难受，难不成我喜欢的是瘾君子？话是如此，我还是看了看《猜火车》，不过我没有看完，这世上怎么会有这么恶心的电影，我看到主角掏屎就没再看了。不过她一提到这部电影就兴奋地打颤，上牙磕下牙，“要是我这辈子能拍出这样一部电影，此生无憾啊。”这话我也就听听而已，她经常有这种惊世骇俗的想法，一阵一阵的，像是得了癫痫一样。看了《闻香识女人》，她就想去学表演；看了《猜火车》，她就想拍电影……好像所有的这些都很简单，只要动动嘴皮子就可以拥有一切。<br>不过我觉得她可以试着成为下一个王家卫，做不成王家卫，也可以尝试做他的编剧嘛。这很简单，因为王家卫的台词都是一个事件+一个绕口的时间+一个无聊的事件。比如说，发生车祸之后的三天零五个小时八分钟，我又去吃了甜筒，不过这次我没要香芋味……听了我的提议，她半天才憋出一句：“跟你一样矫情。”然后就想着自己要怎样拍一部跟《猜火车》一样伟大的作品了。<br>但她很快就死心了。她一脸郁闷地跟我讲:“什么乱七八糟的，还拍《猜火车2》。”<br>“不好看？豆瓣评分8.0啊，不至于吧。”<br>“没原来的味道了。”<br>说完她就叫我去爬山。她心情不好就想去爬山，爬山确实可以让人心情愉悦，可这就难为了我这么一个将近两百斤的胖子。<br>“顾问，唱首歌来听听。”<br>“呼——别，让我休息下。”<br>“好了没，我看你是真要减肥了。”<br>“肯定的，我回去就减肥。你监督我。”<br>“恐怕不行啊。”<br>“为什么？”<br>“我要去孟加拉了。”<br>“为什么要去那么远的地方？”<br>“你说云到底像什么？”<br>“像，嗯，像牙齿流汗的疯子。”<br>“会记得我吗？”<br>“当然。”<br>“永远记得？”<br>“肯定。”<br>“手机号码会换吗？”<br>“怎么可能，换了号码你就找不到我了。”<br>说完我就感觉手心里多了什么滑溜溜的东西。我必须紧紧抓住才可以避免失去。<br>“喂，你可别把我手背上的纹身摸没了！”<br>这时候我才知道她手上的六芒星纹身是假的是可以水洗的。所以我至今也不清楚她身上到底有没有真正的纹身。<br>那是2017年，我以为她说去孟加拉跟她说自己要拍电影一样是心血来潮，就像夏天一样，每年都来但过不了多久又是秋天。可没想到那天她是来真的。她走了，好像从没有存在过一样。</p><h2 id="06"><a href="#06" class="headerlink" title="06."></a>06.</h2><p>今年是2020年，我现在在一家杭州的出版社当编辑。我工作的出版社你就是把百度翻烂了也搜索不到。如今的生活说不上好也说不上差，中规中矩罢了。<br>我现在正在去杭州的大巴车上。坐在我前座的先生和驾驶员唠嗑不止，让人怀疑他们能聊到天崩地裂。已经三个小时了。<br>我的手机响了，是来自西藏的号码。真是要人命，不知道哪个混蛋把我的电话号码发到了网上。然后就是一个劲的铃声，原来全中国有这么多人觉得自己是村上春树和卡夫卡，醒醒吧，你算什么东西，不过是一些穷困潦倒眼高手低的癞蛤蟆而已。<br>我在心里默数十个数，好家伙，反正也不可能在这么噪杂的环境里睡着，不如听听对方讲些什么。<br>“喂。”没人说话，我拿开手机看了看，没有问题。哪有人求编辑不说话的。我稍微提了提嗓子，“喂，说话啊！”<br>“是我，怎么不记得我了，顾问？”<br>“是你？没电话的！”<br>“什么话，你这是。我有名字的，我叫……”<br>“我知道。没电话的。你现在在哪呢，怎么号码是西藏的，从孟加拉回来了？”<br>“我怎么可能去孟加拉？语言不通嘛。我现在在珠穆朗玛峰山脚。你来不来。”<br>“来不了。”<br>“不能请假？”<br>“请不了。”<br>“嘿，三年前你可不是这样的。怎么，做了大编辑忙得假都没法请了？”<br>“一般般一般般。”<br>“切，就知道指望不上你。我明天要来杭州，总有时间来接我这个老朋友吧。”<br>“唔，看情况。”<br>“什么叫看情况啊，你可一定要来，我从来没来过杭州。”<br>“行，行，保证到。”<br>“这还差不多。”<br>叫人无处安放的沉默。<br>“都是老朋友了，帮我个忙。”<br>“先说说是什么忙。”<br>“就是，那个，我有本书的稿件，你能帮我出版吗？”<br>“有投稿过吗？”<br>“有，就是那个，额，反正没成。顾问，你什么意思，帮不了就说帮不了，问这些杂七杂八的干嘛。”<br>“行，看在老朋友的面子上，你把电子稿发给我，邮箱知道的吧，网上都有。”<br>“额，我的是手稿，而且我没电子邮箱。”<br>“喂，那你买手机干嘛，准备用它自卫不成？”<br>“我的是老人机。”<br>“我是服了，不是我说，现在没有智能机可不行。”<br>“唉，我今天给你打电话可不是听你讲这些的。听说你自己写书了，不错啊。”<br>完了，我就怕别人跟我讲这件事，特别是她，因为她知道我的过去。人到了一定的年纪就会想要摆脱自己的过去，所以我现在特别怕见到熟人。<br>“啊，你说那个，书写得不太好，没有看的必要。”<br>“怕什么，想不想听听我的看法？”<br>真是怕什么来什么。“别，别，我现在在大巴车上，现在不想和你吵架。”<br>“哟，你还知道啊！”<br>我知道她什么意思，以前我可不是这样的，那时候我看了王小波的《黄金时代》就把他的书扔到河里，一连说了三十个“他妈的”。这可不是我乱说，她当时还帮我数过。据她所说，在那之后的一个星期里，我总共说了三万多次“他妈的”。因为我把书扔到了河里，所以我只好又重新买一本，当我再打开《黄金时代》时，我正在说第三万两千零五十二次“他妈的”。<br>有时候我真讨厌自己的记忆力，真不知道为什么我还会记得这件事。那时候她嘲笑我多次一举，把书扔了最后又要要重新买一本。我那时候是说“我也不知道为什么，跟魔怔了似的”。其实真正的答案是“我不敢相信这本书竟然不是我写出来的”，但这句话马尔克斯说过，所以我不准备再说一遍。<br>现在我写的这本卖的还可以的书，简单来说，它就像是“一点朱红万人尝”的妓女。<br>“我这里很吵，到时候再说。”</p><h2 id="07"><a href="#07" class="headerlink" title="07."></a>07.</h2><p>“嘿，美女，等谁呢！”<br>“滚！”<br>“这么多年没见，脾气还是这样暴躁啊！”<br>“顾问？你是顾问，这么瘦了，都。”<br>我感觉有一个黏糊糊的蛇一样的东西正往我的手心钻。我赶紧把它甩开。<br>“喂，你什么意思？结婚了？”<br>“没。”<br>“有女朋友了？”<br>“也没。”<br>“那你怕什么？我又不会吃了你。”<br>“我怕什么？你能不能用镜子好好看看自己？”<br>“怎么，不好看？我不是一直都这样的？”<br>“拜托，人是要慢慢长大的。我现在要是和你手握手走在大街上，像什么样子！”<br>“你那时候可是说要永远跟我在一起的，怎么，全忘了？”<br>“你说云到底像什么？当然是像棉花啊，懂了吗？你有地方去吗？”<br>“有的。我说顾问你一直盯着我干嘛，开车啊。前面不是还嫌弃我给你丢脸了吗？现在又目不转睛地看着我，什么意思啊！”<br>“去哪？”我突然有些后悔今天来接她了。<br>“唔，就是那里，你知道吧！”<br>“那里是哪里，有地址吗？”<br>“啊，这，我又说不清。这样吧，你先开着，到地方了，我会提醒你的。”<br>“你可别诓我，我可没空带你绕杭州一圈。”<br>“知道知道，您可是大编辑，放心，到地方会告诉你的。”<br>“呵呵。我没别的意思，就是我们实在没必要把时间浪费在这种事情上，你懂吧？”<br>“开车开车，我知道，我当然知道。”</p><hr><p>“你在干什么？自从上了车就盯着我的裆看，耍流氓啊！”<br>“把你美的，我在想你兜里装了点什么，怎么还动来动去的。”<br>“手机震动。你是不知道，我原来也不知道，当了编辑我才知道原来世上有这么多人想当作家。一个个都以为自己是什么天才，要我说全都是精神病自大狂。”<br>“所以你连看都不看？”<br>“哪能啊！怎么能不看，我还得靠他们吃饭呢！不过看多少倒是看心情。”<br>“喂，那书真是你写的？”<br>“怎么又来了，咱们三年没见，能不能聊点开心的事？这种事能不能别再聊了！”<br>“你说云到底像什么？”<br>“还来，有劲吗？我刚才还说了，像棉花糖。”<br>“不，像牙齿流汗的疯子。”<br>我看她才是神经病。今天就不该来接她，早知道随便编个理由搪塞过去了。</p><h2 id="08"><a href="#08" class="headerlink" title="08."></a>08.</h2><p>我小心翼翼地关上门，好像我今天就没有出过门。手机震动不止，都是些神经病。不像我。<br>我现在已经从黑乎乎的河底爬上岸了。只要上了岸你就能听到满世界的喝彩，全世界的称赞。他们不知道这些，当然其实上他们从来不存在，他们总会上岸，世上哪会有不上岸的人。不上岸只能待在乌漆嘛黑的河里，他们怎么可能一直呆在那里呢？<br>如果他们真的存在，他们也一定是聋子，如果你能听到那些欢呼那些称赞，你会不上岸？可他们只以为我们发了疯。其实谁疯了还真不一定。<br>然而我早已上岸。只有手机震动不已。</p>]]></content>
      
      
      <categories>
          
          <category> 小说 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 散文 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>遗传算法求解问题（1）</title>
      <link href="/2022/12/09/yi-chuan-suan-fa-qiu-jie-wen-ti-1/"/>
      <url>/2022/12/09/yi-chuan-suan-fa-qiu-jie-wen-ti-1/</url>
      
        <content type="html"><![CDATA[<h2 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h2><p>在一个长度为 n 的数组中选择 10 个元素，使得 10个元素的和 与 该元组中元素总和的 1&#x2F;10 接近</p><h2 id="问题约束"><a href="#问题约束" class="headerlink" title="问题约束"></a>问题约束</h2><p>数组长度 n：10 &lt;&#x3D; n &lt;&#x3D; 100;<br>数组中没有重复的数字，所以选择的10个元素中也没有重复的数字</p><h2 id="遗传算法原理"><a href="#遗传算法原理" class="headerlink" title="遗传算法原理"></a>遗传算法原理</h2><p>请移步我上一篇的博客 <a href="https://new-ass.github.io/2022/12/06/ji-yu-jian-dan-yi-chuan-suan-fa-jie-jue-liu-shui-che-jian-diao-du-wen-ti/">基于遗传算法解决流水车间调度问题</a></p><h2 id="构建该问题遗传算法模型"><a href="#构建该问题遗传算法模型" class="headerlink" title="构建该问题遗传算法模型"></a>构建该问题遗传算法模型</h2><h3 id="染色体编码"><a href="#染色体编码" class="headerlink" title="染色体编码"></a>染色体编码</h3><p>每个染色体编码成随机选择的10个元素序列，比如 [1,2,3,4,5,6,7,0,8,9]</p><h3 id="基因交换、变异"><a href="#基因交换、变异" class="headerlink" title="基因交换、变异"></a>基因交换、变异</h3><p>在遗传算法中，可以将问题的一个可行解看成一条染色体，染色体在配对时发生基因交换或者发生基因变异生成新的染色体，即新的可行解。</p><p>而新产生的可行解（染色体）参与到下一次基因配对中，产生另一些新的可行解。</p><h4 id="基因交换"><a href="#基因交换" class="headerlink" title="基因交换"></a>基因交换</h4><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''如果交换前的解为【1 2 3 4 5】 解1【4 2 5 1 3】 解2要交换部分为【2 3 4】【2 5 1】交换后解为【1 2 5 1 5】 解3【4 2 3 4 3】 解4我们发现此时两个解中的元素有重复，需要进一步约束下面就是进一步约束此时 解1 的 头（head） 为 【1】，被交换过来的部分为 【2 5 1】，交换给解2的部分为 【2 3 4】，其中 1 重复，所以将重复的 解1 的 头（head） 更改为 被交换过来的部分1和交换过去的部分同一位置的数，所以 解3 的头（head） 为 4解1 的 尾（tail）也一样，改为 3所以最后的 解3 为 【4 2 5 1 3】          解4 为 【1 2 3 4 5】'''</span></code></pre><h4 id="基因突变"><a href="#基因突变" class="headerlink" title="基因突变"></a>基因突变</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 基因突变，从 长度为 n 的数组中随机挑选一个选择替换可行解中的任意一个元素，需要保证替换的元素不能和已有元素重复</span><span class="token comment" spellcheck="true"># 如：原来的解为 【1，2，3，4，5】，基因突变后 【1，2，17，4，5】</span></code></pre><h3 id="适应度"><a href="#适应度" class="headerlink" title="适应度"></a>适应度</h3><p>由于问题目标是：10个元素的和 与 该元组中元素总和的 1&#x2F;10 接近。</p><p>所以在该问题中可行解中10个元素的和 与 该数组中元素总和的 1&#x2F;10 越接近适应度就越高，即差值的绝对值越小，适应度越高，有适应度公式<br>$$<br>适应度 &#x3D; 1&#x2F; abs(10个元素和-所有元素和&#x2F;10)<br>$$</p><p>注意：<br>有可能随机到的可行解和总和的 1&#x2F;10 正好相等，但 1&#x2F;0 会报错，考虑到 是 1&#x2F;10，所以如果差值不为 0，那么最小的差值是 0.1，即适应度为 10，很显然相等的情况适应度最高，所以将其适应值设置为 11</p><h3 id="适应度映射为概率之后的归一化处理"><a href="#适应度映射为概率之后的归一化处理" class="headerlink" title="适应度映射为概率之后的归一化处理"></a>适应度映射为概率之后的归一化处理</h3><h4 id="适应度映射为概率"><a href="#适应度映射为概率" class="headerlink" title="适应度映射为概率"></a>适应度映射为概率</h4><p>$$<br>适应度 &#x2F; 适应度的总和&#x3D;计算映射后的概率<br>$$</p><h4 id="归一化处理"><a href="#归一化处理" class="headerlink" title="归一化处理"></a>归一化处理</h4><p>伪代码如下：</p><pre class=" language-python"><code class="language-python">此时概率列表为 <span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>概率 <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> 列表：    <span class="token keyword">if</span> 概率 <span class="token operator">&lt;</span> i<span class="token punctuation">:</span>        选择 i 对应的染色体        <span class="token keyword">break</span> 退出循环        <span class="token triple-quoted-string string">'''解释如果此时随机的概率为 0.1，那么 0.1&lt;0.2,选择 0.2 所对应的染色体如果此时随机的概率为 0.5，那么 0.5>0.2, 0.5>0.3, 0.5&lt;0.7, 选择 0.7 所对应的染色体——在判断 0.5和0.7的关系之前，循环已经判断了 0.5 和 0.2，0.3 之间的大小关系，所以在判断0.5 和0.7的关系时，我们已经保证了此时 随机的概率（0.5）不在0.2和0.3的概率范围之内'''</span></code></pre><p>具体代码如下</p><pre class=" language-python"><code class="language-python">P_guiyi_list <span class="token operator">=</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>P_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 归一之后的概率列表</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    P_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>P_guiyi_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> P_num<span class="token operator">-</span>j <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            finally_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">break</span></code></pre><h3 id="染色体配对（复制）"><a href="#染色体配对（复制）" class="headerlink" title="染色体配对（复制）"></a>染色体配对（复制）</h3><p>遗传算法配对选择的方式多种多样，对该问题我们选择轮盘赌法进行染色体选择。</p><ul><li>轮盘赌法——将个体适应度大小映射为概率进行复制：适应度高的个体有更大概率复制，且复制的分数越多。<ol><li>将适应度大小映射为概率——比如此时有20个可行解，那么就有20个适应度（比如说 1&#x2F;路程 ），那么每个可行解映射后的概率为 该可行解的适应度 &#x2F; 20个可行解的总和</li><li>轮盘赌法的详细介绍（个人理解）—— 比如一开始问题的可行解有20个，即20个染色体，在第一次俩俩配对后生成 N 个可行解，此时问题的可行解有 20+N 个（其中可能有重复的可行解），然后对这 20+N 个可行解的适应度进行降序排序，选择 20+N 个可行解中适应度前 20 的可行解进行下一次染色体配对</li></ol></li></ul><h2 id="遗传算法代码"><a href="#遗传算法代码" class="headerlink" title="遗传算法代码"></a>遗传算法代码</h2><h3 id="随机生成长度为-n-的数组"><a href="#随机生成长度为-n-的数组" class="headerlink" title="随机生成长度为 n 的数组"></a>随机生成长度为 n 的数组</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> randomnum_list_len <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>num_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num_list_len<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> num <span class="token keyword">in</span> num_list<span class="token punctuation">:</span>        num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>    num_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 长度为 n：num_list_len</span><span class="token comment" spellcheck="true"># 随机生成的数组：num_list</span></code></pre><h3 id="参数介绍"><a href="#参数介绍" class="headerlink" title="参数介绍"></a>参数介绍</h3><pre class=" language-python"><code class="language-python">N <span class="token operator">=</span> <span class="token number">50</span> <span class="token comment" spellcheck="true"># 种群规模</span>T <span class="token operator">=</span> <span class="token number">200</span> <span class="token comment" spellcheck="true"># 迭代次数</span>PM <span class="token operator">=</span> <span class="token number">0.05</span> <span class="token comment" spellcheck="true"># 变异概率</span>PC <span class="token operator">=</span> <span class="token number">0.7</span> <span class="token comment" spellcheck="true"># 交换概率</span>num_list_len <span class="token comment" spellcheck="true"># 数组长度</span>num_list <span class="token comment" spellcheck="true"># 数组列表</span></code></pre><h3 id="初始化染色体（可行解）"><a href="#初始化染色体（可行解）" class="headerlink" title="初始化染色体（可行解）"></a>初始化染色体（可行解）</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    初始化染色体    :param N:    :return:    """</span>    init_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        init_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span> <span class="token keyword">in</span> init_list<span class="token punctuation">:</span>                rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            init_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span><span class="token punctuation">)</span>        init_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>init_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> init_data</code></pre><h3 id="计算适应度"><a href="#计算适应度" class="headerlink" title="计算适应度"></a>计算适应度</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fitness</span><span class="token punctuation">(</span>init_data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    计算适应度    :param init_data: --> list    :param N: --> num    :return:    """</span>    fit_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        sum_num <span class="token operator">=</span> abs<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>sum<span class="token punctuation">(</span>num_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 有可能随机到的可行解和总和的 1/10 正好相等，但 1/0 会报错，考虑到 是 1/10，所以如果差值不为 0，那么最小的差值是 0.1，即适应度为 10，很显然相等的情况适应度最高，所以将其适应值设置为 11</span>        <span class="token keyword">if</span> sum_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            fit <span class="token operator">=</span> <span class="token number">11</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fit <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> sum_num <span class="token comment" spellcheck="true"># fit 越高，适应度越高</span>        fit_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>fit<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(fit_list)</span>    <span class="token keyword">return</span> fit_list<span class="token comment" spellcheck="true"># fit 是该可行解的适应度，i 是该可行解的索引</span><span class="token comment" spellcheck="true"># i 的意义是 当对 fit 进行排序时，通过 i 对排序之后适应度相对应的可行解进行排序</span></code></pre><h3 id="基因交换-1"><a href="#基因交换-1" class="headerlink" title="基因交换"></a>基因交换</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">change</span><span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    PC = 0.7    :param solve_list: --> 染色体种群    :return: solve_list: --> 经过基因交换后的染色体种群    """</span>    <span class="token comment" spellcheck="true"># 选择父代列表和母代列表</span>    male_list <span class="token operator">=</span> solve_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    female_list <span class="token operator">=</span> solve_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(male, female)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 选择需要交换基因的两个个体</span>        <span class="token comment" spellcheck="true"># print(j)</span>        <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.7</span><span class="token punctuation">:</span>            male <span class="token operator">=</span> male_list<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male_list<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            female <span class="token operator">=</span> female_list<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>female_list<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 两个个体之间的基因交换</span>            random_index1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要交换部分的起始索引点</span>            random_index2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要交换部分的末尾索引点</span>            <span class="token keyword">while</span> random_index2 <span class="token operator">&lt;=</span> random_index1<span class="token punctuation">:</span>                random_index1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                random_index2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># child1, child2 = male[0:random_index1] + female[random_index1:random_index2] + male[random_index2:], female[0:random_index1] + male[random_index1:random_index2] + female[random_index2:]</span>            child1_head <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            child1_tail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> male<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>random_index1<span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child1_head<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child1_tail<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            child1 <span class="token operator">=</span> child1_head <span class="token operator">+</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span> <span class="token operator">+</span> child1_tail            child2_head <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            child2_tail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 子代2头</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> female<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>random_index1<span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child2_head<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 子代2尾</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child2_tail<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            child2 <span class="token operator">=</span> child2_head <span class="token operator">+</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span> <span class="token operator">+</span> child2_tail            <span class="token comment" spellcheck="true"># print(len(set(child1)), len(set(child2)))</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child1<span class="token punctuation">)</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child2<span class="token punctuation">)</span>    <span class="token keyword">return</span> solve_list</code></pre><h3 id="基因变异"><a href="#基因变异" class="headerlink" title="基因变异"></a>基因变异</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">mata</span><span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    基因突变    PM = 0.05 变异概率    :param solve_list: --> 染色体种群    :return: solve_list: --> 经过基因交换后的染色体种群    """</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> solve_list<span class="token punctuation">:</span>        <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> PM<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># print(i)</span>            change_index  <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            i<span class="token punctuation">[</span>change_index<span class="token punctuation">]</span> <span class="token operator">=</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(i)</span>    <span class="token keyword">return</span> solve_list</code></pre><h3 id="归一化处理以及染色体选择复制"><a href="#归一化处理以及染色体选择复制" class="headerlink" title="归一化处理以及染色体选择复制"></a>归一化处理以及染色体选择复制</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">guiyi</span><span class="token punctuation">(</span>init_data<span class="token punctuation">,</span> fit_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    归一化处理以及染色体选择复制    :param init_data:    :param fit_list:    :return: init_data    """</span>    finally_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 适应度（可行解）排序</span>    <span class="token comment" spellcheck="true"># print(init_data)</span>    fit_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    fit_list <span class="token operator">=</span> fit_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(fit_list)</span>    index_list <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i  <span class="token keyword">in</span> fit_list<span class="token punctuation">]</span>    init_data <span class="token operator">=</span> <span class="token punctuation">[</span>init_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> index_list<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>    fit_list <span class="token operator">=</span> fit_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(init_data)</span>        <span class="token comment" spellcheck="true"># 概率归一化处理</span>    num_list <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> fit_list<span class="token punctuation">]</span>    P_list <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token operator">/</span> sum<span class="token punctuation">(</span>num_list<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> num_list<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 概率列表</span>    P_guiyi_list <span class="token operator">=</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>P_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 归一之后的概率列表</span>        <span class="token comment" spellcheck="true"># 轮盘赌法染色体选择复制</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        P_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>P_guiyi_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> P_num<span class="token operator">-</span>j <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>                finally_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">break</span>    <span class="token keyword">return</span> finally_data</code></pre><h3 id="迭代"><a href="#迭代" class="headerlink" title="迭代"></a>迭代</h3><pre class=" language-python"><code class="language-python">init_data <span class="token operator">=</span> init<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 初始化可行解</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>T<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    fit_list <span class="token operator">=</span> fitness<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 计算适应度</span>    init_data <span class="token operator">=</span> guiyi<span class="token punctuation">(</span>init_data<span class="token punctuation">,</span> fit_list<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 轮盘赌法选择 N 规模的 可行解</span>    <span class="token comment" spellcheck="true"># 输出迭代结果</span>    fit_list <span class="token operator">=</span> fitness<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span>    fit_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    res_index_list <span class="token operator">=</span> <span class="token punctuation">(</span>max<span class="token punctuation">(</span>fit_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min<span class="token punctuation">(</span>fit_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    res_list <span class="token operator">=</span> <span class="token punctuation">[</span>sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>res_index_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>res_index_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第{}次迭代结果：{}---{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span> res_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>res_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    init_data <span class="token operator">=</span> change<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 基因交换</span>    init_data <span class="token operator">=</span> mata<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 基因变异</span></code></pre><h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''在一个长度为 n 的数组中选择 10 个元素，使得 10个元素的和 与 该元组中元素总和的 1/10 接近'''</span><span class="token keyword">import</span> random<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> pltnum_list_len <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span>num_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num_list_len<span class="token punctuation">)</span><span class="token punctuation">:</span>    num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> num <span class="token keyword">in</span> num_list<span class="token punctuation">:</span>        num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>    num_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(num_list_len, num_list)</span><span class="token comment" spellcheck="true"># num_list_len = 78</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># num_list = [35, 30, 52, 26, 18, 70, 56, 44, 74, 71, 38, 40, 31, 90, 98, 80, 78, 50, 16, 12, 14, 19, 76, 82, 79, 11, 33, 55, 37, 88, 73, 99, 72, 65, 29, 96, 66, 97, 54, 62, 100, 85, 61, 41, 20, 49, 13, 68, 51, 28, 86, 21, 34, 83, 63, 47, 64, 48, 46, 67, 10, 95, 58, 93, 59, 39, 94, 36, 87, 42, 84, 43, 22, 15, 17, 77, 24, 32]</span><span class="token comment" spellcheck="true">#</span><span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    初始化染色体    :param N:    :return:    """</span>    init_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        init_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span> <span class="token keyword">in</span> init_list<span class="token punctuation">:</span>                rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            init_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span><span class="token punctuation">)</span>        init_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>init_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> init_data<span class="token keyword">def</span> <span class="token function">fitness</span><span class="token punctuation">(</span>init_data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    计算适应度    :param init_data: --> list    :param N: --> num    :return:    """</span>    fit_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        sum_num <span class="token operator">=</span> abs<span class="token punctuation">(</span>sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span>sum<span class="token punctuation">(</span>num_list<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> sum_num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            fit <span class="token operator">=</span> <span class="token number">11</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            fit <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> sum_num <span class="token comment" spellcheck="true"># fit 越高，适应度越高</span>        fit_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>fit<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(fit_list)</span>    <span class="token keyword">return</span> fit_list<span class="token keyword">def</span> <span class="token function">change</span><span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    PC = 0.7    :param solve_list: --> 染色体种群    :return: solve_list: --> 经过基因交换后的染色体种群    """</span>    <span class="token comment" spellcheck="true"># 选择父代列表和母代列表</span>    male_list <span class="token operator">=</span> solve_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    female_list <span class="token operator">=</span> solve_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(male, female)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 选择需要交换基因的两个个体</span>        <span class="token comment" spellcheck="true"># print(j)</span>        <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.7</span><span class="token punctuation">:</span>            male <span class="token operator">=</span> male_list<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male_list<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            female <span class="token operator">=</span> female_list<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>female_list<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 两个个体之间的基因交换</span>            random_index1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要交换部分的起始索引点</span>            random_index2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要交换部分的末尾索引点</span>            <span class="token keyword">while</span> random_index2 <span class="token operator">&lt;=</span> random_index1<span class="token punctuation">:</span>                random_index1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                random_index2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># child1, child2 = male[0:random_index1] + female[random_index1:random_index2] + male[random_index2:], female[0:random_index1] + male[random_index1:random_index2] + female[random_index2:]</span>            child1_head <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            child1_tail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> male<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>random_index1<span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child1_head<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child1_tail<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            child1 <span class="token operator">=</span> child1_head <span class="token operator">+</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span> <span class="token operator">+</span> child1_tail            child2_head <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            child2_tail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 子代2头</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> female<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>random_index1<span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child2_head<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 子代2尾</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> female<span class="token punctuation">[</span>random_index2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                num <span class="token operator">=</span> i                <span class="token keyword">while</span> num <span class="token keyword">in</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">:</span>                    num <span class="token operator">=</span> female<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">[</span>male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span>                child2_tail<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>            child2 <span class="token operator">=</span> child2_head <span class="token operator">+</span> male<span class="token punctuation">[</span>random_index1<span class="token punctuation">:</span>random_index2<span class="token punctuation">]</span> <span class="token operator">+</span> child2_tail            <span class="token comment" spellcheck="true"># print(len(set(child1)), len(set(child2)))</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child1<span class="token punctuation">)</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>child2<span class="token punctuation">)</span>    <span class="token keyword">return</span> solve_list<span class="token keyword">def</span> <span class="token function">mata</span><span class="token punctuation">(</span>solve_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    基因突变    PM = 0.05 变异概率    :param solve_list: --> 染色体种群    :return: solve_list: --> 经过基因交换后的染色体种群    """</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> solve_list<span class="token punctuation">:</span>        <span class="token keyword">if</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> PM<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># print(i)</span>            change_index  <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len<span class="token number">-1</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> num_list_len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            i<span class="token punctuation">[</span>change_index<span class="token punctuation">]</span> <span class="token operator">=</span> num_list<span class="token punctuation">[</span>rand_num<span class="token punctuation">]</span>            solve_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(i)</span>    <span class="token keyword">return</span> solve_list<span class="token keyword">def</span> <span class="token function">guiyi</span><span class="token punctuation">(</span>init_data<span class="token punctuation">,</span> fit_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    归一化处理以及染色体选择复制    :param init_data:    :param fit_list:    :return: init_data    """</span>    finally_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 适应度（可行解）排序</span>    <span class="token comment" spellcheck="true"># print(init_data)</span>    fit_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    fit_list <span class="token operator">=</span> fit_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(fit_list)</span>    index_list <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i  <span class="token keyword">in</span> fit_list<span class="token punctuation">]</span>    init_data <span class="token operator">=</span> <span class="token punctuation">[</span>init_data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> index_list<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>    fit_list <span class="token operator">=</span> fit_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>N<span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># print(init_data)</span>    <span class="token comment" spellcheck="true"># 概率归一化处理</span>    num_list <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> fit_list<span class="token punctuation">]</span>    P_list <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token operator">/</span> sum<span class="token punctuation">(</span>num_list<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> num_list<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 概率列表</span>    P_guiyi_list <span class="token operator">=</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>P_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>P_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 归一之后的概率列表</span>    <span class="token comment" spellcheck="true"># 轮盘赌法染色体选择复制</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        P_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>P_guiyi_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> P_num<span class="token operator">-</span>j <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>                finally_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">break</span>    <span class="token keyword">return</span> finally_dataN <span class="token operator">=</span> <span class="token number">50</span> <span class="token comment" spellcheck="true"># 种群规模</span>T <span class="token operator">=</span> <span class="token number">200</span> <span class="token comment" spellcheck="true"># 迭代次数</span>PM <span class="token operator">=</span> <span class="token number">0.05</span> <span class="token comment" spellcheck="true"># 变异概率</span>PC <span class="token operator">=</span> <span class="token number">0.7</span> <span class="token comment" spellcheck="true"># 交换概率</span>X <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>Y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>init_data <span class="token operator">=</span> init<span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 初始化可行解</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>T<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    fit_list <span class="token operator">=</span> fitness<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 计算适应度</span>    init_data <span class="token operator">=</span> guiyi<span class="token punctuation">(</span>init_data<span class="token punctuation">,</span> fit_list<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 轮盘赌法选择 N 规模的 可行解</span>    <span class="token comment" spellcheck="true"># 输出迭代结果</span>    fit_list <span class="token operator">=</span> fitness<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span>    fit_list<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>    res_index_list <span class="token operator">=</span> <span class="token punctuation">(</span>max<span class="token punctuation">(</span>fit_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> min<span class="token punctuation">(</span>fit_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    res_list <span class="token operator">=</span> <span class="token punctuation">[</span>sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>res_index_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sum<span class="token punctuation">(</span>init_data<span class="token punctuation">[</span>res_index_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第{}次迭代结果：{}---{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>i<span class="token punctuation">,</span> res_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> res_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    Y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>res_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    init_data <span class="token operator">=</span> change<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 基因交换</span>    init_data <span class="token operator">=</span> mata<span class="token punctuation">(</span>init_data<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 基因变异</span>res <span class="token operator">=</span> sum<span class="token punctuation">(</span>num_list<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>y <span class="token operator">=</span> <span class="token punctuation">[</span>res<span class="token punctuation">]</span><span class="token operator">*</span> <span class="token punctuation">(</span>T<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(x)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span>color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/bba4797d412347a687cfd3da545214b8.png"></p><p><img src="https://img-blog.csdnimg.cn/e880b30923254bf49c69433d203796a1.png"></p>]]></content>
      
      
      <categories>
          
          <category> 遗传算法GA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遗传算法GA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(13)——后记</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-13/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-13/</url>
      
        <content type="html"><![CDATA[<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>我们读诗、写诗并不是因为它们好玩，而是因为我们是人类的一分子，而人类是充满激情的。没错，医学、法律、商业、工程，这些都是崇高的追求，足以支撑人的一生。但诗歌、美丽、浪漫、爱情，这些才是我们活着的意义。——《死亡诗社》</p><p>人活着总是在追寻某种自由。<br>马克思和恩格斯说：“只有在集体中才可能有个人自由。”其中“可能”二字委实妙不可言，饱含辩证法精神。<br>就我浅薄的见识和阅历而言，无论是集体对个人的评价还是个人对个人的评价似乎都是以某个特定模板为标准的。以成功为例，读书学习是走向成功的道路之一，除此以外还有千万条道路，写作就是其中之一；但如果你想靠写作为生，很不幸，集体或个人会告诉你全中国靠写作吃饭的人并不多，所以他们的建议是先好好学习吃饱饭然后在试着写作。换言之，他们似乎在告诉你学习学得如何你最后都会获得幸福（如果幸福是吃饱饭的话），而写作，除非你能写出名堂，否则就无幸福可言。而且在学习后感到幸福后你可以做你想做的事，从而让自己更幸福。<br>但我觉得这一套是很可笑的，因为它忽视了个体感受。所以我觉得马、思两位哲人所说的“可能”在今天看来是很有自知之明的。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(12)——浮游吧，For You（二）</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-12/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-12/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="十一．浮游吧，For-You（二）"><a href="#十一．浮游吧，For-You（二）" class="headerlink" title="十一．浮游吧，For You（二）"></a>十一．浮游吧，For You（二）</h1><p>有人在按门铃。零的手在床头柜上试探性地摸了几把才抓住手表。5:38A.M.早上5:38，这也就是说现在上门的不是产品推销员，也不是收电费查水表的公司职员。这样一来就只能是公寓里的邻居了。零挣扎着爬了起来。<br>零知道自己可以装作什么都没听到把卧室门关上再堵上自己的耳朵继续躺在床上睡到天荒地老。可这样以来就和零的人设不相符合了。大早上狂按门铃说明对方一定有很要紧的事要零帮忙。听到这样的门铃，零作为热心的好邻居是怎么也不可能对它充耳不闻的。<br>所谓人设，不过是杀手隐藏自己的一种方法罢了。一般人都知道高调会引人注目，所以很多杀手就以为低调可以让自己“泯然众人”。可实际上“低调”是“神秘”的同义词。一个人整天呆在家里，避免和任何人接触，并不能消除别人对你的好奇，相反这样所招致的侧目并不会比高调示人所引起的注意要少。只有“平庸”才是“普通”的同义词——每天准时出门按时回家，必要时向邻居寻求帮助，顺手帮邻居解决几个小麻烦。这样才能让杀手伪装自己融入普通人。这样精辟的结论自然不是零总结的。零所知道的全部都是木匠教导的。<br>不过零还是猜错了，站在门前催命一般按着门铃的是29。今天29的皮肤仍然黯淡无光，全然没有往日的光泽。零对29知道自己的住址并不感到奇怪，自己的信息在组织里并不是机密，更何况29还有属于自己的情报渠道。<br>“提醒一句，你踩到雷了。”<br>“啊？”29露出睡醒后才有的特有的恍惚表情，好像他比零更惊讶自己为什么会站在这里。“你刚才说什么？”<br>“我是说你踩到猫屎了！”<br>“哦”29抬起脚看了看自己的脚底，“没事。你穿的是什么，睡衣？”<br>零倒不觉得29的问题有多奇怪，他可以很清晰地理解29——“杀手只能相信自己和自己手里的枪”，任何以为杀手都不能保证在自己睡觉的时候不被仇家找上门。换言之，优秀的杀手从不躺在床上睡觉，他们从来都是双手持枪坐在椅子上睡觉的，哪怕有一只蟑螂在地板上爬过他们也会迅速地睁开双眼，警觉地探视四周的情况。<br>零略显无奈地笑了笑，“我只是零，没必要这样苛责我吧？真不进来坐坐？”<br>29看看手表：“没时间了。我还是长话短说，你最近要出事。”<br>“出事？”零觉得有些好笑，“我最近是要出车祸还是——？”<br>“我没在开玩笑，”29不耐烦地打断零，“追悼会结束后有人看见画家从你公寓里出来。组织怀疑你和画家勾结。”<br>“真的假的？是，那天是有人找我，不过他是组织派来的，组织不可能不知道这点。再说，谁看见画家从我家出来的，我怎么没看见？”<br>“那个组织派来的人是谁？”<br>“F区幸福小镇23小区第一单元的985。有什么问题吗？”<br>“有什么问题？我说你难道不知道画家在获得个性化称号前完成了九百多个任务吗？这在组织里是前无古人，我想应该也后无来者。”<br>这句话像是一条线将所有的线索全都串成一串，之前想不通的事零现在全都明白了。但这是自己莫名其妙被按上的罪名：“这我又怎么会知道？我只是零啊！我应该知道吗？”<br>29瑶瑶头，“这也是没办法的。重要的不是你怎么想，而是组织怎么以为。”<br>零突然想到了什么，“所以你是来抓我的？”<br>“现在是5:43，组织的人应该会在六点左右到这里。你没多少时间了，赶紧整理整理东西走吧。”<br>“为什么这样帮我？”<br>“没时间了，与其纠结这种东西还不如赶紧整理东西走吧。”<br>29倚在门框上看着零走进走出，像是在看忙着搬家的蚂蚁。趁着零在卧室整理衣物，他开始打量零的公寓。更普通人的公寓相比，零的公寓只能用“简约”来形容，但如果是跟其他杀手相比，这间公寓就是金碧辉煌的宫殿。<br>一般的杀手的公寓里只有一张椅子和一张床。床除了是用来隐藏自己的工具，还是用来锻炼的器具。床是俯卧撑和仰卧起坐的必需品。杀手的厨房空无一物，连冰箱都是不必要的，杀手的三餐无非是几片面包和一瓶牛奶。<br>很显然，零的公寓不是这样的，就以29倚在门口的有限的视角来看，他可以很清晰地看到两台音箱和一架堆满书本的书架。29看不到零的客厅和厨房，但他可以想象出零的厨房：就算不能说是锅碗瓢盆一应俱全，但说到做菜却是绰绰有余的，在灶台旁边一定会有一台冰箱。或许冰箱里面空空如也，但不管怎么说他还是拥有冰箱。<br>5:46。<br>29用手揉揉太阳穴，零从来就不是杀手，这种想法已经不是第一次出现了。与其说他是杀手，倒不如说他是走错房间的孩子。他从不以“杀手”自居，穿着睡衣安稳地睡在床上，住在“奢侈豪华”的公寓之中。家居众多就意味着麻烦，因为这样一来发生紧急状况时你就不能保证武器一定在自己触手可及的地方。零不是真正的杀手。<br>5:52。<br>29重新换了个姿势靠在门框上。他用指尖轻按双眼试着保持冷静。零到底在干什么！明明东西都已经整理好了，绿色的旅行袋都已经放在门边了，他又回去找什么呢？29看着零火急火燎地从这个房间走到另一个房间。他好像在找什么要紧的东西。要是现在组织的人来了我又该作何解释？29根本想不出什么好办法，要是真这样自己也只好在组织的人询问前把零杀了。<br>话说回来自己又为什么要帮零呢？这个问题其实不是29不想回答零，而是他根本不知道答案。如果硬要说什么的话，29觉得零不可能会和画家勾结，不因为别的，就因为零不是杀手。但这个理由连他自己都说服不了，更何况向零解释。这个理由只能解释自己对零的同情，可同情却不值得让自己冒着生命危险救他，那么到底是为什么呢？<br>当29反应过来时零已经背着旅行包手捧吊兰站在他面前了，此时零一幅要哭的表情。<br>“整理好了？”<br>“吉祥不见了。”<br>“吉祥？”<br>“我家的猫。他不见了。”<br>29松了一口气，“那没事，我是说猫说不定先走了。不管怎样，人总比猫重要。现在已经五点五十六了，再不走就来不及了。”<br>“猫或许确实比我们自由，但猫和人说到底又有什么区别呢？”话虽如此，零还是走出了大门，“29，如果你看到他，一定要替我好好照顾他。”<br>“行，我是说如果我遇到他的话。”可实际上29根本不知道零的猫长什么样子，这世上也没有哪只猫会在脑门上写着“吉祥，零的猫”这几个字。29也实在不明白不过是一只猫，就真的这么值得在意？<br>零突然停下脚步，“有件事我觉得有必要让你知道，其实个性化称号是一个骗局，组织——”<br>“能猜到。”<br>“那为什么？”<br>“除了杀手，我不知道自己还能做什么。作为杀手我还拥有更多，如果我逃了，我就什么也没有了。不像你，我知道你一定知道自己要做什么。”<br>“怎么可能，我也是被逼无奈的。谁想啊！”<br>“都这样了还不相信我？不跟我说实话？随便你，有些事自己知道就好。好了，快走吧。”<br>零突然停下脚步，“我跑了，你在这里被组织知道了怎么办？”<br>“我不过是好大喜功的杀手。再说，一位负伤的杀手无论如何也不会去追一位亡命之徒的，哪怕对方是零。”<br>“谢谢。”<br>5:58。<br>一道清脆的枪声划破天际。零回头看了眼冰冷森严的公寓，希望29只是朝自己的胳膊或是大腿开了一枪，而不是像海明威一样朝自己的太阳穴开枪。<br>零抬头望天，今天是阴天。他隐约感觉有些闷，可能再过一会儿要下雨。It rains dogs and cats。要是现在吉祥在就好了，他可以轻而易举地闻出是否有下雨的征兆。如果会下雨，吉祥就会跳到自己的头上把自己的头发挠成鸡窝，好像在催自己快走一样；如果不下雨，他就会慵懒的趴在自己的怀里休息。不知道他现在在哪。<br>零现在只有一个地方可以去。也正如画家所说的那样，当选项出现时，他不会犹豫，也不会有任何纠结。</p><p>零从来没有在白天来过浮游吧，所以他从来不知道酒吧在白天是这样的冷清——此时酒保正坐在柜台后面剥土豆，而画家则无聊地试着让高脚杯仅仅靠底部的一个支点立在桌面上。有钱人的游戏，每次高脚杯立足未稳摇摇欲坠之时零都替画家捏一把汗，虽说一个高脚杯不怎么值钱，但一直玩这个游戏损失怕也不小。偌大的酒吧只有三个人，给零世界末日来临的错觉。零随即想到酒吧这么冷清也有可能是太早的缘故。<br>画家对面摆着一杯“哈尔9000”，零径直走过去坐下。旅行包放在脚边，吊兰摆在柜台上。见到零，画家露出笑容，满脸的皱纹也随之和蔼一笑，“你来了。”<br>“我回去看了《2001：太空漫游》。你该不会要在酒里下毒把我毒死吧。”<br>“都说了，叫这个名字是因为我喜欢。只是典故出自《2001：太空漫游》。”<br>“所以你也是知道这件事的？”<br>“知道一些，但知道的不多，跟你知道的差不多。”酒保说话的时候手上的动作可没有停。零不知道剥这么多土豆是给谁吃。<br>“很好。所以你不觉得要给我一个解释？”<br>“你难道猜不出来？”画家此时没有再玩找重心的游戏，他把高脚杯倒扣在桌上，“骗你就是骗你了，这没什么好辩解的。我想你也应该明白我为什么会骗你。没错，我是答应过你老师，在必要的时候帮你一把，但我不认识你，我不可能在听了木匠的一面之词后就毫无保留的相信你。我好不容易才逃出来，可经不住失败。再说我也没有逼你选择，你也不是没有选择的余地。”<br>“选择的余地？难道我要等着组织来抓我？”<br>“哦？”这回倒轮到画家惊讶了，“我还以为你是自愿来的。其实组织也只是来抓你的，到时候你只要发挥一下作家的想象力就可以摆脱和我联系的嫌疑。你的的日记在我这里，组织也没法借题发挥。再说，你是木匠的徒弟，组织在没有证据的情况下是不可能为难你的，他们这点脸还是要的，最多他们也不过是把你边缘化，好吃好喝的供着你以彰显他们的人情味。这难道不是你可以接受的？我想这也算是变相地帮了你一把吧。”<br>“可我没有这个选项。我现在总不能回去了吧？”<br>“是，”画家抱歉的笑了笑，“我承认这对你来说不太公平，是我疏忽了。但在我看来，这反而是好事，说明像木匠的人还是有的，至少帮你的朋友是一个。而你，不觉得我们有点像吗？”<br>“别，可千万别把我们混为一谈。你是一个劲的想走，我可不是。我是没得选，至少我以为自己没得选。”<br>“零，有时候不是别无选择，而是那个选项正好是你的心之所向。”<br>“你这话说的，反正现在我也只能待在你这条贼船上了，随你怎么想。要我说，你和酒保倒是真想，净说一些高深莫测之语。不当哲学家真是可惜了。”<br>“能不像？我是浮游吧的老板。”<br>“啊？”<br>门外传来细微的撞击声，酒保放下土豆，“我去看看。”<br>“别紧张，零。绝影和组织还不知道我是这儿的老板，也就是他们现在还是一种隔岸观火的状态。外面是敌人的可能性很小，基本可以说是没有。”<br>“你真是这的老板？他们都说你和这的老板是朋友，你是怎么躲过组织的监控的？”<br>“隐藏自己的方法千千万，只要想总会有办法的，你看就是天气也会有没有太阳和月亮的时候。只要你愿意没有什么是不可能的。你不是知道一个先例吗？绝影。不过我不打算建立另一个组织，因为我知道自己迟早会给后人误解的，就像扑克一样。”<br>“浮游吧是你的心血所在，准备死守着不放？”<br>“何至于。这里迟早会给夷为平地成为组织或是绝影的地盘。我们肯定不能再待在镇子里，最好是到外面去。我行李都准备好了。”说着画家提起脚边的旅行包放在柜台上。<br>零开始向想像一幅地图。这里是镇子，那里是山。似乎哪里都是山，镇子以外是什么他全然想象不出，也没有人告诉过他。或许地球就只有一个镇子那么大。“外面？外面是哪里？”<br>“山那面是沙漠，我就知道这么多。跟不跟我们来取决于你，我不要求你什么。”<br>“难道我能在这里待下去？别逗了，我别无选择。”<br>画家露出与好友久别重逢的笑容，“别再自欺欺人了，你不是别无选择，只是你自己要这样做。如果你现在向组织举报出卖我也还来得及。”<br>“说得有道理。说不定我已经这么做了，你看酒保到现在都还没回来。”<br>“你就别再试探我了。我知道你，你跟我是一类人，相信我。”<br>“相信你？要我相信一个逃离组织以后还带着画的人？”零指着画家旅行袋上的法式长棍似的画筒。<br>好像零讲了一个很好笑的笑话，画家脸上的皱纹旁若无人地放肆大笑，“我承认因为自己的疏忽让你遭受了一些不公平待遇，但人生难道是事事公平的？而且我也说了这也是你的心之所向，这是不是事实你自己心里清楚。当然你大发雷霆我也是清楚的。不过你由此说我是扯谎鬼就过分了。<br>“‘画家’这个名字可是百分之百纯粹的不能再纯粹的个性化称号了，我每做一个任务都故意留下一幅画，这样才在完成九百多个任务后逼迫组织授予我‘画家’的名字。如果这都不叫‘个性’，那我就要好好问问你什么是‘个性’了。”<br>零没有再说话，画家也没有乘胜追击。男人之间的交流，莫如说人与人之间的交流点到为止即可，也实在没有必要逼着对方承认错误。<br>画家率先打破这沉默，“你呢，还打算叫‘零’？”<br>“不清楚。”<br>“没考虑过‘作家’或是‘文豪’？”<br>“那太不谦虚了。”零突然想到了什么，“真的要去沙漠？那里有人住？”<br>“有的吧，”画家眼里闪着异样的光补充道，“总会有的。”<br>零开口想要再说些什么，此时酒保推开门冲了进来，他把吉祥举在胸前，“零，这是你的猫吧！”<br>“是的。不过现在我不叫‘零’，我现在是‘写手’。”<br>他知道猫总是对的。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(11)——猫总是对的</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-11/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-11/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="十．猫总是对的"><a href="#十．猫总是对的" class="headerlink" title="十．猫总是对的"></a>十．猫总是对的</h1><p>零面前坐着一位老人。他头发胡须雪白，好像去染发时粗心的理发师一不小心顺手把胡子也一起染白了一样。他的白发披肩，跟胡子混为一体，说是头发长在下巴上零也会相信。零想到或许这就叫“头发胡子一把抓”。看着眼前这位披头散发的老者，零立马就想到了“白毛狮王XX”和“甘道夫XX”的名字。同样向零明示眼前之人年迈的是他脸上的皱纹。尽管人们常说时间之神用刻刀在人们脸上划出一道又一道的皱纹，但实际上零从未见过有谁的皱纹可以用“刻出来”形容。除了眼前的这位老人。他脸上的皱纹就是用“沟壑纵横”形容也不为过。零看着他深刻的皱纹和他干净的脸，不禁在想他每天早上洗脸时花在清理皱纹里的灰尘的时间要多少。<br>当零走进客厅时，老人正坐在落地窗前的圆桌上津津有味地看着零的日记，好像那是最近正流行的通俗小说。落日的余晖透过窗子撒进房间，像是画家手上神奇的画笔，勾勒出老者身体的轮廓线条，给他镀上一层金。<br>日记是很私人的东西，换言之，日记从来都不是写给别人看的。零写的日记从未给别人看过，哪怕是自己最尊敬的老师也不例外。零平常都是把日记锁紧保险箱的，但现在眼前这位老人正在看着自己的日记而且还不住的点头，好像自己写的全是他知道的却不知如何表达的东西。现在会出现这种情况就说明自己以为万无一失的保险箱已经被眼前这位行将就木的老头打开了。<br>零一直以为当别人未经允许翻看自己的日记时自己就会像被惹怒的猫一样弓起身体，喉咙发出低沉的有警告意义的声音，然后像弹簧一样弹射出去给对方留下终生难忘的记忆。实际情况也是如此，记得有一次木匠因为无聊随便翻了日记几页，零就和木匠冷战了好几天。其实里面也并没有什么隐私，但不论有没有经过自己的同意，别人翻看自己的日记总给零一种叫人扒光丢到动物园里任人欣赏戏耍的感觉。<br>这种感觉并不适用于吉祥。吉祥不过是一只猫，零根本不担心他会对谁说什么，就算要说他也只能跟其他的猫讲。且不论短尾猫和镇上的野猫们语言是否相通，就算世上所有的猫都可以无障碍交流，但这些猫谁又知道零是谁呢？而且零写日记的时候吉祥总会在旁边看着，可以说吉祥是零的日记的第一位读者。甚至如果没有吉祥在旁边“监督”零反而不知道该怎么写下去。<br>有时候零会忘记整理日记把它放回保险柜之中。这就是说有时候当零早上起来时他会看到吉祥正在拨弄自己的日记本。日记中有些遮住内容的梅花印就是这样来的。但就算吉祥的脚印会遮盖日记的部分内容，零也不会生气，因为日记不是写给别人看要别人评价的东西，有那么循规蹈矩干什么。相反零以为自己的日记中有吉祥留下的梅花印能让日记更像日记，平添了不少生活气息。<br>除此之外眼前这位老人也没有给零一种受侵犯受侮辱的感觉，或许是因为老人身上被落日余晖细细勾勒的轮廓给零一种神圣的感觉。神圣的人到底很难让人厌弃。在零看来，自己很难对对方抱有敌意有很大部分的原因来自此时正慵懒地趴在老人腿上的一脸惬意的吉祥。猫总是很奇怪的，有时候对人热情得过分，有时候又对人不理不睬冷淡得可以，但有一点可以肯定，对自己不喜欢的人猫死活都喜欢不起来。就算木匠和零认识了这么久，甚至可以说是情同父子的关系，吉祥对木匠也是一副爱答不理的样子——看到木匠走来它也不过是抬抬眼皮，要是木匠要过来试图抱吉祥，它就会轻巧地跳开，重新挑选一块舒适的地方趴下，给木匠留下一个结结实实的狗啃泥；其实这还算好的，要是碰上吉祥心情不好的时候，留给木匠的就不仅是狗啃泥那么简单，还有一颗“猫屎”地雷和一个在说“我就是这样不待见你”的白眼。<br>零就这样站在这里静静地看着老者翻看自己的日记一点也不着急。零开始怀疑到底自己是这里是自己的家还是他才是这儿的主人。但这只是那种百无聊赖式的怀疑，总的来说对面的老者并不让零有距离感，好像他们是认识了多年的好友。<br>终于，老者合上零的日记，轻轻抚摸着吉祥。像是得到了指示一样，吉祥轻盈地跳上圆桌继续趴着，像是金字塔前的狮身人面像。对两人吉祥全然不顾，只是眯眼沉浸在自己的世界里。<br>老者站起身来。零目测对方身高有一米九，但老者的身高并没有给零带来排山倒海式的压迫感，这与老者的气质有关。也与吉祥的表现有关。吉祥毫不紧张，相反露出的是安详平和的表情（在零看来），那表情仿佛在说“没关系的，零。别紧张，他是朋友哦”。零对吉祥的表情和他表情下传递出来的信息完全没有怀疑，因为零知道猫总是对的。<br>老者零露出灿烂的笑容，脸上的皱纹也随之舒展开来，露出不尽相同却一样发出善意的笑容。“啊，不好意思没看到你来了，看日记看入迷了嘛！”随后他意识到自己的这句话有歧义，赶紧解释道：“我不是故意故意要看你日记的，只是好奇，呃，也不能叫好奇。唉，这要怎么说——”<br>“没关系的，”零摇摇头。他看得出来对方是为自己看日记的行为看到难为情，虽说零没有多少经验，但他还是可以轻易地判断出对方是真的尴尬还是故意表现出来给自己看的尴尬。“没关系的，只要别对别人讲就行了，也不是说有什么见不得人的东西，你刚看过这你也是知道的。日记毕竟是很私人的东西。话说回来，前辈您找我是有什么事吗？”<br>老者看到零没有大发雷霆，马上放松下来，“放心吧，这种事情我还是清楚的。其实就算我真要跟谁讲这些也没有会想听。说真的，你当杀手真的是一个错误的选择，如果你能下定决心做一个作家，我不敢保证你一定会声名鹊起，但我想肯定比现在当杀手要好。”<br>零完全揣摩不出老者的意思，他究竟是有感而发还是在这里故意设下一个陷阱钓鱼执法？“前辈一定是在说笑，成为杀手可是我的愿望。再说我又怎么适合当作家呢？”<br>“真的？”老人瞪圆眼睛挑挑眉表示惊讶，聚集的抬头纹则是露出疑惑的表情。不过他没再说什么，他知道零现在还不可能完全信任自己，“哦，忘了自我介绍了，我是F区幸福小镇23小区第一单元的985。”<br>“原来是F区幸福小镇23小区第一单元的985前辈啊，不知道您找我是有什么事？”零完全不敢相信对面的老者在完成了985个任务后都还没有被授予个性化称号。<br>“可别叫我前辈，也别叫我的全名，如果它真是我的名字的话。说老实话，这又臭又长的名字简直就不是给人记忆的。如果可以的话，也别叫我前辈，我无非比你早生几年早做了一些任务。如果你立志要成为真正的杀手，你就会发现我并非优秀的杀手。就以你那个整天画直不直弯不弯的墨线的老师木匠为例，他是组织里获得个性化称号时完成任务最少的，如果我没记住的话好像是217个。根据组织的记录，平均完成三四百个任务就可以获得个性化称号，像我这种完成985个任务都没获得个性化称号的在组织里是独一份。<br>“至于今天我找你是为了什么事，我建议你最好还是坐下来听。有些事情只适合坐下来听。我不太确定这件事对你而言究竟意味这什么。”<br>零忐忑不安地坐在985对面的凳子上，不知所措地看了眼趴在他和985之间的吉祥。吉祥仍然趴在桌上小憩，完全不在意他们两人在干嘛。如果不是他随着呼吸而上下起伏的肚皮，零都要怀疑吉祥是不是在梦里安详地去世了。零越看越觉得吉祥趴着时的动作、平静的神情和狮身人面像没有任何差别。应该没问题的，零看着吉祥想到。<br>985从上衣口袋里掏出一只黑色的录音笔，“这是你老师死前跟画家的一段对话录音，我想你应该会感兴趣的。”说着他按下播放键。<br>“开始了？”这是木匠的声音，是零现在只能在梦里才能听到的声音。<br>“开始了。如果要讲什么遗言，还是快点讲完为好，我可没那么多的时间在这里陪你。”这不是木匠的声音，如果985没有撒谎那这就是画家的声音了。零总觉得画家的声音有些熟悉。<br>“说实话，我是没想到你这个老疯子竟然真的会这么做。”<br>“有必要这么惊讶吗？组织的那些勾当你我都心知肚明，我也不是非得这么做，全都都是组织逼的。你就别说我多疯狂了，你难道就不想这么做？”<br>“大家都一样，谁不是被生活所逼？我也这么想过，但成功的可能性太小了。我敢说大部分人都想这么做，可又有谁有这样的勇气呢？那句话怎么说的，当你有了权力之后，你最想要的是更大的权力，而同时最怕的就是失去它。可能性太小，谁敢用自己拥有的一切冒险呢？没这勇气，倒是有骗人的魄力。骗人谁不会？我是真没想到你竟然成功了。”<br>“可别把事情说得这么轻松，我付出了多少你又不清楚。”<br>“是啊是啊，”木匠的声音低沉了许多，“要想成功不付出点什么又怎么能行？道理我自然明白，我也肯坚持，只是害怕失去。因为这他妈太难了。”<br>“你难道甘心一辈子都做木匠？每天画着这些直不直弯不弯的墨线你就知足了？还是说你喜欢他们看你时羡慕尊敬的眼神？”<br>宛如实质的沉默不知何时充斥于整个空间，零感觉呼吸有些不顺畅。橡胶质感的沉默。零诧异地看了985一眼，用手指了指桌上的录音笔，好像在说“怎么回事？坏了还是结束了？”985摇摇头，也用手指了指录音笔，似乎在说“别紧张，等等就好”。<br>大约半分钟后，木匠的声音再次传来，“面对你说遗言，感觉怪别扭的。”<br>“叫我帮忙录遗言的是你，现在说别扭的也是你。你该不会是在拖延时间吧！”<br>“拖延时间？亏你想得出来。我巴不得不能逃过组织的追捕呢！别把我想得这么不堪，再说如果我真是来抓你的，你现在还能这么轻松？好好想想吧。唉，其实我死就死了，我这种人老早就算已经死了吧，就是可怜了我的徒弟啊。”<br>“如果我是你，我就想办法带着他一起离开，就算不为自己也是为他。”<br>“说得简单，以为人人都是你啊！如果我一直活着，零根本跑不了。只有我死了他才有逃跑的机会——他只是零，组织不可能花大力气监视他的。看过《斑羚飞渡》没有？”<br>“没看过。我也不想知道这是什么东西。你确定自己真不是在拖延时间？你要是再跟我乱七八糟地扯这些有的没的，我们可就不能像这样心平气和地聊下去了，我可不管三七二十一只能一枪崩了你！”<br>“这可不能全怪我，谁又能心平气和地直面死亡？”<br>“说实话，我觉得你就算死了，你那宝贝徒弟也不见得能逃出去。”<br>“所以我才会这么积极地来抓你，今天我死了也顺便把你放走了，你可就欠我了一个天大的人情。既然我已经死了，那这人情就还给我的徒弟好了，帮我徒弟一把。”<br>“你想的可能有点多，你这样帮我我当然很感激。至于你的徒弟，反正你已经死了，我帮不帮他你也不知道了。说实话这段录音能不能送到你的宝贝徒弟手里还是的问题呢！你会不会太看得起我了？”<br>“都到这地步了，冒险一下又何妨？帮不帮忙随便你，你开心就好，反正我押你赢。好了好了，你也别烦我了，真的要说遗言了。”<br>“现在准备好了？”<br>“准备个头，你能对死亡保持平常心？可别跟我扯什么‘感谢死亡’。哪有什么准没准备好，只是死我一个和死咱们三个的数学题罢了。”<br>“思想境界够高啊！”<br>“到底是我在拖延时间还是你自己在拖延时间？你还是闭嘴吧。别到时候我们谁也走不了。”<br>隔了几秒，木匠才重新开口，似乎是在酝酿情绪。<br>“零，当你听到这段话的时候，我应该已经死了。请不要说我‘牺牲’了，我的死跟任何人都无关，更不是为了组织。如果说真是为了谁，我想也是为了你。<br>“自你成为正式杀手，取得‘零’这个名字后，我就一直在想这真是一个正确的选择吗？我想不仅是我，就是你也应该能或多或少地意识到自己并没有做杀手的诸多天赋，甚至连平庸的杀手也称不上。每当我看见你起早贪黑拼命训练时我都会在想你会不会有别的可能性。我想你也应该知道这个问题的答案——你是零，是组织的杀手，你不可能是你自己。<br>“但现在我发现其实也不是完全没有希望，所以我选择用自己的死来换取画家的帮助。刚刚说了，别说我是‘牺牲’的，哪怕我是为你而死，也不要以为我对你的期望有多大。我这样做也是有私心的，因为这是我未竟的梦想。<br>“我还记得你那时候从浮游吧回来问我有关‘木匠’这个名字的问题。如果我没记错的话，我告诉你‘木匠’并非私人性质的名字，组织也不是不近人情的。很抱歉，我说谎了，组织就是这般不近人情，所谓的‘个性化称号’从头到尾都是一个骗局。<br>“你的猜测没有错，我叫‘木匠’是因为用断头台和大风车残忍杀害了那个最后被截成两节的人。不过这个名字的非私人性也体现在这里，这个人不是我杀的而是组织帮我杀的，就像罗贯中帮诸葛亮火烧博望坡一样，可笑。个性化也是组织施舍的。我叫‘木匠’只是一场表演，我又不喜欢木工，我喜欢的是书法啊！<br>“我想你可能也注意到了，我从来没有接受过什么任务，这是‘个性化称号’的福利，没有这个我怎么会骗人呢？说到底，怕了，拥有的越多越害怕失去。可实际上都是哄人的把戏。<br>“零，人之将死，其言也善。我是真的不希望你走我的老路。如果你愿意的话，还是接受画家的帮助吧。别相信组织的鬼话，我用脚趾头都知道他们会说什么。绝影和组织是一路人，画家不可能和他们参和在一起。”<br>“喂，还等什么，赶紧给我来一枪，准备好了现在，等下就不好说了。”<br>“早知如此，何必当初。”<br>“说到这个，我死后你要给我念悼词不的？”<br>“唔，‘人死身灭，精神永存’怎样？”<br>“别，千万别，死了就别再打扰我。‘人死身灭，精神永存’还不如‘人死身灭，干干净净’。”<br>“那行，就用‘人死身灭，干干净净’好了。”<br>“喂，我的意思是说……算了，随便你，只要不是‘人死身灭，精神永存’就行。”<br>“一路走好，我的朋友。”<br>“兄弟，祝你好运。”<br>“砰——”。吉祥被枪声惊醒，像屁股给打火机点着似的慌忙跳下桌子。吉祥疑惑地往回望了一眼，围着桌子踱来踱去，一个劲地嗅来嗅去。意料之中桌子被炸得粉碎的情形并没有出现。零和985像门神一样呆坐在椅子上。零再次灵活地爬上桌子，小心翼翼地靠近录音笔，伸出爪子轻轻触碰录音笔，像在判断老鼠的死活。就在吉祥放松的当口，画家的声音再次传来：“真正的光明绝不是永没有黑暗的时候，只是不被黑暗所遮蔽罢了。”<br>吉祥惊得往后一跳，喉咙底下传来低沉的“呼噜”声，他半弓着身子，零相信只要录音笔再发出半点声响，吉祥一定会扑上去把录音笔撕得粉碎。不过录音已经结束了，985站起身来，“事情就是这样。这件事你最好别跟任何人讲。有些事情得一个人独处时才能想明白，我就先走了。日记我暂时先带走，这几天可别写日记，被组织知道了可不好。如果有什么急事，可以来浮游吧找我。”<br>“浮游吧？我的一个朋友告诉我近来最好不要去浮游吧。”<br>“到时候你就会明白自己非去浮游吧不可了。你也不用担心，船到桥头自然直，到时候你自然会知道是去浮游吧的时候了。相信我，到时候你不会犹豫，也不会纠结，选项自然而然就会出现。”<br>零感觉今天自己处于信息台风的风眼之中，自己并没有主动去探索什么，但各种各样的信息却纷至沓来叫自己知道它们，也不管自己想不想知道。零根本不知道自己现在在想什么，到底是木匠死去的悲伤？还是了解“真相”后的悲愤？话又说回来，那段录音是真实的还是经过加工的？如果是真实的，组织为什么会叫985把录音笔送来给我，难道不怕自己反叛组织？还是说组织这样做是为了彰显自己的好心？可这也说不通，录音的内容可以轻而易举地反驳这一点。如果这是假的，组织又何必让自己听到这样的内容？难不成是为了看自己会不会反叛？可自己只是零啊，就算有这贼心也没这贼胆啊！还有985，他尽管没有个性化称号，也应该是组织的高层吧，又为什么会叫我到被组织视为“眼中钉”的浮游吧找他呢？完全解释不通啊！……如果录音内容真的是真相，那么这个真相又引出了更多的疑问逼迫零去探索真相。零不清楚事情为什么会发展到这个地步，自己明明什么都不想知道，可事情却让自己不能如愿。<br>吉祥像说梦话似的叫了一声。零发现吉祥不知何时又趴在桌上休息了，刚才录音笔的事并没有给他造成太大的困扰，他只是沉浸于自己的世界里。罢了罢了，零想道，到该知道的时候自己总会知道的，就像今天一样。可惜日记给985拿走了。<br>猫总是对的，零现在能确定的只有这一点。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(10)——无论周围再多人，感觉还是自己一个人</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-10/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-10/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="九-无论周围再多人，感觉还是自己一个人"><a href="#九-无论周围再多人，感觉还是自己一个人" class="headerlink" title="九. 无论周围再多人，感觉还是自己一个人"></a>九. 无论周围再多人，感觉还是自己一个人</h1><p>   今天零终于知道那天酒保不让他知道的事情是什么了。但他丝毫没有知道机密的欢喜，如果可以的话，他宁愿不知道这件事，因为知道这件事他所付出的代价实在是太大了。<br>零抬头望天。今天的天干净的看不到一丝云，正因为如此天空反而湛蓝得有些可拍，叫人瘆得慌。烈日照得零不得不眯起眼，仅仅在外面站了一小会儿，豆大的汗珠就顺着脸颊滚落下来。闷热的一天。零很讨厌夏日的晴天，特别是现在。零有些气愤，凭什么今天是艳阳高照的一天？为什么贝多芬死于雷电交加的雨夜？为什么盖茨比下葬的当天淫雨霏霏？这是凭什么，零百思不得其解，贝多芬不过就是会写几个音符的聋子，盖茨比更只是一个被爱情冲昏头脑的私酒商人。凭什么，凭什么他们可以被冠以“伟大”二字，凭什么连老天都要为他们哭泣？不论是“乐圣”贝多芬还是了不起的盖茨比，跟自己的老师木匠相比都是普通的不能再普通的人。他们整天念叨着自己的音乐和心中所爱，却不知道木匠的伟大。如果说杀人也是一门艺术的话，木匠绝对是杀手界的毕加索，如果你见识过木匠残忍却又极具暴力美学的手艺，看见过他持枪时的坚毅背影，欣赏过他说“人死身灭，精神永存”时的忧郁气质的话，你就会知道与他相比贝多芬和盖茨比不过是幼儿园的孩子罢了。可这样一位优秀的杀手在上天眼里却根本排不上号，甚至比不过聋子和爱情傻瓜。<br>你，名字。木匠。我问的是名字，不是职业。木匠，名字就是木匠。好吧，职业。杀手。杀手？那你走错地方了，你该去的地方是那，地狱锅炉房。好了，没什么好疑惑的，小子，快走吧。下一个！名字。贝多芬。哦，贝，等等，贝多芬？是那个写出《欢乐颂》的贝多芬？是的，如果你说的是那个聋子的话，我想我就是他。终于，我的天，哦，请原谅我的失礼。您知道吗？我们等这一天等了多久了吗？终于千盼万盼把您盼来了，你的到来使我们天堂游乐园蓬荜生辉，啊，我是您的粉丝，您可以给我写张签名吗？哦，我的上帝啊，我竟然碰到了“乐圣”贝多芬的手，妈妈你看到了吗？真是对不起，贝多芬先生，浪费了您这么多时间，请往这边走，对，就是这个方向。下一个！名字。盖茨比。什么？你就是那位超级无敌举世无双的绝世好人盖茨比？……<br>是的，上天就是这样的势利，他愿意为贝多芬和盖茨比尽情地挥洒自己的悲伤，于是毫无征兆的，雷声大作，连日暴雨；可木匠这样一位杀手界的毕加索却因为“杀手”二字就给打发到锅炉房烧火。这样还不够，上天还嫌弃木匠浪费了他的时间，在他下葬的那天露出灿烂无比的笑容驱赶一切阴翳，暂停所有呼吸，让为他送行的亲朋好友受尽折磨。而这仅仅因为他觉得木匠浪费了他的时间。<br>零这样越想越气愤，恨不得马上抬手指天破口大骂，可又碍于周围的情况只好作罢。今天是组织高层木匠下葬的日子。前来参加这场葬礼的最少也有三四千人，大家身着西装排成一个方阵。从上往下看，只能看到黑漆漆的一片，根本分不清站在这里的是什么，就是说是被一块黑幕布遮住了也会有人相信。就是C区南方公园48小区17单元的29的肤色也在这个悲伤的日子里显得有些黯淡。<br>面对青天，背靠黄土，一个杀手最后的归宿。——《杀手准则》最后一条。这一条的意思是说杀手死后不立碑不拍遗照，就是静静地长眠地下。所以木匠的木不过是一个略微凸起的小土堆。在几千人的方阵面前，这个凸起的小土堆就像一颗黄豆那样不起眼。所以你不难想象在这样的一个大方阵里，只要位置在三排以后的人就根本看不到这个被称为“坟墓”的小土堆。刚开始三排以后的人还左右晃动身子试图从前面的人头缝隙中看到木匠的坟墓，但他们还是只能看到黄色的土地，其实那确实是木匠坟墓的上半部分，不过因为大多数人都没能很好地理解《杀手准则》最后一条的内容，所以他们都以为这是因为前面的人把他们的视线挡住了。于是第四排的人拍拍第三排的人的肩膀，“嘿老兄，挡住了，你能不能稍微蹲下点？”第三排人一蹲下又发现第二排的人把自己挡住了，所以同样的对话又顺着第二排的人往第一排传递。<br>思想也是会传播的，这句话的意思是说当第五排的人看到前三排的人相继蹲下后他们突然就明白了第四排人的用意，于是他们拍拍第四排人的肩膀……之后是第六排，第七排，第八排……<br>这样的结果是到最后第一排人完全趴在地上，只用下巴支撑；第二排人也是趴在地上，不过他们却是略微抬起脑袋，活像水族馆里讨好饲养员的海豹；第三排人采取的是前臂撑地的姿势；第四排人是标准的俯卧撑动作……后一排的人总比前一排的人高那么一点，像是拇指人从地面爬上人头顶的阶梯。这样逐级上升的趋势到中间的时候就戛然而止，中间那排人始终保持着直立的状态。从第一排到中间这一排，不知道的人还会以为这是他们在模拟演化从浮游生物到直立行走的智人的进化过程呢！<br>中间一排人保持直立状态似乎是在告诉后面的人“现在叫我蹲下你们也什么都看不到了，你们最好还是借助高跷这种外物好了”。但我们都知道这么一句话“只要思想不滑坡，方法总比困难多”，换言之，如果中间一排人真的要让后面的人看到坟墓的话，他们大可以传话给第一排让大家改变阵型。至于为什么会出现这种情况，其实也不难理解——<br>在中间这一排中间出现了一批好人。好人意思是就说当他看到木匠的墓只是一个突起的小土堆时他就感到异常失望：这可是木匠的坟墓啊，木匠是谁？是组织的高层，是拥有个性化称号的受人尊敬的前辈，他的墓怎么能是一个小土堆呢？所以当后面的人拍拍他的肩膀问他能不能蹲下时，她怀着为他人着想不让别人感受自己刚才感受到的失望之情的想法，决定保持直立的状态。同一排里剩下的人看到他们都保持直立也就纷纷放弃了趴在前一排人身上的青蛙抱对的姿势。这也就是说这个方阵所演化的进化史并不完整，他是直接从两栖动物跨越进化到智人的生物奇迹。<br>站在旁边的领队看到大家这种自发的行为一开始还是挺感动的，可没过多久他就感觉不对劲了；虽说木匠是组织的高层，大家的这种行为尽管不雅但也可以看出大家对木匠的尊重，可是，等下领导要出席葬礼讲话，他要是看到这种情况可不会以为这是什么有感而发，到时候大发雷霆不说，讲不来还要怪我没有制止。于是领队轻轻自己的喉咙，“你们，都给我站好了！”<br>窸窸窣窣的声音传来，原先趴在地上的人全都爬起身来拍拍身上的尘土整理西装站好。前一半的人因为看到过木匠的小土堆所以自然而然地保持不动。但后一半人就不干了，他们原先还可以隐约看到点什么，可现在大家又都站起身来他们就又什么都看不到了。于是他们又开始左右晃动身子试着从人头缝隙里看到些什么。紧张的领队吹了声口哨，“全体都有——，立——正——！”<br>没有办法，后一半人只好停止摇晃。领队松了一口气，现在的方阵真是整齐划一，再不像随风摇曳的稻草。领队看着眼前的方阵，不禁一阵恍惚：好像之前的演化史全是幻觉，似乎从古至今他们保持的都是这样一个整齐划一的方阵。这样思考的越久他就越觉得刚才什么都没有发生过。<br>现在是整齐划一的方阵，这句话的意思是说现在后一半人只能看到前排人的后脑勺。多年以后，当后一半人回忆自己曾经参加过的木匠的葬礼时，他们所能想到的只有前面人的黑乎乎的后脑勺。他们不认识木匠，也没有见过他，更没有欣赏过他精湛的杀人技巧，对他们而言，“木匠”不过是一个符号、一个名字。本来他们还可以见识一下木匠那个寒酸的略微突起的小土堆坟墓，但在多年以后它们回忆起这一切时，木匠只是一个符号、一个名字、一个黑乎乎的后脑勺。不过说实话，寒酸的小土堆坟墓也不见得比黑乎乎的后脑勺号多少。<br>零对领队的做法完全不能理解，在他看来，刚才的所有行为都只是大家对木匠的尊敬的表现罢了。既然今天大家在这里就是为了祭奠哀悼木匠，那还要在意什么形象吗？只管表达自己的敬仰，挥洒自己的悲伤好了。不过零没有跟领导抱怨，他知道现在如果自己这样做了，自己的行为就叫得了便宜还卖乖，因为如果他不是木匠的学生，以他的身份地位是无论如何也不可能站在第一排的。<br>大家站成方阵站在这里不知道有多久，只知道每个人（除了零）心里都只有这样的一个想法：西装早就给浸湿了，呆在这里已经够久了，这么还不解散？可实际上太阳根本没有西移半分。如果大家生活在电影里，此时通过镜头你看到的一定是被高温折磨得翻腾上升的水汽。闷热的天气不仅折磨着水汽和西装，还在折磨着语言。在炎热的夏日里，就是语言也是汗津津、黏糊糊、臭烘烘的。<br>今天的天气是真热啊，就是敲个鸡蛋到地上都能被蒸熟。得了吧，老兄，你管这叫热？那你肯定没去过山那边的沙漠，那才叫热，跟个大蒸笼似的，饿了还可以咬自己一口充饥。各位，我不是引战，今天这天气就是女朋友跑了我都懒得去追。睁眼说瞎话，别人不知道你，我还不知道？你是没女朋友才这么说，如果你真有女朋友而且她真跑了，你肯定屁颠屁颠地跑出去不追到中暑休克誓不摆休。诸位，有一说一，木匠前辈我是尊敬的，毕竟他老人家是拥有个性化称号的组织高层，但叫我们一直站在烈日骄阳下可不算什么地道事，我尊敬他，可我也不认识他啊，我又何必受着苦难呢？嘘——，老兄，小声点，看到第一排那个眼睛红肿的小伙子没？那是A区东方街道53小区56单元的零，是木匠的学生，就算咱们不给木匠面子，也给这个可怜人一些面子吧，小声点讲。唔——，我天！谁他妈放屁！生化武器啊，这是！不行了，要死人嘞。别让我知道是谁放的屁，否则我一定要他好看让他吃不了兜着走。老兄，少说几句吧，你不觉得现在说话跟吃屁一样？大兄弟，你可真幽默，话说回来你不也说话了？你也说了。你又说了。你好说？……<br>几千人排成的方阵就像一间密不透风的房子把足以熏死几头非洲象的让人欲仙欲死的臭屁困在其中。以领队的视角观察，他看到的就是这几千人像喝醉酒一样东倒西歪，嘴里还含糊不清地说着什么。领队很轻易就得出了他们此时的东倒西歪和之前的左右摇晃的看热闹心理完全不同的结论。不过领队再怎么聪明，他也绝对想不到方阵里的人们东倒西歪是因为臭屁。相反他被自己感动得一塌糊涂：本来我还以为怀疑在这样炎热的日子里按照规矩把几千人摆成方阵一起悼念死者是事倍功半、出力不讨好的一件事，可没想到在这样艰苦的条件下大家还是能被木匠的人格魅力所感动。还是组织的规矩更有先见之明！嗯，说不定条件越艰苦效果越好。突然他又想到原来自己还准备跟领导讨论变通一下规矩进行悼念活动。这样想着在这烈日下他的冷汗就冒出来了：我竟然怀疑组织的规矩，真是罪过啊，幸好我当时什么都没说，不然……领队想着连打了三个寒战。<br>这时候他看见在方阵的后方有一个小黑点越来越大，领队马上认出来这是领导的专车。他转头看向方阵，方阵的几千人还是像刚才一样东倒西歪，甚至摆动的幅度比之前的还要大，有几个人甚至要用手撑地才可以勉强保持不倒。活像失灵的无人航拍器。领队跟了领导好多年，对领导的一切知道得一清二楚：他每天早上6点起床，早餐吃粥，只吃煮三十分钟的粥；十二点准时吃晚饭，雷打不动，就算暂停开会也得吃饭，他吃饭只吃用手淘洗过的米煮过的饭；对晚饭，领导没什么要求但一定要好吃；领导喝茶只喝明前龙井……这些只是生活起居上的要求，都是些鸡毛蒜皮的小事。小事的意思是说如果领队在这方面做错了事，领导绝不会责怪，只是沉默地瞪着领队直到领队道歉。“这有什么好道歉的？都是小事，身为杀手，根本不该在意衣食住行这些小事。”<br>是的，这些都是小事。对于领导而言，真正的大事只有一个：杀手应该是孤独的狼王，是泰山崩于前而色不变的人。很显然，现在这些在木匠墓前排成方阵哀悼木匠的杀手们，一个个都像体内磁场失灵的晕头转向的白鸽，跟从不回头看爆炸现场的人八竿子打不着。领队完全可以想象领导看到这一幕的表情：他会紧抿嘴唇，一副明明有很多话却不知从何说起的样子，他会深深吸一口气然后又重重地吐出，他坚毅得如同大理石一般的脸庞上满是这样一句话“你们……你们……你们要我说你们什么好！”。为了避免悲剧的发生，领导小声地喊道：“给我站好了，都！领导来了！”<br>“领导来了”这四个字仿佛有魔力一般，顿时将众人定在自己的位置上，又是像从远古一直保持到现在的方阵，似乎中间发生的全是幻觉。这也是没办法的事，跟领导的怒火、钢铁一般的规矩相比，生化武器的臭屁可爱得像刚出生的婴儿。<br>“领导来了”就意味着领导有话要讲。这也是情理之中的事，组织高层被人杀害，领导怎样也要有所表示。原本按照规矩，领导讲话是哀悼仪式的最后一项活动，在这之前还要请死者的亲朋好友讲一番话。杀手，孤独的狼王，这句话的意思是说木匠没有亲朋好友，换言之，零就是木匠最亲近的人。但零只是站在第一排，呆呆地听着领导专车的靠近，像是名为《伤心者》的雕塑，一动不动。零为发言做了诸多准备，可他没有演讲稿，没有演讲稿就没有说话的资格。<br>当零把自己精心准备的自以为是自己目前巅峰之作的演讲稿递给领导后，领导先是认真地阅读了前几段，然后不耐烦地往下翻了几页，这几个动作让零感觉自己受到了愚弄。他感觉领导根本不能理解自己，好像对领导来说，无论自己写得是好是坏，他过目一遍仅仅是例行公事。领导又疑惑地返回到第一页，重新看了几眼，然后把稿子放在办公桌上，用钢笔压住。<br>领导抬起头看着零，脸上的严肃表情瞬间放松，露出拒人于千里之外的说着“不好意思”的笑容，“A区东方街道53小区56单元的零。这真是一个很长的名字，你允许我直接叫你零吗？”没等零回答，他又自顾自地说下去，“我知道木匠对你而言不仅仅是老师这么简单，他更像是你的父亲。我要说的是你并不孤单，木匠是我们尊敬的人，他为组织做出过巨大的贡献，对于木匠的牺牲，我们的悲伤难过不比你的少。木匠像是你的父亲，你又何尝不是他的孩子呢？你是他生前最亲近的人，所以我想由你在他的墓前说点什么，他是乐意见到的，而且你写的演讲稿是我生平所见最深情的最让人感同身受的演讲稿……”<br>但是，零在心里说，但是。<br>“但是，”领导说着拿开压在演讲稿上的钢笔，重新翻开零的演讲稿，“我有一点不太明白，为什么你在演讲稿中提到的是生活中的木匠？哦，零，请不要露出这样的表情，我不是那个意思。生活中的琐事，不论再小再细再碎都是木匠的一部分，是人之所以成为人的原因之一。但请你注意，这只是‘一部分’，是‘原因之一’，当然，没有这些自然就不会有你的老师木匠。但反过来说却是成立的，我是说从某种意义上而言。<br>“木匠最后能成为木匠绝不是因为他喜欢木工，当然他的名字叫‘木匠’倒是因为这一点。可喜欢木工却不能让他成为优秀的叫人闻风丧胆的杀手。生活中的木匠是什么样的人仅仅影响他成为木匠，而决定这一点的才是关键。老话说得好，‘死有重于泰山，有轻于鸿毛’，如果我们能把木匠成功的经验总结出来，并让大家知晓，我想这也是木匠希望看到的。你说是不是这样，零？”<br>领导放下手里的稿子，打开左手边的盒子往自己的嘴里倒入了几粒薄荷糖，然后在即将盖上盖子时像想起什么似的问零道；“糖要吗？”看到零摇摇头，他重新合上盖子，拿起钢笔，像要把什么写在零脑子里一样继续说道：“我能理解你的想法，零。真的，我能理解你的悲伤，木匠对你来说是一位特别的存在，我想你一定想给他一个与众不同的追悼会，别不好意思承认，这没什么不好意思的，人之常情嘛！但我希望你明白，你是一个聪明的孩子，你一定会明白的。<br>“幸福的家庭每每相似，不幸的家庭个个不同。这就是规矩存在的意义，没有铁一般的规矩存在，那就无幸福可言。这也是我们追悼会有流程的原因，或者说是初衷——今后我们的组织里，不管死了谁，只要他是做过一些有益的工作的，我们都要给他送葬开追悼会，用来寄托我们的哀思，团结组织。<br>“木匠已经死了。不论我们承不承认这都是无法改变的事实。对历史的人来说，他唯一的价值就在于为后人留下什么，物质遗产、精神财富。虽然这话说的有一些不近人情，但事实就是如此，我们想知道的是木匠如何成为受自己人尊敬，让敌人闻风丧胆的杀手，而不是要知道生活中私底下的木匠是怎样的人，尽管这同等重要。<br>说着领导拿起演讲稿以不容分说的姿态将演讲稿塞到零的手里，并且拍了拍他的肩膀，“你的悲伤我们感同身受，这也是一篇令人潸然泪下的演讲稿，如果你回去之后能再改改就更好了！我们需要的是受人尊敬的木匠。”<br>而不是活生生的木匠。零在心里补充道。不过他什么都没有讲，只是回答了一个“嗯”，然后就拿着自己的巅峰之作离开了。巅峰之作，零走在路上时脑子里不断地冒出这句话，就像泉水咕噜咕噜从泉眼涌出来一样。巅峰之作？滚他娘的巅峰之作！<br>零从来就没有想过要给木匠组织一场与众不同别开生面的追悼会，他甚至不明白为什么自己的真情流露在领导眼里就是在搞特殊、与规矩不符。不过就是一场追悼会而已，零这样想到。在零眼里，木匠从来都不是什么值得尊敬的必须让人仰望的人，木匠也是一个活生生的有血有肉的人。<br>当零问木匠如何成为一位优秀的杀手时，木匠的回答永远是“好好训练”，如果零再追问下去，木匠就会破口大骂，“优秀从来就没有经验可言，你唯一可以做的就是努力、坚持，这有什么好问的，还不滚去训练？”；相比于回答怎样成为优秀的杀手，或是叙述自己曾经执行过的惊心动魄的任务，他更喜欢跟零聊聊木工。实际上与其说是聊木工，莫如说他更喜欢和零讨论墨线是否画直，因为自零成为木匠的学生以来，他就没看见过木匠造出过什么东西。有意思的是，当零说木匠的线画直时木匠并不怎么高兴，相反若说线没有画直，木匠反而会笑骂零几句，和他说几句玩笑话。在零看来木匠并不值得尊敬，或者说，这世上从来就没有值得尊敬的人。有的只有活生生的人以及他们死后留下的孤零零的坟墓和伤心欲绝的亲朋好友。<br>当零告诉领导自己并没有将演讲稿改好时，对方先是愣了一下，随即便露出了例行公事的笑容，“没事，这又有什么关系呢？不论你做不做这个演讲，不论你演讲的内容是什么，都不会有人怀疑你对木匠怀有的情感的。相信我，大家都能理解你，伤心到极致的人有时是流不出一滴泪说不出一句话的。”<br>现在回想起来，零总觉得领导的笑容里流露出的绝不仅仅是失望这么简单，似乎还有警告。警告？领导在警告我什么，零百思不得其解。<br>欢迎领导讲话的雷鸣般的掌声将零从思考的井底拉了上来。单听掌声，你根本无法想象这是由在烈日下站了许久的人发出的。这雷鸣般的掌声，不仅仅是在对领导表示欢迎，也是在提醒坟墓里的木匠睁开眼睛竖起耳朵好好听领导的演讲。<br>“今天真热啊，我就是在这里站了一小会汗已经止不住地流下来了。而诸位排成方阵在这骄阳下已等待多时，单就这一点而言，我是敬佩诸位的。诸位的毅力，诸位的耐心让我看到了组织年轻一代的风采，无论如今局势多么紧张，对我们多么不利，我都没有一丝一毫的担忧，因为有你们，有富有天赋的、朝气蓬勃的你们。青出于蓝而胜于蓝，你们是组织的希望。或许你们经验还有些不足，一些技能的运用可能还有些不熟练，但这些都不足以掩饰今天我在诸位身上看到的未来，这个未来我曾经在木匠身上看到过，这是一个金色的足以使你们的名字留在组织历史上的未来。”<br>领导这段话刚说完，领队就开始带头鼓掌，随后方阵又爆发出雷鸣般的掌声。不知道领队是由衷地鼓掌还是事先受到领导的示意安排，总之他在领导话音刚落之时的掌声衔接的无比自然。在鼓掌的时候，零很想大叫一声“好，再来一段”，不过他到底没有这样做，因为他知道这样做必然会因为破坏追悼会的氛围而被迫选择“脚底按摩”。他总觉得这不像是追悼会的氛围，但他一时半会也想不出这像什么，只是单纯的觉得不太对劲。<br>再次听到雷鸣般的掌声，领导双手平摊往下压一压示意大家保持安静，，随即露出“你们这样我很不好意思”的笑容，继续说道：“今天，因为木匠的牺牲我们在这里相聚。我们都知道‘背靠黄土，面朝青天，是一个杀手最好的归宿’，所以请不要因为木匠的坟墓如何就说组织不近人情。这不仅是杀手们最后的归宿，也是我们最好的归宿——坟的大小并不能决定什么。人死身灭，精神永存。”<br>“人死身灭，精神永存！”领队开始喊道，然后是整个方阵在喊。零现在可以确定领队之前的鼓掌和现在的喊口号都是经过领导授意的。零感觉有些不舒服，但也仅仅是不舒服还远远没有让零感觉自己受到了愚弄，因为他知道这不是作秀，不过是流程罢了。追悼会的流程。当一切声音都消失以后，零只能听到旁边枯树上的鸟叫声。原本聒噪的鸟叫声此时听来像是从渺远的地方传来的，零感觉自己来到了另一个星球。<br>领导的眼里闪着赞许的光，满意的点点头，“木匠的牺牲，是业已发生的事，无论我们承不承认这都是无法回避的事实。木匠牺牲了，我知道你们中有人伤心欲绝，有人感到迷茫害怕，但我要告诉你们不要同情不要害怕，同情和害怕是懦夫的表现！我们是杀手，死亡是杀手的朋友而不是敌人。请不要害怕死亡，相反，今天我要告诉各位我们应该敬畏死亡，感谢死亡。”<br>领导说着停下话头似乎在等待领队带头鼓掌，不过领队并没有什么动作，他还在等待领导的下文。隔了好长一段空白他才意识到领导正在瞪自己。道歉的话将要脱口而出之时领队意识到现在并非私下场合，于是他举起双手准备鼓掌，此时领导已经决定不再等领队的鼓掌，准备继续讲下去。这就是说在短暂的沉默之后，领导的讲话和领队的鼓掌同时响起。领导又恶狠狠瞪了领队一眼，顿时领队就像落水狗一样垂下双手。不过方阵并没有意识到这一点，又是雷鸣般的掌声。领导不得不扯起嗓子提高音量才能让大家听到他的演讲。<br>“是的，诸位并没有听错，我说的是感谢死亡。我知道你们很疑惑，死亡明明是世上最阴冷的事，我又为什么要说感谢死亡呢？诸位，请诸位试想一下，如果没有死亡，如果没有一次次与死神擦肩而过，那么诸位，站在我面前的诸位会有现在的成就吗？不，你们一定和现在不同，我可以明确地告诉诸位，如果事实真是如此，你们一定会比现在差劲。我也承认，死亡是黑暗冷酷的，但如果没有死亡的锻炼，诸位又如何会成为组织的希望？没有死亡，我们就什么也不是。<br>“死亡并非是一切的结束，它仅仅是开始。木匠牺牲了，他的肉体已从世界消失了，但总有东西是死亡，是任何力量都无法抹杀的，那就是木匠的精神，是他成功的经验，是组织赖以生存的根基。我前面也说了，我在诸位的身上看到了金色的足以铸就伟大的未来。但要让这个未来照进现实，单有天赋和热血是不够的，诸位还需要经验。而这些经验是死亡教给我们的，是木匠留下的精神财富。<br>“如果我们要对杀手下定义，我们完全不需要绞尽脑汁的去想什么形容词，我们就想想木匠好了。木匠，这个人，或者说这个名字本身就是杀手的同义词。冷酷，专业，毫不畏惧，一切你能想到的形容优秀杀手的名词都可以用来形容木匠。<br>“然而，诸位，然而就在几天前，木匠，这位优秀的受人尊敬的杀手却被组织的叛徒画家残忍杀害了。本来我们以为画家叛出组织是因为对组织不满，可我却没有想到画家这只白眼狼竟然会跟绝影勾结杀害木匠。绝影近来崛起势头正盛，可我们也没想打压他，相反我相信良性竞争更能让双方都从中得益有所进步。可没想到我们竟然犯了珠穆朗玛峰式的错误，使组织的高层木匠惨死。<br>“逝者已逝，生者仍存。木匠牺牲了，但他的死亡让我们看到了绝影的狼子野心。木匠牺牲了，我知道诸位心中满是悲伤，但悲伤是懦夫才有的情绪，我们是杀手，我们应该化悲痛为力量。我们隐忍低调太久了，久得人们已经忘记我们才是杀手界说一不二的王了。但今天，从今天开始，我们是时候伸出獠牙让绝影明白谁才是杀手界的王者了！<br>领导话音刚落，整个方阵都开始扯着嗓子高喊“人死身灭，精神永存”，这次没有领导带头，完完全全是所有人的自发行为，零也不例外。大家的脸都喊红了，感觉要把自己心中的悲伤、愤怒和积郁全都喊出来才肯罢休。事后零其实也不太清楚自己为什么会跟大家一起喊口号，好像其他人都这样做自己不这样做就感觉很不好意思。<br>零在方阵中看着领导和领队上车时，心里突然想到自己先前感觉到的确实没有错，这绝对不是追悼会，相反更像是战前动员会。零不胜悲哀地想到：无论周围再多人，感觉还是自己一个人。<br>领导的专车扬起一阵尘土离开。专车化为小黑点消失在所有人的视野里，众人就全部化作离笼的鸟兽四散开来，朝停车的地方跑去。此时他们心里的想法只有一个：空调。零看着跑远的人们，想到以前体能测试长跑时，和自己同组的人也是这样超过自己然后把自己远远甩在身后的。其实单看体能测试的成绩，零只能算是不能接任何任务的预备杀手。但就算零再怎么差劲，木匠也没有恨铁不成钢地对零说“我这么优秀的杀手怎么会交出你这种烂泥扶不上墙的学生”，相反木匠常常面有愧色地对零讲“如果我不是木匠你也就不会被迫成为杀手了”。有时候零也分不清木匠讲这话到底是激将法还是肺腑之言。现在是谁都不知道答案，木匠已经死了。零避免使用“牺牲”，因为“牺牲”总给零一种生命不属于自己的错觉。<br>零隐约听到有人在叫自己，不过他没有转头看，难道现在还会有人落在自己身后？如果现在真的有人在叫自己那也只有可能是躺在坟墓里的木匠了。可木匠已经死了，所以零并不打算扭头看是谁在叫自己，自己转过头只能看到木匠寒酸的小土堆坟墓。退一步讲，就算真是木匠在叫自己，自己也不能回头。杀手，本该冷酷无情。自己不回头，木匠也会感到欣慰的吧，因为这样一来自己最起码还像一个杀手，尽管自己差劲得不能再差劲了。零的鼻头一酸，该死的，可千万别流泪啊，前面不是还说要冷酷无情的？这个样子还怎么能让木匠省心？<br>眼泪到底没有流出来。有人拍拍零的肩膀，是28，哦，现在应该叫他C区南方公园48小区17单元的29了。“在想什么呢？我刚才叫了你这么多声都没听到？”说完29才想到今天是木匠的追悼会，随即有些尴尬地解释道：“额，我是说——”<br>零没等29说完就摇摇头表示不想回答这个问题，“你呢？他们都跑回车上吹空调了，你怎么还慢悠悠地，不热吗？”<br>29看零没在之前的问题上找茬，放松似的吐了一口气，“唉，当然热啊，怎么可能不热？不过现在衣服都像从水里捞上来的一样，早点吹空调迟点吹空调又有什么本质的区别呢？都一样嘛。”<br>听到29的回答零在心里暗骂了自己一声，自己怎么会以为29慢悠悠地走在最后是因为他对木匠的尊敬，因为木匠死去的悲伤？在木匠生前，零就没有见过29——那时候他应该还叫28或是27——来找过木匠。他原本就不认识木匠，木匠对他来说不过是一个名字、一个符号，你怎么能要求一个人对名字、符号的消失表现出多大的悲痛呢？哦，不对，零突然又想到身为符号和名字的木匠还没有死去，人死身灭，精神永存嘛！<br>零感觉29对自己说了句什么。“不好意思，你刚才说了什么？我没听清。”<br>“我说，你不是开车来的？”<br>零诧异地看了29一眼，“这话怎么说？”<br>“喏”29朝前方努了努嘴，“这些车里没有你的车。”<br>零看着眼前清一色的黑色车辆。好像这些车是专门来为木匠送行的，但实际上零知道车是黑色没有多大的意义，不过是组织给每位杀手的配车而已，至于黑色，组织认为黑色象征低调隐忍。就在零抬头观察的几秒内又有四五辆车发动离开，原本拥挤的被划分为停车场的区域此时已有了好几块空缺位置，远远望去，或者说从高空鸟瞰，这里就像国际象棋的棋盘。车辆争先恐后地离开，给零一种盛大的晚宴业已结束之感。<br>“这么肯定这里面没有我的车？”<br>“不是我炫耀和自夸，我专门调查过会来参加追悼会的所有人，我是说除了一些组织的高层。当然我没有通过组织的情报系统，我的级别不够高，不过我有自己的情报来源。总之呢，我搞到了大多数人的情报，里面就有你的。你的车牌号在我的脑子里，很显然，这里没有你的车。”<br>“原来如此。这就是‘杀手只能相信自己和自己手里的枪’吧，学到了。我的车确实没有停在这里，我停在别的地方。”<br>在零正准备离开时，29又把他叫住了，“可以捎我一程吗？”<br>“你前面不是还说要回车上吹空调的？现在怎么又说自己没车要我捎你一程？”<br>29有些局促地笑了笑，“这不是前面在太阳底下站久了脑袋晒糊涂了嘛，现在才想起自己并没有开车来。”<br>“哦。”零才不相信一个会专门调查追悼会参加者资料的人会不选择开车来参加追悼会，而且还相信自己会捎他一程。<br>“如果我不答应捎你一程，你会怎么办？”<br>“还能怎么办？只能走回去啰。就这么绝情？连捎我一程的油费都舍不得？”<br>“绝情？杀手不就该是冷酷无情的吗？你就这么肯定我会答应捎你一程？”<br>“我们好歹也算是合作伙伴吧。就算不是莫逆之交，我想这么也是可以让你载我一程的交情吧！”<br>“不是我抬杠，当时要是我们的任务对象是同一个人，现在我们可不会在这里攀交情。倒是算账的可能性更大。”<br>“公是公，私是私。我们只有在做任务时才应该做一个冷酷无情的杀手。当然这只是我的个人愚见，当时说这话的人是什么意思现在谁也不清楚。”<br>“公是公，私是私”，零在心里默念了几遍咀嚼了好一会儿。29说这句话的语气绝不仅仅是告诉我他是怎么想的，零总觉得这句话被29拉长后更像是他讲给自己听的开导之语。<br>“没想到这里还有一个废弃仓库。”<br>“不是吧，你会调查来参加追悼会的所有人，却不知道这里有一个废弃仓库？”<br>29摇摇头，“调查参加追悼会的人只是为了防止其中出现叛徒时自己不至于会惊慌失措。换句话说，做这些事只是为了让自己在出现紧急状况时能更好地分析局势。至于废弃仓库，说老实话，不论它存不存在都不会是多么大的变数。当然，自己没有提前知道这个位置上有这样一个废弃仓库是我的疏忽。”<br>“经验丰富。”不过零不确定这句赞美的话有没有完整地传进29的耳朵，因为此时29正呆滞地看着零的车。零的车也是组织发的配车，唯一不同的是他用喷漆在车身上画了很多歪歪斜斜的白线。像是幼儿园的孩子随手画的涂鸦。<br>“这个啊，我本来是打算在引擎盖上画上一个粗鄙的牛头的，不过我嫌牛头太难画了，就随手在上面画了几条线。”<br>“真的？”29有些艰难地吐出这两个字，不知道他是不相信零的话还是说不相信竟然会有人在组织的配车上画画涂鸦。<br>“你这人可真逗，当然是骗你的，”零说着瞥了29一眼，好像在说你这家伙怎么这样好骗，“在引擎盖上画露出猥琐笑容的牛头是一部小说里写的，不过这些线是我很认真地随手画的。”<br>“你这又是何苦呢？要是被组织知道了肯定要受处罚。”<br>“所以我才把车停在这个仓库里。我可没那么傻，开着被涂得不成这样的车在领导的眼皮底下晃来晃去。”<br>“得，得，”29现在倒是从刚才的呆滞中缓过来了，不过他还是不明白零这样做的用意，“那到底为什么要这样做呢？”<br>“为什么要这样做？到底是我们其实我也不知道。如果说真有什么理由的话，我也只能说不为什么，只是单纯的觉得这样有趣。”其实零画这些线只是因为他觉得对墨线情有独钟的木匠会喜欢。不过零不打算向29说什么，29一定不能理解自己，到头来只是白费口舌。<br>“有烟吗？”零问坐在副驾驶座上的29。<br>“你抽烟？”<br>“我不会抽。”零接过29递来的打火机和烟。“你抽烟？”<br>“以备不时之需。你不抽烟，要烟是为什么？”<br>“果然，我还是经验不足。”零并没有回答29的问题，只是将手中的香烟点燃将其平放在仪表盘上的烟灰缸上。零没有着急地发动引擎只是静静地盯着香烟的火星看。呛人的烟味瞬间填满车内的狭小空间。<br>“喂喂，你这又是在搞什么？不开窗户啊？”<br>“你就当我是在给老师上香好了。你难道不觉得关上窗户更有一种在寺庙里那种神秘庄重的烟火缭绕的感觉？”<br>“你是足够奇怪的，上香不会在坟前上吗？在车里搞这些乱七八糟的是干什么。要把人呛死啊！咳咳。”<br>“躺在那个坟里的是木匠，可不是我的老师。受人尊敬的木匠在那个墓里，有血有肉的与你我没有什么不同的木匠可不在那里。”<br>零不确定这段绕口令一样的话29有没有听懂，反正29现在并没有再抱怨什么。有可能29已经习惯了车内呛鼻的烟味。<br>灰白色的烟此时已将空间填满，从外面往里看你或许只能看到灰蒙蒙的一片。零不禁在想，如果老师知道自己在车里给他上香，他应该也会感到高兴的吧，他一定会喜欢这种腾云驾雾的体验。零隔着灰蒙蒙的烟还可以隐约看到忽闪忽亮的香烟头，他突然想到了几句诗。<br>“列车正经过黄河&#x2F;我正在厕所小便&#x2F;我在厕所里&#x2F;时间很长&#x2F;现在这时间属于我&#x2F;我等了一天一夜&#x2F;只一泡尿功夫&#x2F;黄河已经流远。”<br>“你刚才在说什么？”<br>“什么说什么？”<br>“你刚才神神叨叨地在念什么，我说。”<br>“哦，”零这才意识到刚才自己不仅是在脑子里想，而且还自言自语地说出来了，“我刚才想到了几句诗，觉得很适合给老师做悼词。”<br>“诗？”29没再讲话，好像就“诗”开始思考什么。这倒是让零感到有些意外，尽管他希望29保持安静，因为他不知道29问起来自己要怎么回答。但在他看来，29应该对自己用诗为老师送行表示意外才是，至少也得对自己说“这不符合规定”。29一句活都没再讲，好像随着香烟的点燃，释放出的不只是呛鼻的烟味，还有无可排遣的沉默。<br>直到香烟自然熄灭，零才打开车窗发动引擎。29还是没有说话，变成了不会说话不能动弹的木头人。他只是瘫坐在副驾驶座上目视前方。零不太确定前方的风景有没有在29的视网膜上留下痕迹。<br>零叫住打开车门的29，“嗳，我说，你真的不是开车来的？”<br>29的嘴张了张，似乎想说什么，但等了半天，他还是叹了一口气，“说实话，其实我确实是自己开车去的。”<br>“那为什么？觉得我很好愚弄？还是觉得愚弄我很有意思？”<br>29摇摇头，“是为什么呢？我也不太清楚。是啊是啊，杀手就应该是冷酷无情的，我也不知道为什么，看到你一个人走就突然把你叫住了。反正……我也说不太清，不是有意要骗你的就是了。”<br>零其实是不相信29的这一番话的，但29绝对是经验丰富的杀手，至少对零来说是这样的。这就是说就算29的回答称不上是天衣无缝，零也找不出29这套说辞的漏洞。<br>零离开的时候29正点燃一支香烟准备刁在自己嘴上。他望着前方，不知道在想些什么。甚至零不太确定29有没有注意到自己的离开。零又回头看了29一眼，不知道是角度原因还是因为别的是什么因素，此时29皮肤的蓝色比先前黯淡了许多，像是暴风雨前的海面。零无聊地想到：或许29是属变色龙的，他会根据自己的心情变化改变自己皮肤颜色的亮暗。就是不知道他现在这样代表的是什么心情。<br>29的咳嗽声是那天零听到的29发出的最后的声音。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(9)——浮游吧，for you（一）</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-9/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-9/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="八-浮游吧，for-you（一）"><a href="#八-浮游吧，for-you（一）" class="headerlink" title="八. 浮游吧，for you（一）"></a>八. 浮游吧，for you（一）</h1><p>酒保冲坐在柜台前面的零眨眨眼：“现在我该是叫你‘零’还是‘壹’？”<br>零没有回答这个问题：“一杯‘哈尔9000’。”<br>酒保诧异地看了零一眼没再说什么。当他把酒调好递给零的时候他终于忍不住了，因为今天的零有些不对劲，好像丢了魂一样，至少在调酒的时候零并没有欣赏酒保赏心悦目的表演。<br>“今天是什么特殊的日子？平常你可是不喝‘哈尔9000’的。”<br>“是啊，‘哈尔9000’，这么好喝的鸡尾酒，如果不在特定的日子里喝他感觉良心都过意不去啊。”不过零还是没有解释今天是什么日子，他略微侧过身子，让酒保可以看到自己身后的吉他手，“这小子这么会在这里？”<br>“你说吉他手？他来我们这里应聘。我们不太确定他的能力如何，所以暂时让他在这里演奏一晚看看效果。他怎么了，做任务的时候惹你不快了？”<br>零呷了一口酒，“不是可以斩钉截铁地说‘他惹我不快了’的情况。准确的说，只是忍受不了他。你能想象一个人有事没事酒赞美主？今天我牙刷的真干净，一定是主在晚上抚摸过我的牙刷；今天我吃的是烤鸡，感谢主创造了如此美味的食物；今天我还活着，一定是主的恩赐……要我说，能吃上烤鸡，倒不如感谢劳动人民；如果上帝真这么喜欢你，干嘛让你活着，老早就把你叫到天堂唱诗班去了……这些你能理解？”<br>“大致可以。除了一点，天堂唱诗班应该不需要吉他手。”<br>听了酒保的话，零终于露出来久违的笑容，“那你能相信这位正歇斯底里地唱着《18 Till I Die》的老兄，是因为天堂唱诗班不需要吉他手才没上天堂的人？”<br>“凡事皆有可能。嘿，别这么沮丧，我可不是在跟你玩文字游戏敷衍你。这么跟你说吧，嗯——，知道浮游吧名字的由来吗？”<br>零摇摇头表示不知道。<br>“浮游吧以前不叫浮游吧，叫白鸽酒吧。关于这个名字，老板的解释是说白鸽象征和平，这也就是说他希望自己的酒吧是一片中立区，没有争斗，只有酒和音乐。但为什么最后会改名字，这还得从我的前任说起。<br>“别想歪，我是说在我之前的那个酒保，不是说我的前女友。<br>“那小子气质不凡，人又长得英俊潇洒，不仅调的一手好酒，而且头脑也极其灵光。无论是镇上发生的大事还是家长里短的琐事，又或者是虚无缥缈的传闻、让人忍俊不禁的稗官野史，又抑或是让人脸红的低俗小说、云里雾里的《查拉图斯特拉如是说》，全部的全部，他都能如数家珍给你娓娓道来。如果造字时每个词都有一个模板，那么他一定是‘酒保’的原型。<br>“不过你能想象，像他这样完美的人竟然是虔诚的基督教徒？当然信仰什么是他的自由，别说是基督，就是全能神，甚至他要参拜自己的照片也不是什么问题。<br>“唯一的问题是他脑子里的保险丝崩了。就这样‘砰’的一声他脑子就坏掉了——那天他跟每个顾客说‘你要信仰主’，大家以为这是他讲什么鞭辟入里的见解的开场白，于是大家都问他‘为什么这样讲’，你猜他的回答是什么，你绝对猜不到，他说‘如果你信仰主，那你就会把身上所有的钱都给我的’。你听听，这叫什么话！<br>“我要说的就是这么一件事，世上的事都是这么一回事，凡事皆有可能。”<br>“这样比起来吉他手倒是没有这样讨人厌了。话说回来，你的前任是真可怜。”<br>“凡事皆有可能，先生。世人都可怜，我们唯一可以做的就是让别人觉得我们幸福，此外别无他法。”<br>零就酒保的话想了一阵，没有再说什么。“不过这件事跟这里最后叫浮游吧又有什么因果关系呢？”<br>“原来叫白鸽酒吧是为了证明自己这里是中立区，这点我前面也说了。至于为什么现在叫‘浮游吧’，这也很好理解：就算经营酒吧的目的是为了赚钱，我们也不能说‘你要把钱都给我’吧，相反我们还要说‘顾客就是上帝’。这就是‘浮游吧’名字的由来。浮游，for you。”<br>“感觉这样不太诚实。”零抬头想了想。<br>“诚实？”酒保摇着头笑了，零其实上不太喜欢这种笑容，准确的说如果换一个人用同一种语气露出同样的笑容，那他给零的就是“老兄这不是显而易见的吗？你怎么这么笨，连这都不知道”的感觉。但酒保给人的却是两个老朋友聊天时其中一方说了有趣的笑话后才有的由衷的笑容。既不居高临下也称不上故弄玄虚。<br>“并不是所有的话都可以用‘诚实’的线来划分。左边的是‘诚实’，右边的全是‘谎言’，要是事事都是这样简单就好了。就像‘顾客就是上帝’一样，是真是假其实大家心知肚明，但是你也知道这句话无关乎‘诚实’与‘谎言’，或者说这话既不真实但也并非全是谎言。更何况谁也不寻根问底。”<br>零并没有说话，而是让酒保的话在空气中先徘徊一阵。等到所有词句都一一印在他的脑海里，他才开口说道：“高深莫测之言。作为我，至少无法理解。倒是给你这么一说我连什么是‘诚实’都快不知道了。”<br>“深刻，未必是接近真相的方法。”<br>“在黑暗中摸索也比在光明中等待要好。”零针锋相对道。<br>“或许你已经站在门前了。”<br>“可我还没有走进去。”<br>酒保盯着零的眼睛，想从中寻找出什么。酒保在酒吧工作了很多年，见识过各色各样的人，有道貌岸然，自诩绅士但实质上所作所为全是流氓行径的人；有平时木讷无言，醉酒后却能够夸夸其谈之徒；有什么事情都无所谓的好好先生；有凡事必争，誓要胜利的强词夺理之辈……他是经验丰富的酒保，这句话的意思就是说他知道五百二十三种表示自己在听别人说话的回答。与此同时他也知道每个人想的是什么，面对醉酒后夸夸而谈之人他会露出心有戚戚的表情，甚至恨不得尖叫几声才肯罢休；遇上一心买醉的酒鬼，他会模仿约翰·麦克莱恩的语气说“这就足够了？”；碰上为鸡毛蒜皮小事吵得面红耳赤的人，他又化身为庸俗的哲学家说一些人尽皆知的真理，“这个嘛，地球总是围着太阳转。”……对于经验丰富的酒保来说，这世上没有不能交谈之人，正如这世上没有不可归类之人一样。<br>然而酒保所掌握的五百二十三种回答之法中却没有一种可以用来回答零使他满意。但这并不是说零无法被归类，相反零是所有人里面最容易被归档的。要想形容零，用一个词就足够了——好奇。对于好奇之人，酒保毫无办法，尽管他们有时也会咄咄逼人、无理取闹，也会同你争得面红耳赤，但所有人都知道只是好奇使然，除了徒叹奈何什么也做不了。<br>酒保放松似的叹了一口气：“诚实是什么？这可是一个复杂的问题，就像要人回答‘我是谁’一样。在我看来，对中国人来说，诚实就是‘见人说人话，见鬼说鬼话’‘说话做事都留三分’；对美国人来说，‘诚实’就是相信自己说的话做的事。我想世上的诚实都逃不出这两种。”<br>零对这个回答还是不太满意，“那你是怎么看待‘诚实’的？据我所知，你既非中国人，也不是美国人。”<br>酒保盯着零的脸好像在确认什么。当然从一开始酒保就知道他不可能在零的脸上看到“自以为掌握局势走向，现在是逗你玩”的戏谑的笑容，他知道零只是想知道真相。准确的说，在零看来只要他听取不同的人的见解，就迟早能了解一些真相。<br>“随便讲讲喽，试试又不花钱。不像彩票和赌马。”<br>“好吧，好吧。据说卓别林先生有一次因为心理问题咨询心理医生。心理医生给他的建议是：你应该去看看卓别林的默剧表演，最后保证你捧腹大笑，把所有的烦恼都抛掷脑后。卓别林一脸无奈地告诉医生自己就是卓别林。结果医生哈哈大笑说这是他今年听过的最好笑的笑话。诚实大概就是这么一回事。”<br>“又是极其深奥之语。可惜我听不懂。”零仰天长叹道。<br>“深刻，真的不见得是真相的同义词。朦胧模糊或许才是世界的本质。”<br>“可能确实是这么一回事。难怪组织不同意我的晋升。”<br>“可怜啊。”说着酒保又递给零一杯“哈尔9000”，“这杯不要钱，算我请你的。”<br>“好人啊，你真是！”零半开玩笑半认真地说道，“总觉得你不该是酒保，你应该成为哲学家。”<br>酒保饶有趣味地挠挠头，“哦，哲学家？此话怎讲？”<br>零并没有马上回答，而是慢慢地回味嘴里的“哈尔9000”。那是酒在嘴里跳动的美妙感觉。零现在有些明白酒保请自己再一杯“哈尔9000”的用意了：刚才自己因为未能晋升所困扰自然就不可能有心思品酒。零缓慢地、意犹未竟地咽下这一口酒。<br>“其实也不是非得是哲学家不可，我是说感觉你不该是酒保，应该是什么我也说不清，总之不该是酒保。说得有些绕，不知道你听懂没有。反正在我看来，当你以为或许世上之人都是绅士时，酒保们可以明确地用他们的行为和身影在第一时间告诉你你的想法是有多天真。我虽称不上见多识广，但遇到的酒保却不在少数，他们净是一些惺惺作态之辈，听到有趣的事情就露出千篇一律的笑容；听到牢骚抱怨又故作深有同感之态，甚至想为对方哀嚎几声；跟别人聊天时又说着大同小异的拾人牙慧之语……总之一句话，叫人提不起劲。哦，当然，我是说除了你之外大家都这样。”<br>“你有这样的感觉或许是因为我在你面前伪装得很好。可能跟我交谈久了你就会发现我跟你口中的那些酒保没有什么本质区别，甚至我可能是你认识的酒保里最叫人提不上劲的。”<br>零摇摇头，肯定地说：“这倒不至于。作为杀手，我的实力和经验称不上多好甚至可以说是差到极致也不为过，但说到观察力，我还是有自信的。你和其他酒保绝对不同，或许你自己不觉得。但相信我，你和他们的差距就像牛和蜗牛一样，蜗牛是牛吗？”<br>“真是谢谢了。听了你的这番话，我好像发现了作为酒保的意义。”<br>零不太清楚说这话纯粹是开玩笑还是肺腑之言，不过他并不打算开口询问，模糊一些未必是什么坏事。再说他已经讲了自己要讲的，剩下的似乎也不是自己可以控制的了的。<br>两人没有再说什么，去到哪里的沉默再次返回。此时的沉默并非是一开始的那种压抑的沉默。取而代之的是随音乐跳动的沉默。此时舞台中心的吉他手像癫痫发作似的弹着《Love Me Do》。零一遍遍感受着“哈尔9000”在舌尖跳动的律感，一边漫无边际地想着：“如果不考虑吉他手不顾一切的信仰主，如果不去看他癫痫式的表演，他的弹奏和演唱似乎也不错。”<br>周围的喧闹声突然消失，好像有人躲在角落里偷偷地按下暂停键一样，就连在弹奏《Love Me Do》的吉他手也明显的出现了与歌曲不相符的凝滞质感。所有人的目光都被这个刚走进酒吧的男人所吸引，他戴着黑色墨镜，身穿棕色的风衣。当意识到所有人都对自己行注目礼时，他竖起了风衣的领子，不知道他是在模仿高仓健（杜丘），还是在炫耀自己可以在浮游吧持枪。<br>酒保走过来，对零笑道：“据说男人戴墨镜的理由只有一个，那就是装酷。倒是女人有两个理由戴墨镜，除了装酷，还有可能是为了遮住因为失恋而哭得红肿的双眼。”<br>零略微想了想，“不是我抬杠，我想男人哭得撕心裂肺伤心欲绝的时候也是有的吧。”<br>酒保夸张地耸耸肩，“那叫铁汉柔情，又为什么要遮掩呢？”<br>“幽默俏皮之语。不过相比于墨镜，我对这家伙可以持枪进入咱们这家号称‘酒和音乐圣地’的酒吧更有兴趣。”<br>酒保并没有回答零的问题，因为此时风衣男子已经坐在了柜台前，将手里的沙漠之鹰随意地放在桌上，“一杯血腥玛丽。”酒保递给他一杯自他进门就开始调的血腥玛丽，“你最好把枪收一收。”<br>“非常时期，非常对策。”<br>“那也没必要直接把枪拿出来吧，生怕别人不知道你带枪。”<br>“我没有带扑克牌已经是很给老板面子了。再说了，老板和他是好朋友的事大家可都是知道的。要是他现在突然走进浮游吧我们怎么办？说到底我们自保，不然你以为老板这么强势的人为什么会让步？”<br>“我只是一个打工的，老板怎么想不是我该去了解的。他要这么做自有他的理由，我遵守就好。我刚才说的不过是意见而已。如果你要是有什么话想跟老板讲，直接去找他好了，以你的身份老板不可能让你吃闭门羹，实在没有必要跟我在这里阴阳怪气地说什么。”<br>风衣男子没有说话，只是端着酒杯环顾四周。随着他的坐下，所有人又给按下了播放键，之前的喧闹再次返回。足以掀翻屋顶的动静。连着歇斯底里地唱了两首歌后，吉他手好像也有些累了，改唱节奏旋律舒缓的《Yesterday》。<br>“酒和音乐的圣地？你说出来这件事，这里还能是圣地吗？或许之前这里真是放松之地，但现在看看他们的笑脸，又有几张是真的？他们的手都是插兜紧紧握着兜里的枪，生怕有谁进来朝他开枪。别再自欺欺人了，哪里有什么世外桃源。就算没有这件事也会有另一件事，梦总归是梦，该醒来了。”<br>“我说了我只是一个打工的，你如果要说这个还是去找老板吧。”酒保的声音冰冷得像在冰箱里放了三年零一个礼拜的啤酒。<br>“你以为我在跟你说话？被逗了，老兄，你有这资格吗？我可是在跟你家老板说话，我相信老板一定躲在这里的某个黑暗角落里，像个杀手一样躲在暗处观察人们的一举一动分析所有人的行为。他表面给人自由，可实际上却是大权在握，一切都在他的掌握之中。我说话从来都不是讲给你听的，我相信老板躲在暗处什么都听得到。新的时代即将来临。”说着风衣男子举起高脚杯跟空气碰杯，他相信暗处的老板是会和他碰杯的。酒保没有说话，只是自顾自地擦拭着手里的高脚杯，他浑身上下都在说“离老子远点，滚一边去”。风衣男子结束了他的长篇大论从容地喝着血腥玛丽。这或许是因为酒保没有搭腔，也有可能是因为在他看来躲在暗处观察的老板没有在听了他的演讲后现身。总之他知道他再一个人说什么看上去都像是神经病患者的自娱自乐。零更不会自讨没趣地说什么，只是小口地酌着“哈尔9000”。他既不认识风衣男子，也不清楚他们口中的“那件事”是什么，自然没有必要引火烧身。<br>风衣男子指着零手里的“哈尔9000”问道：“这是什么酒？我怎么从没见过。”<br>“哈尔9000。”<br>“哈尔9000？真是奇怪的名字，有什么含义吗？”<br>“不太清楚。或许只是因为这么叫好听。”<br>察觉到零求救的目光，酒保抬起头，他的声音回升到零下五摄氏度，“哈尔9000，是某系列电脑的名称。当然至于把它当做酒的名字只是因为我喜欢。”<br>“只是因为喜欢？倒也确实是你们的做法。”风衣男子理解似的点点头，“为什么这么做？因为我喜欢，好像世上的事除了‘喜欢’就什么也没有了，视规矩于无物，跟工厂完全是两个极端。他们死守规矩偏要别人用数字做名字，也不问问别人的感受。”<br>“先生，大家都一样。不论是工厂还是你们。”<br>风衣男子摇摇头，“可别把我们和工厂混为一谈。是的，我们也制定规矩，但我们可不像工厂那样墨守成规，我们有容错机制，不像工厂，因为对名字提出点什么意见就逼他跳楼。”<br>“可你们却因为有人不在现场留下代表你们的扑克牌就对他施以酷刑。”酒保说着往高脚杯上哈了一口气。<br>“这是规矩。而且我们老早就告诉所有人不遵守规矩会如何，不像工厂，表面给他选择，实际却别无他法。”<br>酒保没再讲话，他知道再讲下去势必会演化为争吵。两位固执己见的人只能在一起聊聊天气。<br>风衣男子一口将酒饮尽，“希望下一次再在这里见面的时候你还能这样理直气壮地说‘因为我喜欢，所以他叫哈尔9000’。”<br>目送着风衣男子走出浮游吧，确定对方不会再返回后，零才开口道：“这什么情况？”<br>“非常时期，不知道发生什么反而是好事。如果真想知道的话，我只能告诉你，杀手界可能要变天了。”<br>“如果什么都不知道怕最后是死也死得不明不白。我是说如果杀手界真要变天，到时候一定会死很多人吧，以我的实力，给人当炮灰都有人嫌。”<br>“别太悲观，事情还没有到最坏的时候。绝影和你们组织都还在找可以开战的理由。这也是我让你别太好奇的原因——你只是零，身份地位都不高，知道一些机密反而会给组织盯上当做开战的替罪羊。还有，最近可别太经常来酒吧，你刚才也听到了，不论是绝影还是组织都把我们这视为必争之地。面对这样一触即发的局面，我们也不得不变通规矩，不然你以为刚才那位为什么敢在这里持枪。”<br>“听到你的关心，我感动得要流泪了。话说回来，刚才那人是谁？”<br>“老K，绝影的高层。做个不恰当的类比，他在绝影的地位就像你老师木匠在组织的地位一样。”<br>“还要再来一杯吗？”酒保看着零面前的空酒杯加了一句。<br>零摇摇头，“不了。绝影的事可以讲讲吗？”<br>“绝影和你们组织的那点破烂事就像报纸娱乐板块里的明星花边新闻一样，并非机密要闻。相反更像是人们茶余饭后的谈资。也就是平日里不管不问，不然你早就对这些破事烂熟于心了。<br>“既然你什么都不知道，那我想我还是从头说起好了。我们都知道绝影是最近几百年才成立的杀手组织，而他和你们组织分庭抗礼更是最近几十年才有的，这也就是说在这之前杀手界都是组织一家独大的。<br>“说来也奇怪，组织以完成任务的个数来为成员命名的规矩是古已有之，换句话说组织是很注重名字的，但这样一个注重名字的组织自己却没有名字。现在有人叫他‘工厂’其实还是太有侮辱性质的。更有意思的是‘工厂’这名字是绝影最先提出的。顾名思义，‘工厂’就是在讽刺组织成员用数字来命名。至于个性化称号，不知道是不是绝影的创始人没有考虑到这个问题。<br>“最狗血的是，绝影的创始人原来还是组织的高层，如果我没有记错的话他当时的名字——或者说是个性化称号——是扑克。扑克跟画家很像，都会在完成任务后在现场留下独属于自己的记号——扑克留下扑克牌，画家留下他的画。有关‘绝影’，扑克的说法是没有没有任何寓意，单纯取着玩的，只是想恶心恶心组织。不过现在绝影的高层们都认为‘绝影’是取自曹操座下的那匹名马‘绝影’的传说。那是一匹可以与时间赛跑，甚至可以摆脱影子的千里马。绝影的高层认为扑克以此为名是为了勉励后来者，‘五步杀一人，千里不留名’。<br>“原来绝影的规矩只有一个，那就是不择手段地完成所有任务。后来不知道是继任者们太仰慕扑克了还是因为别的什么，他们又加了另一条规矩：任务完成后一定要在现场留下扑克牌以此证明是绝影的杀手在做任务。是的，只有这一条多加的规矩，老K的名字不过是一个例外，他们没有以扑克命名的惯例，那家伙不过是扑克的脑残粉。当然我很怀疑真正的扑克说话会不会向他一样冲。<br>“如果说原来扑克叛出组织成立绝影是因为对组织命名方式的不满，那么现在两者之间的矛盾其实已经由理念不同转变为杀手界在时间冲刷下的自我更新了——组织信奉的是老派的那一套，完成任务，不着痕迹；而绝影的杀手更为狂妄自大，往任务对象的家中寄预告信，‘于几月几日拜访’，并且在现场留下最醒目的痕迹，生怕别人不知道这是他们干的一样。在组织看来，绝影的规矩没有体系，像是小孩过家家一样；在绝影眼中组织就是不懂变通的老迂腐。不过有一件事他们倒是统一战线，那就是浮游吧都是一群不讲规矩的臭流氓。<br>“不论是组织还是绝影，他们都以为自己与众不同，其实那只是在他们看来罢了，在我们这些局外人的眼里他们没有任何区别。有人怀疑绝影和组织其实是一个人的两只手，不论他们有什么矛盾，争斗的过程多么惊心动魄、扣人心弦，都不会对手的的主人造成任何伤害，自然也就不会有哪一方真正压制另一方。说白了，不过是捞钱的隐秘手段而已——绝影的人以为自己比组织的杀手更优秀，但组织又自诩天下第一，你有见过天下第一的收费比天下第二的便宜吗？所以只要保持这样的状态只要两只手不断交替上升，那么金钱就会源源不断地滚进手主人的钱包。<br>“现在这样紧张的局面好像准备让这种猜测不攻自破。不过我总以为我们能想到的绝影和组织也一定能想到，所以在我看来就算真的开战顶多也就是雷声大雨点小，最多最多不过是死几个炮灰。他们这是醉翁之意不在酒，如果说他们真想下定决心做什么，那也是要把我们浮游吧一锅端了。所以啊，这几天没什么事情就不要往这里跑。”<br>零端起高脚杯准备喝点什么时才想起酒已经喝完了，随后他尴尬地放下酒杯，“要不是这种事真实发生在我们身边，我肯定会以为你刚才讲的是某部52集大型电视连续剧的剧情梗概。说到底真是谢谢你了，虽然因为某些原因你有事情不能告诉我，但最起码我现在也不是完全不知道发生了什么的糊涂蛋了。”<br>酒保放下擦拭的酒杯，诧异的看来零一眼，“突然这么正经的跟我道谢我还真是不习惯呢！”<br>“没办法，有一段时间不能来了，我想就认真地说声谢谢好了。”零站起身耸耸肩道。<br>酒保没有应他，继续擦着手中的高脚杯。在零看来酒保手中的杯子已经很干净了，可以清晰地从上面看到酒保的脸。但酒保还是用劲地擦着，不把它搓下一层皮誓不罢休。零知道酒保不爱说再见，也不准备等他回答就转身离开，这时候他像突然想起什么似的指了指舞台上中央的吉他手：“我很好奇这家伙还要唱多久？”<br>“怎么，不喜欢？”<br>“那倒不至于，只是很好奇他今天要唱多久？”<br>“既然说要试用一个晚上，那最少也要唱到12点吧。”<br>“真是怪可怜的。你说他最后一首歌会不会唱的是《难忘今宵》？”<br>“你好像忘了什么事了，他唱的最后一首歌绝不可能是《难忘今宵》，他唱的一定是《上帝与你同在》之类的歌曲吧！”酒保说着朝零眨了眨眼睛。<br>“哦，对了，酒叫‘哈尔9000’真的只是因为你喜欢？”<br>“没理由骗你，建议你去看看《2001：太空漫游》，名字倒是出自这里。”<br>“走啦走啦，晚了还不得叫老师打死。”</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(8)——锦鲤抄</title>
      <link href="/2022/12/07/tao-chi-shu-zi-zhi-nan-8/"/>
      <url>/2022/12/07/tao-chi-shu-zi-zhi-nan-8/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="七．锦鲤抄"><a href="#七．锦鲤抄" class="headerlink" title="七．锦鲤抄"></a>七．锦鲤抄</h1><p>凡事都是有原因的，他知道自己从没有半夜醒来的习惯。今天这种情况是破天荒的一遭。<br>他开始检查自己的身体，毫无尿意，手脚也没有酸痛，基本可以排除抽筋的可能性，肚子、牙齿、脑袋也没有发出无理取闹的抗议。一言以蔽之，自己健康得像春天里的熊。没有人喜欢例外，因为例外就意味着异常，而一般情况下异常又和意外挂钩。但在对自己身体做了一个事无巨细的检查之后，他到底是放松下来了。凡事都是有原因的，但同时他也知道凡事都有例外，什么事都有第一次，这就是说尽管没有半夜莫名惊醒的习惯，但在排除一切可能性后，这件事情的发生也就不是那么不可理喻的了。毕竟自己年纪也大了，他这样想着重新闭上眼睛等待睡意的再次拜访。<br>毫无睡意。他赌气似的翻了翻身子，身下的床发出的“吱嘎”声在半夜听来显得异常清晰，像是在替他向某个偷走他睡意的不知名存在发出的抗议声。事出反常必有妖，他开始回忆自己前一天经历了什么。平平淡淡的一天，相比于平常的日子，昨天自己经历的无聊得就像1+1&#x3D;2一样，简单得让人泄气。于是他又对自己做了一个全身检查，如果他拥有灵魂出窍的能力，他此时肯定已经将自己的身体像面团一样翻来覆去地摆弄过几十回了。还是没有问题。可现在最大的问题就是一切正常，没有过度的兴奋，没有身体的不适，有的只是串错门的睡意。然后他又有些好笑地想到：准确的说，自己也并没有拥有睡意。<br>他感觉自己身上有些燥热，黏糊糊的好像要流汗。他由此想到或许思考不只是脑力活动那么简单，如果没有充沛的体力就不能完成连续不断的思考。他开始想像自己的大脑。一台做工精细、没有任何误差的机器，啮合得严丝合缝的齿轮。他开始思考，大脑便工作，机器就运转，于是齿轮缓慢加速，严谨得像数学公式的成对转动，多米诺骨牌式的连续运转。高效有序但其间没有任何细微的声响。没有人知道大脑里的机器在运转，除了自己。这是这个机器唯一的优点，当然组织会认为这是大脑唯一的缺点。没有噪音，但会发热。机器，发热。这样想着，他突然想到了池塘里的鲤鱼。<br>鲤鱼们现在在干嘛，它们应该也是要睡觉的吧！就是不知道鲤鱼们睡觉的时候它们是无意识地游动还是让自己安静地沉在水里呢？他有一种想翻身下床去看看鲤鱼们现在如何的冲动，不过他没有这样做，因为他知道这只会让自己更加兴奋，到时候自己就跑去画画而更不想睡觉了。<br>不知道鲤鱼会不会跟人一样思考。他觉得这个问题的答案自己根本想不出来，准确的说，自己永远也不会知道这个问题的答案，因为大脑在思考的时候是不会发出任何声响的。他发现自己有些羡慕鲤鱼，如果鲤鱼会思考的话。因为鲤鱼们一直待在水里，在思考的时候会有水帮它们降温。至于鲤鱼们只能待在水里永远也无法脱离池塘这一点，他倒是不甚在意——自己也没比它们好到哪里去，不过是池塘和“组织”的区别，而且孰优孰劣还需要好好思考一番。<br>他开始流汗。于是他愈发确定思考是一项体力活动。<br>还是没有睡意。他就这样躺在床上，死死盯着天花板。他试着将天花板所在的平面分成两半，然后再将其中一半一分为二，他感觉自己现在做的事跟试图列举所有的素数一样没劲。他开始怀疑自己这样做的动机：自己这样做到底是因为无聊打发时间还是想让自己无聊到想要睡觉，他越想越觉得后者的可能性太小了，做这样的事只会让自己更兴奋。至少这样做了以后，他感觉更热了。大脑一定在高速运转，他想。由此他不禁怀疑数羊到底是一种帮助睡眠的方法，还是一种让身体意识到兴奋后的疲倦的方法——只是人造睡意而非吸引迷路的睡意。<br>不知道是心理作用还是事实果真如此，在大脑高速运转齿轮咬合火花四溅终归于平静之后，他感觉自己四肢无力，像是被挤出盒子的软绵绵的果冻。在他的印象里已经被自己切成面巾纸大小的天花板开始向他靠近。没一会儿，他就看到天花板已经降到自己的面前了，他可以清晰地感知到自己的呼吸喷在其上四散开来，他甚至能看到被天花板阻挡的鼻息。天花板还在缓缓下落，原本只是一方面巾纸大小的天花板现在在他眼里已经如棺材板一般大了。随着棺材板的落下，名为“眼帘”的代表厚重睡意的铁幕也缓缓降落。<br>他感觉自己给人推了一把，猛然睁开眼睛。他有些把握不准现在的情况，自己到底是在梦里睁眼太过用力导致自己在现实中猛然睁开双眼，还是说自己从来就没有睡着过，或许这仅仅是大脑齿轮停止运转后又重新开始工作让眼睛看到的景像再次传到大脑而产生的错觉。他并没有在这个问题上纠结太久，他的注意力很快就被紧贴在自己身上的睡意吸引。他的睡意已经湿透了，好像他刚刚穿着它跳到池塘里游了几圈。湿透的睡衣紧贴在身上好像给自己裹上了一层保鲜膜，这种感觉实在称不上舒服。他摸摸自己的皮肤，但感受到的却不是想象中的汗津津、黏糊糊。他有些琢磨不清身上的是汗水还是普通的水。不过有一点他可以百分之百确定：相较于前半夜的温度现在的温度高得有些离谱。他可以肯定这既非大脑工作发热也不是源于心理作用。一定是出了什么事。<br>他站在床边，半是疑惑半是惊讶地看着自己刚才躺过的地方。那里床单的颜色比周围的更深。如果那是汗，他简直不敢相信自己会出这么多的汗。他可以清晰地认出那块被浸湿的区域里连成的人形轮廓，像是刑侦人员为尸体画的轮廓线。如果不是那里现在没有躺着他自己，他都要怀疑自己已经灵魂出窍了。<br>他拉开窗帘，清冷的月光例行公事般地投进房间，在地板上留下一个漆黑的人影。他不喜欢月亮，特别是圆月，准确地说他不喜欢出现在天空中的圆形（球形）物体。但相比较于太阳他更讨厌月亮，或许是因为他不能够直视太阳。有句话怎么说得来着？“当你凝视深渊时，深渊也在凝望着你”。无论是太阳也好月亮也好，总给他一种对方无时无刻不在监视世人的感觉。想到这里他自嘲似的笑了笑，这当然不能怪罪太阳或是月亮，说到底是自己太神经质的。<br>直到一条火蛇快速地从窗前略过，他才从月亮身上收回目光注意到楼下已经是红色的海洋了。难怪现在房间里的温度这样高，他恍然大悟。不过火势这么大竟然都没有烧到自己的房间也真是一个奇迹。他又瞥了眼月亮，不知道这场大火在月亮眼里又代表着什么，是俗套的戏剧还是地上蝼蚁们的无聊勾当？他并不在意是谁纵的火，准确的说除了组织没有人会这么做。至于选择的是纵火他也没有什么好意外，如果是他他也会选纵火的，因为如果不是他突然醒来他今天肯定就不明不白地死去了。无论怎么看纵火都是一项成本极低效率极高的选择。总而言之，组织对自己动手，选择何种方法他都不会感到惊讶，唯一让他感到意外的是组织选择今天对他动手。这并不是说组织今天动手打了他一个措手不及（当然这也是事实），而是说他不太能相信组织能忍到今天才对他动手。按他的想法，组织会在自己得到个性化称号前就把自己杀了。或许是因为一直没找到合适的借口，他想。<br>他走到门前试着转动门把手，在他摸上门把手的一瞬间，就像被蜜蜂蛰了一下一样他赶紧抽回手臂，轻轻揉搓着耳垂。看样子火已经蔓延到门外了，不过到底是为什么自己的卧室反而完好无顺呢？然后像报复刚才门把手把自己烫伤一样，他狠狠地踹了门几脚。门自是纹丝不动，反倒他的腿还被震麻了。他知道单靠自己随意踢几脚是无论如何也不能把门踹开的（其实就是用出吃奶的劲结果也一样），但他还是在走回床边的路上抱怨了几句：“早知道卧室的门就不用防盗门了，结果现在是搬起石头砸自己的脚。真是讽刺。”<br>他说着掏出早先藏在枕头底下的手枪，对着防盗门就是几枪。如果你问他：“既然外面已是熊熊大火又为什么要急着打开门让火蔓延到卧室呢？”他或许也不知道自己是怎么想的，他不确定打开门是为了什么，照门的温度来看他已然没有逃出生天的可能性，但他还是要开门，这样做的目的主要不是为了逃出生天（能逃出去是最好），而是因为他决心反抗。能不能成功是一回事，必须要让组织明白自己决不妥协。<br>然而意料之中打破夜晚岑寂的枪声并未如他所愿那般响起。没子弹！他恼火地将手枪扔向防盗门。他冷静下来意识到事情有些不对劲：他可以用自己的姓名起誓自己每晚睡前都会认真地检查手枪里的子弹，换言之，他的手枪里不该没有子弹。这不仅是他的自信，更是他的职业素养。还有另一种可能，不过他并不认为组织会有这样的幽默——如果组织能够在自己熟睡时神不知鬼不觉地取出自己枕头底下的手枪里的子弹，那么他们一定不会选择多此一举地纵火并以此欣赏自己的绝望，他们一定会趁自己在熟睡中小心翼翼地摘下自己的项上人头。<br>随着时间的流逝，月亮愈发明亮愈发冰冷。它透过窗子投下白森森的光。他觉得自己被越发皎洁的月亮嘲笑。它在嘲笑自己手枪没有子弹，它在嘲笑自己只能坐以待毙。他赌气似的站起身来，自己死就死了，难不成还要给月亮这种满脸白粉的死物嘲笑？他准备再上前去踹几脚门，就算这样无济于事。他现在有些后悔自己没有在卧室里准备两枚火箭弹，不然他现在肯定在尝试射下月亮，顺便把自己的房子炸上天。火箭弹？他被自己的想法逗笑了：自己现在肯定离发疯不远了。<br>就在他弯起左腿准备弹腿时他听到了钥匙插进锁口的声音，他急忙止住自己的动作，捡起被丢到一旁的手枪，就算没有子弹这东西好歹也可以发挥一下热兵器的威慑力。<br>门打开。站在他对面的是身着红色华服的女子。她的身后什么也没有，没有他想象中不住咆哮张着血盆大口的火焰。但随着门的打开，温度确确实实又往上爬了几级台阶。这时候他有些庆幸自己的衣服已经湿透了，不然现在这种汗如雨下的感觉别提有多难受了。<br>他想不出有什么形容词可以形容站在他面前的女子，现在出现在他的脑海中的词只有一个——“赛贵妃”。他可以肯定对方不是组织派来的，这倒不是说组织中没有女杀手，而是据他所知，组织中没有爱穿华服的杀手，因为穿着也就意味着私人。<br>女子好像从头至尾都没有注意到正对着她的黑洞洞的枪口，她的声音像是山涧里叮咚作响的泉水：“官家可是迷路了？”<br>官家？可真是一个文绉绉的词啊，他怀疑女子是从画上飘然而至的人，不过得是怎样的丹青妙笔才能画出这样一位“赛贵妃”的女子呢？至少他自己最满意的仕女图也不及她的千分之一。迷路？反正自己现在也难逃葬身火海的命运，倒不如顺着她的话说下去，看看她有什么好办法。<br>“啊，小生正要去浮游吧，还望姑娘指点迷津。”<br>女子闻后一笑，她的笑容让他想到了鲤鱼们无聊时吐泡泡的情形。现在可真是城门失火殃及池鱼，不知道现在鲤鱼们怎么样了。“这可真是有缘，妾身刚从浮游吧归来，如若官家不介意，妾身倒是可以为官家带路。”<br>“那就有劳姑娘了。”他根本就没考虑过对方会不会对自己怀有敌意，或者说就算她是来杀自己的，他也不在意。有句话说的好，“牡丹花下死，做鬼也风流”。与其葬身火海，倒不如死在女人手上。他开始想像自己死于女子手中被组织发现后组织的反应。既然女子不是组织的人，那么组织就不会对外说自己是死于他杀。他们肯定会伪造自己葬身火海的事实，这很符合组织的教义，个人不存在。换言之，组织只允许集体中的视某种模板为榜样的个人存在。自己死亡的真相一定会被掩盖，但这不是什么大问题，想到无论自己是逃出生天还是死于非组织成员之手，自己都是在恶心组织，他就忍不住要笑出声来。<br>他跟着女子拐进左手边的一条走廊。在他的印象里房间中根本没有这条连廊。不过今天遇到的莫名其妙的事情还算少吗？不知道在哪里迷路的睡意，莫名其妙消失的子弹，那么现在凭空出现一条不曾存在过的走廊又有什么好大惊小怪的？<br>“官家，跟牢妾身莫要走远。这火可是实实在在的火，官家莫要靠得太近，到时候被火烧伤倒不好了。”经女子这么一说，他才注意到不知从何时开始长廊上净是乱舞的火焰，像是伺机而动的火蛇，只待他放松便以迅雷不及掩耳之势缠上他让他受烈火焚身之痛。说来奇怪，明明是木质的连廊，但不知道为什么面对这熊熊大火，走廊并没有发出“噼里啪啦”的呻吟，反而像圣女贞德一样默默忍受这一切，一声不吭。好像自走廊建造完成以来，这火便一直缠着它燃烧。廊在火便燃，火燃廊就在。在这里，火与廊并非是互不相容的存在，而是相辅相成的有机体。<br>火悄无声息地燃烧着。但如果不是木廊每隔一段时间便会有部分掉落，他都要怀疑这悄无声息的火是自己的幻觉了。华服女子走得很快，他必须要小步快跑才能跟上。他有些疑惑地盯着华服女子的光洁的腿，就目测而言，她的腿并不比自己长，至于步频，实话实说，他并不觉得对方的步频比自己要快。相反在他看来，华服女子的步频走姿只能用从容不迫来形容。但不管他怎样努力华服女子都要领先他一步，这让他想到了游泳——有些人只要轻轻地摆动双臂随意扑腾一下便可以一骑绝尘。<br>尽管华服女子的脚步需要他小步快跑才能追上，但这样的速度也仅仅是与连廊跌落的速度堪堪持平。燃烧的连廊跌落也是毫无动静的，正如它凭空出现一样，像水消失在水里。他试图转头看看后面的情况，但华服女子出声制止了他：“官人注意脚下，莫要回头看。”听华服女子的意思好像跟在他们身后的是美杜莎。不过他也不打算尝试，好奇害死猫嘛。而且到目前为止华服女子并未对他表现出什么恶意，现在还是相信她为好。<br>火仍然无声无息地烧着，但想象中滚滚浓烟的情形也并未出现，相反他似乎隐约闻到夏天雨后泥土的味道。这可真是奇怪的现象，火与木头，浓烟与雨水，这两队原本互不相容的因素在这里却能和谐相处。<br>他不太清楚自己跟在华服女子身后走了有多久，只知道如果在不停下脚步自己就要喘不过气了。虽然自己年纪大了，但他对自己的身体素质其实是很有信心的，可现在他已经上气不接下气了。就在他考虑要不要喊住华服女子叫他慢一些是，华服女子却自己主动停了下来。原本不知在什么时候他们已经穿过走廊了。<br>华服女子指着前面泛着白光的出口，“官家，穿过前方的出口便是浮游吧了。妾身就送到这里了。妾身这里有幅画希望官家能够帮妾身送给浮游吧的一位朋友。”说着华服女子递给他一个画筒。<br>他弯腰对女子做了个揖，“那就多谢姑娘了，小生就此别过。”<br>就在他俯身钻入洞口时，他感觉自己后脑勺给人敲了一棒，随即眼前一黑。此时他脑中闪过的想法只有一个：这可真他妈幽默。</p><hr><p>醒来时印入他眼帘的是灰蒙蒙的天空，像是在暴风雨后被搅得浑浊不堪的大海。白惨惨的月亮已经不见踪影，光芒万丈让人无法直视的太阳被连成整体的灰云遮挡。对他而言，这世上只有两种天气：有太阳或是月亮的天气，没有太阳月亮的天气。<br>全身酸痛，好像有人把他全身的骨头都抽离出来敲成粉末重新组合后再塞进他身体一样。他忍住像是蚂蚁噬咬全身的苦痛，试着站起身来。隔了好一会儿他才意识到自己正处在房子后的后山上。<br>隔着浓稠的乳白色的雾，他隐约可以看见自己的房子。可别说房子有什么被火焚烧过的痕迹，就是墙上的应该被烟熏黑的痕迹也不存在。那么昨天晚上经历的到底是什么？<br>要很仔细看他才可以看到蚂蚁大小的人在他的房子里进进出出，因为隔着太远他自然听不到他们的说话声，但根据他们慌张的动作，他怀疑对组织而言自己应该算是失踪了。不知道为什么，自己明明连人都看得见，却始终没有看到房前的池塘。不知道是因为组织将它填满了还是因为雾太浓。不管怎样，他现在都不可能跑到山下去看鲤鱼的情况如何。现在只能祝福它们了。<br>手里握着的画筒提醒他先前经历的并非是梦境。当然也许也不是真正的现实。他可以轻而易举地认出这个画筒是属于自己的。其中装着的是自己最喜欢的却在几天前莫名消失的画。他还记得当时为了这幅画自己恨不得把整幢房子翻个底朝天。没想到这幅画最后会在华服女子的手里。她叫我把这幅画送给浮游吧的一个朋友，难不成她是叫我把这幅画送给现在的自己？<br>他打开画筒展开画卷，画中栩栩如生，似乎真的在水中游动的鲤鱼此时却不知在何处。雪白得没有一点纤尘的宣纸。他死盯着手里的画卷，似乎这样做，跑到哪里的鲤鱼就会重新游回到宣纸上。<br>有些问题是需要花一辈子思考的。他好像明白了什么，默默收起画卷。抬头看天，还是灰蒙蒙的一片。没有太阳或月亮，就是好天气。既然华服女子完成了带他去浮游吧的承诺，那么他也应该完成他的承诺——把画带到浮游吧。<br>说实话，他现在也只能去浮游吧。但他从未像现在这么高兴，因为他现在是失踪人口。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(7)——任务报告以及日记</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-7/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-7/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="六-任务报告以及日记"><a href="#六-任务报告以及日记" class="headerlink" title="六. 任务报告以及日记"></a>六. 任务报告以及日记</h1><p><strong>任务归档：护送类任务<br>任务编号：B1708691<br>任务内容：护送在山中迷路的吉他手安全回到小镇（下附吉他手照片及信息）<br>执行人：A区东方街道53小区56单元的零<br>任务详情：<br>不做计划的杀手注定被杀。<br>                     ——《杀手准则》第8条<br>随机应变的事十赌九输的赌徒，绝非优秀的杀手。<br>                       ——《杀手准则》第11条</strong></p><p>  要在寒风刺骨的冬天到一座全年积雪的的高山中绝非易事，甚至有可能会为此丢掉性命也说不定。机会和成功只会留给有准备的人，为此我专门查阅了和这座山有关的所有资料，得知山中并没有什么凶猛的野兽，以及位于半山腰的猎人小屋是山中唯一可以歇脚的地方。<br>   为避免寻人过程中出现迷路的情况，我专门准备了一根长为百米的麻绳。我的计划是：绳子一头与马棚相连，另一头与自己绑在一起，这样一来我就可以搜索以木屋为圆心的方圆百米的区域了。</p><p><strong>杀手，可以失败，但绝不能犯错。<br>                            ——《杀手准则》第19条<br>    连续三天都没有见到人影，或许吉他手已经冻死了。<br>少说话，多做事（任务）。<br>                          ——《杀手准则》第3条<br>对杀手而言，犯错意味着死亡。<br>                            ——《杀手准则》第20条<br>杀手，小心翼翼的代名词。<br>                             ——《杀手准则》第31条</strong><br>    我不清楚吉他手是否有仇家，但小心翼翼怎么也不为过，所以在搜索吉他手期间我一直睡在地窖中。<br>时至今日我在想到4月23日晚上的暴风雪时仍感到一阵后怕——当时我正在寻找吉他手的身影，突然之间，狂风裹挟着暴雪而来。就是现在我也不敢相信原本毫无重量的入手即化的雪花竟也会像刀子一般锋利。风无孔不入，藏在风中的雪也一样，就算裹得再怎么严实，还是感到全身上下有刀子划过，怕是历史上的凌迟之刑也不过如此。<br>幸亏我提前备有绳子，不然现在我已经成了大自然残酷而又神奇的手里的又一件完美艺术品了。<br>正因为4月23日晚与大自然的激烈搏斗，在第二天我并没有注意到进入地窖的C区南方公园48小区103单元的28。甚至在C区南方公园48小区103单元的28开枪后将我惊醒后我也没有意识到是有人在地窖开枪，反而在对事态发展了解不足的情况下贸然打开地窖的大门。<br>在“吉他手”的信息与任务提供的信息不符时，我因为怀疑组织的任务信息有误而莫名被缴械，还因此被对方逼入绝境。若不是C区南方公园48小区103单元的28及时相救，我肯定已然牺牲。<br>在C区南方公园48小区103单元的28的帮助下，准确的说是他以自己的一人之力解决了所有敌人。当时我已经相信吉他手已死，我的第一个任务注定失败。可谁知我所寻找的吉他手却在我正心灰意冷之时推门而入。于是我和C区南方公园48小区103单元的28将他安全送到镇上。<br>在这几天里我从C区南方公园48小区103单元的28身上学到很多，其中最重要的一点是：紧张，是杀手必须摒弃的的劣根性。</p><hr><p><strong>任务是否完成：是<br>执行人是否晋升：否<br>任务评述：<br>杀手，孤独的狼王。<br>                           ——《杀手准则》第1条</strong><br>与人合作的只是弱者，绝非杀手。换言之，杀手只能相信自己和自己手中的枪。但A区东方街道53小区56单元的零却是在C区南方公园48小区103单元的28帮助下才完成任务的。毫不客气的说，没有A区东方街道53小区56单元的零吉他手也能安全返回小镇。<br>我们并未从报告中看到A区东方街道53小区56单元的零的贡献和亮点。相反，他非常“完美”地违反了《杀手准则》第3、20、31条，并使自己陷入绝境。他甚至还怀疑组织提供的信息是否属实。<br>诚然，从结果上看，A区东方街道53小区56单元的零完成了任务，但经过会议讨论我们决定取消他的晋升。我们需要的不是幸运观众，而是独当一面的狼王。<br>报告说明：<br>根据古老而神圣的《杀手公约》，B类任务将在任务报告完成20年后向杀手界公开。在此期间除组织高层会议成员外任何人都不得查阅报告。除执行人外他人不得公开并谈论其内容。</p><hr><p><strong>任务归档：潜伏刺杀类任务<br>任务编号：A242032719<br>任务内容：刺杀吉他手（下附吉他手以及其近日行程）<br>执行人：C区南方公园48小区103单元的28<br>任务详情：<br>            不做计划的杀手注定被杀。<br>                     ——《杀手准则》第8条<br>        随机应变的事十赌九输的赌徒，绝非优秀的杀手。<br>                       ——《杀手准则》第11条</strong><br>最了解自己的永远是自己的敌人。诚哉斯言，若要刺杀成功，必须对目标猎物了如指掌。在刺杀过程中必须要注意食物——“吉他手的食物”在杀手界和赏金猎人界的名气堪比“白雪公主后妈的毒苹果”——，哪怕我提前到达猎人小屋。<br>根据组织提供的信息，吉他手会在4月24日抵达猎人小屋，所以我在当天凌晨到达。我知道4月24日早上6点到8点会有暴风雪来临，吉他手也会在这个时间段内抵达。在他到达前，我尽量将零在猎人小屋的痕迹清理干净，并且给在地窖的零打了一针镇静剂——因为他的任务时保护吉他手。<br>出乎意料的是吉他手还有两个同伴。尽管我可以一枪击杀吉他手，但这不是最合适的时机。所以我暂时先躲入地窖。<br><strong>横冲直撞的是有勇无谋的武夫，而非事了拂衣去，深藏功与名的杀手。<br>                     ——《杀手准则》第2条</strong><br>根据泡咖啡这件事，我可以断定谁是吉他手。但是从他们的对话里我了解到还有另一伙人在来的路上。为避免出现不必要的麻烦，我决定继续等待。<br>当所有人到齐后，我开枪击倒其中一位以此引起混乱。但我的计划出现了疏忽：零被我的枪声惊醒并且在没有了解事态发展的情况下贸然走出地窖。<br>迫不得已的情况下我也只好冲出地窖做一位有勇无谋的武夫了。唯一值得庆幸的是对方的实力并不算太强。可惜的是，在混乱中我失手将吉他手的脑袋打烂了。</p><hr><p><strong>任务是否完成：是<br>执行人是否晋升：是<br>任务评述：<br>杀手，孤独的狼王。<br>                          ——《杀手准则》第1条</strong><br>杀手，本该冷酷无情。但C区南方公园48小区103单元的28为了救A区东方街道53小区56单元的零而使自己陷入绝境。从结果上看C区南方公园48小区103单元的28完美地完成了刺杀吉他手的人物——尽管在幕后的杀手跳到了台前，但C区南方公园48小区103单元的28杀净所有人也可以说是间接地呈现了杀手在幕后的状态，因为死人是不会开口的，换言之，没有人会把吉他手的死和我们联系在一起。当然这一切都是大伙心知肚明的，而这恰恰能够提高组织的名望。<br>根据从猎人小屋反馈回来的结果报告，C区南方公园48小区103单元的28并非如他自己在报告中所叙述的那般莽撞，因为对方太弱才侥幸完成任务的。谦逊，莫如说是扮猪吃虎。是一个杀手必备的核心素养之一：从现场的情况来看，无论是杀人于无形的毒药，还是简便有力的热兵器，抑或是冰冷的冷兵器，C区南方公园48小区103单元的28都可谓是使用得得心应手，毫无晦涩生疏之处。自组织成立以来，我们见过诸多天才，有人一路辉煌成就一代传奇，有人如流星般闪耀过后瞬间陨落，但却从没有人如C区南方公园48小区103单元的28一样在30件任务之前将诸多技艺纳入自己的武器库之中。<br>基于上述理由，经过会议讨论决定通过对C区南方公园48小区103单元的28的晋升。但组织的规矩不可挑战。杀手毕竟冷酷无情，所以在给C区南方公园48小区103单元的28晋升的同时必须给予其警告，以示公正。<br><strong>报告说明：</strong><br>根据古老而神圣的《杀手公约》，A类任务只得在确认执行人彻底死亡后才可向杀手界公开。在此期间除会议高层人员外任何人不得查阅报告（会议高层人员查阅也必须留下申请调阅的记录），除执行人外任何人都不得讨论其中内容。</p><hr><p>4月25日  多云<br>终于。终于顺利把吉他手安全送到镇上了，终于可以不用听这家伙一直喋喋不休地讲“主”“主”“主”了！我的天，现在就是写这个字，我全身都是鸡皮疙瘩。不——，该死的，我晚饭看到猪肉都恶心反胃。<br>吃晚饭的时候我注意到吉他手左手无名指上有一周颜色比其他部分浅的区域。我根本不敢想像竟然会有人愿意和吉他手结婚，相反他离婚在我看来倒是合情合理大快人心。尽管这样讲很是武断，但有一说一，和吉他手仅仅是待在一起一天我都快要崩溃了——雪终于停了，主，我感谢您，没有您的指引，我肯定早已葬身其中了；主啊，究竟是怎样的伟力才能造就我眼前的美丽世界，一定是您的手曾轻抚过我的双眼；我们的所思所想皆来自您的指导，我们的所食所穿所用全都来自您的赏赐，主，我赞美您；两位，如果没有你们的帮助我一定不能安全到达，愿主保佑你们……如若“阿门”是下一句，可以闭上了你的嘴，无谓“主说”要是“主说”更加崩溃……我想最后如果有人愿意和吉他手共度余生肯定是因为她叫“主”。<br>但不管怎么说，我总归是完成了我的第一个任务。乐观地想，这样一来我离“文豪”不就更近了一步吗？<br>要想成功晋升真正成为“壹”，单单完成任务是不够的，还得提交任务报告让组织来评价是否能够有晋升的资格。<br>按照28的说法，任务报告也是组织评价一位杀手的重要标准，如果你的报告写得不符合标准那无论你任务做得多么完美也无济于事。“除此之外，如果你的行为与《杀手准则》有多处不符，你无论如何也不可能获得晋升。”28对我说。<br>至于怎样的任务报告可以称之为“好”“符合标准”，28的说法是：既不能过分夸大事实神话自己，也不能过分贬低自己妄自菲薄；既要与事实相符，又不能和《杀手准则》有较大的出入，即使有出入也要情有可原。<br>这话讲得跟绕口令一样，听起来极其深奥，所以说实话我没听懂28究竟要表达的是什么。看这样子，吉祥你也没有听懂。不过我想没听懂也没有什么关系，无论是谁都会喜欢坦诚的人吧。<br>我没想到28竟然会专门替我写一篇任务报告，但说实话，这东西真的符合他刚才跟我讲的原则里的“与事实相符”吗？或许是因为我没有真正明白28的意思吧。如果我要成为作家，那我就一定要明白一些道理了解一些真相，理解言语背后的力量，所以我准备将28替我写的任务报告抄录在日记里。这样一来我就可以有事没事看它几眼试着去理解它。只要一刻不停地保持思考，我迟早能明白一些道理。或多或少。<br><strong>不做计划的杀手注定被杀。<br>                     ——《杀手准则》第8条<br>随机应变的事十赌九输的赌徒，绝非优秀的杀手。<br>                       ——《杀手准则》第11条</strong><br>保护吉他手是我的第一个任务。保护型任务，称不上多困难，但也绝不简单。狮子搏兔亦用全力，要想顺利地完成任务，必须要做好周全的计划。<br>首先，半山腰的猎人小屋是山上唯一可以落脚的地方，吉他手一定会去那里，所以我决定以猎人小屋为中心进行地毯式搜索。<br>天气问题倒是很好解决，只要每天认真收听天气预报即可。这个任务最大的麻烦是C区南方公园48小区103单元的28的任务是刺杀吉他手。<br>杀手不是赌徒，而且杀手总是冷酷无情的，所以我并没有把希望寄托在28会看在和我隶属于同一个组织的情况下网开一面放我一马。寻人并非是一朝一夕便可完成的，这注定是一件漫长的工作，所以我暂时住在猎人小屋中。为避免C区南方公园48小区103单元的28突然出现打我一个措手不及，我住在地窖里。<br>                <strong>少说话，多做事（任务）。<br>                          ——《杀手准则》第3条<br>                对杀手而言，犯错意味着死亡。<br>                            ——《杀手准则》第20条<br>                杀手，小心翼翼的代名词。<br>                             ——《杀手准则》第31条</strong><br>然而事与愿违。<br>4月24日晚我被枪声惊醒。人在刚醒来时总是迷迷糊糊的，话是如此，但这种错误是不应该出现在一个杀手身上的。很不幸，我当时并没有意识到枪是同样躲在地窖里的C区南方公园48小区103单元的28开的。这就是说我在没有了解事态发展的情况下便贸然出击，使自己丧失了主动权。事后想想这真是一个灾难性的错误。<br>唯一值得庆幸的是我并没有听那些人的谎话乖乖交出我的枪。也正因如此，我得以和他们对峙直到C区南方公园48小区103单元的28出手救下我。准确的说，C区南方公园48小区103单元的28以一己之力解决了所有人，而救下我似乎只是顺手为之。<br>值得一提的是，C区南方公园48小区103单元的28并非是完全冷酷无情的杀手，当知道我们的任务对象“吉他手”并非是同一人时他决定帮我一把。最后我能找到吉他手并且将他安全护送到镇上也多亏了C区南方公园48小区103单元的28的帮忙和指导。</p><hr><p>我并不打算使用28替我写的任务报告，这并不是说他写得不好。只是因为我实在无法理解28关于好的任务报告的说法和他写的任务报告之间到底有何联系。对于未知的、无法理解的事物，最好的态度是不做评价，保持隔岸观火的状态。相反，我坚信：做人要尽量做到公平和诚实。所以在不清楚28口中的“与事实相符”的意思的情况下我决定写我心中的“与事实相符”的任务报告。</p><p>没想到有一天我写日记竟然能写这么长。或许这恰好能证明我有当作家的天赋。虽然这话显得太不要脸了，但我想做人还是乐观一点好，否则只能朝自己的太阳穴来一枪以结束悲伤。<br>现在是晚上十一点，并非是菲茨杰拉德所说的“灵魂至暗”时刻，换句话说十一点对很多人来说仅仅是夜生活的开始罢了。无论周围再多人，感觉还是自己一个人。就连吉祥也睡着了。莫名的孤独感或许是因为任务结束后的骤然放松……<br>乐观也罢悲伤也罢，孤寂也好狂欢也好，现在终归是晚上十一点，明天又是新的一天……个性化称号不是一蹴而就的，与其想东想西，不如明天早起好好训练。<br>据说组织对任务报告的批复是很快的，或许明天醒来我就是“壹”了。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(6)——名字的故事（二）</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-6/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-6/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="五．名字的故事（二）"><a href="#五．名字的故事（二）" class="headerlink" title="五．名字的故事（二）"></a>五．名字的故事（二）</h1><p>如前所述，零有一套辨认别人的方法，即“命名方法”2.0版。但这只是适用于他个人的辨认方法，打招呼时可不能直呼“蓝皮肤的28”，否则等待零的只能是三选一。<br>一般情况下零是这样打招呼的：比如说他要找“蓝皮肤的28”他就只用去找蓝皮肤的人，而整个组织只有一位蓝皮肤的人。换句话说零根本不用去记谁是谁，看到蓝皮肤他就知道是28了，接着他就上前拍拍他的肩膀：“28……”，这样就自然而然地聊起来了。当然有时候两人距离比较远，在这种情况下零也没有什么多好的办法，他使用的是一种有生命危险的方法。在无法和对象发生肢体接触的情况下他一般是这样做的：首先大喊一声“28”，如果这里只有一个28那就没什么问题了；但如果这里有很多个28，不用我说，你也知道他们有些人会有些不会（因为“名字的狼来了”圈套）转过头来，但这对零来说不是问题，尽管他不知道自己要找的28的全名是什么，但他从一开始就认出对方了，于是他指着自己要找的28说：“28，对，说的就是你，没错，怎么可能会错？难道你不是28？……这不就行了吗？对，我找你有事，你先别走……”诚然这不失为一种和人打招呼的好方法，不仅可以完成和人对话的基本要求，而且还给自己免去了记忆的负担。同样，这种方法的弊端也很明显——难免会给别人目空一切的狂妄感觉。所以零和别人打招呼的时候没少被人拳脚相加。<br>零有时候也会纠结是三天两头给人打一顿难受还是不停地被别人的名字痛苦，这个问题零说服自己说服了好久也没甘心。他是这样想的：被人揍是肉体上的痛苦而且是短暂的，但背这些莫名其妙的名字是精神上的折磨而且这种痛苦是长期的甚至会变本加厉——万一出现了一个更新更复杂的（零并不以为会有更新更简便的前缀，因为简单就得私人化，但这在组织中却是不可能出现的）前缀怎么办？后来他又发现两者其实又差不多，他被人揍肯定是长期的过程，除非他不主动跟人打招呼。现在他又觉得后者的危害更大，根据他的经验，记忆会使人头昏目眩。其实分不清东南西北倒还好，他有一次竟然因为头晕眼花走进了女厕所，结果可想而知。零从这件事得出的结论是：记名字不仅是精神上的折磨，而且还会衍生出肉体的痛苦……不知道零以后会怎么想，反正他也正应了那句歌词“没什么烦恼，恐怕就想到什么生存意义想到没完没了”。<br>无论零怎样纠结，零有一点倒是看得很明白，就是跟“吞粪”“锤蛋”“跳楼”比起来，被人揍，那都不叫事。而且他还不可能叫人给打死，这倒不是说组织的杀手很好相处。零没有给人打死，主要是因为零的老师。<br>前面说的根据完成任务的多少来命名是对于组织的中层和基层成员而言的，对于高级成员，也就是零的老师这种层次的杀手，他们就不是单纯的以完成任务的个数来命名的了，它们那叫个性化名字。这也不难理解，要想混到高层，恐怕要完成数不胜数的任务。对于无穷大来说，加一和减一的区别很大吗？至于他们的个性化名字到底是怎么命名的，我也不太清楚，只知道零的老师叫木匠。<br>虽然没有官方说明个性化名字命名方式，但这丝毫没有扼杀立志要成为作家的零的好奇心（相反，我觉得这反而还激发了他的想象力和积极性）。众所周知，如果拥有几千分之一的拼图是无论如何也不会知道整幅图的原貌的，但实际上我们的脑海中会有一个大致的轮廓（或者说是猜测），而这就是想象力发挥作用的结果。我讲这个是为了向各位说明，如果你抓住一个有疑点的东西，然后发挥那威力无比的想象力，你一定会得到一个答案，但如果说那个答案正确无比，我是不相信的。零对高级成员的猜测就是这样的东西。<br>如阿基米德所说，要翘起地球不是问题，但也要有支点。所以零的猜测也有自己的支点，否则就是胡言乱语。<br>到了木匠这种层次，就是江湖传说一样的存在。一般杀手听到他的名字，就像聚贤庄的幸存者听到“乔（萧）峰”一样，心里千言万语汇成一句话“我去，这就是杀我家满门的家伙”。我举这个例子可不是没话找话，而是想说明就像乔峰有聚贤庄这样彪炳的战绩在身，木匠也留下了不少让人胆战心惊的事迹。<br>其中最令人胆寒的是木匠曾经在十九位杀手的围攻中生还。没人知道那天到底发生了什么，只知道最后只留下了十九具杀手的尸体，而木匠则潇洒飘然离去。这并不算什么，只能说明木匠杀人技术高超。唯一让人捉摸不透的是现场十八位杀手全部被一枪爆头，其中有一位确实被砍成两半。其实说是“砍”也不符合实际，因为那家伙的两段身体相隔十多米，而且他的血洒满这间屋子。据说，当时过来收尸的人之后看到西红柿都恶心。<br>有好事者根据屋子里的风车和断头台这样推理被腰斩的人的死亡过程——断头台上没有刀片，所以木匠是把“腰斩之人”的头塞进洞里，然后用十几根橡皮筋绑在那人的腰上，另一头和风车连在一起，随着风车的转动橡皮筋越绷越紧，最后把“腰斩之人”也给拉长了，他的腰从水桶变成水蛇，再变成竹竿，最后就成了拉面。在这一伸长的过程中你可以清晰地听到“腰斩之人”内脏被拉长的声音，先是胃和肾，然后是肺，最后是心。木匠就这样听着，听到心脏被拉长，他就明白到极限了，赶紧砍断橡皮筋……<br>“然后就听到‘嗖’的一声，那人就像子弹一样弹了出去。本来在砍断橡皮筋的一瞬间那人就应该被扯裂的。但他飞出去的速度太快了，所以就在半空中才被截成两段。如果你仔细听，就是‘嗖——’‘嘶——’‘啦——’‘嗞——’，然后像烟花一样，血像西红柿一样到处乱飞乱溅……”<br>酒保的脸兴奋到有些扭曲，好像他当时就在现场，零看着他的脸又想了想当时的情景感到一阵恶心，“我想我能明白他们为什么会对西红柿感到恶心了。能给我换一杯酒吗？随便什么，别是红的就行。”<br>“你这样还怎么当杀手啊？”酒保递了听冰啤给零。<br>“你说这会不会是老师被成为木匠的原因？”<br>“有可能。不过这话谁又说得清？令狐冲不是还成了尼姑庵的老大？再说你们这些杀手取名字就跟小孩子过家家一样——一本正经的胡说八道。特别是你们组织，还偏用数字，明知不好使还硬着头皮用下去。”<br>零喝了口冰啤，“慎言啊，要是给别人听到了，你的脑袋就上榜了。”<br>“有错还不让说？行，你要不想听就不说这个了，还是说回名字好了，我记得你们组织里还有个叫‘画家’的呢！”<br>“‘画家’？”零突然想到了什么，举啤酒的手顿了顿，“他该不会在一次任务中用对方的血画画吧！”<br>酒保的嘴角抽了抽；“有趣的猜测。有没有这样的事我不清楚。其实我想说的是他每次完成刺杀任务都会在尸体旁边留下一幅画。”<br>“画？难怪叫‘画家’啊！不对啊，组织可是要求杀手在完成任务后尽量清理现场的。”<br>“我又不是你们组织的人，我只知道画家会留下一幅画。或许这是他最后成为组织高层而你成为零的原因。”<br>“还是算了吧，”零重重地吐出一口气，“如果我真这么做了，就算组织不追究，我也会被老师打个半死。”<br>零喝完最后一口啤酒站起身来，“得走了。”<br>酒保没有说话，只是微不可微地点点头就算是打过招呼了。不过零又走了回来：“或许有些鲁莽，但我还是想说，我是说提个意见——以后可不可以不要放这首《shape of my heart》了？听到这首歌，我总觉得你要拔枪射杀我。”<br>“放轻松，”酒保露出灿烂的笑容，“这里没有门，不会有人玩口香糖的游戏。至于拉环的游戏，别忘了‘浮游吧’的规矩，这里可不允许带武器。”<br>“说了只是意见，没必要这样当真。”话是如此，但零的兴致明显减弱了不少。<br>“我有没有说你和手杖、礼帽很搭？”<br>“如果可以的话，我也希望自己是绅士。或许莫里亚蒂这种类型适合我也说不定。”零说着还朝酒保眨眨眼。<br>“这话可不像是杀手会说的。好了，绅士先生，有兴趣再来一杯吗？”<br>“你可真会忽悠人。好了，真得走了。”<br>酒保看着零走远的背影，“其实我想说你真的不适合成为杀手啊。”说完他又低下头擦拭手中的高脚杯。</p><p>零看着眼前脸墨线都画不直的男人，“老师，你为什么会叫‘木匠’？”<br>“怎么突然问这个问题？嗯，你今天去过‘浮游吧’，是在酒吧听到了什么，是吧？”木匠仍然在画直线。但还是歪歪斜斜的“直线”。<br>“我听酒保说了你从十九名杀手手中重围的事。”<br>“十九名杀手？不是是把……”木匠拍拍脑门，“你说这件事啊！你不说我都快忘了，不过这件事和我叫‘木匠’又有什么关系呢？”<br>“有传闻说你用断头台和大风车折磨了一位杀手，所以……”<br>“所以你觉得我是因为木制的断头台和风车残忍杀害了其中一位杀手才会被叫做‘木匠’？很有趣的想法，就像哥伦布叫美洲土著‘印度人’一样，很有道理但是完全没有错误。其实原因很简单，没你想的那么复杂——只是因为我喜欢木工。就这么简单。”<br>“简单到极致也是一种复杂吧。但这样一来您的名字不就是私人性质的东西了吗？”<br>木匠叹了口气，“在你看来组织就这么不近人情吗？这件事你以后会明白的，你也可以简单地理解为当你完成的任务超过一定数量时，你就可以拥有这种带有私人性质的个性化名字了。实际上这种名字一点也不私人。”<br>“那画家呢？他也一样？”<br>“画家？你见到那个疯子了？”木匠一脸惊讶。他也不知道自己是希望零见到画家还是希望他们永远也不要见面。<br>“我也是听酒保说的，他说画家会在刺杀任务完成后留下一幅画。老师怎么会说画家是疯子呢？难道他很危险？”<br>“你是十万个为什么吗？问题怎么这么多。你看，都是因为你分散我的注意力，线都画不直了。”<br>看着那歪歪直直的墨线，零不禁腹诽了一句：老师你不去写书法真是可惜了，这线可谓是笔走龙蛇啊……</p><hr><p>4月8日  多云<br>今天从酒保那里听到了有关老师的事，从十九名杀手里冲出重围，不知道我要到什么时候才有这样的实力。不过老师的手法实在是太残忍了，直接杀了不好吗？又为什么要折磨对方呢？要是在折磨中被人发现，那后果……算了，对过去做假设没有意义。话又说回来，老师可是教导我完成任务时应该采取最有效的手段。“在和死神跳贴面舞时，能活下来就不错了，还在意什么体面不体面的？记住，你是杀手不是绅士。”——这可是老师的原话。再说老师，实际是组织中的所有人难道不都是很遵守这些规定——1）.有效迅速地完成任务；2）.在1）的前提下，清理现场，尽量消除自己留下的痕迹；3）.少说话，多做任务……——的吗？当然，除了画家。不过到底为什么老师要做这样一件吃力不讨好的事？<br>还有名字的问题。不知道是直觉还是我那作家的想象力作祟的缘故，我总觉得老师的名字和这件事有明显关系。至于“喜欢木工”这一点也得存疑，至少我没看到老师眼里有热情存在，老师看木材的眼神就像晒太阳时吉祥看我的眼神一样，仅仅是在确认那个是我（木头）而已。而且老师在做木工时的状态和我写作时完全不同，最起码没有我热爱写作那样热爱木工。难怪说是喜欢“木工”。还有老师木工的技术，不过既然只是“喜欢”，技术不好也是可以理解的。<br>话说回来，仅仅是“喜欢”就可以用“木匠”当个性化称号，那我是不是以后就叫“作家”了？不对，“作家”和“木匠”一样没档次，应该叫“大文豪”。这虽然是实话，但还是要谦虚一些，就叫“文豪”好了。其实“绅士”也行，如果是“绅士”的话倒也可以勉为其难的接受。<br>糟糕，忘记问要完成多少个任务才会获得个性化称号。算了吧，知道答案更让人心塞，不知道还可以保留幻想。不知道哪时候才可以有这样的实力。我现在还是零啊！<br>假设没有意义，你也是这样觉得的吧，吉祥。文章要一个字一个字地写，训练也要一步一个脚印。明天还要早起，今天就写到这里吧。要尽快成为“壹”，这样才能靠近“作家”，哦不，是“文豪”。<br>（此处有几个梅花印）<br>好了好了，吉祥别闹！行行我不写了。真的不写了。是该洗洗睡了。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(5)——今日死神喜怒无常</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-5/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-5/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="四-今日死神喜怒无常"><a href="#四-今日死神喜怒无常" class="headerlink" title="四.今日死神喜怒无常"></a>四.今日死神喜怒无常</h1><p>我们常说“时间长河”“历史长河”，这就是说我们把流逝的时间必作永不停息的河流。<br>无论从语法还是逻辑上进行分析，这些话都没有任何问题，甚至被称为“真理”也不为过。<br>但关于时间，我更喜欢王小波先生的比喻，他把人的不同生命阶段都对应闹钟的不同时刻。有人的闹钟停在上午10点，有人的闹钟停在下午2点。要是把所有人的闹钟都摆在一起，有的已经停了有的还再走，它们停的时间不尽相同。那或许是一件很奇妙的事。这样一形容发现自己是真羡慕卖闹钟的人，说不定时间之神就隐藏在他们之中。<br>对于讲故事的人来说，时间更像是闹钟而不是不舍昼夜的河流。自然而然，讲故事的人就是钟表匠，这就意味着只要愿意，他可以随意改变故事的顺序，“前进”“倒退”“×1”“×2”“×0.5”“停”……似乎全世界都被玩弄于自己的股掌之中，可实际上哪里也去不了，不变的唯有不舍昼夜的时间……<br>现在就让我们来试试这个戏法，让我们静悄悄地拨动时针、分针，可千万不要让零他们发现，然后我们就来到了这天的早些时候。</p><hr><p>刺杀吉他手，这是28的第29个任务。28是组织里年轻一代的天才、领军人物，因为他是同辈中完成28个任务最快的，当然也是完成任务最完美的。他被誉为“最有潜力获得个性化称号的成员”。无论别人怎么称赞，28都知道不管是最快最完美地完成28个任务还是50个任务，自己都得不到个性化称号，不过是28和50的区别罢了。“最有潜力”不等于“一定”，28知道组织从不在意过程——只要你有个性化称号，你就会收到他们羡慕嫉妒的眼光，哪怕你已经七老八十了。<br>要想平安地完成任务，再怎么小心都不为过，这就是说28并不满足于任务上的简单描述。只有新手菜鸟才会根据人物的描述制定计划，要将执行任务时的变数减到最小，就要收集最全面最详细的资料材料。<br>所以此时28正待在屋里等待吉他手的到来。这是翻山到镇上的路上的唯一可以休息的地方。至于吉他手是否会选择休息，28并不担心，不论是天气预报还是28的经验，在两个小时内一定会有一场暴风雪到来。而这里，是唯一可以落脚的地方。28透过窗户看着屋外银装素裹的世界。洁白的世界，可惜即将流血。现在一切都在掌握中，只等吉他手的到来。这个任务的唯一变数是吉他手为什么要来这里，不论是28个人的圈子还是依靠组织的人脉渠道都搞不清楚吉他手的目的来意。<br>现在这种情况只有两种可能：一是吉他手今天要做的事保密程度很高，也意味着意料之外的变故会很多；二是吉他手今天的行动单纯是心血来潮，这也不见得是一件好事，对于杀手而言，心血来潮是最要不得的，因为这就是说你必须把接下来的一切都推向命运之神的赌桌上。“买定离手。”<br>28在脑海里一遍遍过着自己的计划，又在一边思考着未知的信息可能会引起的变故，他用左手大拇指轻揉自己的太阳穴，调整自己的呼吸——无论如何，箭在弦上，不得不发。<br>28不清楚自己站在窗前站了多久，尽管耐力是他们这些职业杀手掌握的第一项技能，但此时28也开始怀疑吉他手的决定是心血来潮——乘兴而来，败兴而归。或许组织的消息有误也说不定。<br>突然，28看到远处有三个小黑点。三个人？果然还是有意外。不过28并不着急，他早已做好无法一击必杀的准备。自己可以躲到地窖里静待时机。但28并不着急躲进地窖，他在等三人进一步靠近，他至少要知道三人中谁是吉他手。难道这是另一批人？不过没有人能够回答28。看着三人已然走到屋前，28只能先无奈地躲进地窖。<br>屋子的门被推开，随着三人的进入，夹带着水汽的风也灌了进来。这是三个牛仔打扮的人。为了方便叙述，我称他们为“倒吊人”“暴徒”和“牛仔”。<br>“这天是真他妈冷！不过这倒让我想到小时候被一条狗追到树上的事。我都不知道自己是怎么爬上去的，下来还是顺着自己撒的尿冻成的冰柱滑下来的。”倒吊人边搓手取暖边说道。<br>牛仔摘下自己的手套，“我敢保证，今天比你小时候经历的冬天还要冷。说白了，全球变暖不过是那些政客为抬高油价编出来的谎话。我敢保证你到南极一看，那里的冰盖肯定比以前大得多。准有半个地球那么大。”<br>暴徒抖了抖帽子上的雪，“我看这天还是那么敞亮，看这样子等下不一定会下雪。到时候他们不来怎么办？”<br>“你就放一百个心吧，只管把你的心吃到肚子里好了，”倒吊人笑了笑，“两个小时里一定会有场大雪。别看现在是艳阳天，天气就像婊子对你的态度，给钱就有阳光，事后却立马翻脸。与其纠结之后是否下雪，倒不如赶紧做好准备，省得以后手忙脚乱。你（他用手指了指暴徒）按计划去泡咖啡，你在窗边坐好，别忘了枪。记住，我们必须保持距离，可不能让他们看出我们之间相互认识。”<br>他们？28轻轻按了按双眼，还有另一伙人，看来情况变得复杂起来了。计划赶不上变化。现在只能见机行事。28这样想着缓慢低下头，现在没必要一直抬头盯着他们。现在动手自己根本没有胜算，更何况还有另一伙人。更重要的是吉他手还没有出现，他是跟着另一伙人还是改变计划不来了？28根本不清楚事情接下来会怎么发展。既然如此只能走一步看一步了。过多的假设没有意义。这样想着28盘腿坐下开始擦拭自己的枪。对于杀手而言，他们可以信任的只有自己手里的枪。对28来说，枪更是力量的延伸。<br>28就这样擦着枪静静等待，直到上方一片寂静，直到有人推门而入，他才停止擦枪站起身来回踱步。28知道这幕戏的高潮即将上演。他现在必须来回踱步保持温暖好让自己能够打出绝杀的一枪。他必须活到这幕戏的最终章，这也是他获得个性称号的必经之路，不是最重要的一环，但却是必不可少的一步。<br>门被推开，正义和红脸女子（当然此时她的脸上没有血迹）并排走进来。站在柜台后面的倒吊人一脸惊讶的说：“老兄，干嘛要把双手拷在一起的？这对女士来说可不是什么绅士行为。”<br>正义哈哈大笑：“她？绅士？哈哈，我从不以绅士自诩，我不愿被这些条条框框所束缚。至于这位女士，获得你同情的臭婊子，她，……（正义说出她的名字），可值10万元。如果不把她铐住，我就要曝尸荒野喽！你听说过她吗？”<br>倒吊人摇摇头：“我没听说过她。不过我很好奇你为什么不直接杀了她呢？据我所知，赏金超过5万的人可都是生死不论的。”<br>正义拉着红脸女子坐到柜台前面：“我准备把她送到镇上，直接杀了她未免太便宜她了，只有绞刑才可以洗清她的罪恶。”<br>“啊哈，这可真是有缘。自我介绍一下，我是镇上新来的绞刑官。”<br>正义看着倒吊人伸出的手，没有动作也没有说话，只是挑了挑眉。倒吊人也不尴尬，收回自己的手，好像刚才什么都没发生过一样。他掏出自己的名片：“这是我的名片。”<br>“先生，你知道什么是正义吗？正义就是我在法官面前执行绞刑，但如果，我是说如果我在这里对她实行绞刑，哪怕你们都拍手称快，我做的都是非正义的。当然，这很好理解，特别是对您这种先生来说。但您肯定不知道，正义是我执行绞刑时无人问津，非正义却是我执行私刑时他们说大快人心。”<br>正义并没有就“正义”和倒吊人讨论什么，也没有接过他手上的名片，只是让它在空中呆呆地浮着。他转向另一面：“那两个人是干什么的？”<br>“不知道，我来的时候他们就已经在了。”说着倒吊人用手指了指坐在窗边的牛仔，“他似乎是个牛仔。我就知道这么多。要不你去问问？”<br>正义点点头，拽着红脸女子走到牛仔的旁边。“你在写什么？”<br>“日记。”<br>“日记？这么文艺的吗？刚才那人可说你是位牛仔啊！”<br>“你似乎对牛仔有什么偏见。哦，当然，其实我也没见过除我之外写日记的牛仔，我想我可能是第一位写作的牛仔，不过凡事都有第一个嘛。不过你要是知道我从小就梦想成为作家你就不会觉得有什么奇怪了。不是我自夸，我的文章以前还登上过报纸呢！那报纸叫什么来着，就是镇上最有名的那个，叫什么我倒是有些记不得了，你知道吗？”说着牛仔不着痕迹地合上了自己的日记本。<br>“那为什么最后会成为牛仔？”正义根本没打算回答牛仔的问题。<br>“生活所迫。靠写文章有养活不了自己，除非你是知名作家。不过可以的话我不会放弃写作，万一一炮而红呢？你呢？你又为什么成为赏金猎人？为了钱？可别告诉我你这么做是为了维护正义。”<br>“也不是没有这种可能。你写的是今天的日记吗？里面会出现我吗？你又为什么来这里？”说着正义便去翻看牛仔的日记。<br>牛仔单手死死按住日记本。“日记这么私人的东西，没有经过本人的同意，最好还是不要随便翻看。”<br>看着牛仔抿成一条线的嘴唇，正义读出了警告的意思。“说得有道理。我也一样，最讨厌别人随便动我的东西，特别是当那东西价值十万元时。”<br>“我什么时候成为你的物品的？你可太自作多情了。”女子讥笑道。<br>正义没有说话，只是抬起和红脸女子铐在一起的手往红脸女子鼻梁上来了一拳。“哦？那你告诉我现在被我抓住的人是谁？如果我是你我就老老实实地闭嘴，这样你或许还能平安地到达镇子。其实我根本不介意一枪打死你。”<br>“大作家，你还是继续写你的日记好了。希望你可以把我写的高大勇猛一些。”说着正义又来到了暴徒身边，“你这是在干嘛？”<br>“你看不到吗？”暴徒头也不抬，“在给鸡拔毛，不然你打算吃什么？出门吃雪吗？”<br>“这锅里的是什么？”正义说着伸手去掀锅盖，“嗯——，真香！”<br>“土豆泥。”<br>门又给人用背撞开。“我说老兄，你这可不厚道。自己待在屋里取暖，叫我们把马车停在马棚里。这天气可是要把人冻成冰雕啊！”推门而入的是黑人老兄和白人警官。<br>“唔——，”白人警官赶紧跑到壁炉前，“还是屋子里暖和啊！”<br>此时正义已端着一杯咖啡拽着红脸女子坐在了用餐的长桌前，吹了吹滚烫的咖啡，“呋——，这又有什么办法呢？受点罪就全当是搭顺风车的费用好了。”<br>黑人老兄坐在屋子中央的沙发上，翘着二郎腿：“这三位是？”<br>“柜台后面的是镇上新来的绞刑官，在那里写日记的是牛仔。至于这位正在做晚饭的是……”<br>“牛仔？”黑人老兄换成右脚架在左腿上，对正义挑挑眉。<br>正义放下喝了一口的咖啡，站起身，对倒吊人说：“先生，这位（他指着蹲在壁炉边烤火的白人警官）可是镇上新来的警长，你认识他吗？”<br>“不认识。”倒吊人摇摇头，“我还没有到镇上见过我的同僚们呢！今天是我任职的第一天。”<br>正义没说什么，又转过去问白人警官：“那你认识这位绞刑官吗？”<br>此时白人警官已经站起身坐到黑人老兄对面的沙发上，“不认识。今天是我到镇上的第一天。这是我的任职文书……”<br>“先生们！这可真是有趣，第一次来到镇上的警官和绞刑官。没有警徽的警长，只有名片的绞刑官。不得不说咱们还真是有缘，你说我要不要相信？”<br>正义说话的时候已经移动到牛仔的身边，此时他的枪口正抵着牛仔的脑门，“把枪给我。没别的的意思，毕竟我这里可有一位价值10万元的人。别担心，等暴风雪一过枪就还给你。”<br>牛仔盯着正义看了好一会儿才开口，好像在看等待擦拭的皮鞋，“我的经验告诉我除了自己我能相信的只有枪，而不是你的保证……”<br>牛仔话还没说完，黑人老兄已经站到他的身后用刀抵住牛仔的脖子，“你的经验难道没告诉你识时务者为俊杰吗？”<br>“好吧，好吧。”牛仔把手伸向腰间，用大拇指和食指提出手枪。<br>“扔到外面去。”正义说道。<br>当牛仔把枪扔出去后，正义示意红脸女子拿过牛仔手里的日记。正义在翻看日记时，黑人老兄像想起什么似的，问道：“你只带了一把枪？”<br>“是的。”<br>“那么今天的经验就会告诉你出门最好带两把枪，甚至有必要带三把枪。当然对我们这种老手来说，带多少把枪都一样。”<br>正义把日记扔回到桌上，重新用枪抵住牛仔的脑门，“我很好奇你为什么来这里。”<br>“我回老家看我老妈，她住在山的那边。”<br>正义和黑人老兄对视一眼仿佛在说对方没什么问题。<br>“好吧，”正义把枪重新塞回腰间，“防人之心不可无。我走的时候会把枪还给你，我是说如果到时候我找得到枪的话。”<br>正义和黑人老兄重新回到自己的座位上。无言的沉默充满整间屋子。倒吊人清了清喉咙，“看这样子离鸡肉炖熟还有好长一段时间，此时的沉默总是让人心神不宁。我看这里有一把破吉他，不如我为大家弹上一曲活跃活跃气氛？”<br>“我也想弹。”红脸女子嘟囔道。<br>“要不我弹你唱？别不好意思，我的歌喉可谓是南辕北辙，如果你愿意献上一曲那是最好不过的。先生这样有什么问题吗？”<br>“好吧，”正义略微想了想，然后转向红脸女子，“你最好别耍什么小聪明，我手里的枪可不长眼睛。”<br>倒吊人取下挂在墙上的吉他，轻轻一拨。听到吉他发出低沉的音色，他才满意地点点头开始弹奏。</p><p><strong>“我有一支笔，还有一张纸<br>想要给你写信，却不知如何寄往你心里<br>我明白信会被退回<br>查无此人，地址不详<br>今晚没有星，只有暴风雪<br>想要给你写信，但无论如何也开不了口<br>假如让我讲下去<br>我在大笑，你就死去”</strong></p><p>正义听到这里又往红脸女子的面门来了一拳：“我想我已经说的很清楚了，如果你不摆正你的位置，我不介意……哇——”正义的话还没有说完，就感到胃里一阵恶心，张嘴吐了女子一脸血。满屋都是血腥味。<br>“这……”正义指着红脸女子又吐了一口血。<br>“哈哈，我在大笑，你就死去。我在大笑，你就死去……”红脸女子一脸狰狞地重复着那句歌词。她用手随意抹了抹脸，甚至还舔了几口脸上的血。“我在大笑，你就死去。我在大笑，你就死去……”<br>“砰——”一声枪响。黑人老兄的声音也随之响起：“真是不好意思，打扰到你的演唱了。不过呢，我还是希望几位冷静一下。我看他也已经死透了，警长你过去把他的枪收一下，嗯，应该有4把枪，有两把是我的。至于你，十万元小姐，我劝你把自己的小心思收一收，我的胆子很小，要是一不小心开枪把你打死了，你之前所做的一切努力可就全白费了。”<br>警长拿起正义身上的4把枪，“你就这么相信我？不怕我先朝你开枪？”<br>“我的经验告诉我出门最少要带三把枪。至于你会不会对我开枪，恕我直言，我想剩下的这几位可比我危险多了。好了，你自己留下一把枪，剩下的都扔出去让它们和大自然为伴吧。”<br>在警长按黑人老兄的话做完这些后，黑人老兄站起身来朝天开了一枪，“好了，三位，请你们站起来，手举过头顶。对，就这样，没错，然后慢慢地走到墙边背对着我。”<br>“很好。其实我也不想这么做，我们本来也没有什么矛盾，我想你们中有人是来救这位十万元小姐的。哦，当然也有可能你们都是来救她的。救人？没问题啊。你们爱救谁就救谁，悉听尊便，但是你们不该把这家伙杀了的，既然你们可以杀他，那为什么不可以杀我们呢？警长，告诉我，如果死神对你说你原本是今天死的，但因为他今天心情好准备发发善心让你明天再死，你会怎么做？或者说你会相信他吗？”<br>“说实话，我不知道我会不会相信，但不管他说的再怎么好听，我肯定先开枪把他打死。”警长双手持枪，转过头回答了黑人老兄的问题又赶紧转回来。生怕这几人暴起反抗。<br>黑人老兄重新坐到椅子上：“很好。我想你们已经听到我们的答案了。我这人是很善良的，我自然愿意相信你们都是好人，我是说下毒的那位除外。我想我已经把话说的很明白了，我现在只想杀那个下毒的。但等下我怎么想就说不清了，你们最好是谁下的毒，不然……”<br>黑人老兄停顿了几秒观察三人的反应。三人一点动静都没有，一幅事不关己的表情。“好吧好吧，看这样子下毒的那位杂种还抱有侥幸的心理。没关系，不过我想你毒死他是为了救这位十万元小姐的吧。很好，没关系，我看你现在还怎么装。我数三下，一，二……”<br>“你赢了。”暴徒一脸无奈地转过身来，“先别开枪，有话好好说……”<br>黑人老兄压根就不相信暴徒的话，直接往他的面门连开三枪，顿时暴徒的头就像开了瓤的西瓜。<br>在地窖里关注事情走向的28意识到这是一个让局势变得更复加混乱的最好时机——只有无止境的混乱才可以增加完成任务的希望和机会。<br>这样想着，28将枪口对准黑人老兄的裆部。<br>“唔——”黑人老兄捂着裆部，钻心的疼痛让他不住地在地上打滚。<br>白人警官一脸难以置信地看着黑人警官，这时候倒吊人迅速从腰间拔出枪往警长大腿开了一枪。警长吃痛随手往倒吊人身上甩了几枪。28抱着看热闹不嫌事大的心理又试着朝屋子里开一枪。不过这次运气却没有这么好。没有命中目标。但这一枪让双方突然意识到了什么，很默契地停止开火。牛仔不着痕迹地放下即将抽出枪的手。<br>倒吊人捂着腹部的伤口，开口道：“看样子这里混进来了一只婊子养的老鼠，我有个建议，不如我们先放下各自的成见，先解决这只老鼠再好好聊聊我们之间的问题，怎么样？”<br>此时零被28的枪声惊醒，为了解情况而走出地窖……<br>剩下的事你已经知道了，现在让我们再一次轻巧地拨动闹钟的时钟和分钟，让时间来到警长追着零进入地窖的时候。<br>因为牛仔被28一枪爆菊，倒吊人不得不趁乱开枪试着解决黑人老兄和白人警官两人。结果是当白人警官进入地窖后屋子里只剩下红脸女子和捂裆的黑人老兄了。<br>黑人老兄勉强地在床上支起身体，用枪指着红脸女子：“没想到你这十万元小姐的吸引力还蛮大的，前后为你而来的就有三拨人。说实话，其实我挺看不起这家伙的，明明你们这些通缉犯只是生死不论的猎物，可这家伙偏偏自明清高每次到要把对方活着带到镇里接受什么正义的审判。可笑，谁在意这东西，有钱不就好了，结果自己就因为这虚无缥缈的正义而死。依我看这家伙根本就不在意正义是否得以伸张，他想听的不过是法官的称赞和表扬。但就算如此，我也不认为他应该死在你们这些亡命之徒的手上。我跟他不一样，我不在意正义是否得到伸张，所以下地狱后你还是好好求求死神让你下辈子别再值这么多钱了。祝你好运！”<br>出乎黑人老兄意料的是，随着扳机的扣动他并没有听到枪声。他的笑容像是面具凝固在脸上。该死，早知道没子弹我就等到警长上来了再杀她。<br>红脸女子愣了一下，“哈哈。今天我会大笑，你就死去。我会大笑，你就死去。”她一边这样唱着，一边拖着正义笨重的尸体向壁炉旁边的斧头移动。<br>“嘿！嘿！……”黑人老兄试图叫住红脸女子。他当然知道对方不可能听自己的话停下，而且就算她停下自己也不知道说些什么来拖延时间。刚才她的小命还握在我的手上，现在我却成了她砧板上的鱼。真他妈讽刺啊！<br>这样想着黑人老兄便听天由命地躺在床上。现在自己只能寄希望于白人警官。希望他能快点解决那个操蛋杀手返回。<br>他可以清楚的听到红脸女子举着斧头一次一次砍着正义的手臂的声音。每听到一声剁肉的声音，他就忍不住颤抖一下，仿佛她砍的不是手，而是他的心。<br>突然他发现自己只听到“硁硁”的脚步声。果然还是来不及了吗？<br>随着红脸女子的脚步声的靠近，黑人老兄反倒放松下来——事到如今慌张也无济于事，倒不如走得安详。<br>斧刃在黑人老兄的眼中越来越大，很快就替代了全世界。就在这时他突然想到自己捂裆的姿势不太雅观，可一切都已经来不及了……</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(4)——吉他手</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-4/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-4/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="三．吉他手"><a href="#三．吉他手" class="headerlink" title="三．吉他手"></a>三．吉他手</h1><p>零也学着28的样子把耳朵贴在地窖的木门上，可他什么也听不到，明明刚才还听到了<br>尖锐的笑声。他很想问问28他听到了什么，但想到刚才28对自己说的话，好吧，还是少说话为好，万一他往我的裆部甩一枪……<br>就这样贴着木板门站了很久，久得让零都怀疑再保持这样的姿势自己就要落枕了。站到落枕，这几个字连起来我怎么就听不懂了呢？零已经无聊到自我吐槽了。<br>不知道28听到了什么，反正他猛地推开了地窖的木门，由于零紧贴着门，28这一下让零一下扑了个空，幸好零身体素质还不错，他并没有摔倒只是一个踉跄。等到零稳住身体时，28已经连开两枪。零看到的就是红脸女子倒在黑人老兄的怀里，黑人老兄左手捂裆但头却已经滚到地上了。血像打翻的油漆染红了整块床单。不知道的人可能还以为这会是一对被厉鬼索命的小情侣吧……不得不说零的想象力确实丰富。<br>28并不知道零此时在想什么，他只是一言不发地捡起滚到地上的脑袋。如果现在黑人老兄的脑袋来一句“你这该死的操蛋杀手”就有趣了；零恶趣味地想着，或许28亲黑人老兄一口也行……<br>28自然不会亲黑人老兄的脑袋，他一手提着脑袋，一边用手将他的眼睛合上，像抚摸情人的手一样，郑重其事地低吟一句：“人死身灭，精神永存。”<br>在28做这些事的时候，零不知何时也来到了床边，他将红脸女子的眼睛合上：“今夜死神喜怒无常。”<br>听到零的话，28诧异地看了他一眼，“这不符合规定。”<br>“又无所谓，”零耸耸肩，“每次都说这句话就不会厌烦的？变变花样又没关系。他又不会说话，没有人会知道的。”<br>说着零从28手中拿过脑袋，“你说是吧，黑人老兄？”然后他又用黑人老兄的口吻回应自己：“虽然你是该死的操蛋杀手，但我也不得不承认你说得有道理。”<br>28有些无奈地叹了口气：“这不仅是程序的一部分，也不仅是对死者的尊重，更是我们杀手应有的觉悟——‘人死身灭，精神永存’。不管怎样，还是遵守为好。”<br>“好了好了，”零不耐烦地应道。跟老师一样，老顽固，零在心里补充道。“这些尸体怎么办？我们是先回镇上还是……”<br>“现在还是在下暴风雪，”28看了眼窗外，零也顺着他的视线望去，漆黑一片，好像两人被丢到了宇宙深处。真不知道28是怎么确定外面在下雪的，“镇子现在是回不去了，看样子得在这里呆一晚，不知道明早雪会不会停。哎，我们还是先把尸体搬到地窖里好了。”<br>在把尸体一步步搬进地窖的过程中，零突然想到了什么：“28你怎么会在这里的？”<br>“我的任务是刺杀吉他手。不过结果你现在也知道了，吉他手的脑袋都给这位赏金猎人一枪打的稀碎。12万就这样没了。”<br>确实是这么一回事，脑袋都叫人打烂了自然就无从辨认身份，没有身份任务就不叫完成。可怜的28。等等，好像我的任务是保护吉他手吧。要是他没有死……光是这么想想，零就觉得下体一寒。<br>“那你知道我的任务是寻找护送吉他手吗？”<br>“知道。”<br>“如果他没死你会怎么做？”<br>“杀手不做假设，假设没有意义。对于杀手来说，做假设的时候就是面对死亡回顾一生的时候。这可是组织的教义，木匠前辈不可能没告诉过你。”<br>一个个怎么都把组织的话当做真理，组织实际上是传销组织吧！他们放的屁都是香的。“假设没意义，这我当然知道。可我也记得，杀手从不打无准备之仗。你也肯定有一个周全的计划吧！如果我和你见面的时候吉他手还活着你会怎么做？”<br>“我会劝你放弃任务，然后作为补偿帮你完成下一个任务。”<br>“如果我不听劝怎么办？你也一定考虑过这种情况吧！”<br>“那我就只好让我的抢跟你好好交流交流了。”<br>是和我的裆部来一个好好交流吧！零腹诽了一句。<br>当零试着搬动黑人老兄的尸体时，他听到“砰”的一声，吓得一哆嗦，赶紧跳开，“不是吧，我不过是没按规矩说‘人死身灭，精神永存’，这他妈就诈尸了？28，怎么办？你可要救我啊！”<br>听到零颤抖的求救声，28扶额试着保持冷静，他怕自己会忍不住朝零开枪。28深吸一口：“不是诈尸，是有人敲门。”<br>“不是诈尸就行，吓死我了……不对啊，敲门？不是暴风雪吗，怎么现在还有人经过？”<br>“不清楚。”<br>“那现在怎么办？”<br>“剩下的两具尸体先别管。你先去开门，我在门后面盯着。”<br>零没说话，这确实是现在最好的办法了。他在门前站定，见28轻微地点点头，深吸一口气，把门打开。<br>对方是一位蓝眼白人小哥，“这雪实在是太大了，可不可以让我进来暖暖身子？”<br>零不着痕迹地看了看28，看到28同意后，点点头：“那就进来吧。”<br>“谢谢，您可真是位好人，在全球变暖的今天，不知道这场雪……”白人小哥的话戛然而止，因为他此时已经看到了原本被零挡住的两具尸体。<br>关于黑人老兄的尸体大家都知道，我就不描述了。另一具是那位身上没有伤口却倒在血泊中的老兄。要说明的是此时他原本和红脸女子拷在一起的手已经被砍下来了，这也可以解释红脸女子是怎样来到黑人老兄的身边的用斧头把他的脑袋砍下来的。<br>与此同时，白人小哥感觉自己脑后一凉，28正用枪顶着他的后脑勺。“双手举高，慢慢转过来。零，去把门关上，我都快冻成企鹅了。”<br>白人小哥在28的示意下坐到沙发上，28坐在他对面，黑洞洞的枪口指着白人小哥的，额，他的裆部。<br>“现在，我问你答。手举高，我可没叫你把手放下。”<br>零好不容易才把门关上，“这风可真是大，感觉一不小心就要给吹走了。”<br>“是啊，风是真大。那么你是怎么找到这里的，小子？暴风雪这样大，你孤身一人在山里乱走，这件事不管怎么看都非比寻常啊。嗯？解释一下。”说着28晃了晃手枪。<br>“我迷路了。像您说的那样，雪这么大，反正我待在外面迟早给冻死，既然如此我想就碰碰运气随便走走。这一定是主的旨意。我向主发誓我没有说谎。一定是主听到了我的祷告。”<br>“我说了，手——举——高！”<br>“啊，我只是……”<br>“主是谁，你觉得我们信仰他吗？”28粗暴地打断对方的话，“如果主真得存在的话，我们这种人早就下地狱了！”<br>“不。主会原谅你的。”他的手动了动，似乎想在胸前画一个十字，很快他又想到了28的话，刚放下的手就这样停在了半空。<br>“名字。”<br>白人小哥说出了自己的名字。<br>零听到这个名字，心里一紧，难怪我觉得这小子长得这么熟悉，“你，是吉他手？”<br>白人小哥一惊，“对，我是吉他手。”然后他像想起来什么，像溺水者看见稻草一样露出灿烂的笑容，“我知道了，你一定是那个护送我的人吧。他一定是你的同伴吧。你赶紧跟他说说，我真的是迷路啊，绝对没有恶意。我可以向主发誓。我只想安全地度过今晚。”<br>“28，你看……”<br>你还是太天真了，别人一句话就把你晃过去了，零。你该使用祈使句，比如说“你会弹吉他吗？我看你手上有弹吉他弹出来的老茧，这里有把吉他，你可不可以弹弹看。”你直接说“你是吉他手”，还带有疑惑惊奇的语气，那么这样他难道还猜不出你和吉他手有什么关系？他就肯定会打蛇上棍。对方如果是赏金猎人或是杀手，就一定会调查到你在这，至于吉他手的信息也只不过是随手就能弄到的。反正你又不认识吉他手，就是假扮他你也认不出来。<br>“好吧，”28开口说道，“看来这是个误会。没想到我们的任务会因为名字闹乌龙，也幸好那位吉他手已经死了，不然还不知道会发生什么。你说是吧，零？”28站起身来继续搬尸体。<br>“要帮忙吗？”零说道。<br>“枪在身上吧！你继续盯着他，如果他有什么异常举动，别管，直接开枪。如果真出现这种情况，就当做任务失败好了，下个任务我帮你完成。”<br>看着28拖着无头的黑人老兄的尸体消失在地窖里，吉他手开口问道：“这里到底发生了什么？上帝啊。愿主保佑你们。”<br>“如果上帝真是仁慈的话，就不会有死人了。而你，也就不会因为暴风雪被困在这里了。就像那个谁可以分开红海一样，你说不定也可以在主他老人家的光辉指引下直接穿过这暴风雪了！怎么，要不要试试？”<br>“不，这些都是上帝对我们的考验，他是指引者，并非保护神。‘上帝永永远远为我们的上帝，他必作我们引路的，直到死时’，‘你的话是我脚前的灯，是我路上的光’，阿门。对于你们的渎神之语，主会原谅的。”<br>你的信仰可真是坚定啊！上帝指引你吞粪你也吃吗？不过话说回来，如果你信仰的是组织的话，那你和28一定会有很多共同语言。<br>零突然想到了什么，开口说道：“知道赏金猎人和杀手吧？”看到吉他手给出肯定的答案，零继续说道：“喏，刚才那个被拖进地窖的无头的黑人老兄就是一位杀手，至于这位倒在血泊里的像条死狗的老兄则是一位赏金猎人。你也知道做我们这行的，名字是很私人的东西，就算他们已经死了，我也不能随便透露他们的信息。你只要知道他们有不可和解的私人恩怨就行。<br>“干我们这行的争斗也分为武斗和文斗。顾名思义，武斗自然就是要分出个你死我活；文斗则不然，文斗方式多种多样，一般由争斗双方共同决定选择什么方式进行争斗。文斗也并不像武斗那样一定要分一个你死我活。今天他们选择的就是文斗。当然现在是什么情况你也看到了，这就是说这中间出了点意外。其实准确的说文斗也有一定的生命危险。<br>“他们选择的文斗方式，嗯，是对对子。对对子知道的吧？那就行，因为这件事是黑人老兄首先提出的，所以就由血泊里的这位率先出对。血泊里的老兄出的是：莺莺燕燕翠翠红红处处融融洽洽。黑人老兄回的是：雨雨风风花花时时年年暮暮朝朝；血泊里的老兄一看这也难不倒黑人老兄，于是又出：我上等威风，显现一身虎胆。黑人老兄哈哈一笑，说你真的要我对？然后没等对方回答，黑人老兄就回道：你下流贱格，露出半个龟头。<br>“这两个对子一对，出对子的老兄突然就开始吐血，像广场上的喷泉一样。黑人老兄一看这个跟自己有深仇大恨的家伙竟然吐血三升而亡，便高兴的不能自已。这时候他看到那家伙左手铐这一副手铐，笑着说‘你平常自诩是正义的化身，结果却因为本为消遣作乐的对对子吐血而亡，正义在惩戒恶人时得以实现，可娱乐的对对子却不认这个账。’然后他拿起斧子把对方的左手齐肘砍下。最后他又因为狂喜用斧头把自己的头砍了下来……”<br>“上帝啊！”吉他手在胸前花画了一个十字“‘说谎的嘴，为耶和华所憎恶；行事诚实的，为他所喜悦’，愿主原谅这个根据《唐伯虎点秋香》随口改编的故事。”<br>“切——”零感觉自己被耍了，但对方又是那么一本正经地说话，要么是他不懂我的幽默，要么是他在讽刺我，“真没意思，早就知道了怎么不揭穿我？浪费我口水。”<br>零说着走向桌子为自己倒了杯咖啡。<br>“‘你们不要论断人，就不被论断；你们不要定人的罪，就不被定罪。你们要饶恕人，就必被饶恕。’这都是主的教诲。”<br>行，你这主的脑残粉。话说上帝讲这些话就是为了打人脸看别人笑话的吧！这样看来他也是挺有趣的，就是教徒太迂腐了。零端起杯子正准备喝咖啡。“如果我是你，我就不会喝咖啡。”28不知道何时从地窖钻了出来，“除非你想象他一样吐血而亡。”<br>“有毒？我靠，真狠啊，这些人。”零吓得赶紧把咖啡倒掉。<br>“好了。看样子这雪今晚不会停了。这样吧，零睡床上，吉他手就睡在你现在坐的单人沙发上。至于我，就坐在这把木椅上。这样一来，大家就都保持着一定的距离，有什么问题吗？”<br>“那现在我的手就不用一直举在空中了吧？”28一出现，吉他手就把手举过头顶，他是真的怕这位酷似阿凡达的杀手一不开心就开枪把自己打死。<br>“可以。”<br>“他的尸体就这样放在这里，不碍事？”零指了指血泊里的尸体。<br>“嗯，他躺在这里也不碍事，就先这样好了。再说他和地窖里的那些人不一样。他代表的是正义，至少他在做自己内心认为是正义的事。”<br>你该不会听到了那个我根据《唐伯虎点秋香》胡诌的故事吧？零笑了笑，“就是不知道他会不会对对子。”<br>“对对子？这跟对对子又有什么关系？”28一脸疑惑。<br>“额，就当我什么都没讲。只是无伤大雅的玩笑。”看来我有些高估28的幽默指数了。<br>“对了，灯别关。”<br>不知道是经历了这样多刺激的事还是怎样，零一躺在这张满是血的床上，意识就开始驶入黑暗，他最后看到的画面是28在桌上支起两支枪，黑洞洞的枪口对着他和吉他手的裆部。<br>此时闪过零脑海里的想法只有一个：你只能相信自己和自己手里的枪。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(3)——名字的故事（一）</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-3/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-3/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="二．名字的故事（一）"><a href="#二．名字的故事（一）" class="headerlink" title="二．名字的故事（一）"></a>二．名字的故事（一）</h1><p>　　零和28自然都不是他们的真名，不过这也不是他们的外号。一说到外星人，球迷就想到罗纳尔多，这个才是外号。很显然，除了认识28的人，没有人会把28这个数字和这位全身蓝色的人联系在一起。<br>　　那么28和零到底代表什么呢？如前所述，零是一位杀手，而且28还提到了“老师”，所以你不难知道零隶属于一个杀手组织。接着，不论出于何种理由，你都会猜测28也是组织中的一员。不管你的理由是什么，我都会恭喜你猜对了。然后，聪明的你会继续猜测28和零是他们在组织中的代号。但这次只猜对了一半，零和28不仅是代号，还是名字。前面也说了这不是真名，这句话的意思就是说在“零”之前，他们的父母一定给他们取过名字。不幸的是，现在谁也不知道他们的真名是什么。因为他们的父母已经给组织灭口了。至于组织的档案记录，说实话，这种私人的无关紧要的事，往往随着一泡屎就不知忘到哪里去了。<br>　　众所周知，名字都是有意义的，比如说，X振华，就饱含了父母希望孩子振兴中华的愿望，而王二狗就是父母希望孩子可以不富有，但要顽强的期望；至于隔壁老王之类的名字，我想不用我解释什么，你也能知道这是对男性尊严的嘲讽……言归正传，我要说的是零和28尽管不是他们的真名，但也是有意义的名字。<br>　　在讲他们名字的意义之前，还有另外一件事要讲。据我所知，数字是人类历史上最伟大的发明，数字的出现，不仅一改之前的清谈营造务实的氛围（多计算，少说话），而且让人们知道该如何量化很多抽象的东西。举例来说，有时候，对作家而言，书籍印刷的数量畅销的程度就是对他们名气甚至是才华的量化；而对普通人而言，年收入的高低更是幸福与否的标准；甚至于连外观也可以量化，比如选美大赛的名次，又或者说是曲线优美的秘书的工资……看到这里你一定就会明白，零和28也是某样东西的量化。是的，零和28是他们能力的量化。与之相同的是用分数量化学生的能力。推理过程如下：“学生能力”由“自控力，本身天赋，努力程度”等因素体现，而“考试分数”则可以体现“自控力”等能力，所以“考试分数”约等于（近似可以决定）学生日后的成就。“零”和“28”也一样，能力的高低体现在完成任务的速度和完成度上，而任务完成的个数大多数时候可以从侧面反映完成任务的速度和完成度。所以“零”和“28”就是他们完成的任务的个数。<br>　　当明白了他们的取名原理后，你就会发现随着这种取名方法的使用，最大的问题是重名的人很多。你能想象在食堂吃饭时，随着自己的一声“零”，瞬间有几百个人同时抬起埋进碗里的头看你的情形？这还不是最可怕的，这不过是使名字和“帅哥”“美女”划上等号。最主要的问题是时间一长人们就会陷入名字的“狼来了”式的圈套。简单说来是这样的，一开始大家都以为别人口中的“零”是自己，但时间一长，大家又都以为别人口中的“零”不是自己，这就是说尽管他们都是零，但当你叫零的时候却没有人会回应你。<br>　　为了解决这个问题，组织的领导试过很多方法，比如说把组织中的人分成若干小组，这样就可以区分他们――第一小组的零，第二小组的零，以此类推。不过这个方法并没有得到推广，因为高层发现如果真要实行这种方法，迟早要把一个人分成一个小组，这不仅麻烦，而且既然是小组，那至少得有两个人。如果一个人一个小组，那“第X小组”就不是名字的前缀，而是名字的一部分了。这是组织不能容忍的――用完成任务的个数命名是自组织成立以来就存在的不成文的规定，即使能变通（比如加前缀），但也不能改变命名方式（一个人是一个小组就不行）。<br>　　据说有位前辈提出用“X-Y”的方式命名，比如说这个人是“零-1”，那位仁兄叫“零-2”。然而他犯了一个显而易见的错误，同样是零，他们的“-Y”是完全不同的，这就是说此时的“-Y”并非是权宜之计，而是带有私人性质的玩意，跟名字没有什么本质区别。你会发现这位前辈犯的错误和之前“第X小组”是一样的，不过恶劣程度确实不同。在高层看来，“第X小组”因为是第一次调整所以有容错空间，但“-Y”在有错误示范的前提下，仍然犯了同样的错误，在领导看来这就是明知故犯，挑战组织的权威。<br>　　组织对明知故犯向来是“零容忍”，但这并不是说组织是残忍的，相反他们是仁慈的民主的，给了他三个选择：一）.吞粪自尽  二）.捶蛋自尽  三）.脚底按摩。同样，这三个选项也是组织自成立起就存在的惩罚犯严重错误的人的。当然这三个选项确实让人摸不着头脑，不过最起码一）和二）好像还可以理解，或许就是字面意思。倒是这“脚底按摩”叫人百思不得其解。不过据说这位前辈最后是从二十层搂高的地方跳下来的，很显然这种死法和“吞粪自尽”“捶蛋自尽”不搭边，也正如福尔摩斯所说的那样“排除一切可能，剩下的无论多么不可能也是真相”，所以我们有理由怀疑“从二十层搂高处跳下”就是“脚底按摩”。至于到底有何因果关系就不得而知了。<br>　　现在的解决方法是把组织内部分成几个区，区又分成几个街道，街道还可以分成几个单元……在这种称呼方法下，前一章出现的零在公共场合就是这样被称呼的――A区东方街道（他家位置在组织总部的东面）53小区（距总部53公里）56单元（自东南到东北按顺时针转动九十度的范围里他是第53个零）的零。这也仅仅是权宜之计，还有很多不完善之处，因为再往下划分单位就注定会出现“室”，但杀手又大多是独身一人，换句话说当划分到“室”的时候，这些前缀就又变成私人的名字的一部分了。现在比较合理的补救方法是当出现“室”的时候该用“XX单元（东西经坐标）XX幢（南北纬坐标）的X”来命名。<br>但这些方法都有一个问题那就是所要记忆的量太大，特别是搬家之后前缀也会随之变化。我们都知道记忆是很耗费时间和精力的事。换句话说，一个在记忆领域有成就的人是很难在别的领域有同样大的成就，。当然不排除例外，但例外就意味着异于常人，至少按照概率学的观点，在一个有上万名成员的组织里不可能人人都是天才。知道了这一点，你就不难理解组织近来落寞的趋势了，他如今似乎有被另一个组织“绝影”压下一头的危机。杀手界的第一把交椅易位似乎已经是不可避免了的。有关“绝影”的事以后再说，还是先说回名字。<br>A区东方街道53小区56单元的零（据我所知，此故事中只有一个零，所以下文提到他时都用“零”代替）是组织中唯一一个可以将前缀划到“室”的人，因为他是组织中唯一一个不是独身一人居住的人，也就是说“室”对零来说是一个范围。除了零，在这个范围里还包括一只短尾猫和一株吊兰。其实上零从来就不想成为杀手，他的梦想是当一位作家。而且零自以为自己有成为作家的才能。就我浅薄的见识而言，作家最重要的天赋就是想象力，换言之，对于作家而言胡思乱想比规规矩矩更好，所以零从来就不是规矩的人。正因如此，零有自己的一套辨认别人的方法。<br>除了想象力，作家还要有卓越的洞察力。零的方法就和观察有关——他用别人身上独一无二的特征作为前缀。比如说，28原先的发型是莫西干，所以零就在心里叫他“莫西干的28”。这只是“零的命名方法”1.0版，还有很多不足——后来28剃了头发成了寸头，但却不能叫他“寸头28”，因为组织里的杀手大多留的是寸头。最后零还是解决了这个问题。于是“零的命名方法”2.0版横空出世，在2.0版本里零对28的称呼就是“蓝色的28”了。再比如说，他把组织中的一个四十七命名为“代号47”，很显然这位“47”是个光头。看到这里你会发现在2.0的版本里前缀并不仅仅是个人特征，有时还与种族特征有关——比如：阿三56（这家伙是印度人），鬼子17（他是日本人），甚至还有甜姐13（这姑娘长得像瑞秋·麦克亚当斯）……有时候你不得不佩服零的像爱因斯坦头发一样发散的联想能力，或许这就是作家必须要有的天赋前提。<br>一开始零还打算将自己这套“命名方法”2.0献给组织，毕竟组织可是发布了价值百万的“命名”悬赏任务的。现在我们都知道零没有将这个方法献给组织，不然他就是壹了。这件事的经过是这样的：在零准备将命名方法2.0献给组织的早上，因为前一天吃了太多黄豆（用他老师的话说那天零吃的黄豆足够让一头水牛把肠子拉出来）而来来回回去了十几趟厕所，不知道是那天第几次坐在坐便器上，零闻着厕所久久不能散去的恶臭，突然灵光一现想到了什么（他想到了什么我不得而知，可以肯定的是，他绝不是在想屎的味道或许还不错），然后低头庄重的看了看自己的下体，又想到了二十层楼的高度，之后他就止不住的连打了十几个寒战，这时候他突然想到自己的命名方式也会陷入“私人性质”的陷阱，而且还不止，最后自己还会被安上种族歧视的帽子，尽管这不是他的本意。然后零又想到既然组织早就发布了悬赏任务，但现在还是没有什么好办法，这就说明实际上组织并不想要有新的命名方法，因为零一个人能想到的，组织也一定能想到。明白了这一点后，零就不再着急了，在坐便器上呆坐了整整一天。也正因为如此，我们现在还能听到零在雪中小屋的故事，不然我要讲的就是“壹的尸体”的故事了。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(2)——雪中小屋</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-2/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-2/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="一-雪中小屋"><a href="#一-雪中小屋" class="headerlink" title="一.雪中小屋"></a>一.雪中小屋</h1><p>　　“砰――”零被枪声惊醒。靠，竟然睡着了！希望一切还来得及。零赶紧起身，向上走去。<br>　　“吱――”，地窖的木板门被零打开，“砰――”，一颗子弹从洞口射下来擦着零的鬓角飞过去。这他妈，形势不容乐观啊。什么狗屎运，我接的是寻人救人的任务吧，这架势比刺杀任务还他妈吓人！<br>　　“嘿，兄弟，有话好好说，这是个误会……”<br>　　“误会？误会个屁！”一个粗犷的声音打断零，“你这狡诈的、阴险的操蛋杀手！”<br>　　杀手？难道身份暴露了？<br>　　“误会，这真是误会，要不这样，你先别开枪，我慢慢走上来，反正我也没有武器。这真是误会。”<br>　　“误会？你这操蛋鬼！不过你要上来也行，我也可以不开枪。那你得先把枪扔上来。”<br>　　“我没枪……”<br>　　“砰――”回答零的是一枚子弹。<br>　　“我真没枪，不骗你。”<br>　　“没枪是吧，那行，你就别上来了。不过这娘们就……我数三下，你不扔枪走上来我就开枪打死她。3，2，……”<br>　　“别开枪――”零从背后掏出枪扔上去。他妈的，这情报有问题，明明说吉他手是金发蓝眼的白人帅哥，怎么就变成一女的？“现在我可以上来了吧！”<br>　　“还有一把枪也扔上来。”<br>　　“这次是真没了。我发誓。”<br>　　“发誓？向谁发誓？犹大吗？13块钱你连节操都可以不要，还差这一次谎言？哦，嘶――，你这该死的操蛋鬼！没枪就给我生一支枪出来，否则别上来！”<br>　　碰上个狠角色。别怕，沉住气。<br>　　“你是来救她的吧。呵呵，3，2……”<br>　　他妈的，我当然是来救她的，可谁知道是从你们这些杀手手里救人。我的任务难道不是把她从暴风雪中救出来，哪是从你们这些亡命之徒手里救人？<br>　　“好吧，你赢了。”零又掏出一把枪扔上去。<br>　　“呵，还是热乎的，放在裆里的吧！希望你那东西有没有被冻坏，不然就一点乐趣也没有了！”<br>　　乐趣？这该不会是同性恋吧！唉，早知道就不争着抢这个任务了。这他妈只是我第一个任务啊！<br>　　“那现在我可以上来了吧。”不管怎样，还是要先摸清楚状况。<br>　　“别急，双手举过头顶，慢慢走上来。”<br>　　零慢慢走出地窖，刚探出头他就看到有两把枪指着自己。这两把枪的主人在他的左手边。一位是黑人，他右手拿枪，但枪口向下斜，对着的目标不是零的脑袋，好像是他的裆部……他左手捂裆，皮裤内侧已经被血染黑了，看到这里零好像能明白前面说的“操蛋杀手”似乎并不仅仅是一句骂人的话。可问题是我好像没开过枪吧……另一位杀手倒是比黑人老兄正常，至少他的枪口对准的是零的脑袋。不过也实在没有正常到哪里去，他并没有站在地上而是站在别人的尸体上。他脚踩在尸体老兄的肩膀上，说实话，零看到这个姿势，感觉杀手2号随时会解开裤子拉链朝尸体的裆部尿上一泡……想到这里零有些分不清是杀手2号给人一种同性恋的感觉还是自己有同性恋的倾向。<br>　　不过零并没有纠结多久，因为那位“捂裆传人”黑人老兄开口了：“你认识他吗？”<br>　　还没等零回答，他身后就传来声音，“我不认识他。”<br>　　零转过身。刚才说话的是坐在地上的红脸女子，她当然不是唱戏的角，脸上自然就是血了。应该不是她的血，最起码零并没有发现她脸上有什么伤口。她的手和谁铐在一起，而那个人正躺在地板上，他的身下是一滩血，同样没有致命伤口。此外还有两个牛仔打扮的人。一人捂着腹部的伤口坐在沙发上，另一个人坐在椅子上面对着那两名杀手，手放在桌下。我敢打包票那家伙手里有枪。<br>　　该死，零转念想到，这哪是普通的寻人救人任务，这明明是帮派火并啊！我这位置可真尴尬，楚河汉界啊……<br>　　“真不认识他？他可是丢了两把枪来救你。”<br>　　还没等那位红脸女子开口，零就先说道：“我不认识她，她也不认识我。我无意陷入这场纠纷，我只是来找吉他手的，看这样子我好像迷路了。”<br>　　“老兄，我觉得他说的好像像那么一回事……”杀手2号说道。<br>　　“闭嘴，警长。这里有吉他手吗？他说找人你就信，我的蛋都给他一枪崩了。”<br>　　“你找吉他手？”一个尖锐的声音响起，是那个红脸女子，“他死了。喏，就是那位白人警长脚下的家伙。你运气不错，他值十二万，而且生死不论。”<br>　　十二万？什么乱七八糟的，这任务不是说把吉他手安全带到镇上才给一万？怎么就生死不论了，这他妈是救人？<br>　　“什么？他就是吉他手？”不过很快黑人老兄就大笑起来，“他值十二万？哈哈，他的头都给我一枪打爆了，谁认得到他？现在这家伙还不如我的屁。”<br>　　“嘶――”或许是笑得太剧烈而牵动伤口，黑人老兄捂裆捂得更紧了。<br>　　红脸女子反唇相讥，“我觉得他至少比你的蛋值钱……”<br>　　“啊――”还没讲完，黑人老兄就朝红脸女子的大腿开了一枪。<br>　　这情况……还是先撤吧。“既然人都死了，那我就先走了。你们慢慢聊，当我没来过。嗯，我肯定是迷路了。”说着零就慢慢往地窖走下去。回答他的是黑人老兄的子弹。“喂，要这么狠吗？差点断子绝孙啊！”零赶紧缩回地窖。<br>　　“嘿！你个操蛋鬼，运气还不错……”<br>　　“砰――”的一声打断了黑人老兄的话，看样子是那位椅子中的牛仔开的枪。不过他也就开了一枪。然后零就听到一声惨叫，接着是黑人老兄的大嗓门：“该死，又是那操蛋的小子。警长，你快去追他，这臭婊子我看着。”<br>　　看这样子，那位椅子中的牛仔也被爆了菊花。等等，该死，这他妈算什么，栽赃嫁祸啊？零赶紧朝地窖深处走去。脚步声在地窖里出人意料的大声，零完全分辨不出白人警官在自己的哪个方向上。“嘿，有话好好说。我的枪都给你们了，怎么可能是我开的枪。再说我也没地方藏枪。”<br>　　“没地方藏枪？小子，这我可不信，你和他们肯定是一伙的。苦肉计演的不错啊，连自己的兄弟都下手。”<br>　　“苦肉计？开什么玩笑，如果我跟他们真是一伙的，我演什么苦肉计，先一枪崩了你的蛋再说……哦，见鬼！”零突然想到了什么，完了，现在跳进黄河也洗不清了。<br>　　“告诉我，小子，你要怎么爆我的蛋？你的子弹要怎样才能穿过那个吉他手的尸体？”<br>　　零意识到白人警官和自己的距离在缩短，他赶紧往后退。突然，零感觉自己撞上了什么坚硬的东西。是墙！完了完了，看样子今天是要交代在这里了。零可以肯定借着从上面地板漏下的光白人警官可以看到他已经被逼到绝境了。等等，既然是警长，说不定可以讲讲道理。<br>　　“我说大兄弟……”<br>　　“砰――”一颗子弹从我脚边擦过，“谁是你兄弟？”<br>　　“额，我是说警长，你看，我也没杀人，至少你没看见过我开枪不是吗？既然这样，能不能先把枪放下，要是不放心把我铐起来也行。”<br>　　“要我放下枪也不是不可以。真的不是你开的枪？”<br>　　“当然不是，警官。我真的只是来找人的，既然那老兄已经死透了，我也没什么理由开枪，你说是吧？要我说，地窖里一定还藏着另一个人，他才是真正的操蛋杀手！”<br>　　“嗯――”借着漏下来的灯光零看见他点了点头。看来有戏。<br>　　“你看，警官，既然误会都解开了，能不能先把枪放下。万一擦枪走火可就不好了。”<br>　　“我怎么这么不相信你呢？”<br>　　你怎么不按套路来呢？不管骗不骗你我这都算是投降了吧，那也该把枪放下了。<br>　　零感觉有些力不从心：“你看，我腰间也没有枪套，怎么可能还有枪？我总不能把枪藏在屁眼里吧！”<br>　　谁知他竟然煞有介事的点了点头，“说的有道理，要不你把裤子脱了，让我检查检查？”<br>　　这是什么话？零看见他似笑非笑的表情，“靠，你玩我……”<br>　　“再见了，希望你下辈子记得在屁眼里藏枪。”<br>　　“砰――”。零能想象子弹从枪膛飞出后，枪口的硝烟缓慢消散的样子。跟烟一样，随着子弹的射出，零的生命走向了总结。<br>　　原来这就是死亡吗？没有一点痛苦。零甚至都感受不到子弹射向哪里，那家伙该不会是一枪把我的脑袋崩得稀巴烂吧！零又想到了先前的吉他手，估计自己现在跟他差不多，脑浆四溅，只有半个脑壳留在自己的尸体旁边，剩下一半早就不知道给崩到哪里去了。<br>　　零隐隐约约听到轻微的脚步声，是橡胶鞋踩过地板的声音，原来鬼走路也有声音。不知道是已经完成从人到鬼的转换，还是别的什么原因，零能听到头顶上传来的女子的尖笑声。这是什么，贞子吗？<br>　　“嘿，你打算抱头缩在墙角待多久啊？”这是一个熟悉的声音。<br>　　“你是哪位？我是新来的，现在还看不见。”<br>　　“闭着眼睛当然看不见了。”<br>　　“哦，原来是这样，”零尴尬地挠挠头。他重新睁开眼，站在他面前的是一个蓝色的轮廓，“28，你怎么也在这里？不是吧，你也死了？我就知道不该接这个任务的。”<br>　　这位被称为“28”，长得酷似阿凡达的蓝皮肤的人嘴角抽了抽（当然，因为光线昏暗的缘故，零并没有看到28的这个动作），用枪指了指旁边的尸体，“喏。”<br>　　零顺着枪口的方向看去，躺在那里的是那我白人警官。看样子刚才开枪的是28。等等，“我说28，之前开枪爆别人菊花的是不是你，你可把我害惨了。”<br>　　“嘘――”28做了一个禁声的手势，并示意零跟上。<br>　　“28，你怎么会在……”零话还没有说完，就被28一把按在墙上。28低声对零说：“多做任务，少说话。你老师没教过你吗？明白了就点头。”随着零的点头，全身蓝色的28才把捂住零的嘴的手拿开。28走到地窖的木板门下方，耳朵紧贴在门上。<br>　　他在等待一个时机。</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逃离数字指南(1)——序</title>
      <link href="/2022/12/06/tao-chi-shu-zi-zhi-nan-1/"/>
      <url>/2022/12/06/tao-chi-shu-zi-zhi-nan-1/</url>
      
        <content type="html"><![CDATA[<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><p>本文开头有借鉴昆汀电影《八恶人》</p><h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><p>  如果有一只猴子和一台打字机，再给它无限的时间，无论它识不识字，会不会打字，它一定可以写出一套《莎士比亚全集》。――这就是著名的“莎士比亚的猴子”。因为在无限的时间面前，排列的概率毫无意义，也无“错误”可言。换言之，面对时间长河，所有的偶然全是必然。<br>　　如果你能赞同这只不停打字的猴子，那么我想要你理解平行世界也不是难事――如果有无限的空间，不停流逝的时间，那么就一定存在另一个被称为“地球”的行星，会有另一个“你”，同样，那些无可奈何的懊恼，追悔莫及的遗憾，在这里或许仍然存在，或许从未发生。知道了这一点，你就不会觉得我讲的故事不可能发生。<br>  请注意，故事中所涉及的名词与你知道的是同一种意思。</p><p>  如今我走到人生十字路口，我知道哪条路是对的，毫无例外，我就知道，但我从不走，为什么？因为他妈的太苦了！——《闻香识女人》</p>]]></content>
      
      
      <categories>
          
          <category> 逃离数字指南 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小说 </tag>
            
            <tag> 逃离数字指南 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于遗传算法解决流水车间调度问题</title>
      <link href="/2022/12/06/ji-yu-jian-dan-yi-chuan-suan-fa-jie-jue-liu-shui-che-jian-diao-du-wen-ti/"/>
      <url>/2022/12/06/ji-yu-jian-dan-yi-chuan-suan-fa-jie-jue-liu-shui-che-jian-diao-du-wen-ti/</url>
      
        <content type="html"><![CDATA[<h1 id="基于简单遗传算法解决流水车间调度问题（FSP）"><a href="#基于简单遗传算法解决流水车间调度问题（FSP）" class="headerlink" title="基于简单遗传算法解决流水车间调度问题（FSP）"></a>基于简单遗传算法解决流水车间调度问题（FSP）</h1><h2 id="流水车间调度问题（FSP）"><a href="#流水车间调度问题（FSP）" class="headerlink" title="流水车间调度问题（FSP）"></a>流水车间调度问题（FSP）</h2><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>n 个工件要在 m 台机器上加工，每个工件需要经过 m 道工序，每道工序要求不同的机器，n 个工件在 m 台机器上的加工顺序相同。工件在机器上的加工时间是给定的，设为<br>$$<br>t_{ij}(i &#x3D; 1….,n; j &#x3D; 1,…,m)<br>$$</p><h3 id="问题的目标"><a href="#问题的目标" class="headerlink" title="问题的目标"></a>问题的目标</h3><p>确定 n 个工件在每台机器上的最优加工顺序，使最大流程时间达到最小。</p><h3 id="假设（约束条件）"><a href="#假设（约束条件）" class="headerlink" title="假设（约束条件）"></a>假设（约束条件）</h3><ul><li>每个工件在机器上的加工顺序是给定的</li><li>每台机器同时只能加工一个工件</li><li>一个工件不能同时在不同的机器上加工 </li><li>工序不能预定</li><li>工序的准备时间与顺序无关，且包含在加工时间中</li><li>工件在每台机器上的加工顺序相同，且是确定的</li></ul><h3 id="问题的数学模型"><a href="#问题的数学模型" class="headerlink" title="问题的数学模型"></a>问题的数学模型</h3><p><img src="https://img-blog.csdnimg.cn/0749f9e13f8047db803fb1897b151a7c.png"></p><h2 id="遗传算法原理"><a href="#遗传算法原理" class="headerlink" title="遗传算法原理"></a>遗传算法原理</h2><h3 id="基因交换、变异"><a href="#基因交换、变异" class="headerlink" title="基因交换、变异"></a>基因交换、变异</h3><p>遗传算法模拟生物学染色体配对过程中基因交换、基因变异对问题进行求解。<br><img src="https://img-blog.csdnimg.cn/50c1f4f26d6146fb9bd07f8351652bea.png"></p><p>在遗传算法中，可以将问题的一个可行解看成一条染色体，染色体在配对时发生基因交换或者发生基因变异生成新的染色体，即新的可行解。</p><p>而新产生的可行解（染色体）参与到下一次基因配对中，产生另一些新的可行解。</p><p>比如对于某一个问题的可行解有【1，2，3，4，5】，【2，3，4，5，1】，两个可行解交叉配对之后生成的新可行解可以是【1，3，4，5，5】和【2，2，3，4，1】，然后产生的新可行解在进行配对生成新的可行解。</p><h3 id="染色体编码"><a href="#染色体编码" class="headerlink" title="染色体编码"></a>染色体编码</h3><p>将问题的可行解抽象化为适用于遗传算法的形式</p><ul><li>二进制编码，将数值转换为二进制串，用以基因的配对交换、变异</li><li>旅行商问题，比如 10 个城市，某个解可以表示为【3，2，1，4，5，7，6，8，9，0】</li><li>根据不同的问题进行不同的抽象实现</li></ul><h3 id="适应度"><a href="#适应度" class="headerlink" title="适应度"></a>适应度</h3><p>遗传算法模拟生物学染色体配对过程。</p><p>以生物学简单理解，适应度可以理解为新生成的染色体的存活能力——一般来说，两个优秀染色体生成的新染色体也是优秀的——所以适应度越高，该染色体留下来（不被淘汰）的概率越大。</p><p>以旅行商问题为例，如果问题目标是要求路径最短，那么我们可以认为路径越短的可行解适应度越高，如果要用数值表示适应度，我们可以选择用 1&#x2F;可行解表示的路径 的方式表示适应度，这样越小的路径表示的适应度数值表示就越大。</p><h3 id="染色体配对（复制）"><a href="#染色体配对（复制）" class="headerlink" title="染色体配对（复制）"></a>染色体配对（复制）</h3><p>遗传算法的本质是对问题部分的可行解进行交换、变异产生新的可行解，并且希望在这个过程中可以通过较少次数得出该问题的最优解——如果次数过多或者直接产生所有可行解去寻找最优解那么实际上这样的方法和枚举法没有什么区别，反而会浪费时间和资源。</p><p>所以遗传算法中选择可行解（染色体）配对交换、变异是很重要的一步，也是算法优化的关键。</p><p>遗传算法配对选择的方式多种多样。</p><ul><li>轮盘赌法——将个体适应度大小映射为概率进行复制：适应度高的个体有更大概率复制，且复制的分数越多。<ol><li>将适应度大小映射为概率——比如此时有20个可行解，那么就有20个适应度（比如说 1&#x2F;路程 ），那么每个可行解映射后的概率为 该可行解的适应度 &#x2F; 20个可行解的总和</li><li>轮盘赌法的详细介绍（个人理解）—— 比如一开始问题的可行解有20个，即20个染色体，在第一次俩俩配对后生成 N 个可行解，此时问题的可行解有 20+N 个（其中可能有重复的可行解），然后对这 20+N 个可行解的适应度进行降序排序，选择 20+N 个可行解中适应度前 20 的可行解进行下一次染色体配对</li></ol></li><li>精英产生精英——对适应度高的前 N&#x2F;4 的个体纪念性复制，然后用这些个体把后 N&#x2F;4 个体替换掉</li><li>不一定要将当前个体的复制体将下一个个体替换掉，可以选择随机选择个体进行配对</li><li>也不一定把适应度低的个体替换掉——从生物学理解，两个优秀（适应度高）的个体不一定生成的子代一定优秀（适应度高）—— 即遗传算法有很大概率只能找到局部最优解而不是全局最优解</li><li>还有很多。。。</li></ul><h3 id="染色体变异"><a href="#染色体变异" class="headerlink" title="染色体变异"></a>染色体变异</h3><p>和染色体配对一样，选择哪个染色体发生变异，或者发生变异的位置选择的策略也是多种多样的</p><ul><li>每个个体都发生变异</li><li>只对适应度低的后 N&#x2F;4 的，或者 N&#x2F;2 个个体变异</li><li>按适应度大小映射为概率变异</li><li>可以选择多个位点进行变异</li><li>还有很多。。。</li></ul><h3 id="适应度映射为概率之后的归一化处理"><a href="#适应度映射为概率之后的归一化处理" class="headerlink" title="适应度映射为概率之后的归一化处理"></a>适应度映射为概率之后的归一化处理</h3><p>比如此时有 4 个 可行解，根据 适应度 &#x2F; 适应度的总和 计算映射后的概率，比如此时 4 个可行解适应度映射后的概率为 【0.2，0.1，0.4，0.3】。</p><p><img src="https://img-blog.csdnimg.cn/96827dc0d3574dfda0281cab77e79ab1.png"></p><p>面对【0.2，0.1，0.4，0.3】的概率，在选择染色体时我们一般选择 【0.2，0.1，0.4，0.3】长度的 if 判断选择染色体，伪代码如下：</p><pre class=" language-python"><code class="language-python">概率 <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> 概率 <span class="token operator">&lt;</span> <span class="token number">0.2</span><span class="token punctuation">:</span>    选择 <span class="token number">0.2</span> 对应的染色体<span class="token keyword">if</span> <span class="token number">0.2</span> <span class="token operator">&lt;=</span> 概率 <span class="token operator">&lt;=</span> <span class="token number">0.2</span><span class="token operator">+</span><span class="token number">0.1</span><span class="token punctuation">:</span>    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><p>理论上这样的代码不报错也是可行的，但实际上这种代码是不合理的，因为假设此时可行解的规模大小是 1万，那么我们就需要写 1万 个 if 条件判断，这显然是不可能的，所以解决办法就是对这些概率进行归一化处理——这样就可以用 循环+if 条件判断解决要写 1万 个 if 判断的麻烦。</p><p><img src="https://img-blog.csdnimg.cn/82b8637a307b4b82a88dd6ada0671ad0.png"></p><p>伪代码如下：</p><pre class=" language-python"><code class="language-python">此时概率列表为 <span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>概率 <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> 列表：    <span class="token keyword">if</span> 概率 <span class="token operator">&lt;</span> i<span class="token punctuation">:</span>        选择 i 对应的染色体        <span class="token keyword">break</span> 退出循环        <span class="token triple-quoted-string string">'''解释如果此时随机的概率为 0.1，那么 0.1&lt;0.2,选择 0.2 所对应的染色体如果此时随机的概率为 0.5，那么 0.5>0.2, 0.5>0.3, 0.5&lt;0.7, 选择 0.7 所对应的染色体——在判断 0.5和0.7的关系之前，循环已经判断了 0.5 和 0.2，0.3 之间的大小关系，所以在判断0.5 和0.7的关系时，我们已经保证了此时 随机的概率（0.5）不在0.2和0.3的概率范围之内'''</span></code></pre><p>另一种判断方式的伪代码：</p><pre class=" language-python"><code class="language-python">此时概率列表为 <span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>概率 <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>概率差值列表 <span class="token operator">=</span> <span class="token punctuation">[</span>概率 <span class="token operator">-</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> 概率列表<span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> 概率差值列表<span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 选择第一个差值 &lt; 0 的 i 对应的染色体</span>        选择 i 对应的染色体        <span class="token keyword">break</span> 退出循环    <span class="token keyword">continue</span> <span class="token triple-quoted-string string">''' 解释 随机概率为 0.1 差值列表为 【-0.1，-0.2，-0.6，-0.9】 -0.1 是第一个小于0的差值，所以选择 0.2 所对应的染色体 '''</span></code></pre><h2 id="将流水车间调度问题（FSP）转换成遗传算法模型"><a href="#将流水车间调度问题（FSP）转换成遗传算法模型" class="headerlink" title="将流水车间调度问题（FSP）转换成遗传算法模型"></a>将流水车间调度问题（FSP）转换成遗传算法模型</h2><h3 id="染色体编码-1"><a href="#染色体编码-1" class="headerlink" title="染色体编码"></a>染色体编码</h3><p>每个染色体编码成工件号序列，比如5个工件的一个编码为序列：[5 1 3 4 2]——表示为加工顺序为工件5，工件1，工件3，工件4，工件2</p><h3 id="基因交换、变异-1"><a href="#基因交换、变异-1" class="headerlink" title="基因交换、变异"></a>基因交换、变异</h3><p>在遗传算法中，可以将问题的一个可行解看成一条染色体，染色体在配对时发生基因交换或者发生基因变异生成新的染色体，即新的可行解。</p><p>而新产生的可行解（染色体）参与到下一次基因配对中，产生另一些新的可行解。</p><h4 id="基因交换"><a href="#基因交换" class="headerlink" title="基因交换"></a>基因交换</h4><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''如果交换前的解为【1 2 3 4 5】 解1【4 2 5 1 3】 解2要交换部分为【2 3 4】【2 5 1】交换后解为【1 2 5 1 5】 解3【4 2 3 4 3】 解4我们发现此时两个解加工工件有重复，需要进一步约束下面就是进一步约束此时 解1 的 头（head） 为 【1】，被交换过来的部分为 【2 5 1】，交换给解2的部分为 【2 3 4】，其中 1 重复，所以将重复的 解1 的 头（head） 更改为 被交换过来的部分1和交换过去的部分同一位置的数，所以 解3 的头（head） 为 4解1 的 尾（tail）也一样，改为 3所以最后的 解3 为 【4 2 5 1 3】          解4 为 【1 2 3 4 5】'''</span></code></pre><h4 id="基因突变"><a href="#基因突变" class="headerlink" title="基因突变"></a>基因突变</h4><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 基因突变，相当于内部相关值进行交换</span><span class="token comment" spellcheck="true"># 如：原来的解为 【1，2，3，4，5】，基因突变后 【1，3，2，4，5】</span></code></pre><h3 id="适应度-1"><a href="#适应度-1" class="headerlink" title="适应度"></a>适应度</h3><p>由于问题目标是：确定 n 个工件在每台机器上的最优加工顺序，使最大流程时间达到最小。</p><p>所以在该问题中时间越小可行解的适应度就越高，有适应度公式<br>$$<br>适应度 &#x3D; 1&#x2F;最大流程时间<br>$$</p><h3 id="适应度映射为概率之后的归一化处理-1"><a href="#适应度映射为概率之后的归一化处理-1" class="headerlink" title="适应度映射为概率之后的归一化处理"></a>适应度映射为概率之后的归一化处理</h3><h4 id="适应度映射为概率"><a href="#适应度映射为概率" class="headerlink" title="适应度映射为概率"></a>适应度映射为概率</h4><p>$$<br>适应度 &#x2F; 适应度的总和&#x3D;计算映射后的概率<br>$$</p><h4 id="归一化处理"><a href="#归一化处理" class="headerlink" title="归一化处理"></a>归一化处理</h4><p>选择第二种伪代码</p><pre class=" language-python"><code class="language-python">此时概率列表为 <span class="token punctuation">[</span><span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">]</span>概率 <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>概率差值列表 <span class="token operator">=</span> <span class="token punctuation">[</span>概率 <span class="token operator">-</span> i <span class="token keyword">for</span> i <span class="token keyword">in</span> 概率列表<span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> 概率差值列表<span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 选择第一个差值 &lt; 0 的 i 对应的染色体</span>        选择 i 对应的染色体        <span class="token keyword">break</span> 退出循环    <span class="token keyword">continue</span></code></pre><p>具体代码如下</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 适应度概率归一化处理</span>choice <span class="token operator">=</span> <span class="token punctuation">[</span>choiceList<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># print(choice)</span>sum_choice <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+</span> sum_choice<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(sum_choice)</span>         <span class="token comment" spellcheck="true"># print(rand_num)</span><span class="token triple-quoted-string string">'''选择配对的个体，选择 self.N 个'''</span>choice_three <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>    three_change_list <span class="token operator">=</span> <span class="token punctuation">[</span>rand_num <span class="token operator">-</span> sum_choice<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>sum_choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    change_index <span class="token operator">=</span> self<span class="token punctuation">.</span>where_change<span class="token punctuation">(</span>three_change_list<span class="token punctuation">)</span>    choice_three<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>change_index<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h3 id="染色体配对（复制）-1"><a href="#染色体配对（复制）-1" class="headerlink" title="染色体配对（复制）"></a>染色体配对（复制）</h3><p>遗传算法配对选择的方式多种多样，对该问题我们选择轮盘赌法进行染色体选择。</p><ul><li>轮盘赌法——将个体适应度大小映射为概率进行复制：适应度高的个体有更大概率复制，且复制的分数越多。<ol><li>将适应度大小映射为概率——比如此时有20个可行解，那么就有20个适应度（比如说 1&#x2F;路程 ），那么每个可行解映射后的概率为 该可行解的适应度 &#x2F; 20个可行解的总和</li><li>轮盘赌法的详细介绍（个人理解）—— 比如一开始问题的可行解有20个，即20个染色体，在第一次俩俩配对后生成 N 个可行解，此时问题的可行解有 20+N 个（其中可能有重复的可行解），然后对这 20+N 个可行解的适应度进行降序排序，选择 20+N 个可行解中适应度前 20 的可行解进行下一次染色体配对</li></ol></li></ul><h2 id="遗传算法代码"><a href="#遗传算法代码" class="headerlink" title="遗传算法代码"></a>遗传算法代码</h2><h3 id="染色体类"><a href="#染色体类" class="headerlink" title="染色体类"></a>染色体类</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># data</span><span class="token comment" spellcheck="true"># fitness 适应度</span><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data<span class="token punctuation">,</span>fitness<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data        self<span class="token punctuation">.</span>fitness <span class="token operator">=</span> fitness</code></pre><h3 id="参数介绍"><a href="#参数介绍" class="headerlink" title="参数介绍"></a>参数介绍</h3><pre class=" language-python"><code class="language-python">N <span class="token operator">=</span> <span class="token number">20</span>  <span class="token comment" spellcheck="true"># 群体大小，即进行染色体配对时，染色体规模，配对时只考虑其中 20个 可行解</span>T <span class="token operator">=</span> <span class="token number">50</span>  <span class="token comment" spellcheck="true"># 终止进化代数</span>Pc <span class="token operator">=</span> <span class="token number">0.6</span> <span class="token comment" spellcheck="true"># 交叉概率</span>Pm<span class="token operator">=</span><span class="token number">0.1</span> <span class="token comment" spellcheck="true"># 变异概率</span>n <span class="token operator">=</span> <span class="token number">5</span> <span class="token comment" spellcheck="true"># 工件个数</span>machine <span class="token operator">=</span> <span class="token number">4</span> <span class="token comment" spellcheck="true"># 机器个数</span></code></pre><h3 id="实例化参数"><a href="#实例化参数" class="headerlink" title="实例化参数"></a>实例化参数</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>pc<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span>pm<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>N<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>T<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>n<span class="token operator">=</span>work_num<span class="token punctuation">,</span>machine<span class="token operator">=</span>machine_num<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    N = 20  # 群体大小    T = 50  # 终止进化代数    Pc = 0.6 # 交叉概率    Pm=0.1 # 变异概率    n = 5 # 工件个数    machine = 4 # 机器个数    '''</span>    self<span class="token punctuation">.</span>pc <span class="token operator">=</span> pc    self<span class="token punctuation">.</span>pm <span class="token operator">=</span> pm    self<span class="token punctuation">.</span>N <span class="token operator">=</span> N    self<span class="token punctuation">.</span>T <span class="token operator">=</span> T    self<span class="token punctuation">.</span>n <span class="token operator">=</span> n    self<span class="token punctuation">.</span>machine <span class="token operator">=</span> machine</code></pre><h3 id="生成初始解"><a href="#生成初始解" class="headerlink" title="生成初始解"></a>生成初始解</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 生成 N 个（种群规模）的初始解</span><span class="token keyword">def</span> <span class="token function">init_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    N_group <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>        order_list <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># node = Node(order_list,fitness(order_list))</span>        N_group<span class="token punctuation">.</span>append<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(N_group)</span>    <span class="token keyword">return</span> N_group</code></pre><h3 id="计算最大流程时间和适应度"><a href="#计算最大流程时间和适应度" class="headerlink" title="计算最大流程时间和适应度"></a>计算最大流程时间和适应度</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">fitness</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>order_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    根据列表顺序调整整体数据。    '''</span>    <span class="token comment" spellcheck="true"># 复制 order_list</span>    three_init_data <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(three_init_data)</span>    <span class="token comment" spellcheck="true"># 输出</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        i <span class="token operator">=</span> order_list<span class="token punctuation">[</span>j<span class="token punctuation">]</span>        order_i <span class="token operator">=</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        three_init_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> source_data<span class="token punctuation">[</span>order_i<span class="token punctuation">]</span>    init_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>three_init_data<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(init_data)</span>    <span class="token comment" spellcheck="true"># k = init_data.shape[0]</span>    <span class="token comment" spellcheck="true"># j = init_data.shape[1] - 1</span>    <span class="token comment" spellcheck="true"># print(k,j)</span>    <span class="token keyword">def</span> <span class="token function">find_time</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> j <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> init_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> k <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> j <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> find_time<span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">elif</span> k <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> j <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> find_time<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            time <span class="token operator">=</span> max<span class="token punctuation">(</span>find_time<span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> find_time<span class="token punctuation">(</span>k<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>        <span class="token keyword">return</span> time    time <span class="token operator">=</span> find_time<span class="token punctuation">(</span>self<span class="token punctuation">.</span>n<span class="token punctuation">,</span> self<span class="token punctuation">.</span>machine<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(time)</span>    fitness <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> time    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>    <span class="token keyword">return</span> fitness<span class="token punctuation">,</span> time</code></pre><h3 id="基因交换-1"><a href="#基因交换-1" class="headerlink" title="基因交换"></a>基因交换</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">cross_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span>    changed_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token triple-quoted-string string">'''    函数：两点交叉 传入数据为node列表 长度20    '''</span>    <span class="token keyword">def</span> <span class="token function">change_main</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">'''        两点交叉        传入数据为两个个体        '''</span>        a1_copy <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>        a2_copy <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>        random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 确保 random_1 &lt; random_2</span>        <span class="token keyword">while</span> random_1 <span class="token operator">></span> random_2 <span class="token operator">or</span> random_1 <span class="token operator">==</span> random_2<span class="token punctuation">:</span>            random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>n<span class="token number">-1</span><span class="token punctuation">)</span>            random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>n<span class="token number">-1</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 交换,因为是无脑交换，所以需要考虑交换之后的工件顺序是否有重复，即不能出现交换之后的解为 [1, 4, 3, 1, 5] [4, 2, 2, 3, 5] 的情况</span>        a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span> <span class="token operator">=</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>        intermediate1 <span class="token operator">=</span> a1<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>        intermediate2 <span class="token operator">=</span> a2<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>        head1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        head2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        tail1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        tail2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token triple-quoted-string string">'''        如果交换前的解为        【1 2 3 4 5】 解1        【4 2 5 1 3】 解2        要交换部分为        【2 3 4】        【2 5 1】        交换后解为        【1 2 5 1 5】 解3        【4 2 3 4 3】 解4        我们发现此时两个解加工工件有重复，需要进一步约束        下面子代头尾的代码就是进一步约束        此时 解1 的 头（head） 为 【1】，被交换过来的部分为 【2 5 1】，交换给解2的部分为 【2 3 4】，其中 1 重复，所以将重复的 解1 的 头（head） 更改为 被交换过来的部分1和交换过去的部分同一位置的数，所以 解3 的头（head） 为 4        解1 的 尾（tail）也一样，改为 3        所以最后的 解3 为 【4 2 5 1 3】                  解4 为 【1 2 3 4 5】        '''</span>        <span class="token comment" spellcheck="true"># 子代1头</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span>random_1<span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate2<span class="token punctuation">:</span>                i <span class="token operator">=</span> intermediate1<span class="token punctuation">[</span>intermediate2<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>            head1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 子代1尾</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate2<span class="token punctuation">:</span>                i <span class="token operator">=</span> intermediate1<span class="token punctuation">[</span>intermediate2<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>            tail1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 子代2头</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span>random_1<span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate1<span class="token punctuation">:</span>                i <span class="token operator">=</span> intermediate2<span class="token punctuation">[</span>intermediate1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>            head2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 子代2尾</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate1<span class="token punctuation">:</span>                i <span class="token operator">=</span> intermediate2<span class="token punctuation">[</span>intermediate1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>            tail2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        result1 <span class="token operator">=</span> head1 <span class="token operator">+</span> intermediate2 <span class="token operator">+</span> tail1        result2 <span class="token operator">=</span> head2 <span class="token operator">+</span> intermediate1 <span class="token operator">+</span> tail2        result1 <span class="token operator">=</span> Node<span class="token punctuation">(</span>result1<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">)</span>        result2 <span class="token operator">=</span> Node<span class="token punctuation">(</span>result2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> result1<span class="token punctuation">,</span> result2    <span class="token comment" spellcheck="true"># 选取 母亲 和 父亲</span>    male <span class="token operator">=</span> choice_three<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    female <span class="token operator">=</span> choice_three<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">!=</span> len<span class="token punctuation">(</span>female<span class="token punctuation">)</span><span class="token punctuation">:</span>        minmale <span class="token operator">=</span> min<span class="token punctuation">(</span>len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>female<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        minmale <span class="token operator">=</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>minmale<span class="token punctuation">)</span><span class="token punctuation">:</span>        cross_rand <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> cross_rand <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>pc<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 发生交换</span>            a1<span class="token punctuation">,</span> a2 <span class="token operator">=</span> change_main<span class="token punctuation">(</span>male<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> female<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>            changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>male<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>female<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> changed_list</code></pre><h3 id="基因突变-1"><a href="#基因突变-1" class="headerlink" title="基因突变"></a>基因突变</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 基因突变，相当于内部相关值进行交换</span><span class="token comment" spellcheck="true"># 如：原来的解为 【1，2，3，4，5】，基因突变后 【1，3，2，4，5】</span><span class="token keyword">def</span> <span class="token function">variation_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cross_change_three<span class="token punctuation">)</span><span class="token punctuation">:</span>    changed_variation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        variation_rand <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> variation_rand <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>pm<span class="token punctuation">:</span>            random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print("变异之前的数据",cross_change_three[j].data)</span>            cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">]</span><span class="token punctuation">,</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">]</span><span class="token operator">=</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">]</span>            changed_variation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print("变异之后的数据",cross_change_three[j].data)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            changed_variation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> changed_variation</code></pre><h3 id="轮盘赌法选择"><a href="#轮盘赌法选择" class="headerlink" title="轮盘赌法选择"></a>轮盘赌法选择</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 确定进行配对的个体</span><span class="token keyword">def</span> <span class="token function">where_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>three_change_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>three_change_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> three_change_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> i        <span class="token keyword">continue</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment" spellcheck="true"># 选择操作</span>choiceList <span class="token operator">=</span> <span class="token punctuation">[</span>N_group<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#             print(choiceList)</span><span class="token triple-quoted-string string">'''求出个体i被选中的概率，选择轮盘赌'''</span><span class="token comment" spellcheck="true"># 适应度概率归一化处理</span>choice <span class="token operator">=</span> <span class="token punctuation">[</span>choiceList<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># print(choice)</span>sum_choice <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+</span> sum_choice<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(sum_choice)</span><span class="token comment" spellcheck="true"># print(rand_num)</span><span class="token triple-quoted-string string">'''选择配对的个体，选择 self.N 个'''</span>choice_three <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>    three_change_list <span class="token operator">=</span> <span class="token punctuation">[</span>rand_num <span class="token operator">-</span> sum_choice<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>sum_choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    change_index <span class="token operator">=</span> self<span class="token punctuation">.</span>where_change<span class="token punctuation">(</span>three_change_list<span class="token punctuation">)</span>    choice_three<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>change_index<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><h2 id="最终完整代码"><a href="#最终完整代码" class="headerlink" title="最终完整代码"></a>最终完整代码</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> copy<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> random<span class="token keyword">import</span> threading<span class="token comment" spellcheck="true"># data</span><span class="token comment" spellcheck="true"># fitness 适应度</span><span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>data<span class="token punctuation">,</span>fitness<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> data        self<span class="token punctuation">.</span>fitness <span class="token operator">=</span> fitness<span class="token comment" spellcheck="true"># 测试样例</span><span class="token comment" spellcheck="true"># source_data = {'1':[1,31,41,25,30],</span><span class="token comment" spellcheck="true">#              '2':[2,19,55,3,34],</span><span class="token comment" spellcheck="true">#              '3':[3,23,42,27,6],</span><span class="token comment" spellcheck="true">#              '4':[4,13,22,14,13],</span><span class="token comment" spellcheck="true">#              '5':[5,33,5,57,19]</span><span class="token comment" spellcheck="true">#             }</span>path_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"car01.txt"</span><span class="token punctuation">,</span> <span class="token string">"car07.txt"</span><span class="token punctuation">,</span> <span class="token string">"rec01.txt"</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># path_list = ["rec21.txt"]</span><span class="token comment" spellcheck="true"># path_list = ["rec31.txt"]</span><span class="token keyword">for</span> path <span class="token keyword">in</span> path_list<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>    source_data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        count <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>            data_list <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">if</span> <span class="token string">""</span> <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>                data_list<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(data_list)</span>            <span class="token keyword">if</span> count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                work_num <span class="token operator">=</span> int<span class="token punctuation">(</span>data_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                machine_num <span class="token operator">=</span> int<span class="token punctuation">(</span>data_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>count<span class="token punctuation">)</span>                work_time_list <span class="token operator">=</span> data_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> work_time_list<span class="token punctuation">:</span>                    <span class="token keyword">if</span> <span class="token string">"\n"</span> <span class="token keyword">in</span> i<span class="token punctuation">:</span>                        i <span class="token operator">=</span> i<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>                    data <span class="token operator">=</span> int<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                    values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(values)</span>                source_data<span class="token punctuation">[</span>str<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> values            count <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token comment" spellcheck="true"># print(source_data)</span>    <span class="token keyword">class</span> <span class="token class-name">GA_FSP</span><span class="token punctuation">:</span>        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>pc<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span>pm<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>N<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>T<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>n<span class="token operator">=</span>work_num<span class="token punctuation">,</span>machine<span class="token operator">=</span>machine_num<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''            N = 20  #群体大小            T = 100  #Ga终止进化代数            Pc = 0.6 #交叉概率            Pm=0.1 #变异概率            n = 5 #工件个数            machine = 4 #机器个数            '''</span>            self<span class="token punctuation">.</span>pc <span class="token operator">=</span> pc            self<span class="token punctuation">.</span>pm <span class="token operator">=</span> pm            self<span class="token punctuation">.</span>N <span class="token operator">=</span> N            self<span class="token punctuation">.</span>T <span class="token operator">=</span> T            self<span class="token punctuation">.</span>n <span class="token operator">=</span> n            self<span class="token punctuation">.</span>machine <span class="token operator">=</span> machine        <span class="token keyword">def</span> <span class="token function">fitness</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>order_list<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''            根据列表顺序调整整体数据。            '''</span>            <span class="token comment" spellcheck="true"># 复制 order_list</span>            three_init_data <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(three_init_data)</span>            <span class="token comment" spellcheck="true"># 输出</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                i <span class="token operator">=</span> order_list<span class="token punctuation">[</span>j<span class="token punctuation">]</span>                order_i <span class="token operator">=</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                three_init_data<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> source_data<span class="token punctuation">[</span>order_i<span class="token punctuation">]</span>            init_data <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>three_init_data<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(init_data)</span>            <span class="token comment" spellcheck="true"># k = init_data.shape[0]</span>            <span class="token comment" spellcheck="true"># j = init_data.shape[1] - 1</span>            <span class="token comment" spellcheck="true"># print(k,j)</span>            <span class="token keyword">def</span> <span class="token function">find_time</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> k <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> j <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> init_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>                <span class="token keyword">elif</span> k <span class="token operator">>=</span> <span class="token number">2</span> <span class="token operator">and</span> j <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> find_time<span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>                <span class="token keyword">elif</span> k <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> j <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> find_time<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    time <span class="token operator">=</span> max<span class="token punctuation">(</span>find_time<span class="token punctuation">(</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">)</span><span class="token punctuation">,</span> find_time<span class="token punctuation">(</span>k<span class="token punctuation">,</span> j <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> init_data<span class="token punctuation">[</span>k <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">]</span>                <span class="token keyword">return</span> time            time <span class="token operator">=</span> find_time<span class="token punctuation">(</span>self<span class="token punctuation">.</span>n<span class="token punctuation">,</span> self<span class="token punctuation">.</span>machine<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(time)</span>            fitness <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> time            <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>            <span class="token keyword">return</span> fitness<span class="token punctuation">,</span> time        <span class="token comment" spellcheck="true"># 生成 N 个（种群规模）的初始解</span>        <span class="token keyword">def</span> <span class="token function">init_list</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            N_group <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>                order_list <span class="token operator">=</span> <span class="token punctuation">[</span>p <span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">#             node = Node(order_list,fitness(order_list))</span>                N_group<span class="token punctuation">.</span>append<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(N_group)</span>            <span class="token keyword">return</span> N_group        <span class="token comment" spellcheck="true"># 确定进行配对的个体</span>        <span class="token keyword">def</span> <span class="token function">where_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>three_change_list<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>three_change_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> three_change_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">:</span>                    <span class="token keyword">return</span> i                <span class="token keyword">continue</span>        <span class="token keyword">def</span> <span class="token function">cross_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span>            changed_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token triple-quoted-string string">'''            函数：两点交叉 传入数据为node列表 长度20            '''</span>            <span class="token keyword">def</span> <span class="token function">change_main</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token triple-quoted-string string">'''                两点交叉                传入数据为两个个体                '''</span>                a1_copy <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>                a2_copy <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>                random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 确保 random_1 &lt; random_2</span>                <span class="token keyword">while</span> random_1 <span class="token operator">></span> random_2 <span class="token operator">or</span> random_1 <span class="token operator">==</span> random_2<span class="token punctuation">:</span>                    random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>n<span class="token number">-1</span><span class="token punctuation">)</span>                    random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>n<span class="token number">-1</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 交换,因为是无脑交换，所以需要考虑交换之后的工件顺序是否有重复，即不能出现交换之后的解为 [1, 4, 3, 1, 5] [4, 2, 2, 3, 5] 的情况</span>                a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span> <span class="token operator">=</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>                intermediate1 <span class="token operator">=</span> a1<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>                intermediate2 <span class="token operator">=</span> a2<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">:</span>random_2<span class="token punctuation">]</span>                head1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                head2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                tail1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                tail2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                <span class="token triple-quoted-string string">'''                如果交换前的解为                【1 2 3 4 5】 解1                【4 2 5 1 3】 解2                要交换部分为                【2 3 4】                【2 5 1】                交换后解为                【1 2 5 1 5】 解3                【4 2 3 4 3】 解4                我们发现此时两个解加工工件有重复，需要进一步约束                下面子代头尾的代码就是进一步约束                此时 解1 的 头（head） 为 【1】，被交换过来的部分为 【2 5 1】，交换给解2的部分为 【2 3 4】，其中 1 重复，所以将重复的 解1 的 头（head） 更改为 被交换过来的部分1和交换过去的部分同一位置的数，所以 解3 的头（head） 为 4                解1 的 尾（tail）也一样，改为 3                所以最后的 解3 为 【4 2 5 1 3】                          解4 为 【1 2 3 4 5】                '''</span>                <span class="token comment" spellcheck="true"># 子代1头</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span>random_1<span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate2<span class="token punctuation">:</span>                        i <span class="token operator">=</span> intermediate1<span class="token punctuation">[</span>intermediate2<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>                    head1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 子代1尾</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> a1_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate2<span class="token punctuation">:</span>                        i <span class="token operator">=</span> intermediate1<span class="token punctuation">[</span>intermediate2<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>                    tail1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 子代2头</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token punctuation">:</span>random_1<span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate1<span class="token punctuation">:</span>                        i <span class="token operator">=</span> intermediate2<span class="token punctuation">[</span>intermediate1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>                    head2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 子代2尾</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> a2_copy<span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    <span class="token keyword">while</span> i <span class="token keyword">in</span> intermediate1<span class="token punctuation">:</span>                        i <span class="token operator">=</span> intermediate2<span class="token punctuation">[</span>intermediate1<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">]</span>                    tail2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                result1 <span class="token operator">=</span> head1 <span class="token operator">+</span> intermediate2 <span class="token operator">+</span> tail1                result2 <span class="token operator">=</span> head2 <span class="token operator">+</span> intermediate1 <span class="token operator">+</span> tail2                result1 <span class="token operator">=</span> Node<span class="token punctuation">(</span>result1<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>result1<span class="token punctuation">)</span><span class="token punctuation">)</span>                result2 <span class="token operator">=</span> Node<span class="token punctuation">(</span>result2<span class="token punctuation">,</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>result2<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> result1<span class="token punctuation">,</span> result2            <span class="token comment" spellcheck="true"># 选取 母亲 和 父亲</span>            male <span class="token operator">=</span> choice_three<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>            female <span class="token operator">=</span> choice_three<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span>len<span class="token punctuation">(</span>choice_three<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span> <span class="token operator">!=</span> len<span class="token punctuation">(</span>female<span class="token punctuation">)</span><span class="token punctuation">:</span>                minmale <span class="token operator">=</span> min<span class="token punctuation">(</span>len<span class="token punctuation">(</span>male<span class="token punctuation">)</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>female<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                minmale <span class="token operator">=</span> len<span class="token punctuation">(</span>male<span class="token punctuation">)</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>minmale<span class="token punctuation">)</span><span class="token punctuation">:</span>                cross_rand <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> cross_rand <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>pc<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 发生交换</span>                    a1<span class="token punctuation">,</span> a2 <span class="token operator">=</span> change_main<span class="token punctuation">(</span>male<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> female<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                    changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a1<span class="token punctuation">)</span>                    changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a2<span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>male<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                    changed_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>female<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> changed_list        <span class="token comment" spellcheck="true"># 基因突变，相当于内部相关值进行交换</span>        <span class="token comment" spellcheck="true"># 如：原来的解为 【1，2，3，4，5】，基因突变后 【1，3，2，4，5】</span>        <span class="token keyword">def</span> <span class="token function">variation_change</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cross_change_three<span class="token punctuation">)</span><span class="token punctuation">:</span>            changed_variation <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                variation_rand <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> variation_rand <span class="token operator">&lt;</span> self<span class="token punctuation">.</span>pm<span class="token punctuation">:</span>                    random_1 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                    random_2 <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># print("变异之前的数据",cross_change_three[j].data)</span>                    cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">]</span><span class="token punctuation">,</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">]</span><span class="token operator">=</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_2<span class="token punctuation">]</span><span class="token punctuation">,</span> cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">[</span>random_1<span class="token punctuation">]</span>                    changed_variation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># print("变异之后的数据",cross_change_three[j].data)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    changed_variation<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cross_change_three<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> changed_variation        <span class="token keyword">def</span> <span class="token function">__sort_threelist</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>arr<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''            冒泡排序，适应度排序，有进行归一化处理吗？            '''</span>            n <span class="token operator">=</span> len<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>n<span class="token operator">-</span>i<span class="token number">-1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">></span>arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                        arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span>arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">,</span>arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>            <span class="token keyword">return</span> arr        <span class="token keyword">def</span> <span class="token function">pro_go</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 初始化种群</span>            N_group <span class="token operator">=</span> self<span class="token punctuation">.</span>init_list<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                N_group<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> Node<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 开始迭代</span>            draw_x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            draw_y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> num <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>T <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># 每完成一次迭代就计算一次适应度</span>                <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    N_group<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>fitness <span class="token operator">=</span> self<span class="token punctuation">.</span>fitness<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">#                 print(N_group[j].fitness[0])</span>                <span class="token comment" spellcheck="true">#                 print(N_group)</span>                <span class="token keyword">if</span> num <span class="token operator">></span> self<span class="token punctuation">.</span>T<span class="token punctuation">:</span>                    <span class="token keyword">break</span>                <span class="token comment" spellcheck="true"># 选择操作</span>                choiceList <span class="token operator">=</span> <span class="token punctuation">[</span>N_group<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                <span class="token comment" spellcheck="true">#             print(choiceList)</span>                <span class="token triple-quoted-string string">'''                求出个体i被选中的概率，选择轮盘赌                '''</span>                <span class="token comment" spellcheck="true"># 适应度概率归一化处理</span>                choice <span class="token operator">=</span> <span class="token punctuation">[</span>choiceList<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> sum<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choiceList<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                <span class="token comment" spellcheck="true"># print(choice)</span>                sum_choice <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                <span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">if</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">)</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        sum_choice<span class="token punctuation">.</span>append<span class="token punctuation">(</span>choice<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">+</span> sum_choice<span class="token punctuation">[</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(sum_choice)</span>                <span class="token comment" spellcheck="true"># print(rand_num)</span>                <span class="token triple-quoted-string string">'''                选择配对的个体，选择 self.N 个                '''</span>                choice_three <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>                    rand_num <span class="token operator">=</span> random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>                    three_change_list <span class="token operator">=</span> <span class="token punctuation">[</span>rand_num <span class="token operator">-</span> sum_choice<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>sum_choice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>                    change_index <span class="token operator">=</span> self<span class="token punctuation">.</span>where_change<span class="token punctuation">(</span>three_change_list<span class="token punctuation">)</span>                    choice_three<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>change_index<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token triple-quoted-string string">'''                交叉                传入种群节点即可                '''</span>                cross_choice_three <span class="token operator">=</span> self<span class="token punctuation">.</span>cross_change<span class="token punctuation">(</span>choice_three<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(cross_choice_three)</span>                <span class="token triple-quoted-string string">'''                变异                '''</span>                variation_three <span class="token operator">=</span> self<span class="token punctuation">.</span>variation_change<span class="token punctuation">(</span>cross_choice_three<span class="token punctuation">)</span>                sort_group <span class="token operator">=</span> N_group <span class="token operator">+</span> variation_three                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"次迭代"</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">" "</span><span class="token punctuation">)</span>                N_group <span class="token operator">=</span> self<span class="token punctuation">.</span>__sort_threelist<span class="token punctuation">(</span>sort_group<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>N<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 选择前 self.N 个适应度大的作为下一次迭代的父母</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>N_group<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">'--'</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>N_group<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true">#             print()</span>                draw_x<span class="token punctuation">.</span>append<span class="token punctuation">(</span>num<span class="token punctuation">)</span>                draw_y<span class="token punctuation">.</span>append<span class="token punctuation">(</span>N_group<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fitness<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span>            N_group <span class="token operator">=</span> self<span class="token punctuation">.</span>__sort_threelist<span class="token punctuation">(</span>sort_group<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>N<span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>N_group<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>N_group<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">)</span>            <span class="token keyword">return</span> N_group<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> draw_x<span class="token punctuation">,</span> draw_y    Ga1 <span class="token operator">=</span> GA_FSP<span class="token punctuation">(</span>n<span class="token operator">=</span>work_num<span class="token punctuation">,</span> machine<span class="token operator">=</span>machine_num<span class="token punctuation">)</span>    best1<span class="token punctuation">,</span>draw_x<span class="token punctuation">,</span>draw_y <span class="token operator">=</span> Ga1<span class="token punctuation">.</span>pro_go<span class="token punctuation">(</span><span class="token punctuation">)</span>    final_data <span class="token operator">=</span> best1<span class="token punctuation">.</span>data    <span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>draw_x<span class="token punctuation">,</span> draw_y<span class="token punctuation">)</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="数据介绍"><a href="#数据介绍" class="headerlink" title="数据介绍"></a>数据介绍</h2><pre class=" language-python"><code class="language-python"> <span class="token number">11</span> <span class="token number">5</span> <span class="token comment" spellcheck="true"># 11 —— 11个工件数，5 —— 5 台机器</span> <span class="token number">0</span> <span class="token number">375</span> <span class="token number">1</span>  <span class="token number">12</span> <span class="token number">2</span> <span class="token number">142</span> <span class="token number">3</span> <span class="token number">245</span> <span class="token number">4</span> <span class="token number">412</span> <span class="token comment" spellcheck="true"># 0，1，2，3，4 表示第0，1，2，3，4 机器，其他为加工时间</span> <span class="token number">0</span> <span class="token number">632</span> <span class="token number">1</span> <span class="token number">452</span> <span class="token number">2</span> <span class="token number">758</span> <span class="token number">3</span> <span class="token number">278</span> <span class="token number">4</span> <span class="token number">398</span> <span class="token number">0</span>  <span class="token number">12</span> <span class="token number">1</span> <span class="token number">876</span> <span class="token number">2</span> <span class="token number">124</span> <span class="token number">3</span> <span class="token number">534</span> <span class="token number">4</span> <span class="token number">765</span> <span class="token number">0</span> <span class="token number">460</span> <span class="token number">1</span> <span class="token number">542</span> <span class="token number">2</span> <span class="token number">523</span> <span class="token number">3</span> <span class="token number">120</span> <span class="token number">4</span> <span class="token number">499</span> <span class="token number">0</span> <span class="token number">528</span> <span class="token number">1</span> <span class="token number">101</span> <span class="token number">2</span> <span class="token number">789</span> <span class="token number">3</span> <span class="token number">124</span> <span class="token number">4</span> <span class="token number">999</span> <span class="token number">0</span> <span class="token number">796</span> <span class="token number">1</span> <span class="token number">245</span> <span class="token number">2</span> <span class="token number">632</span> <span class="token number">3</span> <span class="token number">375</span> <span class="token number">4</span> <span class="token number">123</span> <span class="token number">0</span> <span class="token number">532</span> <span class="token number">1</span> <span class="token number">230</span> <span class="token number">2</span> <span class="token number">543</span> <span class="token number">3</span> <span class="token number">896</span> <span class="token number">4</span> <span class="token number">452</span> <span class="token number">0</span>  <span class="token number">14</span> <span class="token number">1</span> <span class="token number">124</span> <span class="token number">2</span> <span class="token number">214</span> <span class="token number">3</span> <span class="token number">543</span> <span class="token number">4</span> <span class="token number">785</span> <span class="token number">0</span> <span class="token number">257</span> <span class="token number">1</span> <span class="token number">527</span> <span class="token number">2</span> <span class="token number">753</span> <span class="token number">3</span> <span class="token number">210</span> <span class="token number">4</span> <span class="token number">463</span> <span class="token number">0</span> <span class="token number">896</span> <span class="token number">1</span> <span class="token number">896</span> <span class="token number">2</span> <span class="token number">214</span> <span class="token number">3</span> <span class="token number">258</span> <span class="token number">4</span> <span class="token number">259</span> <span class="token number">0</span> <span class="token number">532</span> <span class="token number">1</span> <span class="token number">302</span> <span class="token number">2</span> <span class="token number">501</span> <span class="token number">3</span> <span class="token number">765</span> <span class="token number">4</span> <span class="token number">988</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>运行结果是局部最优解，不是全局最优解，每次运行结果可能会有变化</p><h3 id="car01-txt"><a href="#car01-txt" class="headerlink" title="car01.txt"></a>car01.txt</h3><h4 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h4><pre class=" language-python"><code class="language-python"> <span class="token number">11</span> <span class="token number">5</span> <span class="token number">0</span> <span class="token number">375</span> <span class="token number">1</span>  <span class="token number">12</span> <span class="token number">2</span> <span class="token number">142</span> <span class="token number">3</span> <span class="token number">245</span> <span class="token number">4</span> <span class="token number">412</span> <span class="token number">0</span> <span class="token number">632</span> <span class="token number">1</span> <span class="token number">452</span> <span class="token number">2</span> <span class="token number">758</span> <span class="token number">3</span> <span class="token number">278</span> <span class="token number">4</span> <span class="token number">398</span> <span class="token number">0</span>  <span class="token number">12</span> <span class="token number">1</span> <span class="token number">876</span> <span class="token number">2</span> <span class="token number">124</span> <span class="token number">3</span> <span class="token number">534</span> <span class="token number">4</span> <span class="token number">765</span> <span class="token number">0</span> <span class="token number">460</span> <span class="token number">1</span> <span class="token number">542</span> <span class="token number">2</span> <span class="token number">523</span> <span class="token number">3</span> <span class="token number">120</span> <span class="token number">4</span> <span class="token number">499</span> <span class="token number">0</span> <span class="token number">528</span> <span class="token number">1</span> <span class="token number">101</span> <span class="token number">2</span> <span class="token number">789</span> <span class="token number">3</span> <span class="token number">124</span> <span class="token number">4</span> <span class="token number">999</span> <span class="token number">0</span> <span class="token number">796</span> <span class="token number">1</span> <span class="token number">245</span> <span class="token number">2</span> <span class="token number">632</span> <span class="token number">3</span> <span class="token number">375</span> <span class="token number">4</span> <span class="token number">123</span> <span class="token number">0</span> <span class="token number">532</span> <span class="token number">1</span> <span class="token number">230</span> <span class="token number">2</span> <span class="token number">543</span> <span class="token number">3</span> <span class="token number">896</span> <span class="token number">4</span> <span class="token number">452</span> <span class="token number">0</span>  <span class="token number">14</span> <span class="token number">1</span> <span class="token number">124</span> <span class="token number">2</span> <span class="token number">214</span> <span class="token number">3</span> <span class="token number">543</span> <span class="token number">4</span> <span class="token number">785</span> <span class="token number">0</span> <span class="token number">257</span> <span class="token number">1</span> <span class="token number">527</span> <span class="token number">2</span> <span class="token number">753</span> <span class="token number">3</span> <span class="token number">210</span> <span class="token number">4</span> <span class="token number">463</span> <span class="token number">0</span> <span class="token number">896</span> <span class="token number">1</span> <span class="token number">896</span> <span class="token number">2</span> <span class="token number">214</span> <span class="token number">3</span> <span class="token number">258</span> <span class="token number">4</span> <span class="token number">259</span> <span class="token number">0</span> <span class="token number">532</span> <span class="token number">1</span> <span class="token number">302</span> <span class="token number">2</span> <span class="token number">501</span> <span class="token number">3</span> <span class="token number">765</span> <span class="token number">4</span> <span class="token number">988</span></code></pre><p>迭代100次最终值为：7156</p><p><img src="https://img-blog.csdnimg.cn/d849e46387b849fc91765e5634936a55.png"><br><img src="https://img-blog.csdnimg.cn/6b910c934fc54376972a11c13da6fed3.png"></p><h3 id="car07-txt"><a href="#car07-txt" class="headerlink" title="car07.txt"></a>car07.txt</h3><h4 id="数据-1"><a href="#数据-1" class="headerlink" title="数据"></a>数据</h4><pre class=" language-python"><code class="language-python"> <span class="token number">7</span> <span class="token number">7</span> <span class="token number">0</span> <span class="token number">692</span> <span class="token number">1</span> <span class="token number">310</span> <span class="token number">2</span> <span class="token number">832</span> <span class="token number">3</span> <span class="token number">630</span> <span class="token number">4</span> <span class="token number">258</span> <span class="token number">5</span> <span class="token number">147</span> <span class="token number">6</span> <span class="token number">255</span> <span class="token number">0</span> <span class="token number">581</span> <span class="token number">1</span> <span class="token number">582</span> <span class="token number">2</span>  <span class="token number">14</span> <span class="token number">3</span> <span class="token number">214</span> <span class="token number">4</span> <span class="token number">147</span> <span class="token number">5</span> <span class="token number">753</span> <span class="token number">6</span> <span class="token number">806</span> <span class="token number">0</span> <span class="token number">475</span> <span class="token number">1</span> <span class="token number">475</span> <span class="token number">2</span> <span class="token number">785</span> <span class="token number">3</span> <span class="token number">578</span> <span class="token number">4</span> <span class="token number">852</span> <span class="token number">5</span>  <span class="token number">2</span> <span class="token number">6</span> <span class="token number">699</span> <span class="token number">0</span>  <span class="token number">23</span> <span class="token number">1</span> <span class="token number">196</span> <span class="token number">2</span> <span class="token number">696</span> <span class="token number">3</span> <span class="token number">214</span> <span class="token number">4</span> <span class="token number">586</span> <span class="token number">5</span> <span class="token number">356</span> <span class="token number">6</span> <span class="token number">877</span> <span class="token number">0</span> <span class="token number">158</span> <span class="token number">1</span> <span class="token number">325</span> <span class="token number">2</span> <span class="token number">530</span> <span class="token number">3</span> <span class="token number">785</span> <span class="token number">4</span> <span class="token number">325</span> <span class="token number">5</span> <span class="token number">565</span> <span class="token number">6</span> <span class="token number">412</span> <span class="token number">0</span> <span class="token number">796</span> <span class="token number">1</span> <span class="token number">874</span> <span class="token number">2</span> <span class="token number">214</span> <span class="token number">3</span> <span class="token number">236</span> <span class="token number">4</span> <span class="token number">896</span> <span class="token number">5</span> <span class="token number">898</span> <span class="token number">6</span> <span class="token number">302</span> <span class="token number">0</span> <span class="token number">542</span> <span class="token number">1</span> <span class="token number">205</span> <span class="token number">2</span> <span class="token number">578</span> <span class="token number">3</span> <span class="token number">963</span> <span class="token number">4</span> <span class="token number">325</span> <span class="token number">5</span> <span class="token number">800</span> <span class="token number">6</span> <span class="token number">120</span></code></pre><p>迭代100次最终值为：6685</p><p><img src="https://img-blog.csdnimg.cn/c786af829f524c71b5ef8e73f603dea3.png"><br><img src="https://img-blog.csdnimg.cn/262fbea205564d0cb19584cc85b15dd4.png"></p><h3 id="rec01-txt"><a href="#rec01-txt" class="headerlink" title="rec01.txt"></a>rec01.txt</h3><h4 id="数据-2"><a href="#数据-2" class="headerlink" title="数据"></a>数据</h4><pre class=" language-python"><code class="language-python"> <span class="token number">20</span> <span class="token number">5</span> <span class="token number">0</span> <span class="token number">5</span> <span class="token number">1</span> <span class="token number">76</span> <span class="token number">2</span> <span class="token number">74</span> <span class="token number">3</span> <span class="token number">99</span> <span class="token number">4</span> <span class="token number">26</span> <span class="token number">0</span> <span class="token number">74</span> <span class="token number">1</span> <span class="token number">21</span> <span class="token number">2</span> <span class="token number">83</span> <span class="token number">3</span> <span class="token number">52</span> <span class="token number">4</span> <span class="token number">90</span> <span class="token number">0</span> <span class="token number">67</span> <span class="token number">1</span> <span class="token number">48</span> <span class="token number">2</span>  <span class="token number">6</span> <span class="token number">3</span> <span class="token number">66</span> <span class="token number">4</span> <span class="token number">38</span> <span class="token number">0</span> <span class="token number">97</span> <span class="token number">1</span> <span class="token number">36</span> <span class="token number">2</span> <span class="token number">71</span> <span class="token number">3</span> <span class="token number">68</span> <span class="token number">4</span> <span class="token number">81</span> <span class="token number">0</span> <span class="token number">87</span> <span class="token number">1</span> <span class="token number">86</span> <span class="token number">2</span> <span class="token number">64</span> <span class="token number">3</span> <span class="token number">11</span> <span class="token number">4</span> <span class="token number">31</span> <span class="token number">0</span>  <span class="token number">1</span> <span class="token number">1</span> <span class="token number">42</span> <span class="token number">2</span> <span class="token number">20</span> <span class="token number">3</span> <span class="token number">90</span> <span class="token number">4</span> <span class="token number">23</span> <span class="token number">0</span> <span class="token number">69</span> <span class="token number">1</span> <span class="token number">32</span> <span class="token number">2</span> <span class="token number">99</span> <span class="token number">3</span> <span class="token number">26</span> <span class="token number">4</span> <span class="token number">57</span> <span class="token number">0</span> <span class="token number">69</span> <span class="token number">1</span> <span class="token number">12</span> <span class="token number">2</span> <span class="token number">54</span> <span class="token number">3</span> <span class="token number">80</span> <span class="token number">4</span> <span class="token number">16</span> <span class="token number">0</span> <span class="token number">11</span> <span class="token number">1</span> <span class="token number">63</span> <span class="token number">2</span> <span class="token number">24</span> <span class="token number">3</span> <span class="token number">16</span> <span class="token number">4</span> <span class="token number">89</span> <span class="token number">0</span> <span class="token number">87</span> <span class="token number">1</span> <span class="token number">52</span> <span class="token number">2</span> <span class="token number">43</span> <span class="token number">3</span> <span class="token number">10</span> <span class="token number">4</span> <span class="token number">26</span> <span class="token number">0</span> <span class="token number">25</span> <span class="token number">1</span> <span class="token number">59</span> <span class="token number">2</span> <span class="token number">88</span> <span class="token number">3</span> <span class="token number">87</span> <span class="token number">4</span> <span class="token number">40</span> <span class="token number">0</span> <span class="token number">50</span> <span class="token number">1</span> <span class="token number">42</span> <span class="token number">2</span> <span class="token number">72</span> <span class="token number">3</span> <span class="token number">77</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">0</span> <span class="token number">58</span> <span class="token number">1</span> <span class="token number">76</span> <span class="token number">2</span> <span class="token number">71</span> <span class="token number">3</span> <span class="token number">82</span> <span class="token number">4</span> <span class="token number">94</span> <span class="token number">0</span> <span class="token number">79</span> <span class="token number">1</span> <span class="token number">48</span> <span class="token number">2</span> <span class="token number">20</span> <span class="token number">3</span> <span class="token number">63</span> <span class="token number">4</span> <span class="token number">97</span> <span class="token number">0</span> <span class="token number">35</span> <span class="token number">1</span> <span class="token number">57</span> <span class="token number">2</span> <span class="token number">78</span> <span class="token number">3</span> <span class="token number">99</span> <span class="token number">4</span> <span class="token number">80</span> <span class="token number">0</span> <span class="token number">70</span> <span class="token number">1</span> <span class="token number">76</span> <span class="token number">2</span> <span class="token number">53</span> <span class="token number">3</span>  <span class="token number">2</span> <span class="token number">4</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">79</span> <span class="token number">1</span> <span class="token number">22</span> <span class="token number">2</span> <span class="token number">77</span> <span class="token number">3</span> <span class="token number">74</span> <span class="token number">4</span> <span class="token number">95</span> <span class="token number">0</span> <span class="token number">34</span> <span class="token number">1</span> <span class="token number">99</span> <span class="token number">2</span> <span class="token number">49</span> <span class="token number">3</span>  <span class="token number">3</span> <span class="token number">4</span> <span class="token number">61</span> <span class="token number">0</span> <span class="token number">37</span> <span class="token number">1</span> <span class="token number">24</span> <span class="token number">2</span> <span class="token number">32</span> <span class="token number">3</span> <span class="token number">35</span> <span class="token number">4</span>  <span class="token number">4</span> <span class="token number">0</span> <span class="token number">50</span> <span class="token number">1</span> <span class="token number">88</span> <span class="token number">2</span> <span class="token number">46</span> <span class="token number">3</span> <span class="token number">63</span> <span class="token number">4</span> <span class="token number">76</span></code></pre><p>迭代100次最终值为：1368</p><p><img src="https://img-blog.csdnimg.cn/2363b105854f430c85ffcc094b610c44.png"><br><img src="https://img-blog.csdnimg.cn/a4b99d37b4a34425b79d15dbd9860d6a.png"></p><h3 id="rec21-txt"><a href="#rec21-txt" class="headerlink" title="rec21.txt"></a>rec21.txt</h3><h4 id="数据-3"><a href="#数据-3" class="headerlink" title="数据"></a>数据</h4><pre class=" language-python"><code class="language-python"> <span class="token number">30</span> <span class="token number">10</span> <span class="token number">0</span> <span class="token number">12</span> <span class="token number">1</span> <span class="token number">89</span> <span class="token number">2</span> <span class="token number">69</span> <span class="token number">3</span> <span class="token number">94</span> <span class="token number">4</span> <span class="token number">22</span> <span class="token number">5</span> <span class="token number">31</span> <span class="token number">6</span> <span class="token number">22</span> <span class="token number">7</span> <span class="token number">95</span> <span class="token number">8</span> <span class="token number">36</span> <span class="token number">9</span> <span class="token number">38</span> <span class="token number">0</span> <span class="token number">55</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">2</span> <span class="token number">94</span> <span class="token number">3</span> <span class="token number">19</span> <span class="token number">4</span> <span class="token number">43</span> <span class="token number">5</span> <span class="token number">74</span> <span class="token number">6</span> <span class="token number">72</span> <span class="token number">7</span> <span class="token number">10</span> <span class="token number">8</span> <span class="token number">99</span> <span class="token number">9</span> <span class="token number">16</span> <span class="token number">0</span> <span class="token number">34</span> <span class="token number">1</span> <span class="token number">78</span> <span class="token number">2</span> <span class="token number">27</span> <span class="token number">3</span> <span class="token number">40</span> <span class="token number">4</span> <span class="token number">21</span> <span class="token number">5</span> <span class="token number">17</span> <span class="token number">6</span> <span class="token number">15</span> <span class="token number">7</span> <span class="token number">62</span> <span class="token number">8</span> <span class="token number">96</span> <span class="token number">9</span> <span class="token number">63</span> <span class="token number">0</span> <span class="token number">100</span> <span class="token number">1</span> <span class="token number">14</span> <span class="token number">2</span> <span class="token number">23</span> <span class="token number">3</span> <span class="token number">42</span> <span class="token number">4</span> <span class="token number">52</span> <span class="token number">5</span> <span class="token number">18</span> <span class="token number">6</span> <span class="token number">29</span> <span class="token number">7</span> <span class="token number">70</span> <span class="token number">8</span> <span class="token number">21</span> <span class="token number">9</span> <span class="token number">47</span> <span class="token number">0</span> <span class="token number">41</span> <span class="token number">1</span> <span class="token number">92</span> <span class="token number">2</span> <span class="token number">88</span> <span class="token number">3</span> <span class="token number">52</span> <span class="token number">4</span> <span class="token number">99</span> <span class="token number">5</span> <span class="token number">41</span> <span class="token number">6</span> <span class="token number">68</span> <span class="token number">7</span> <span class="token number">22</span> <span class="token number">8</span> <span class="token number">57</span> <span class="token number">9</span> <span class="token number">66</span> <span class="token number">0</span> <span class="token number">24</span> <span class="token number">1</span> <span class="token number">62</span> <span class="token number">2</span> <span class="token number">19</span> <span class="token number">3</span> <span class="token number">35</span> <span class="token number">4</span> <span class="token number">24</span> <span class="token number">5</span> <span class="token number">49</span> <span class="token number">6</span> <span class="token number">100</span> <span class="token number">7</span> <span class="token number">65</span> <span class="token number">8</span> <span class="token number">13</span> <span class="token number">9</span> <span class="token number">41</span> <span class="token number">0</span> <span class="token number">29</span> <span class="token number">1</span> <span class="token number">34</span> <span class="token number">2</span> <span class="token number">38</span> <span class="token number">3</span> <span class="token number">72</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">5</span> <span class="token number">83</span> <span class="token number">6</span> <span class="token number">44</span> <span class="token number">7</span> <span class="token number">91</span> <span class="token number">8</span> <span class="token number">65</span> <span class="token number">9</span> <span class="token number">100</span> <span class="token number">0</span> <span class="token number">89</span> <span class="token number">1</span> <span class="token number">62</span> <span class="token number">2</span> <span class="token number">32</span> <span class="token number">3</span> <span class="token number">54</span> <span class="token number">4</span> <span class="token number">93</span> <span class="token number">5</span> <span class="token number">59</span> <span class="token number">6</span> <span class="token number">8</span> <span class="token number">7</span> <span class="token number">24</span> <span class="token number">8</span> <span class="token number">86</span> <span class="token number">9</span> <span class="token number">66</span> <span class="token number">0</span> <span class="token number">23</span> <span class="token number">1</span> <span class="token number">34</span> <span class="token number">2</span> <span class="token number">89</span> <span class="token number">3</span> <span class="token number">66</span> <span class="token number">4</span> <span class="token number">10</span> <span class="token number">5</span> <span class="token number">48</span> <span class="token number">6</span> <span class="token number">27</span> <span class="token number">7</span> <span class="token number">11</span> <span class="token number">8</span> <span class="token number">94</span> <span class="token number">9</span> <span class="token number">45</span> <span class="token number">0</span> <span class="token number">81</span> <span class="token number">1</span> <span class="token number">57</span> <span class="token number">2</span> <span class="token number">35</span> <span class="token number">3</span> <span class="token number">78</span> <span class="token number">4</span> <span class="token number">23</span> <span class="token number">5</span> <span class="token number">66</span> <span class="token number">6</span> <span class="token number">1</span> <span class="token number">7</span> <span class="token number">3</span> <span class="token number">8</span> <span class="token number">77</span> <span class="token number">9</span> <span class="token number">14</span> <span class="token number">0</span> <span class="token number">72</span> <span class="token number">1</span> <span class="token number">47</span> <span class="token number">2</span> <span class="token number">75</span> <span class="token number">3</span> <span class="token number">27</span> <span class="token number">4</span> <span class="token number">66</span> <span class="token number">5</span> <span class="token number">64</span> <span class="token number">6</span> <span class="token number">30</span> <span class="token number">7</span> <span class="token number">49</span> <span class="token number">8</span> <span class="token number">42</span> <span class="token number">9</span> <span class="token number">7</span> <span class="token number">0</span> <span class="token number">10</span> <span class="token number">1</span> <span class="token number">15</span> <span class="token number">2</span> <span class="token number">26</span> <span class="token number">3</span> <span class="token number">12</span> <span class="token number">4</span> <span class="token number">98</span> <span class="token number">5</span> <span class="token number">12</span> <span class="token number">6</span> <span class="token number">53</span> <span class="token number">7</span> <span class="token number">81</span> <span class="token number">8</span> <span class="token number">46</span> <span class="token number">9</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">47</span> <span class="token number">1</span> <span class="token number">54</span> <span class="token number">2</span> <span class="token number">58</span> <span class="token number">3</span> <span class="token number">73</span> <span class="token number">4</span> <span class="token number">44</span> <span class="token number">5</span> <span class="token number">87</span> <span class="token number">6</span> <span class="token number">87</span> <span class="token number">7</span> <span class="token number">98</span> <span class="token number">8</span> <span class="token number">34</span> <span class="token number">9</span> <span class="token number">15</span> <span class="token number">0</span> <span class="token number">13</span> <span class="token number">1</span> <span class="token number">27</span> <span class="token number">2</span> <span class="token number">29</span> <span class="token number">3</span> <span class="token number">85</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">5</span> <span class="token number">64</span> <span class="token number">6</span> <span class="token number">62</span> <span class="token number">7</span> <span class="token number">62</span> <span class="token number">8</span> <span class="token number">79</span> <span class="token number">9</span> <span class="token number">74</span> <span class="token number">0</span> <span class="token number">49</span> <span class="token number">1</span> <span class="token number">57</span> <span class="token number">2</span> <span class="token number">24</span> <span class="token number">3</span> <span class="token number">44</span> <span class="token number">4</span> <span class="token number">18</span> <span class="token number">5</span> <span class="token number">97</span> <span class="token number">6</span> <span class="token number">59</span> <span class="token number">7</span> <span class="token number">75</span> <span class="token number">8</span> <span class="token number">17</span> <span class="token number">9</span> <span class="token number">22</span> <span class="token number">0</span> <span class="token number">50</span> <span class="token number">1</span> <span class="token number">11</span> <span class="token number">2</span> <span class="token number">93</span> <span class="token number">3</span> <span class="token number">53</span> <span class="token number">4</span> <span class="token number">52</span> <span class="token number">5</span> <span class="token number">13</span> <span class="token number">6</span> <span class="token number">51</span> <span class="token number">7</span> <span class="token number">76</span> <span class="token number">8</span> <span class="token number">87</span> <span class="token number">9</span> <span class="token number">95</span> <span class="token number">0</span> <span class="token number">99</span> <span class="token number">1</span> <span class="token number">87</span> <span class="token number">2</span> <span class="token number">85</span> <span class="token number">3</span> <span class="token number">9</span> <span class="token number">4</span> <span class="token number">87</span> <span class="token number">5</span> <span class="token number">98</span> <span class="token number">6</span> <span class="token number">34</span> <span class="token number">7</span> <span class="token number">22</span> <span class="token number">8</span> <span class="token number">66</span> <span class="token number">9</span> <span class="token number">11</span> <span class="token number">0</span> <span class="token number">7</span> <span class="token number">1</span> <span class="token number">8</span> <span class="token number">2</span> <span class="token number">90</span> <span class="token number">3</span> <span class="token number">95</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">5</span> <span class="token number">79</span> <span class="token number">6</span> <span class="token number">70</span> <span class="token number">7</span> <span class="token number">79</span> <span class="token number">8</span> <span class="token number">6</span> <span class="token number">9</span> <span class="token number">58</span> <span class="token number">0</span> <span class="token number">48</span> <span class="token number">1</span> <span class="token number">100</span> <span class="token number">2</span> <span class="token number">74</span> <span class="token number">3</span> <span class="token number">60</span> <span class="token number">4</span> <span class="token number">74</span> <span class="token number">5</span> <span class="token number">19</span> <span class="token number">6</span> <span class="token number">21</span> <span class="token number">7</span> <span class="token number">6</span> <span class="token number">8</span> <span class="token number">77</span> <span class="token number">9</span> <span class="token number">84</span> <span class="token number">0</span> <span class="token number">96</span> <span class="token number">1</span> <span class="token number">86</span> <span class="token number">2</span> <span class="token number">19</span> <span class="token number">3</span> <span class="token number">15</span> <span class="token number">4</span> <span class="token number">45</span> <span class="token number">5</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token number">90</span> <span class="token number">7</span> <span class="token number">49</span> <span class="token number">8</span> <span class="token number">98</span> <span class="token number">9</span> <span class="token number">80</span> <span class="token number">0</span> <span class="token number">68</span> <span class="token number">1</span> <span class="token number">73</span> <span class="token number">2</span> <span class="token number">55</span> <span class="token number">3</span> <span class="token number">13</span> <span class="token number">4</span> <span class="token number">28</span> <span class="token number">5</span> <span class="token number">16</span> <span class="token number">6</span> <span class="token number">57</span> <span class="token number">7</span> <span class="token number">20</span> <span class="token number">8</span> <span class="token number">76</span> <span class="token number">9</span> <span class="token number">71</span> <span class="token number">0</span> <span class="token number">53</span> <span class="token number">1</span> <span class="token number">38</span> <span class="token number">2</span> <span class="token number">4</span> <span class="token number">3</span> <span class="token number">43</span> <span class="token number">4</span> <span class="token number">11</span> <span class="token number">5</span> <span class="token number">49</span> <span class="token number">6</span> <span class="token number">12</span> <span class="token number">7</span> <span class="token number">91</span> <span class="token number">8</span> <span class="token number">47</span> <span class="token number">9</span> <span class="token number">3</span> <span class="token number">0</span> <span class="token number">57</span> <span class="token number">1</span> <span class="token number">13</span> <span class="token number">2</span> <span class="token number">12</span> <span class="token number">3</span> <span class="token number">12</span> <span class="token number">4</span> <span class="token number">21</span> <span class="token number">5</span> <span class="token number">68</span> <span class="token number">6</span> <span class="token number">2</span> <span class="token number">7</span> <span class="token number">80</span> <span class="token number">8</span> <span class="token number">9</span> <span class="token number">9</span> <span class="token number">28</span> <span class="token number">0</span> <span class="token number">37</span> <span class="token number">1</span> <span class="token number">79</span> <span class="token number">2</span> <span class="token number">92</span> <span class="token number">3</span> <span class="token number">35</span> <span class="token number">4</span> <span class="token number">63</span> <span class="token number">5</span> <span class="token number">13</span> <span class="token number">6</span> <span class="token number">58</span> <span class="token number">7</span> <span class="token number">36</span> <span class="token number">8</span> <span class="token number">65</span> <span class="token number">9</span> <span class="token number">94</span> <span class="token number">0</span> <span class="token number">39</span> <span class="token number">1</span> <span class="token number">49</span> <span class="token number">2</span> <span class="token number">57</span> <span class="token number">3</span> <span class="token number">23</span> <span class="token number">4</span> <span class="token number">53</span> <span class="token number">5</span> <span class="token number">80</span> <span class="token number">6</span> <span class="token number">42</span> <span class="token number">7</span> <span class="token number">29</span> <span class="token number">8</span> <span class="token number">52</span> <span class="token number">9</span> <span class="token number">33</span> <span class="token number">0</span> <span class="token number">36</span> <span class="token number">1</span> <span class="token number">54</span> <span class="token number">2</span> <span class="token number">59</span> <span class="token number">3</span> <span class="token number">69</span> <span class="token number">4</span> <span class="token number">62</span> <span class="token number">5</span> <span class="token number">12</span> <span class="token number">6</span> <span class="token number">77</span> <span class="token number">7</span> <span class="token number">37</span> <span class="token number">8</span> <span class="token number">87</span> <span class="token number">9</span> <span class="token number">47</span> <span class="token number">0</span> <span class="token number">63</span> <span class="token number">1</span> <span class="token number">35</span> <span class="token number">2</span> <span class="token number">26</span> <span class="token number">3</span> <span class="token number">38</span> <span class="token number">4</span> <span class="token number">47</span> <span class="token number">5</span> <span class="token number">82</span> <span class="token number">6</span> <span class="token number">89</span> <span class="token number">7</span> <span class="token number">34</span> <span class="token number">8</span> <span class="token number">1</span> <span class="token number">9</span> <span class="token number">93</span> <span class="token number">0</span> <span class="token number">60</span> <span class="token number">1</span> <span class="token number">28</span> <span class="token number">2</span> <span class="token number">1</span> <span class="token number">3</span> <span class="token number">51</span> <span class="token number">4</span> <span class="token number">94</span> <span class="token number">5</span> <span class="token number">86</span> <span class="token number">6</span> <span class="token number">42</span> <span class="token number">7</span> <span class="token number">75</span> <span class="token number">8</span> <span class="token number">76</span> <span class="token number">9</span> <span class="token number">77</span> <span class="token number">0</span> <span class="token number">2</span> <span class="token number">1</span> <span class="token number">51</span> <span class="token number">2</span> <span class="token number">79</span> <span class="token number">3</span> <span class="token number">74</span> <span class="token number">4</span> <span class="token number">51</span> <span class="token number">5</span> <span class="token number">28</span> <span class="token number">6</span> <span class="token number">78</span> <span class="token number">7</span> <span class="token number">87</span> <span class="token number">8</span> <span class="token number">81</span> <span class="token number">9</span> <span class="token number">35</span> <span class="token number">0</span> <span class="token number">45</span> <span class="token number">1</span> <span class="token number">94</span> <span class="token number">2</span> <span class="token number">42</span> <span class="token number">3</span> <span class="token number">9</span> <span class="token number">4</span> <span class="token number">70</span> <span class="token number">5</span> <span class="token number">4</span> <span class="token number">6</span> <span class="token number">52</span> <span class="token number">7</span> <span class="token number">54</span> <span class="token number">8</span> <span class="token number">16</span> <span class="token number">9</span> <span class="token number">27</span></code></pre><p>由于计算最大流程时间的时间过久，所以此时 N&#x3D;5（种群规模为5），T&#x3D;2（迭代次数2次）</p><p>迭代100次最终值为：2394</p><p><img src="https://img-blog.csdnimg.cn/ea70c770767a4076b32e46b3b9dd919c.png"><br><img src="https://img-blog.csdnimg.cn/5d27f57a1283404e9f9436db7fef4ca3.png"></p><h3 id="rec31-txt"><a href="#rec31-txt" class="headerlink" title="rec31.txt"></a>rec31.txt</h3><h4 id="数据-4"><a href="#数据-4" class="headerlink" title="数据"></a>数据</h4><pre class=" language-python"><code class="language-python"> <span class="token number">50</span> <span class="token number">10</span> <span class="token number">0</span> <span class="token number">59</span> <span class="token number">1</span> <span class="token number">47</span> <span class="token number">2</span> <span class="token number">20</span> <span class="token number">3</span> <span class="token number">43</span> <span class="token number">4</span> <span class="token number">49</span> <span class="token number">5</span> <span class="token number">74</span> <span class="token number">6</span> <span class="token number">38</span> <span class="token number">7</span> <span class="token number">46</span> <span class="token number">8</span> <span class="token number">18</span> <span class="token number">9</span> <span class="token number">12</span> <span class="token number">0</span> <span class="token number">30</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">90</span> <span class="token number">3</span> <span class="token number">97</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">5</span> <span class="token number">70</span> <span class="token number">6</span> <span class="token number">59</span> <span class="token number">7</span> <span class="token number">63</span> <span class="token number">8</span> <span class="token number">15</span> <span class="token number">9</span> <span class="token number">93</span> <span class="token number">0</span> <span class="token number">22</span> <span class="token number">1</span> <span class="token number">58</span> <span class="token number">2</span> <span class="token number">68</span> <span class="token number">3</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">33</span> <span class="token number">5</span> <span class="token number">48</span> <span class="token number">6</span> <span class="token number">27</span> <span class="token number">7</span> <span class="token number">12</span> <span class="token number">8</span> <span class="token number">65</span> <span class="token number">9</span> <span class="token number">21</span> <span class="token number">0</span> <span class="token number">70</span> <span class="token number">1</span> <span class="token number">81</span> <span class="token number">2</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">32</span> <span class="token number">4</span> <span class="token number">72</span> <span class="token number">5</span> <span class="token number">57</span> <span class="token number">6</span> <span class="token number">32</span> <span class="token number">7</span> <span class="token number">25</span> <span class="token number">8</span> <span class="token number">13</span> <span class="token number">9</span> <span class="token number">87</span> <span class="token number">0</span> <span class="token number">38</span> <span class="token number">1</span> <span class="token number">17</span> <span class="token number">2</span> <span class="token number">48</span> <span class="token number">3</span> <span class="token number">53</span> <span class="token number">4</span> <span class="token number">57</span> <span class="token number">5</span> <span class="token number">17</span> <span class="token number">6</span> <span class="token number">25</span> <span class="token number">7</span> <span class="token number">50</span> <span class="token number">8</span> <span class="token number">72</span> <span class="token number">9</span> <span class="token number">72</span> <span class="token number">0</span> <span class="token number">51</span> <span class="token number">1</span> <span class="token number">15</span> <span class="token number">2</span> <span class="token number">72</span> <span class="token number">3</span> <span class="token number">8</span> <span class="token number">4</span> <span class="token number">34</span> <span class="token number">5</span> <span class="token number">90</span> <span class="token number">6</span> <span class="token number">40</span> <span class="token number">7</span> <span class="token number">44</span> <span class="token number">8</span> <span class="token number">47</span> <span class="token number">9</span> <span class="token number">77</span> <span class="token number">0</span> <span class="token number">63</span> <span class="token number">1</span> <span class="token number">84</span> <span class="token number">2</span> <span class="token number">75</span> <span class="token number">3</span> <span class="token number">75</span> <span class="token number">4</span> <span class="token number">71</span> <span class="token number">5</span> <span class="token number">13</span> <span class="token number">6</span> <span class="token number">10</span> <span class="token number">7</span> <span class="token number">97</span> <span class="token number">8</span> <span class="token number">81</span> <span class="token number">9</span> <span class="token number">31</span> <span class="token number">0</span> <span class="token number">48</span> <span class="token number">1</span> <span class="token number">62</span> <span class="token number">2</span> <span class="token number">71</span> <span class="token number">3</span> <span class="token number">70</span> <span class="token number">4</span> <span class="token number">6</span> <span class="token number">5</span> <span class="token number">94</span> <span class="token number">6</span> <span class="token number">10</span> <span class="token number">7</span> <span class="token number">71</span> <span class="token number">8</span> <span class="token number">29</span> <span class="token number">9</span> <span class="token number">99</span> <span class="token number">0</span> <span class="token number">92</span> <span class="token number">1</span> <span class="token number">29</span> <span class="token number">2</span> <span class="token number">91</span> <span class="token number">3</span> <span class="token number">99</span> <span class="token number">4</span> <span class="token number">54</span> <span class="token number">5</span> <span class="token number">64</span> <span class="token number">6</span> <span class="token number">89</span> <span class="token number">7</span> <span class="token number">89</span> <span class="token number">8</span> <span class="token number">38</span> <span class="token number">9</span> <span class="token number">87</span> <span class="token number">0</span> <span class="token number">91</span> <span class="token number">1</span> <span class="token number">21</span> <span class="token number">2</span> <span class="token number">56</span> <span class="token number">3</span> <span class="token number">49</span> <span class="token number">4</span> <span class="token number">43</span> <span class="token number">5</span> <span class="token number">20</span> <span class="token number">6</span> <span class="token number">27</span> <span class="token number">7</span> <span class="token number">68</span> <span class="token number">8</span> <span class="token number">99</span> <span class="token number">9</span> <span class="token number">73</span> <span class="token number">0</span> <span class="token number">62</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">3</span> <span class="token number">89</span> <span class="token number">4</span> <span class="token number">48</span> <span class="token number">5</span> <span class="token number">97</span> <span class="token number">6</span> <span class="token number">79</span> <span class="token number">7</span> <span class="token number">21</span> <span class="token number">8</span> <span class="token number">96</span> <span class="token number">9</span> <span class="token number">77</span> <span class="token number">0</span> <span class="token number">67</span> <span class="token number">1</span> <span class="token number">83</span> <span class="token number">2</span> <span class="token number">70</span> <span class="token number">3</span> <span class="token number">49</span> <span class="token number">4</span> <span class="token number">50</span> <span class="token number">5</span> <span class="token number">50</span> <span class="token number">6</span> <span class="token number">60</span> <span class="token number">7</span> <span class="token number">28</span> <span class="token number">8</span> <span class="token number">15</span> <span class="token number">9</span> <span class="token number">50</span> <span class="token number">0</span> <span class="token number">73</span> <span class="token number">1</span> <span class="token number">18</span> <span class="token number">2</span> <span class="token number">55</span> <span class="token number">3</span> <span class="token number">49</span> <span class="token number">4</span> <span class="token number">66</span> <span class="token number">5</span> <span class="token number">56</span> <span class="token number">6</span> <span class="token number">90</span> <span class="token number">7</span> <span class="token number">29</span> <span class="token number">8</span> <span class="token number">87</span> <span class="token number">9</span> <span class="token number">4</span> <span class="token number">0</span> <span class="token number">27</span> <span class="token number">1</span> <span class="token number">94</span> <span class="token number">2</span> <span class="token number">71</span> <span class="token number">3</span> <span class="token number">33</span> <span class="token number">4</span> <span class="token number">31</span> <span class="token number">5</span> <span class="token number">68</span> <span class="token number">6</span> <span class="token number">45</span> <span class="token number">7</span> <span class="token number">52</span> <span class="token number">8</span> <span class="token number">95</span> <span class="token number">9</span> <span class="token number">40</span> <span class="token number">0</span> <span class="token number">48</span> <span class="token number">1</span> <span class="token number">28</span> <span class="token number">2</span> <span class="token number">46</span> <span class="token number">3</span> <span class="token number">73</span> <span class="token number">4</span> <span class="token number">89</span> <span class="token number">5</span> <span class="token number">35</span> <span class="token number">6</span> <span class="token number">98</span> <span class="token number">7</span> <span class="token number">97</span> <span class="token number">8</span> <span class="token number">67</span> <span class="token number">9</span> <span class="token number">9</span> <span class="token number">0</span> <span class="token number">7</span> <span class="token number">1</span> <span class="token number">51</span> <span class="token number">2</span> <span class="token number">48</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">4</span> <span class="token number">29</span> <span class="token number">5</span> <span class="token number">62</span> <span class="token number">6</span> <span class="token number">37</span> <span class="token number">7</span> <span class="token number">15</span> <span class="token number">8</span> <span class="token number">10</span> <span class="token number">9</span> <span class="token number">66</span> <span class="token number">0</span> <span class="token number">55</span> <span class="token number">1</span> <span class="token number">46</span> <span class="token number">2</span> <span class="token number">65</span> <span class="token number">3</span> <span class="token number">48</span> <span class="token number">4</span> <span class="token number">61</span> <span class="token number">5</span> <span class="token number">36</span> <span class="token number">6</span> <span class="token number">69</span> <span class="token number">7</span> <span class="token number">14</span> <span class="token number">8</span> <span class="token number">78</span> <span class="token number">9</span> <span class="token number">100</span> <span class="token number">0</span> <span class="token number">4</span> <span class="token number">1</span> <span class="token number">4</span> <span class="token number">2</span> <span class="token number">31</span> <span class="token number">3</span> <span class="token number">49</span> <span class="token number">4</span> <span class="token number">28</span> <span class="token number">5</span> <span class="token number">78</span> <span class="token number">6</span> <span class="token number">73</span> <span class="token number">7</span> <span class="token number">26</span> <span class="token number">8</span> <span class="token number">29</span> <span class="token number">9</span> <span class="token number">26</span> <span class="token number">0</span> <span class="token number">19</span> <span class="token number">1</span> <span class="token number">97</span> <span class="token number">2</span> <span class="token number">37</span> <span class="token number">3</span> <span class="token number">30</span> <span class="token number">4</span> <span class="token number">37</span> <span class="token number">5</span> <span class="token number">16</span> <span class="token number">6</span> <span class="token number">15</span> <span class="token number">7</span> <span class="token number">89</span> <span class="token number">8</span> <span class="token number">11</span> <span class="token number">9</span> <span class="token number">16</span> <span class="token number">0</span> <span class="token number">30</span> <span class="token number">1</span> <span class="token number">95</span> <span class="token number">2</span> <span class="token number">86</span> <span class="token number">3</span> <span class="token number">22</span> <span class="token number">4</span> <span class="token number">17</span> <span class="token number">5</span> <span class="token number">16</span> <span class="token number">6</span> <span class="token number">61</span> <span class="token number">7</span> <span class="token number">79</span> <span class="token number">8</span> <span class="token number">24</span> <span class="token number">9</span> <span class="token number">9</span> <span class="token number">0</span> <span class="token number">71</span> <span class="token number">1</span> <span class="token number">39</span> <span class="token number">2</span> <span class="token number">93</span> <span class="token number">3</span> <span class="token number">87</span> <span class="token number">4</span> <span class="token number">38</span> <span class="token number">5</span> <span class="token number">7</span> <span class="token number">6</span> <span class="token number">24</span> <span class="token number">7</span> <span class="token number">1</span> <span class="token number">8</span> <span class="token number">91</span> <span class="token number">9</span> <span class="token number">34</span> <span class="token number">0</span> <span class="token number">83</span> <span class="token number">1</span> <span class="token number">40</span> <span class="token number">2</span> <span class="token number">37</span> <span class="token number">3</span> <span class="token number">25</span> <span class="token number">4</span> <span class="token number">68</span> <span class="token number">5</span> <span class="token number">47</span> <span class="token number">6</span> <span class="token number">81</span> <span class="token number">7</span> <span class="token number">62</span> <span class="token number">8</span> <span class="token number">96</span> <span class="token number">9</span> <span class="token number">19</span> <span class="token number">0</span> <span class="token number">45</span> <span class="token number">1</span> <span class="token number">33</span> <span class="token number">2</span> <span class="token number">12</span> <span class="token number">3</span> <span class="token number">63</span> <span class="token number">4</span> <span class="token number">32</span> <span class="token number">5</span> <span class="token number">40</span> <span class="token number">6</span> <span class="token number">60</span> <span class="token number">7</span> <span class="token number">54</span> <span class="token number">8</span> <span class="token number">66</span> <span class="token number">9</span> <span class="token number">92</span> <span class="token number">0</span> <span class="token number">40</span> <span class="token number">1</span> <span class="token number">67</span> <span class="token number">2</span> <span class="token number">83</span> <span class="token number">3</span> <span class="token number">11</span> <span class="token number">4</span> <span class="token number">62</span> <span class="token number">5</span> <span class="token number">69</span> <span class="token number">6</span> <span class="token number">46</span> <span class="token number">7</span> <span class="token number">93</span> <span class="token number">8</span> <span class="token number">80</span> <span class="token number">9</span> <span class="token number">50</span> <span class="token number">0</span> <span class="token number">100</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token number">2</span> <span class="token number">82</span> <span class="token number">3</span> <span class="token number">78</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">5</span> <span class="token number">43</span> <span class="token number">6</span> <span class="token number">18</span> <span class="token number">7</span> <span class="token number">73</span> <span class="token number">8</span> <span class="token number">86</span> <span class="token number">9</span> <span class="token number">62</span> <span class="token number">0</span> <span class="token number">97</span> <span class="token number">1</span> <span class="token number">75</span> <span class="token number">2</span> <span class="token number">81</span> <span class="token number">3</span> <span class="token number">22</span> <span class="token number">4</span> <span class="token number">38</span> <span class="token number">5</span> <span class="token number">2</span> <span class="token number">6</span> <span class="token number">53</span> <span class="token number">7</span> <span class="token number">44</span> <span class="token number">8</span> <span class="token number">73</span> <span class="token number">9</span> <span class="token number">74</span> <span class="token number">0</span> <span class="token number">74</span> <span class="token number">1</span> <span class="token number">89</span> <span class="token number">2</span> <span class="token number">14</span> <span class="token number">3</span> <span class="token number">33</span> <span class="token number">4</span> <span class="token number">11</span> <span class="token number">5</span> <span class="token number">43</span> <span class="token number">6</span> <span class="token number">70</span> <span class="token number">7</span> <span class="token number">58</span> <span class="token number">8</span> <span class="token number">47</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">0</span> <span class="token number">73</span> <span class="token number">1</span> <span class="token number">46</span> <span class="token number">2</span> <span class="token number">62</span> <span class="token number">3</span> <span class="token number">27</span> <span class="token number">4</span> <span class="token number">63</span> <span class="token number">5</span> <span class="token number">34</span> <span class="token number">6</span> <span class="token number">58</span> <span class="token number">7</span> <span class="token number">91</span> <span class="token number">8</span> <span class="token number">11</span> <span class="token number">9</span> <span class="token number">80</span> <span class="token number">0</span> <span class="token number">14</span> <span class="token number">1</span> <span class="token number">24</span> <span class="token number">2</span> <span class="token number">27</span> <span class="token number">3</span> <span class="token number">62</span> <span class="token number">4</span> <span class="token number">72</span> <span class="token number">5</span> <span class="token number">85</span> <span class="token number">6</span> <span class="token number">98</span> <span class="token number">7</span> <span class="token number">99</span> <span class="token number">8</span> <span class="token number">25</span> <span class="token number">9</span> <span class="token number">7</span> <span class="token number">0</span> <span class="token number">100</span> <span class="token number">1</span> <span class="token number">29</span> <span class="token number">2</span> <span class="token number">8</span> <span class="token number">3</span> <span class="token number">55</span> <span class="token number">4</span> <span class="token number">88</span> <span class="token number">5</span> <span class="token number">96</span> <span class="token number">6</span> <span class="token number">23</span> <span class="token number">7</span> <span class="token number">98</span> <span class="token number">8</span> <span class="token number">19</span> <span class="token number">9</span> <span class="token number">79</span> <span class="token number">0</span> <span class="token number">53</span> <span class="token number">1</span> <span class="token number">11</span> <span class="token number">2</span> <span class="token number">74</span> <span class="token number">3</span> <span class="token number">66</span> <span class="token number">4</span> <span class="token number">94</span> <span class="token number">5</span> <span class="token number">66</span> <span class="token number">6</span> <span class="token number">98</span> <span class="token number">7</span> <span class="token number">87</span> <span class="token number">8</span> <span class="token number">5</span> <span class="token number">9</span> <span class="token number">85</span> <span class="token number">0</span> <span class="token number">68</span> <span class="token number">1</span> <span class="token number">77</span> <span class="token number">2</span> <span class="token number">88</span> <span class="token number">3</span> <span class="token number">47</span> <span class="token number">4</span> <span class="token number">51</span> <span class="token number">5</span> <span class="token number">73</span> <span class="token number">6</span> <span class="token number">16</span> <span class="token number">7</span> <span class="token number">17</span> <span class="token number">8</span> <span class="token number">87</span> <span class="token number">9</span> <span class="token number">96</span> <span class="token number">0</span> <span class="token number">69</span> <span class="token number">1</span> <span class="token number">40</span> <span class="token number">2</span> <span class="token number">46</span> <span class="token number">3</span> <span class="token number">62</span> <span class="token number">4</span> <span class="token number">23</span> <span class="token number">5</span> <span class="token number">31</span> <span class="token number">6</span> <span class="token number">45</span> <span class="token number">7</span> <span class="token number">21</span> <span class="token number">8</span> <span class="token number">15</span> <span class="token number">9</span> <span class="token number">40</span> <span class="token number">0</span> <span class="token number">34</span> <span class="token number">1</span> <span class="token number">41</span> <span class="token number">2</span> <span class="token number">10</span> <span class="token number">3</span> <span class="token number">17</span> <span class="token number">4</span> <span class="token number">25</span> <span class="token number">5</span> <span class="token number">33</span> <span class="token number">6</span> <span class="token number">17</span> <span class="token number">7</span> <span class="token number">28</span> <span class="token number">8</span> <span class="token number">45</span> <span class="token number">9</span> <span class="token number">68</span> <span class="token number">0</span> <span class="token number">7</span> <span class="token number">1</span> <span class="token number">26</span> <span class="token number">2</span> <span class="token number">79</span> <span class="token number">3</span> <span class="token number">76</span> <span class="token number">4</span> <span class="token number">35</span> <span class="token number">5</span> <span class="token number">92</span> <span class="token number">6</span> <span class="token number">77</span> <span class="token number">7</span> <span class="token number">15</span> <span class="token number">8</span> <span class="token number">27</span> <span class="token number">9</span> <span class="token number">69</span> <span class="token number">0</span> <span class="token number">47</span> <span class="token number">1</span> <span class="token number">31</span> <span class="token number">2</span> <span class="token number">83</span> <span class="token number">3</span> <span class="token number">28</span> <span class="token number">4</span> <span class="token number">92</span> <span class="token number">5</span> <span class="token number">83</span> <span class="token number">6</span> <span class="token number">96</span> <span class="token number">7</span> <span class="token number">18</span> <span class="token number">8</span> <span class="token number">84</span> <span class="token number">9</span> <span class="token number">45</span> <span class="token number">0</span> <span class="token number">54</span> <span class="token number">1</span> <span class="token number">96</span> <span class="token number">2</span> <span class="token number">8</span> <span class="token number">3</span> <span class="token number">28</span> <span class="token number">4</span> <span class="token number">94</span> <span class="token number">5</span> <span class="token number">50</span> <span class="token number">6</span> <span class="token number">20</span> <span class="token number">7</span> <span class="token number">28</span> <span class="token number">8</span> <span class="token number">99</span> <span class="token number">9</span> <span class="token number">65</span> <span class="token number">0</span> <span class="token number">9</span> <span class="token number">1</span> <span class="token number">13</span> <span class="token number">2</span> <span class="token number">81</span> <span class="token number">3</span> <span class="token number">1</span> <span class="token number">4</span> <span class="token number">94</span> <span class="token number">5</span> <span class="token number">82</span> <span class="token number">6</span> <span class="token number">29</span> <span class="token number">7</span> <span class="token number">82</span> <span class="token number">8</span> <span class="token number">27</span> <span class="token number">9</span> <span class="token number">45</span> <span class="token number">0</span> <span class="token number">64</span> <span class="token number">1</span> <span class="token number">22</span> <span class="token number">2</span> <span class="token number">51</span> <span class="token number">3</span> <span class="token number">33</span> <span class="token number">4</span> <span class="token number">9</span> <span class="token number">5</span> <span class="token number">25</span> <span class="token number">6</span> <span class="token number">22</span> <span class="token number">7</span> <span class="token number">64</span> <span class="token number">8</span> <span class="token number">78</span> <span class="token number">9</span> <span class="token number">88</span> <span class="token number">0</span> <span class="token number">38</span> <span class="token number">1</span> <span class="token number">25</span> <span class="token number">2</span> <span class="token number">16</span> <span class="token number">3</span> <span class="token number">24</span> <span class="token number">4</span> <span class="token number">62</span> <span class="token number">5</span> <span class="token number">4</span> <span class="token number">6</span> <span class="token number">39</span> <span class="token number">7</span> <span class="token number">77</span> <span class="token number">8</span> <span class="token number">36</span> <span class="token number">9</span> <span class="token number">60</span> <span class="token number">0</span> <span class="token number">72</span> <span class="token number">1</span> <span class="token number">6</span> <span class="token number">2</span> <span class="token number">40</span> <span class="token number">3</span> <span class="token number">56</span> <span class="token number">4</span> <span class="token number">23</span> <span class="token number">5</span> <span class="token number">39</span> <span class="token number">6</span> <span class="token number">38</span> <span class="token number">7</span> <span class="token number">5</span> <span class="token number">8</span> <span class="token number">75</span> <span class="token number">9</span> <span class="token number">44</span> <span class="token number">0</span> <span class="token number">26</span> <span class="token number">1</span> <span class="token number">33</span> <span class="token number">2</span> <span class="token number">37</span> <span class="token number">3</span> <span class="token number">84</span> <span class="token number">4</span> <span class="token number">61</span> <span class="token number">5</span> <span class="token number">86</span> <span class="token number">6</span> <span class="token number">22</span> <span class="token number">7</span> <span class="token number">94</span> <span class="token number">8</span> <span class="token number">93</span> <span class="token number">9</span> <span class="token number">17</span> <span class="token number">0</span> <span class="token number">88</span> <span class="token number">1</span> <span class="token number">39</span> <span class="token number">2</span> <span class="token number">63</span> <span class="token number">3</span> <span class="token number">43</span> <span class="token number">4</span> <span class="token number">98</span> <span class="token number">5</span> <span class="token number">27</span> <span class="token number">6</span> <span class="token number">32</span> <span class="token number">7</span> <span class="token number">20</span> <span class="token number">8</span> <span class="token number">25</span> <span class="token number">9</span> <span class="token number">25</span> <span class="token number">0</span> <span class="token number">73</span> <span class="token number">1</span> <span class="token number">70</span> <span class="token number">2</span> <span class="token number">57</span> <span class="token number">3</span> <span class="token number">5</span> <span class="token number">4</span> <span class="token number">100</span> <span class="token number">5</span> <span class="token number">31</span> <span class="token number">6</span> <span class="token number">34</span> <span class="token number">7</span> <span class="token number">11</span> <span class="token number">8</span> <span class="token number">98</span> <span class="token number">9</span> <span class="token number">76</span> <span class="token number">0</span> <span class="token number">77</span> <span class="token number">1</span> <span class="token number">4</span> <span class="token number">2</span> <span class="token number">85</span> <span class="token number">3</span> <span class="token number">50</span> <span class="token number">4</span> <span class="token number">9</span> <span class="token number">5</span> <span class="token number">45</span> <span class="token number">6</span> <span class="token number">35</span> <span class="token number">7</span> <span class="token number">3</span> <span class="token number">8</span> <span class="token number">41</span> <span class="token number">9</span> <span class="token number">80</span> <span class="token number">0</span> <span class="token number">20</span> <span class="token number">1</span> <span class="token number">36</span> <span class="token number">2</span> <span class="token number">9</span> <span class="token number">3</span> <span class="token number">89</span> <span class="token number">4</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">32</span> <span class="token number">6</span> <span class="token number">76</span> <span class="token number">7</span> <span class="token number">20</span> <span class="token number">8</span> <span class="token number">84</span> <span class="token number">9</span> <span class="token number">6</span> <span class="token number">0</span> <span class="token number">99</span> <span class="token number">1</span> <span class="token number">64</span> <span class="token number">2</span> <span class="token number">7</span> <span class="token number">3</span> <span class="token number">68</span> <span class="token number">4</span> <span class="token number">67</span> <span class="token number">5</span> <span class="token number">85</span> <span class="token number">6</span> <span class="token number">60</span> <span class="token number">7</span> <span class="token number">23</span> <span class="token number">8</span> <span class="token number">55</span> <span class="token number">9</span> <span class="token number">52</span> <span class="token number">0</span> <span class="token number">13</span> <span class="token number">1</span> <span class="token number">7</span> <span class="token number">2</span> <span class="token number">80</span> <span class="token number">3</span> <span class="token number">57</span> <span class="token number">4</span> <span class="token number">22</span> <span class="token number">5</span> <span class="token number">78</span> <span class="token number">6</span> <span class="token number">75</span> <span class="token number">7</span> <span class="token number">17</span> <span class="token number">8</span> <span class="token number">70</span> <span class="token number">9</span> <span class="token number">55</span> <span class="token number">0</span> <span class="token number">40</span> <span class="token number">1</span> <span class="token number">87</span> <span class="token number">2</span> <span class="token number">34</span> <span class="token number">3</span> <span class="token number">96</span> <span class="token number">4</span> <span class="token number">27</span> <span class="token number">5</span> <span class="token number">78</span> <span class="token number">6</span> <span class="token number">53</span> <span class="token number">7</span> <span class="token number">40</span> <span class="token number">8</span> <span class="token number">72</span> <span class="token number">9</span> <span class="token number">91</span> <span class="token number">0</span> <span class="token number">77</span> <span class="token number">1</span> <span class="token number">8</span> <span class="token number">2</span> <span class="token number">14</span> <span class="token number">3</span> <span class="token number">76</span> <span class="token number">4</span> <span class="token number">19</span> <span class="token number">5</span> <span class="token number">82</span> <span class="token number">6</span> <span class="token number">86</span> <span class="token number">7</span> <span class="token number">21</span> <span class="token number">8</span> <span class="token number">10</span> <span class="token number">9</span> <span class="token number">51</span></code></pre><p>由于计算最大流程时间的时间过久，所以此时 N&#x3D;5（种群规模为5），T&#x3D;2（迭代次数2次）</p><h2 id="代码一些问题"><a href="#代码一些问题" class="headerlink" title="代码一些问题"></a>代码一些问题</h2><p>由于计算最大流程时间的时间过久，在处理 rec21.txt 和 rec31.txt 时改变了参数，N&#x3D;5（种群规模为5），T&#x3D;2（迭代次数2次）</p><h2 id="参考内容"><a href="#参考内容" class="headerlink" title="参考内容"></a>参考内容</h2><p><a href="https://blog.csdn.net/qq_44172732/article/details/109721303">代码参考</a></p><p><a href="https://www.bilibili.com/video/BV14a411C7s8/?spm_id_from=333.1007.top_right_bar_window_history.content.click&vd_source=cb11c14760da27e4b18bdfd115cbde31">遗传算法理论学习</a></p>]]></content>
      
      
      <categories>
          
          <category> 遗传算法GA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 遗传算法GA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>anylogic 学习（3）—— 智能体相关操作</title>
      <link href="/2022/11/28/anylogic-xue-xi-3-zhi-neng-ti-xiang-guan-cao-zuo/"/>
      <url>/2022/11/28/anylogic-xue-xi-3-zhi-neng-ti-xiang-guan-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="anylogic-学习（3）——-智能体相关操作"><a href="#anylogic-学习（3）——-智能体相关操作" class="headerlink" title="anylogic 学习（3）—— 智能体相关操作"></a>anylogic 学习（3）—— 智能体相关操作</h1><h2 id="利用智能体盖十层高的楼"><a href="#利用智能体盖十层高的楼" class="headerlink" title="利用智能体盖十层高的楼"></a>利用智能体盖十层高的楼</h2><p>简单来说，想到盖十层高的楼，第一反应就是一层一层往上盖楼，直到有十层高的楼。<br>但实际上可以通过智能体群的操作实现盖十层楼的操作。<img src="https://img-blog.csdnimg.cn/1145704d565f4c3c88b902d5fff43e80.gif"></p><h2 id="上下楼模型的另一种实现方式"><a href="#上下楼模型的另一种实现方式" class="headerlink" title="上下楼模型的另一种实现方式"></a>上下楼模型的另一种实现方式</h2><p>在搭建十层楼的模型的操作中，我们发现智能体除了作为 source 被调用之外，还可以之间在 main 图层运行中直接显示——<strong>可以理解为在 anylogic 中运行主文件是 main，智能体可以理解为运行主文件时调用的其他文件</strong>。所以我们在实现上下楼的模型就可以就第一层和第二层的模型建立两个智能体最后将智能体“映射”到main 窗口中。这样做的好处就是可以避免第一二次层放在一起而造成建模时因为重合难以操作或造成覆盖。</p><h3 id="第一层"><a href="#第一层" class="headerlink" title="第一层"></a>第一层</h3><p><img src="https://img-blog.csdnimg.cn/9b42f2cf8dc94c64b360612dac540c1e.png"></p><h3 id="第二层以及最后运营结果"><a href="#第二层以及最后运营结果" class="headerlink" title="第二层以及最后运营结果"></a>第二层以及最后运营结果</h3><p><img src="https://img-blog.csdnimg.cn/7d2830ab9ce24c448481318273bc6716.gif"></p><h3 id="模型中代码解释"><a href="#模型中代码解释" class="headerlink" title="模型中代码解释"></a>模型中代码解释</h3><h5 id="main-secondFloor-enter-take-agent-："><a href="#main-secondFloor-enter-take-agent-：" class="headerlink" title="main.secondFloor.enter.take(agent);："></a><code>main.secondFloor.enter.take(agent);</code>：</h5><p>代码位置： 代码位置在 <code>firstfloor中的 exit</code><br>解释： 可以简单的理解为智能体从 <code>exit</code>中离开该流程，并且离开的智能体从 <code>main.secondFloor.enter</code>中进入<br>注意：由于 <code>firstfloor</code>和 <code>secondFloor</code>处于同一级别，都在 <code>main</code>下，并不能直接调用enter（或者说 <code>secondFloor</code>），可以理解为调用 enter 时，要返回 enter 的绝对路径——<code>main.secondFloor.enter</code>。</p><h5 id="viewArea-navigateTo"><a href="#viewArea-navigateTo" class="headerlink" title="viewArea.navigateTo();"></a><code>viewArea.navigateTo();</code></h5><p>代码位置：代码位置在 <code>mian</code>中的<code>“启动时”</code><br>代码解释：<code>viewArea</code>是视图区域的变量名，<code>viewArea.navigateTo();</code>是指在运行至该阶段时（以该模型为例，是指<code>“模型启动时”</code>）该视图区域位于运行窗口的中心（聚焦处）</p>]]></content>
      
      
      <categories>
          
          <category> anylogic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> anylogic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>anylogic 学习（2）—— 简单行人库上楼模型</title>
      <link href="/2022/11/28/anylogic-xue-xi-2-jian-dan-xing-ren-ku-shang-lou-mo-xing/"/>
      <url>/2022/11/28/anylogic-xue-xi-2-jian-dan-xing-ren-ku-shang-lou-mo-xing/</url>
      
        <content type="html"><![CDATA[<h1 id="anylogic-学习（2）——-简单行人库上下楼模型"><a href="#anylogic-学习（2）——-简单行人库上下楼模型" class="headerlink" title="anylogic 学习（2）—— 简单行人库上下楼模型"></a>anylogic 学习（2）—— 简单行人库上下楼模型</h1><h2 id="行人库简单介绍"><a href="#行人库简单介绍" class="headerlink" title="行人库简单介绍"></a>行人库简单介绍</h2><p>顾名思义，行人库的使用肯定跟有人行动的模型有关，简单来说，比如说排队模型，车站、地铁模型，很显然跟行人库有关的模型出来考虑行人的动作，还需要注意建筑的模型，比如说建立一个地铁站的模型就需要考虑地铁站的上下楼情况。</p><h2 id="建立模型"><a href="#建立模型" class="headerlink" title="建立模型"></a>建立模型</h2><p><img src="https://img-blog.csdnimg.cn/c2b3e86f28b6407ba1b182f00d230472.png"></p><h2 id="一楼模型"><a href="#一楼模型" class="headerlink" title="一楼模型"></a>一楼模型</h2><p>考虑到 运行时观看 3D 视图，以及一些模型比如车站之类的需要针对建筑建模，这时候如果有墙存在，会影响到 3D 演示时的视角查看，所以在绘制围墙时一般修改围墙的透明度比如说修改为 100 。<br><img src="https://img-blog.csdnimg.cn/3a0a196e22a34019aa8c9994c08c25f0.gif"></p><h2 id="上下楼模型"><a href="#上下楼模型" class="headerlink" title="上下楼模型"></a>上下楼模型</h2><h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p><img src="https://img-blog.csdnimg.cn/6bef0b09d50b4b76b6541b77ddec68b7.gif"></p><h3 id="部分操作解释"><a href="#部分操作解释" class="headerlink" title="部分操作解释"></a>部分操作解释</h3><h4 id="level-层创建"><a href="#level-层创建" class="headerlink" title="level 层创建"></a>level 层创建</h4><p>如图，绘制一面实心颜色填充的墙，作为二楼的地板，将其 <code>Z-高度</code>设置为0，并且新建level层，新建成功的 <code>level1 层</code>相当于建筑的第二层——所以一些在二楼的空间标记，比如说目标线，在创建完成后也需要将层更改为 <code>level1 层</code>。<br><img src="https://img-blog.csdnimg.cn/fd42c654fa3349558914d5a655fe04c9.jpeg"><br><img src="https://img-blog.csdnimg.cn/5d447a944b34441fa7c8d11918f415fa.png"></p><h4 id="楼梯的建模"><a href="#楼梯的建模" class="headerlink" title="楼梯的建模"></a>楼梯的建模</h4><p>anylogic 可以使用 <code>矩形节点</code>来实现楼梯的建模。<br>步骤如下：</p><ol><li><p>创建矩形节点，在 <code>位置和大小</code>中选择<code>斜的</code>并勾选<br><img src="https://img-blog.csdnimg.cn/ebd1fecae171463eb65843aae80e2ab8.png"></p></li><li><p>此时选择矩形节点的 <code>吸引子</code>，选择该斜面是按照角度上升还是直接定义上升的高度</p></li></ol><p><img src="https://img-blog.csdnimg.cn/dea9ee864a324a44a5144fc80483bc9d.png"></p><h4 id="楼梯的逻辑流程图"><a href="#楼梯的逻辑流程图" class="headerlink" title="楼梯的逻辑流程图"></a>楼梯的逻辑流程图</h4><p>上下楼使用的模块是行人改变楼层模块。<br><img src="https://img-blog.csdnimg.cn/6ab66daa57304afda01e7725c763a757.png"><br><code>当前层离开线</code>：以该模型为例，该目标线一定要是在 <code>level层</code>的目标线<br><code>新层进入线</code>：同理，该目标线一定要是在 <code>level1层</code>的目标线<br><code>另：两条线最好不要重合，很有可能会报错，我是这样的</code></p><h4 id="上楼注意事项"><a href="#上楼注意事项" class="headerlink" title="上楼注意事项"></a>上楼注意事项</h4><p><img src="https://img-blog.csdnimg.cn/fa590014a5c64296b043186da6c901fb.png"><br><code>该目标线一定要画，不然会出现行人虽然会出现在楼梯上楼但是会从楼梯中间悬浮而上的情况。</code><br><img src="https://img-blog.csdnimg.cn/375193ab564f433999be00caefdd07ce.gif"></p><h3 id="下楼梯和上楼梯类似"><a href="#下楼梯和上楼梯类似" class="headerlink" title="下楼梯和上楼梯类似"></a>下楼梯和上楼梯类似</h3><p><img src="https://img-blog.csdnimg.cn/a5ac07b296fd41b4abdedc0c84cc4da7.gif"></p>]]></content>
      
      
      <categories>
          
          <category> anylogic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> anylogic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>anylogic 学习（1）—— anylogic 简单介绍</title>
      <link href="/2022/11/28/anylogic-xue-xi-1-anylogic-jian-dan-jie-shao/"/>
      <url>/2022/11/28/anylogic-xue-xi-1-anylogic-jian-dan-jie-shao/</url>
      
        <content type="html"><![CDATA[<h1 id="anylogic-学习（1）——-anylogic-简单介绍"><a href="#anylogic-学习（1）——-anylogic-简单介绍" class="headerlink" title="anylogic 学习（1）—— anylogic 简单介绍"></a>anylogic 学习（1）—— anylogic 简单介绍</h1><h2 id="软件介绍"><a href="#软件介绍" class="headerlink" title="软件介绍"></a>软件介绍</h2><p>anylogic 作为一款仿真建模软件，允许用户通过逻辑流程图并且配合 JAVA 代码设计逻辑建立模型。作为一款仿真软件，anylogic 允许用户通过动画对建立的模型进行模拟，并且用户可以添加互动按键，如按键，滚动条，编辑区域等，使用户可以在模型仿真时进行操作。</p><h2 id="简单操作介绍，以行人库为例"><a href="#简单操作介绍，以行人库为例" class="headerlink" title="简单操作介绍，以行人库为例"></a>简单操作介绍，以行人库为例</h2><p>以行人进入接受服务然后离开这一流程为例</p><h3 id="界面语言更改"><a href="#界面语言更改" class="headerlink" title="界面语言更改"></a>界面语言更改</h3><p>路径：tools —— preferences<br><img src="https://img-blog.csdnimg.cn/293f77a2522b42adb3ceceb98e32cd1a.png"></p><h3 id="快捷键设置"><a href="#快捷键设置" class="headerlink" title="快捷键设置"></a>快捷键设置</h3><p>路径：工具（tools） —— 偏好 （preferences）<br><img src="https://img-blog.csdnimg.cn/666ff97d98334df29cddd7acda61b1a1.png"><br>注意：这里的 代码完成 类似于代码补全功能，这里的快捷键最好设置时要注意不要有按键冲突</p><h3 id="新建模型"><a href="#新建模型" class="headerlink" title="新建模型"></a>新建模型</h3><p>路径：文件 —— 新建 —— 模型<br><img src="https://img-blog.csdnimg.cn/19bbbfc1518f4be480091be43dea4446.png"><br>模型名字好像不可以是中文。<br>模型时间单位可以根据模型实际情况更改，比如说秒、分钟、时和天。<br>也可以在建立好模型后再更改，如图：<br><img src="https://img-blog.csdnimg.cn/93ffb0cf3409460b9a4776c6863a725c.png"><br>点击 “工程” 标签，点击 该模型 名字，比如说我点击的是 “CSDN1”，然后在 “属性” 标签更改 “模型时间单位”。<br>如果没有这些面板可以点击 “视图” 显示这些标签。</p><h3 id="模型建立和逻辑流程图"><a href="#模型建立和逻辑流程图" class="headerlink" title="模型建立和逻辑流程图"></a>模型建立和逻辑流程图</h3><h4 id="1-选择行人库"><a href="#1-选择行人库" class="headerlink" title="1. 选择行人库"></a>1. 选择行人库</h4><p><img src="https://img-blog.csdnimg.cn/f256d78ed82743bbb2665f174a590508.png"></p><h4 id="2-绘制操作"><a href="#2-绘制操作" class="headerlink" title="2. 绘制操作"></a>2. 绘制操作</h4><p>建立流程图时，可以直接拖拽 UI 图到绘制页面，也可以双击后面带有 “铅笔”图案的 UI 图，鼠标绘制，如图：<br><img src="https://img-blog.csdnimg.cn/0fce452af9054760a6ef3e8627131ae0.png"><br>以墙为例，双击进行绘制，单击形成节点（如开始），双击退出绘制。绘制完成后，也可以双击绘制完成的墙生成新的节点（类似于PS？）<br><img src="https://img-blog.csdnimg.cn/9750ad5cb3e64b9d9cac18828d2fa533.gif"></p><h4 id="3-绘制该模型流程图"><a href="#3-绘制该模型流程图" class="headerlink" title="3. 绘制该模型流程图"></a>3. 绘制该模型流程图</h4><p><img src="https://img-blog.csdnimg.cn/93ec7f58095941c48af844da2d2858f0.gif"><br>4. 逻辑流程图绘制<br><img src="https://img-blog.csdnimg.cn/30eb7c2b32f348f4bea0d4235b7a24a4.gif"></p><h4 id="4-使用到的模块简单理解介绍"><a href="#4-使用到的模块简单理解介绍" class="headerlink" title="4. 使用到的模块简单理解介绍"></a>4. 使用到的模块简单理解介绍</h4><h5 id="pedSource-模块介绍"><a href="#pedSource-模块介绍" class="headerlink" title="pedSource 模块介绍"></a>pedSource 模块介绍</h5><p>简单理解就是所有的行人都从这个资源池中产生。<br><img src="https://img-blog.csdnimg.cn/e3d2bc892f574ba095e3da6e9bf9ed18.png"><br>行人可以从三个地方出现：</p><ol><li><code>直线</code>（可以选择 targetline，也就是中文中的 目标线）</li><li><code>节点</code>（node，包括矩形节点、多边形节点）</li><li><code>点</code>（也就是绘制图上的 X&#x2F;Y坐标确立的位置）</li></ol><p>同时也可以设置到达根据，默认是速率<br>也可以是<br><code>间隔时间</code>（每隔多久出现一个行人）<br><code>速率时间表</code>（根据时间表的速率产生行人，比如说前一个小时内出现100个行人，后一个小时内出现200个行人，实际应用比如说车站早晚高峰）<br>到达时间表（跟速率时间表类似）<br><code>inject() 函数调用</code>（平时不会产生行人，运行时调用 inject 函数时才会产生行人）</p><h6 id="inject-函数演示"><a href="#inject-函数演示" class="headerlink" title="inject 函数演示"></a>inject 函数演示</h6><p><img src="https://img-blog.csdnimg.cn/bc8a44dd1c9c47dfb4731f9ca5fa5c53.gif"></p><h6 id="行人智能体"><a href="#行人智能体" class="headerlink" title="行人智能体"></a>行人智能体</h6><p>行人类型，默认是智能体，也可以自己创造智能体选择<br>默认智能体就像上面 inject 函数演示那样使用 五颜六色的 圆点作为行人。<br>我们为了模型运行时好看一些，可以自定义智能体，这里有两种方法<br><img src="https://img-blog.csdnimg.cn/cfbd5a75938f476fae2a01c54be6c0bd.gif"></p><h5 id="pedServices-模块"><a href="#pedServices-模块" class="headerlink" title="pedServices 模块"></a>pedServices 模块</h5><p><img src="https://img-blog.csdnimg.cn/ade3e8ee5b754e029a19512e4114005f.png"><br>该模块确定的行人位置必须是 服务 空间标记（比如说线服务、区域服务）。<br>队列选择策略可以是<br><code>最短队列</code>（默认）<br><code>最近队列</code><br><code>其他</code>（需要选择该服务的服务空间标记）</p><p>行人类型的选择跟 pedSource 类似，但一般不会太在意，如果pedServices跟pedSource 在一条逻辑线上，那么 pedServices 的行人类型就跟  pedSource 类型一致，也就是说一般情况下不需要专门选择 行人类型。</p><h5 id="services-空间标记（线服务）"><a href="#services-空间标记（线服务）" class="headerlink" title="services 空间标记（线服务）"></a>services 空间标记（线服务）</h5><p><img src="https://img-blog.csdnimg.cn/e20ea377862a405c865d40d95789ab96.png"><br>其中<code>服务数</code>在图标中表示就是线服务最前面圆点的个数。<br><code>队列数</code>就是线条数。<br><img src="https://img-blog.csdnimg.cn/913775927b144d0e8f53a0ea63959d01.png"><br><code>服务行人来自</code>的规则可以说是见名知意，要注意的<code>其他</code>这一选项，相当于需要自己使用JAVA代码定义排队和服务的规则。</p><h5 id="pedGoTo-模块"><a href="#pedGoTo-模块" class="headerlink" title="pedGoTo 模块"></a>pedGoTo 模块</h5><p><img src="https://img-blog.csdnimg.cn/6730bfa3ebf24953baf42849182aee05.png"><br>简单理解就是用户在使用该模块时相当于在告诉 行人要去哪并且怎么去。<br>模式分为两种<br><code>到达目标</code>就是告诉行人去哪，至于选择什么路线到达该目标用户并没有定义，即随便行人怎么走，只要到达目标就可以。<br><code>跟随路线</code>相当于不仅告诉行人要去哪，并且告诉行人只能通过某条路线到达目标</p><p>目标，跟 pedSources 类似</p><ol><li><code>直线</code>（可以选择 targetline，也就是中文中的 目标线）</li><li><code>节点</code>（node，包括矩形节点、多边形节点）</li><li><code>点</code>（也就是绘制图上的 X&#x2F;Y坐标确立的位置）</li></ol><h5 id="pedSink-模块"><a href="#pedSink-模块" class="headerlink" title="pedSink 模块"></a>pedSink 模块</h5><p>直接以英文解释，行人消失（沉没）</p><h3 id="运行模型"><a href="#运行模型" class="headerlink" title="运行模型"></a>运行模型</h3><p><img src="https://img-blog.csdnimg.cn/feab32f898324f6d8ade56c1a0d5d10a.gif"></p><h4 id="演示时三维模型"><a href="#演示时三维模型" class="headerlink" title="演示时三维模型"></a>演示时三维模型</h4><p>我们发现我们直接运行模型时，显示的是二维演示过程，如果是三维演示过程，那么要怎么做呢？</p><p><img src="https://img-blog.csdnimg.cn/46bb26802f954f178ba785e9a403794c.gif"><br>三维窗口导航类型<br><code>完全</code>三维窗口视图视角角度无限制<br><code>限制在Z在0以上</code>三维视图窗口视角无法从下往上看</p><h4 id="查看模型时的快捷键"><a href="#查看模型时的快捷键" class="headerlink" title="查看模型时的快捷键"></a>查看模型时的快捷键</h4><p><code>ctrl + 鼠标左键</code>平移模型界面（改变焦点）<br><code>alt+ 鼠标左键</code>三维模型视角改变（改变焦点）<br><code>鼠标滚轮</code>放大演示时的（三维？）视图</p><h4 id="如何运行时三维视图直接显示在屏幕中间"><a href="#如何运行时三维视图直接显示在屏幕中间" class="headerlink" title="如何运行时三维视图直接显示在屏幕中间"></a>如何运行时三维视图直接显示在屏幕中间</h4><p><img src="https://img-blog.csdnimg.cn/4cb367b07c7b44879c036ef79d782b1d.gif"></p><h4 id="视图的其他应用"><a href="#视图的其他应用" class="headerlink" title="视图的其他应用"></a>视图的其他应用</h4><p><img src="https://img-blog.csdnimg.cn/89b9cddda1c3452487ccfb1c72b9798d.gif"></p>]]></content>
      
      
      <categories>
          
          <category> anylogic </category>
          
      </categories>
      
      
        <tags>
            
            <tag> anylogic </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（8）—— django 请求生命周期流程图 以及 路由层介绍</title>
      <link href="/2022/11/28/django-xue-xi-8-django-qing-qiu-sheng-ming-zhou-qi-liu-cheng-tu-yi-ji-lu-you-ceng-jie-shao/"/>
      <url>/2022/11/28/django-xue-xi-8-django-qing-qiu-sheng-ming-zhou-qi-liu-cheng-tu-yi-ji-lu-you-ceng-jie-shao/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（8）——-django-请求生命周期流程图-以及-路由层介绍"><a href="#DJango-学习（8）——-django-请求生命周期流程图-以及-路由层介绍" class="headerlink" title="DJango 学习（8）—— django 请求生命周期流程图 以及 路由层介绍"></a>DJango 学习（8）—— django 请求生命周期流程图 以及 路由层介绍</h1><h2 id="django-请求生命周期流程图"><a href="#django-请求生命周期流程图" class="headerlink" title="django 请求生命周期流程图"></a>django 请求生命周期流程图</h2><p><img src="https://img-blog.csdnimg.cn/4a1a22904d7444dca4c4e0820a58c690.png"><br><img src="https://img-blog.csdnimg.cn/f5c27d6200dc412a8630f0d64ce329a4.png"></p><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""缓存数据库    提前已经将你要想的数据准备好 你来直接拿就行    提高效率和响应时间"""</span></code></pre><h2 id="路由层"><a href="#路由层" class="headerlink" title="路由层"></a>路由层</h2><h3 id="路由匹配"><a href="#路由匹配" class="headerlink" title="路由匹配"></a>路由匹配</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 路由匹配</span>url<span class="token punctuation">(</span>r<span class="token string">"test"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>test<span class="token punctuation">)</span>url<span class="token punctuation">(</span>r<span class="token string">"testadd"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>testadd<span class="token punctuation">)</span><span class="token triple-quoted-string string">"""url 方法第一个参数是正则表达式    只要第一个参数正则表单时能够匹配内容 那么就会立刻停止往下匹配    直接执行对应的视图函数    你在输入 url 的时候会默认加斜杠    django内部帮你做到重定向        一次匹配不行        url 后面加 斜杠 再来一次"""</span><span class="token comment" spellcheck="true"># 取消自动加斜杠</span>APPEND_SLASH <span class="token operator">=</span> <span class="token boolean">False</span><span class="token comment" spellcheck="true"># 首页</span>url<span class="token punctuation">(</span>r<span class="token string">"^$"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>home<span class="token punctuation">)</span></code></pre><h4 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h4><p><img src="https://img-blog.csdnimg.cn/5e4775139c1d4c0ab3ca5a6a7698df3a.gif"></p><h3 id="无名分组"><a href="#无名分组" class="headerlink" title="无名分组"></a>无名分组</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""分组：就是给一段正则表达式用小括号括起来"""</span>url<span class="token punctuation">(</span>r<span class="token string">"test/(\d+)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> xx<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>xx<span class="token punctuation">)</span>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 无名分组就是将括号内正则表达式匹配到的内容当作位置参数传递给后面的视图函数</span></code></pre><h3 id="有名分组"><a href="#有名分组" class="headerlink" title="有名分组"></a>有名分组</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""可以给正则表单式起别名"""</span>url<span class="token punctuation">(</span>r<span class="token string">"test/(?P&lt;year>\d+)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> year<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 有名分组就是将括号内正则表达式匹配到的内容当作关键字参数传递给后面的视图函数</span></code></pre><h3 id="无名分组和有名混用"><a href="#无名分组和有名混用" class="headerlink" title="无名分组和有名混用"></a>无名分组和有名混用</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 不能混用</span><span class="token comment" spellcheck="true"># 但是同一个分组可以使用 N 多次</span></code></pre><h4 id="无名、有名分组代码演示"><a href="#无名、有名分组代码演示" class="headerlink" title="无名、有名分组代码演示"></a>无名、有名分组代码演示</h4><p><img src="https://img-blog.csdnimg.cn/7c4c551af1e44171a1f4707b406dccb2.gif"></p><h3 id="反向解析"><a href="#反向解析" class="headerlink" title="反向解析"></a>反向解析</h3><h4 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h4><p><em><strong>反向解析主要应用于：</strong></em><br>        模板（html 文件中）的超链接<br>        视图（view.py）中的重定向</p><p><em><strong>作用：</strong></em><br>        随着功能的增加会出现更多的视图，可能之前配置的正则表达式不够准确，于是就要修改正则表达式，但是正则表达式一旦修改了，之前所有对应的超链接都要修改，真是一件麻烦的事情，而且可能还会漏掉一些超链接忘记修改，有办法让链接根据正则表达式动态生成吗？ 就是用反向解析的办法<br>        <strong>简单来说，使用反向解析可以在 <code>url.py</code>改变正则表达式时，但是实际运行时却不用输入最近的网址，而实现网址的跳转</strong></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 通过一些方法得到一个结果，该结果可以直接访问对应的 url 触发视图函数</span><span class="token comment" spellcheck="true"># 先给路由与视图函数起一个别名</span>url<span class="token punctuation">(</span>r<span class="token string">"^func_k/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>func<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 反向解析</span>    <span class="token comment" spellcheck="true"># 后端反向解析</span>    <span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> reverse    reverse<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 前端反向解析</span>    <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'xxx' %}"</span><span class="token operator">></span><span class="token number">111</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></code></pre><h4 id="反向解析代码演示"><a href="#反向解析代码演示" class="headerlink" title="反向解析代码演示"></a>反向解析代码演示</h4><p>视图中的重定向<br><img src="https://img-blog.csdnimg.cn/28bf561c2cca460496bea2e299aaa412.gif"><br>模板（html 文件中）的超链接<br><img src="https://img-blog.csdnimg.cn/7cd06fe60e694f4ba010f9c4f996d8f4.gif"></p><h3 id="无名有名反向解析"><a href="#无名有名反向解析" class="headerlink" title="无名有名反向解析"></a>无名有名反向解析</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 无名反向解析</span>url<span class="token punctuation">(</span>r<span class="token string">"index/(\d+)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 前端</span>    <span class="token punctuation">{</span><span class="token operator">%</span> url <span class="token string">"xxx"</span> <span class="token number">123</span> <span class="token operator">%</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true"># 后端</span>    <span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> reverse    reverse<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""这个数字写代码的时候应该放什么    数字一般情况下放的式数据的主键值  数据的编辑和删除    url(r"edit/(\d+)/", views.edit)def edit(request, edit_id):    reverse("xxx", args=(edit_id, ))    {% for user_obj in user_queryset %}&lt;a href="{% url "xxx" user_obj %}">{% endfor %}"""</span><span class="token comment" spellcheck="true"># 有名反向解析</span>url<span class="token operator">=</span><span class="token punctuation">(</span>r<span class="token string">"func/(?P&lt;year>\d+)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>func<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 前端</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'xxx' year=123 %}"</span><span class="token operator">></span><span class="token number">111</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"{% url 'xxx' 123 %}"</span><span class="token operator">></span><span class="token number">111</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token comment" spellcheck="true"># 后端</span>reverse<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"year"</span><span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">}</span><span class="token punctuation">)</span>reverse<span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">.</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="利用无名有名反向解析完成数据的增加查改"><a href="#利用无名有名反向解析完成数据的增加查改" class="headerlink" title="利用无名有名反向解析完成数据的增加查改"></a>利用无名有名反向解析完成数据的增加查改</h3><h4 id="view-py"><a href="#view-py" class="headerlink" title="view.py"></a><code>view.py</code></h4><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">R_useredit</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">:</span>    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id<span class="token operator">=</span>id<span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        user_obj<span class="token punctuation">.</span>update<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">,</span> possword<span class="token operator">=</span>password<span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/R_userlist/"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"R_useredit.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">R_userdelete</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">:</span>    models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id<span class="token operator">=</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/R_userlist/"</span><span class="token punctuation">)</span></code></pre><h4 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a><code>urls.py</code></h4><pre class=" language-python"><code class="language-python">urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>    url<span class="token punctuation">(</span>r<span class="token string">'^admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^R_userlist"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>R_userlist<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^R_useredit/(\d+)"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>R_useredit<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"useredit"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^R_userdelete/(\d+)"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>R_userdelete<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"userdelete"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>home<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre><h4 id="R-userlist-html"><a href="#R-userlist-html" class="headerlink" title="R_userlist.html"></a><code>R_userlist.html</code></h4><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    &lt;script src="{% static "others/JQuery3.6.0.js" %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    &lt;link rel = "stylesheet" href = "{% static 'others/bootstrap-3.4.1-dist/css/bootstrap.min.css' %}" >    &lt;script src = "{% static 'others/bootstrap-3.4.1-dist/js/bootstrap.min.js' %}" ><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>数据展示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table table-bordered table-striped table-hover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>介绍<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>爱好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>操作<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>               {% for foo in user_object %}                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.possword }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.hobby }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.info }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>                            &lt;a href="{% url "useredit" foo.id%}" class="btn-xs btn-primary">编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>                            &lt;a href="{% url "userdelete" foo.id %}" class="btn-xs btn-warning">删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>               {% endfor %}                           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h4 id="R-useredit-html"><a href="#R-useredit-html" class="headerlink" title="R_useredit.html"></a><code>R_useredit.html</code></h4><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    &lt;script src="{% static "others/JQuery3.6.0.js" %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    &lt;link rel = "stylesheet" href = "{% static 'others/bootstrap-3.4.1-dist/css/bootstrap.min.css' %}">    &lt;script src = "{% static 'others/bootstrap-3.4.1-dist/js/bootstrap.min.js' %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span>{{</span> <span class="token attr-name">user_obj.name</span> <span class="token attr-name">}}</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span>{{</span> <span class="token attr-name">user_obj.possword</span> <span class="token attr-name">}}</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-warning btn-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h4 id="运行演示"><a href="#运行演示" class="headerlink" title="运行演示"></a>运行演示</h4><p><img src="https://img-blog.csdnimg.cn/fb2952ef67994ce28ab537ca52ae4785.gif"></p><h3 id="路由分发"><a href="#路由分发" class="headerlink" title="路由分发"></a>路由分发</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""django 的每一个应用都可以有自己的 templates 文件夹 url.py 和 static 文件夹基于上述的特点，可以做到分组开发（每个人只写自己的APP）当一个 django 项目中的 url 特别多的时候 总路由 urls.py 代码非常荣誉不好维护，这个时候也可以利用路由分发来减轻总路由的压力利用路由分发之后 总路由不再干路由和视图函数的直接对应关系而是做一个分发处理    识别当前 url 是属于哪个应用下的 直接分发给对应的应用去处理"""</span><span class="token comment" spellcheck="true"># 总路由</span><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token punctuation">,</span> inclued<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin<span class="token keyword">from</span> app01 <span class="token keyword">import</span> urls <span class="token keyword">as</span> app01_urls<span class="token keyword">from</span> app02 <span class="token keyword">import</span> urls <span class="token keyword">as</span> app02_urlsurlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>    url<span class="token punctuation">(</span>r<span class="token string">'^admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true"># 路由分发</span>    url<span class="token punctuation">(</span>r<span class="token string">"^app01"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>app01_urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 只要前缀是 app01 开头 全部交给 app01 处理</span>    url<span class="token punctuation">(</span>r<span class="token string">"^app02"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>app02_urls<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 只要前缀是 app02 开头 全部交给 app02 处理</span>        <span class="token comment" spellcheck="true"># 终极写法 推荐</span>    url<span class="token punctuation">(</span>r<span class="token string">"^app01"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">"app01_urls"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 此时不需要导入 from app01 import urls as app01_urls</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true"># 子路由</span><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token keyword">from</span> app01 <span class="token keyword">import</span> viewsurlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>   url<span class="token punctuation">(</span>r<span class="token string">"^reg/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>reg<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token keyword">from</span> app02 <span class="token keyword">import</span> viewsurlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>   url<span class="token punctuation">(</span>r<span class="token string">"^reg/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>reg<span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre><h3 id="名称空间"><a href="#名称空间" class="headerlink" title="名称空间"></a>名称空间</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 当多个应用出现了相同的别名</span><span class="token triple-quoted-string string">"""正常情况下反向解析并不能自动识别前缀"""</span><span class="token comment" spellcheck="true"># 名称空间</span>url<span class="token punctuation">(</span>r<span class="token string">"^app01"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>app01_urls<span class="token punctuation">)</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">"app01"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> url<span class="token punctuation">(</span>r<span class="token string">"^app02"</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span>app02_urls<span class="token punctuation">)</span><span class="token punctuation">,</span> namespace<span class="token operator">=</span><span class="token string">"app02"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token comment" spellcheck="true"># 解析的时候</span>    resverse<span class="token punctuation">(</span><span class="token string">"app01:reg"</span><span class="token punctuation">)</span>        <span class="token punctuation">{</span><span class="token operator">%</span> urls <span class="token string">"app01:reg"</span> <span class="token operator">%</span><span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 保证名字不冲突</span><span class="token comment" spellcheck="true"># 一般情况下，有多个 app，一般是命名为 “app01xxx” 的形式</span></code></pre><h3 id="伪静态概念"><a href="#伪静态概念" class="headerlink" title="伪静态概念"></a>伪静态概念</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""静态网页    数据是写死的 万年不变伪静态    将一个动态网页伪装成静态网页    为什么要伪装？    伪装的目的在于增大本网站的 seo 查询力度    并且增加搜索引擎收藏本网站的几率"""</span>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>   url<span class="token punctuation">(</span>r<span class="token string">"^reg.html"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>reg<span class="token punctuation">)</span><span class="token punctuation">]</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（7）—— orm 创建表关系</title>
      <link href="/2022/11/28/django-xue-xi-7-orm-chuang-jian-biao-guan-xi/"/>
      <url>/2022/11/28/django-xue-xi-7-orm-chuang-jian-biao-guan-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（7）——-orm-创建表关系"><a href="#DJango-学习（7）——-orm-创建表关系" class="headerlink" title="DJango 学习（7）—— orm 创建表关系"></a>DJango 学习（7）—— orm 创建表关系</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p> orm 中 如何定义三种关系</p><pre class=" language-python"><code class="language-python">pulish <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Publish"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 默认和主键建立表关系</span>    authors <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Author"</span><span class="token punctuation">)</span>    author_detail <span class="token operator">=</span> models<span class="token punctuation">.</span>OneToOneField<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Author_detail"</span><span class="token punctuation">)</span>ForeignKeyOneToOneField   全自动在字段后面加 _id </code></pre><p>在 django 1.x 中外键默认都时级联更新级联删除</p><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""表与表之间的关系    一对多        多对多        一对一"""</span>图书表出版社表作者表作者详情表<span class="token triple-quoted-string string">"""图书和出版社是一对多的关系，外键字段建在多的一方，图书。图书和作者是多对多关系，需要创建第三张表作者和作者详情表是一对一的关系"""</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># CharField 必须要有 max_length 参数，不指定会报错</span>    <span class="token comment" spellcheck="true"># verbase_name 该参数是所有字段都有的，就是用来对字段的解释</span>    <span class="token comment" spellcheck="true"># 相当于 id int primary key auto_increment</span>    id <span class="token operator">=</span> models<span class="token punctuation">.</span>AutoField<span class="token punctuation">(</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"主键"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># name char(32)</span>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span><span class="token string">"用户名"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># password int</span>    password <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"密码"</span><span class="token punctuation">)</span>    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">)</span>    info <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"个人简介"</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 该字段可以为空</span>    hobby <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"爱好"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"study"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 直接设置默认值</span><span class="token comment" spellcheck="true"># 创建表关系，先创建基表，再创建外键字段</span><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"书名"</span><span class="token punctuation">)</span>    price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"价格"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 8 8位数字，其中小数部分占两位</span>    <span class="token comment" spellcheck="true"># 图书和出版社是 一对多 的关系，外键建在多的那张表上</span>    pulish <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Publish"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 默认和主键建立表关系</span>    <span class="token comment" spellcheck="true"># 如果字段对应的是 ForeignKey 那么 orm 会自动再字段的后面加 _id</span>    <span class="token comment" spellcheck="true"># 如果写了 _id ，orm 也会再后面继续加 _id</span>    <span class="token comment" spellcheck="true"># 后面在定义 ForeignKey 时不要加 _id </span>    <span class="token comment" spellcheck="true"># 图书和作者是 多对多关系，外键建在哪张表都可以，并且不用建第三张表</span>    authors <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Author"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># authors 是虚拟字段，让 orm 直到作者和图书表是多对多关系，并且自动创建第三张表</span><span class="token keyword">class</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"出版社名称"</span><span class="token punctuation">)</span>    addr <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"地址"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"作者名"</span><span class="token punctuation">)</span>    age <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 作者和作者详情表是 一对一 表关系</span>    author_detail <span class="token operator">=</span> models<span class="token punctuation">.</span>OneToOneField<span class="token punctuation">(</span>to<span class="token operator">=</span><span class="token string">"Author_detail"</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Author_detail</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    phone <span class="token operator">=</span> models<span class="token punctuation">.</span>BigIntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"联系方式"</span><span class="token punctuation">)</span>    addr <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"作者地址"</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/7fd19083cbc6412f9586a1287d4676fd.png"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（6）—— Django 数据库连接以及简单的前后端数据交互</title>
      <link href="/2022/11/28/django-xue-xi-6-django-shu-ju-ku-lian-jie-yi-ji-jian-dan-de-qian-hou-duan-shu-ju-jiao-hu/"/>
      <url>/2022/11/28/django-xue-xi-6-django-shu-ju-ku-lian-jie-yi-ji-jian-dan-de-qian-hou-duan-shu-ju-jiao-hu/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（6）——-Django-数据库连接以及简单的前后端数据交互"><a href="#DJango-学习（6）——-Django-数据库连接以及简单的前后端数据交互" class="headerlink" title="DJango 学习（6）—— Django 数据库连接以及简单的前后端数据交互"></a>DJango 学习（6）—— Django 数据库连接以及简单的前后端数据交互</h1><h2 id="pycharm-链接数据库"><a href="#pycharm-链接数据库" class="headerlink" title="pycharm 链接数据库"></a>pycharm 链接数据库</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""三个位置    右侧上方 database    左下方 database    配置里面的 plugins 插件搜索        重装 pycharm    pycharm 可以充当很多数据库的客户端"""</span></code></pre><p><img src="https://img-blog.csdnimg.cn/d723b334898247eb8072f235b61e3171.gif"></p><h2 id="django-orm"><a href="#django-orm" class="headerlink" title="django orm"></a>django orm</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""orm: 对象关系映射作用：能够让不会sql 语句的小白也可以通过 python 面向对象的代码简单快捷的操作数据库不足：封装程度太高，有时候 sql 语句的效率偏低 需要自己写 sql 语句表   ------------   类记录 ------------   对象某个字段的值  -------- 对象属性应用 models.py 文件"""</span><span class="token comment" spellcheck="true"># 0. setting.py 配置文件修改连接的数据库</span><span class="token comment" spellcheck="true"># 项目指定的数据库</span>DATABASES <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true"># 'ENGINE': 'django.db.backends.sqlite3',</span>        <span class="token comment" spellcheck="true"># 'NAME': os.path.join(BASE_DIR, 'db.sqlite3'),</span>        <span class="token string">'ENGINE'</span><span class="token punctuation">:</span> <span class="token string">"django.db.backends.mysql"</span><span class="token punctuation">,</span>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'test518'</span><span class="token punctuation">,</span>        <span class="token string">"HOST"</span><span class="token punctuation">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>        <span class="token string">"PORT"</span><span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>        <span class="token string">"USER"</span><span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>        <span class="token string">"PASSWORD"</span><span class="token punctuation">:</span> <span class="token string">""</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>__init__ 文件    <span class="token keyword">import</span> pymysql    pymysql<span class="token punctuation">.</span>install_as_MySQLdb<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 1. 先去 models.py 文件中书写一个类</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 相当于 id int primary key auto_increment</span>    id <span class="token operator">=</span> models<span class="token punctuation">.</span>AutoField<span class="token punctuation">(</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># name char(32)</span>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># password int</span>    password <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 2. 数据库迁移命令</span><span class="token number">1</span><span class="token punctuation">.</span> python manage<span class="token punctuation">.</span>py makemigrations 将操作记录记录到小本本上（makemigrations 文件夹）<span class="token number">2</span><span class="token punctuation">.</span> python manage<span class="token punctuation">.</span>py migrate 将操作真正同步到数据库中<span class="token comment" spellcheck="true"># 只要你修改了 models.py 中和数据库有关的代码，你就必须重新执行上述的两条命令</span><span class="token comment" spellcheck="true"># 如果创建表时，不定义字段主键时，orm 会自动创建一个名为 id 的主键</span><span class="token comment" spellcheck="true"># Create your models here.</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    CharField 必须要有 max_length 参数，不指定会报错    verbase_name 该参数是所有字段都有的，就是用来对字段的解释    """</span>    <span class="token comment" spellcheck="true"># 相当于 id int primary key auto_increment</span>    id <span class="token operator">=</span> models<span class="token punctuation">.</span>AutoField<span class="token punctuation">(</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> verbose_name<span class="token operator">=</span><span class="token string">"主键"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># name char(32)</span>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span>verbose_name<span class="token operator">=</span><span class="token string">"用户名"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># password int</span>    password <span class="token operator">=</span> models<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"密码"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/683cf437bd45452ca6ae877284f63315.png"><br><img src="https://img-blog.csdnimg.cn/1678556b451249dfb50f5c42f394302e.png"><br><img src="https://img-blog.csdnimg.cn/b9b514e0f80746df95c0e3d1908af0d5.gif"><br><img src="https://img-blog.csdnimg.cn/1cefaa3357e648e083db44b0b4fcc19e.png"></p><h2 id="字段的增删改查"><a href="#字段的增删改查" class="headerlink" title="字段的增删改查"></a>字段的增删改查</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 字段的增加</span>    <span class="token number">1</span><span class="token punctuation">.</span> 直接在终端内给出 默认值    <span class="token number">2</span><span class="token punctuation">.</span> 该字段可以为空，或者直接设置默认值        info <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>verbose_name<span class="token operator">=</span><span class="token string">"个人简介"</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 该字段可以为空</span>        hobby <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">,</span> verbase_name<span class="token operator">=</span><span class="token string">"爱好"</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">"study"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 直接设置默认值</span>        <span class="token comment" spellcheck="true"># 字段的修改</span>    直接修改代码，执行数据库迁移的两条命令即可    <span class="token comment" spellcheck="true"># 字段的删（不要轻易操作）</span>    将对应的字段注释，并执行数据库迁移命令    执行完毕之后，数据消失    <span class="token triple-quoted-string string">"""在操作 models.py 文件的时候一定要细心    千万不要注释一些字段    执行迁移命令之前最好先检查一下自己写的代码"""</span></code></pre><h2 id="数据的增删改查"><a href="#数据的增删改查" class="headerlink" title="数据的增删改查"></a>数据的增删改查</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 查询</span>res<span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">)</span>user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"usrelist.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""返回值暂时当作 列表套对象的格式它也支持索引取值  切片操作 但是不支持负数索引它也不推荐索引的方式取值user_obj = models.User.objects.filter(name=username).first()"""</span>filter 可以携带多个参数，参数与参数之间默认是 <span class="token operator">and</span> 关系，可以把 filter 当作 where<span class="token comment" spellcheck="true"># 增加</span>    res <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 返回值是当前被创建的对象本身</span><span class="token comment" spellcheck="true"># 第二种</span>        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span>        user_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 保存数据</span></code></pre><h2 id="数据的查、改、删"><a href="#数据的查、改、删" class="headerlink" title="数据的查、改、删"></a>数据的查、改、删</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 先将数据库中的数据全部展示到前端，然后给每一个数据两个按钮，一个编辑一个删除</span><span class="token comment" spellcheck="true"># 编辑功能</span>    <span class="token comment" spellcheck="true"># 点击编辑按钮朝后端发送编辑数据的请求</span>    <span class="token triple-quoted-string string">"""    如何告诉后端用户想要编辑哪条数据        将编辑按钮所在的那一行数据的主键值告诉后端        /url/?user_id={{ user_obj.id }}    """</span>    <span class="token comment" spellcheck="true"># 后端查询出用户想要编辑的数据并展示</span>        <span class="token keyword">def</span> <span class="token function">useredit</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>        edit_id <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id <span class="token operator">=</span> edit_id<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>            name <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>            password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 编辑数据</span>            <span class="token comment" spellcheck="true"># 方法一</span>            <span class="token comment" spellcheck="true"># 批量操作，只更新修改的数据，效率较高</span>            <span class="token comment" spellcheck="true"># models.User.objects.filter(id=edit_id).update(name=name, password=password)</span>            <span class="token comment" spellcheck="true"># 方法二，效率较低，将数据全部更新一遍，无论该字段是否被修改</span>            user_obj<span class="token punctuation">.</span>name <span class="token operator">=</span> name            user_obj<span class="token punctuation">.</span>password <span class="token operator">=</span> password            user_obj<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 跳转页面</span>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/userlist/"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"useredit.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 删除功能</span>    跟编辑功能类似    <span class="token keyword">def</span> <span class="token function">userdelete</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>        delete_id <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 删除数据</span>        models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id<span class="token operator">=</span>delete_id<span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/userlist/"</span><span class="token punctuation">)</span>   <span class="token triple-quoted-string string">"""真正的删除功能应该要二次确认，我们这里先不做删除数据内部其实并不是真正的删除，我们会根据添加一个标识字段来表示当前数据是否被删除，如果数据被删除仅仅只是将字段修改一个状态"""</span>name       password          is_deleteaoteman       <span class="token number">123</span>                 <span class="token number">0</span>alterman      <span class="token number">123</span>                 <span class="token number">1</span></code></pre><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a><code>urls.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin<span class="token keyword">from</span> app01 <span class="token keyword">import</span> viewsurlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span>    url<span class="token punctuation">(</span>r<span class="token string">'^admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">'^login/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>login<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^regin/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>regin<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^userlist/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>userlist<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^useredit/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>useredit<span class="token punctuation">)</span><span class="token punctuation">,</span>    url<span class="token punctuation">(</span>r<span class="token string">"^userdelete/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>userdelete<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre><h3 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a><code>views.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> HttpResponse<span class="token punctuation">,</span> redirect<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse<span class="token keyword">from</span> app01 <span class="token keyword">import</span> models<span class="token comment" spellcheck="true"># Create your views here.</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        message <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> message <span class="token keyword">is</span> None<span class="token punctuation">:</span>            <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"该用户不存在"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        user_password <span class="token operator">=</span> message<span class="token punctuation">.</span>possword        <span class="token keyword">if</span> int<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">==</span> user_password<span class="token punctuation">:</span>            user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/userlist/'</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>!<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span>https<span class="token punctuation">:</span><span class="token operator">//</span>img<span class="token operator">-</span>blog<span class="token punctuation">.</span>csdnimg<span class="token punctuation">.</span>cn<span class="token operator">/</span><span class="token number">256727490a004e24b28b5164e8714282.</span>gif<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"密码错误"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">regin</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 用户注册</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        hobby <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"hobby"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 增添到数据库中</span>        models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">,</span> possword <span class="token operator">=</span> password<span class="token punctuation">,</span> hobby<span class="token operator">=</span>hobby<span class="token punctuation">)</span>        user_message <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/login/"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"register.html"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">userlist</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"usrelist.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">useredit</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    id <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id <span class="token operator">=</span> id<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id<span class="token operator">=</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>name<span class="token operator">=</span>username<span class="token punctuation">,</span> possword<span class="token operator">=</span>int<span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span>        user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>all<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"usrelist.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"useredit.html"</span><span class="token punctuation">,</span> locals<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">userdelete</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    id <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span>    models<span class="token punctuation">.</span>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>id<span class="token operator">=</span>id<span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 实际上删除数据还需要二次确认</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/userlist/"</span><span class="token punctuation">)</span></code></pre><h3 id="register-html"><a href="#register-html" class="headerlink" title="register.html"></a><code>register.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    &lt;script src="{% static "others/JQuery3.6.0.js" %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>注册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>111<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>222<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>333<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-warning btn-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a><code>login.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/JQuery3.6.0.js<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>111<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>222<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>333<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-success btn-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="userlist-html"><a href="#userlist-html" class="headerlink" title="userlist.html"></a><code>userlist.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    &lt;script src="{% static "others/JQuery3.6.0.js" %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    &lt;link rel = "stylesheet" href = "{% static 'others/bootstrap-3.4.1-dist/css/bootstrap.min.css' %}" >    &lt;script src = "{% static 'others/bootstrap-3.4.1-dist/js/bootstrap.min.js' %}" ><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>数据展示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table table-bordered table-striped table-hover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>用户名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>密码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>介绍<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>爱好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>操作<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>                {% for foo in user_obj %}                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.possword }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.info }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>{{ foo.hobby }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/useredit/?id<span class="token punctuation">=</span>{{ foo.id }}<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-primary btn-xs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/userdelete/?id<span class="token punctuation">=</span>{{ foo.id }}<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn btn-danger btn-xs<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>删除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>                {% endfor %}            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="useredit-html"><a href="#useredit-html" class="headerlink" title="useredit.html"></a><code>useredit.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    &lt;script src="{% static "others/JQuery3.6.0.js" %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    &lt;link rel = "stylesheet" href = "{% static 'others/bootstrap-3.4.1-dist/css/bootstrap.min.css' %}">    &lt;script src = "{% static 'others/bootstrap-3.4.1-dist/js/bootstrap.min.js' %}"><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>编辑<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span>{{</span> <span class="token attr-name">user_obj.name</span> <span class="token attr-name">}}</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span>{{</span> <span class="token attr-name">user_obj.password</span> <span class="token attr-name">}}</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-warning btn-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="运行演示"><a href="#运行演示" class="headerlink" title="运行演示"></a>运行演示</h2><p><img src="https://img-blog.csdnimg.cn/eb681610512e46cdb480ad2809af8ac3.gif"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（5）—— Django 静态文件配置 以及 简单操作</title>
      <link href="/2022/11/28/django-xue-xi-5-django-jing-tai-wen-jian-pei-zhi-yi-ji-jian-dan-cao-zuo/"/>
      <url>/2022/11/28/django-xue-xi-5-django-jing-tai-wen-jian-pei-zhi-yi-ji-jian-dan-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（5）——-Django-静态文件配置-以及-简单操作"><a href="#DJango-学习（5）——-Django-静态文件配置-以及-简单操作" class="headerlink" title="DJango 学习（5）—— Django 静态文件配置 以及 简单操作"></a>DJango 学习（5）—— Django 静态文件配置 以及 简单操作</h1><h2 id="静态文件配置"><a href="#静态文件配置" class="headerlink" title="静态文件配置"></a>静态文件配置</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 登录功能</span><span class="token triple-quoted-string string">"""html 文件默认放在 templates 文件夹下网站所使用的静态文件默认放在 static 文件静态文件    前端已经写好的 能够直接调用使用的文件        网站写好的 js 文件        网站写好的 css 文件        网站用到的图片文件        第三方前端框架        ...        拿来就可以直接使用"""</span><span class="token comment" spellcheck="true"># django 默认不会自动创建 static 文件夹 需要你自己手动创建</span>一般情况下我们在 static 文件夹内还会进一步的划分处理    <span class="token operator">-</span><span class="token operator">-</span> static        <span class="token operator">-</span><span class="token operator">-</span> js        <span class="token operator">-</span><span class="token operator">-</span> css        <span class="token operator">-</span><span class="token operator">-</span> img        <span class="token operator">-</span><span class="token operator">-</span> other         <span class="token triple-quoted-string string">""" 在浏览器中输入 url 能够看到对应的资源 是因为后端提前开设了该资源的接口  如果访问不到资源，说明后端没有开设该资源的接口 """</span><span class="token comment" spellcheck="true"># 静态文件配置</span>STATIC_URL <span class="token operator">=</span> <span class="token string">'/static/'</span> <span class="token comment" spellcheck="true"># 访问静态文件的令牌，如果你要访问静态文件，就必须以 static 开头</span><span class="token triple-quoted-string string">"""/static/others/JQuery3.6.0.js这是的 /static/ 不是指文件夹，而是指 “令牌”"""</span><span class="token comment" spellcheck="true"># 静态文件配置</span>STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token comment" spellcheck="true"># 静态持有者可以访问的文件，可以有多个路径</span>    os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">"static"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token triple-quoted-string string">"""查找顺序，从上往下一次查找，并且找到一个就停止查找"""</span><span class="token triple-quoted-string string">"""当你在写 django 项目的时候 可能会出现后端代码修改了但是前端页面没有变化的情况    1. 你在同一个端口开了好几个 django 项目        一直在运行的其实是第一个 django 项目        2. 浏览器缓存问题（谷歌为例）        settings            network                disable cache 勾选上"""</span><span class="token comment" spellcheck="true"># 静态文件动态解析</span><span class="token punctuation">{</span><span class="token operator">%</span> load static <span class="token operator">%</span><span class="token punctuation">}</span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"{% static 'others/JQuery3.6.0.js' %}"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"{% static 'others/bootstrap-3.4.1-dist/css/bootstrap.min.css' %}"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"{% static 'others/bootstrap-3.4.1-dist/js/bootstrap.min.js' %}"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>    <span class="token comment" spellcheck="true"># form 表单默认是 get 请求</span><span class="token triple-quoted-string string">"""form 表单 action    1. 不写，默认当前页面所在的 url 提交数据    2. 全写    3. 只写后缀 /login/"""</span><span class="token comment" spellcheck="true"># 在前期我们使用 django 提交 post 请求的时候 需要配置问价按中注释一行代码</span>MIDDLEWARE <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'django.middleware.security.SecurityMiddleware'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="token punctuation">,</span>    <span class="token string">'django.middleware.common.CommonMiddleware'</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true"># 'django.middleware.csrf.CsrfViewMiddleware',</span>    <span class="token string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="token punctuation">,</span>    <span class="token string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class="token punctuation">,</span><span class="token punctuation">]</span></code></pre><p><img src="https://img-blog.csdnimg.cn/9b0a999bf67d45dab2c1683ea2083307.png"><br><img src="https://img-blog.csdnimg.cn/25fe8b841f0c4168a1053769a3dbb3d5.png"><br><img src="https://img-blog.csdnimg.cn/1a1c253d5e3440a7a6bf191b31312e34.png"></p><p><img src="https://img-blog.csdnimg.cn/6c707f1ebe1947daa496e2cef4da249b.png"></p><h2 id="django-小白必会三板斧"><a href="#django-小白必会三板斧" class="headerlink" title="django 小白必会三板斧"></a>django 小白必会三板斧</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""HttpResponse: 返回字符串render: 返回 html 文件    # 第一种传值方式：更加精确，节省资源    # return render(request, "myFirst.html", {"data": user_dict})    # 第二种传值方式：当你要传的数据特别多的时候    """</span>locals 会将所在的名称空间中所有的名字全部传递给 url 页面<span class="token triple-quoted-string string">"""    return render(request, "myFirst.html", locals())redirect：重定向          return redirect("https://www.baidu.com")          return redirect("/home/")"""</span></code></pre><h2 id="request-对象方法"><a href="#request-对象方法" class="headerlink" title="request 对象方法"></a>request 对象方法</h2><pre class=" language-python"><code class="language-python">request<span class="token punctuation">.</span>method <span class="token comment" spellcheck="true"># 返回请求方式，并且全是大写的字符串</span>request<span class="token punctuation">.</span>POST <span class="token comment" spellcheck="true"># 获取用户 post 请求提交的普通数据不包含文件</span>    request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 只获取列表最后一个元素</span>    request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 直接将列表取出</span>request<span class="token punctuation">.</span>GET <span class="token comment" spellcheck="true"># 获取用户 get 请求提交的普通数据，具体用法和 POST 一样，get 请求携带的数据有大小限制</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 返回一个登陆页面</span>    <span class="token triple-quoted-string string">"""    get 请求和 post 请求应该有不同的处理机制    :param request: 请求相关的数据对象 里面有很多简易的方法    :return:    """</span>    <span class="token comment" spellcheck="true"># print(request.method) # 返回请求方式，并且全是大写的字符串</span>    <span class="token comment" spellcheck="true"># if request.method == "GET":</span>    <span class="token comment" spellcheck="true">#     print("来了")</span>    <span class="token comment" spellcheck="true">#     return render(request, "login.html")</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># elif request.method == "POST":</span>    <span class="token comment" spellcheck="true">#     return HttpResponse("收到了")</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取用户数据</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取用户提交的 POST 请求数据，不包含文件</span>        <span class="token comment" spellcheck="true"># &lt;QueryDict: {'username': ['fbjfbjhn'], 'password': ['asd']}></span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> type<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># fbjfbjhn &lt;class 'str'></span>        hobby <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"hobby"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>hobby<span class="token punctuation">,</span> type<span class="token punctuation">(</span>hobby<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 333 &lt;class 'str'></span>        <span class="token comment" spellcheck="true"># get 只会获取裂变最后一个元素</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> type<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># [fbjfbjhn] &lt;class 'list'></span>        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"收到了"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/5a6db73fbfbb41e3abf846970bdbcee5.gif"></p><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><h3 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a><code>login.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    {% load static %}    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/JQuery3.6.0.js<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{% static <span class="token punctuation">'</span>others/bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">'</span> %}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>col-md-8 col-md-offset-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>form-control<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>111<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>222<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>333<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn-success btn-block<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a><code>views.py</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> HttpResponse<span class="token punctuation">,</span> redirect<span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> JsonResponse<span class="token comment" spellcheck="true"># Create your views here.</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># print(request.method)</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># return render(request, 'test.html')</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"你来了"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"收到！！！"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/0e2a0021d96a45f69f31ca231cc829cd.gif"></p><h3 id="views-py-1"><a href="#views-py-1" class="headerlink" title="views.py"></a><code>views.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"POST"</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取用户数据</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取用户提交的 POST 请求数据，不包含文件</span>        <span class="token comment" spellcheck="true"># &lt;QueryDict: {'username': ['fbjfbjhn'], 'password': ['asd']}></span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> type<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># fbjfbjhn &lt;class 'str'></span>        hobby <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"hobby"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>hobby<span class="token punctuation">,</span> type<span class="token punctuation">(</span>hobby<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 333 &lt;class 'str'></span>        <span class="token comment" spellcheck="true"># get 只会获取裂变最后一个元素</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> type<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># [fbjfbjhn] &lt;class 'list'></span>        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"收到了"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/aea1b0ab57834538b53d3429f27dc826.gif"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（4）—— django介绍以及创建</title>
      <link href="/2022/11/28/django-xue-xi-4-django-jie-shao-yi-ji-chuang-jian/"/>
      <url>/2022/11/28/django-xue-xi-4-django-jie-shao-yi-ji-chuang-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（4）——-django介绍以及创建django项目"><a href="#DJango-学习（4）——-django介绍以及创建django项目" class="headerlink" title="DJango 学习（4）—— django介绍以及创建django项目"></a>DJango 学习（4）—— django介绍以及创建django项目</h1><h2 id="python-三大主流-web-框架"><a href="#python-三大主流-web-框架" class="headerlink" title="python 三大主流 web 框架"></a>python 三大主流 web 框架</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""django    特点：大而全，自带的功能多    不足之处：        有时候过于笨重flask    特点：小而精，自带的功能少，第三方的模块特别多    不足之处：        比较依赖于第三方的开发者，容易出现兼容性问题tornado    特点：异步非阻塞，支持多并发，可以开发游戏服务器    """</span>web 框架三部分    A<span class="token punctuation">:</span> socket 部分    B： 路由    C：模板语法    django    A 用的是别人的  wsgiref    B 用的是自己的    C 用的是自己的，没有 jinja2 好用    flask    A 用的是别人的 werkzeug（wsgiref）    B 自己的    C 别人的 jinja2     tornado    A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C 全是自己的</code></pre><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 如何让电脑正常使用 django</span>    <span class="token number">1</span><span class="token punctuation">.</span> 计算机名称不能有中文        右键计算机 点击属性    <span class="token number">2</span><span class="token punctuation">.</span> 一个 pycharm 窗口只开一个项目    <span class="token number">3</span><span class="token punctuation">.</span> 项目里面的所有文件尽量不要出现中文    <span class="token comment" spellcheck="true"># django 版本问题</span>    <span class="token number">1.</span>x 和 <span class="token number">2.</span>x 本身差距并不大        pip3 install django<span class="token operator">==</span><span class="token number">1.11</span><span class="token punctuation">.</span><span class="token number">11</span></code></pre><h2 id="django-基本操作"><a href="#django-基本操作" class="headerlink" title="django 基本操作"></a>django 基本操作</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 命令行</span>    <span class="token comment" spellcheck="true"># 1. 创建 django 命令</span>        <span class="token triple-quoted-string string">"""先切换到对应的目录"""</span>        django<span class="token operator">-</span>admin startproject 项目名（以mysite 为例）                mysite 文件夹            manage<span class="token punctuation">.</span>py            mysite 文件夹                __init__<span class="token punctuation">.</span>py                setting<span class="token punctuation">.</span>py                urls<span class="token punctuation">.</span>py                wsgi<span class="token punctuation">.</span>py     <span class="token comment" spellcheck="true"># 2. 启动 django 项目</span>        <span class="token triple-quoted-string string">"""        一定要切换到项目目录下        """</span>        python3 mange<span class="token punctuation">.</span>py runserver                <span class="token comment" spellcheck="true"># http://127.0.0.1:8000/</span>            <span class="token comment" spellcheck="true"># 3. 创建应用</span>    <span class="token triple-quoted-string string">"""    Next, start your first app by running python manage.py startapp [app_label].    """</span>    python manage<span class="token punctuation">.</span>py startapp 应用名        有很多文件</code></pre><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># pycharm</span><span class="token number">1</span><span class="token punctuation">.</span> new project 选择左侧第二个 django 即可<span class="token number">2</span><span class="token punctuation">.</span> 启动    命令行启动    点击 绿色小箭头<span class="token number">3</span><span class="token punctuation">.</span> 创建 app    命令行直接输命令    pycharm tools run mange<span class="token punctuation">.</span>py task</code></pre><h3 id="命令行和pycharm创建的区别"><a href="#命令行和pycharm创建的区别" class="headerlink" title="命令行和pycharm创建的区别"></a>命令行和pycharm创建的区别</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 1. pycharm 会自动帮你创建 templates 文件夹并且还会在配置文件中配置相关的路径</span>也就意味着使用 命令行创建django时不单单需要创建 templates 文件夹还需要去配置文件中的配置TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token string">'DIRS'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""django 是一款专门开发 app 的 web 框架django 框架类似于大学app 就类似于大学里面的各个学院    比如开发淘宝        订单相关        用户相关        创建不同的 app 对应不同的功能    一个 app 就是一个独立的功能模块"""</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>创建的应用一定要去配置文件中注册<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">*</span>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span>    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span>    <span class="token string">"app01.apps.App01Config"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 全写</span>    <span class="token string">"app02"</span> <span class="token comment" spellcheck="true"># 简写</span><span class="token punctuation">]</span></code></pre><h3 id="主要文件介绍"><a href="#主要文件介绍" class="headerlink" title="主要文件介绍"></a>主要文件介绍</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""- mysite 文件夹    -- mysite 文件夹        -- setting.py 配置文件        -- urls.py    路由与视图函数对应关系（路由层）        -- wsgi.py    wsgiref(不考虑)    -- manage.py    django 入口文件    -- db.splite3   django 自带的 splite3 数据库（小型数据库，功能不多）        -- app01 文件夹        -- admin.py    django 后台管理        -- apps.py     注册使用        -- migrations 文件夹    数据库迁移记录（日志）        -- models.py      数据库相关的 模型类(orm)        -- test.py         测试文件        -- views.py        视图函数（视图层）"""</span></code></pre><h2 id="pycharm-创建-django-项目演示"><a href="#pycharm-创建-django-项目演示" class="headerlink" title="pycharm 创建 django 项目演示"></a>pycharm 创建 django 项目演示</h2><p><img src="https://img-blog.csdnimg.cn/c3b1f5acf3eb4d78b1b70422c93846d2.gif"><br><img src="https://img-blog.csdnimg.cn/b2bae1bdfbea4a30990f92c29fcdd828.gif"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（3）—— django引入：动静态网页</title>
      <link href="/2022/11/28/django-xue-xi-3-django-yin-ru-dong-jing-tai-wang-ye/"/>
      <url>/2022/11/28/django-xue-xi-3-django-yin-ru-dong-jing-tai-wang-ye/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（3）——-django引入：动静态网页"><a href="#DJango-学习（3）——-django引入：动静态网页" class="headerlink" title="DJango 学习（3）—— django引入：动静态网页"></a>DJango 学习（3）—— django引入：动静态网页</h1><h2 id="动静态网页区别"><a href="#动静态网页区别" class="headerlink" title="动静态网页区别"></a>动静态网页区别</h2><pre class=" language-python"><code class="language-python">静态网页    网页上的数据是直接写死的 万年不变动态网页    数据是实时获取的    eg<span class="token punctuation">.</span> 后端获取当前时间展示到前端html页面上        后端数据从数据库获取展示到 html 页面上</code></pre><h2 id="借助于-wsgiref-模块实现动态网页"><a href="#借助于-wsgiref-模块实现动态网页" class="headerlink" title="借助于 wsgiref 模块实现动态网页"></a>借助于 wsgiref 模块实现动态网页</h2><h3 id="文件夹目录"><a href="#文件夹目录" class="headerlink" title="文件夹目录"></a>文件夹目录</h3><p><img src="https://img-blog.csdnimg.cn/1b27ebd6d8174d44a3993b3ed9916736.png"></p><h3 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a><code>main.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> urls<span class="token keyword">from</span> views <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> wsgiref<span class="token punctuation">.</span>simple_server <span class="token keyword">import</span> make_server<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    :param env: 请求相关的所有数据    :param response: 响应相关的所有数据    :return: 返回给浏览器的数据    """</span>    <span class="token comment" spellcheck="true"># print(env) # 字典 wsgiref 模块处理了 http 格式的数据，封装成了字典更加方便操作</span>    response<span class="token punctuation">(</span><span class="token string">"200 OK"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 响应首行 响应头</span>    current_path <span class="token operator">=</span> env<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"PATH_INFO"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># if current_path == "/index":</span>    <span class="token comment" spellcheck="true">#     return [b"index"]</span>    <span class="token comment" spellcheck="true"># elif current_path == "/login":</span>    <span class="token comment" spellcheck="true">#     return [b"login"]</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># return [b"404 ERROR"]</span>    <span class="token comment" spellcheck="true"># 定义一个变量存储匹配到的函数名</span>    func <span class="token operator">=</span> None    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">.</span>urls<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># url 是 元组</span>        <span class="token keyword">if</span> url<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> current_path<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 匹配到的 url 函数赋值给 func</span>            func <span class="token operator">=</span> url<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token keyword">break</span> <span class="token comment" spellcheck="true"># 匹配到一个后，应该立马结束 for 循环</span>    <span class="token comment" spellcheck="true"># 判断 func 是否有值</span>    <span class="token keyword">if</span> func<span class="token punctuation">:</span>        res <span class="token operator">=</span> func<span class="token punctuation">(</span>env<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> error<span class="token punctuation">(</span>env<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>res<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 实时监听 127.0.0.1:8080 地址，只要有客户端来了就会交给 run 函数处理(加括号触发 run 函数的运行)</span>    server <span class="token operator">=</span> make_server<span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">,</span> run<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a><code>urls.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> views <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment" spellcheck="true"># url 和 函数的对应关系</span>urls <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> login<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"/time"</span><span class="token punctuation">,</span> get_time<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">'/dic'</span><span class="token punctuation">,</span> get_dict<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 放在 url.py 中</span></code></pre><h3 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a><code>views.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"index"</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"404 error"</span><span class="token comment" spellcheck="true"># 第一种方式，改变 html 文件本身代码</span><span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">get_time</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>    now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d %X"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 如何将后端获取的数据 ”传递“ 到 html 文件</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>r<span class="token string">"templates/01-get_time.html"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># data 就是字符串</span>    data <span class="token operator">=</span> data<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"time"</span><span class="token punctuation">,</span> now_time<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 在后端将 html 页面处理好之后在返回给前端</span>    <span class="token keyword">return</span> data<span class="token comment" spellcheck="true"># 第二种方式借助 jianjia2 模块</span><span class="token comment" spellcheck="true"># 将一个字典传递给 html 文件 并且可以在文件上方便快捷的操作字典数据</span><span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token keyword">def</span> <span class="token function">get_dict</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    user_dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"username"</span><span class="token punctuation">:</span> <span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>r<span class="token string">"templates/01-get_dict.html"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        data <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    tep <span class="token operator">=</span> Template<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    res <span class="token operator">=</span> tep<span class="token punctuation">.</span>render<span class="token punctuation">(</span>user<span class="token operator">=</span>user_dic<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 给 html 传递了一个值，页面上通过变量名 user 就能拿到 user_dic</span>    <span class="token keyword">return</span> res<span class="token comment" spellcheck="true"># 后端获取数据库中数据展示到前端页面</span></code></pre><h3 id="01-get-time-html"><a href="#01-get-time-html" class="headerlink" title="01-get_time.html"></a><code>01-get_time.html</code></h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>HTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>time<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="01-get-dict-html"><a href="#01-get-dict-html" class="headerlink" title="01-get_dict.html"></a><code>01-get_dict.html</code></h3><pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>!DOCTYPE html<span class="token operator">></span><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>h1<span class="token operator">></span>我是一个页面<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> user <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> user<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> user<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre><h2 id="模板语法之-jinja-2-模块"><a href="#模板语法之-jinja-2-模块" class="headerlink" title="模板语法之 jinja 2 模块"></a>模板语法之 jinja 2 模块</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 模块语法（非常贴近 python，是在后端起作用的）</span><span class="token punctuation">{</span><span class="token punctuation">{</span> user <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> user<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token punctuation">{</span> user<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token operator">%</span> <span class="token keyword">for</span> user_dic <span class="token keyword">in</span> user_list <span class="token operator">%</span><span class="token punctuation">}</span><span class="token operator">&lt;</span>tr<span class="token operator">></span><span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> user_dic<span class="token punctuation">.</span>id <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>         <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> user_dic<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>         <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> user_dic<span class="token punctuation">.</span>sex <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span>         <span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> user_dic<span class="token punctuation">.</span>age <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>td<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>tr<span class="token operator">></span><span class="token punctuation">{</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">}</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/e70c0e3445254e87937d03f9b685d2a2.gif"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（2）—— django引入：借助于wsgiref模块（web服务网关接口）搭建简易 web 框架</title>
      <link href="/2022/11/28/django-xue-xi-2-django-yin-ru-jie-zhu-yu-wsgiref-mo-kuai-web-fu-wu-wang-guan-jie-kou-da-jian-jian-yi-web-kuang-jia/"/>
      <url>/2022/11/28/django-xue-xi-2-django-yin-ru-jie-zhu-yu-wsgiref-mo-kuai-web-fu-wu-wang-guan-jie-kou-da-jian-jian-yi-web-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（2）——-django-引入：借助于-wsgiref-模块（web服务网关接口）搭建简易-web-框架"><a href="#DJango-学习（2）——-django-引入：借助于-wsgiref-模块（web服务网关接口）搭建简易-web-框架" class="headerlink" title="DJango 学习（2）—— django 引入：借助于 wsgiref 模块（web服务网关接口）搭建简易 web 框架"></a>DJango 学习（2）—— django 引入：借助于 wsgiref 模块（web服务网关接口）搭建简易 web 框架</h1><h2 id="使用-socket-的简易-web-框架的局限性"><a href="#使用-socket-的简易-web-框架的局限性" class="headerlink" title="使用 socket 的简易 web 框架的局限性"></a>使用 socket 的简易 web 框架的局限性</h2><pre class=" language-python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span> 代码重复<span class="token number">2</span><span class="token punctuation">.</span> 手动处理 http 格式的数据 并且只能拿到 url 后缀，其他数据获取繁琐<span class="token number">3</span><span class="token punctuation">.</span> 并发问题</code></pre><h2 id="借助-wsgiref-模块"><a href="#借助-wsgiref-模块" class="headerlink" title="借助 wsgiref 模块"></a>借助 wsgiref 模块</h2><pre class=" language-python"><code class="language-python">前提准备，建立多个文件和文件夹<span class="token triple-quoted-string string">"""urls.py      路由(网址后缀)与视图函数（处理业务逻辑的函数）对应关系views.py          存放视图函数(后端业务逻辑)templates文件夹    存储 html 文件"""</span></code></pre><p><img src="https://img-blog.csdnimg.cn/7798d0acf0d24a43ae681dbdb4eea2da.png"></p><h2 id="相关代码"><a href="#相关代码" class="headerlink" title="相关代码"></a>相关代码</h2><h3 id="urls-py"><a href="#urls-py" class="headerlink" title="urls.py"></a><code>urls.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> views <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment" spellcheck="true"># url 和 函数的对应关系</span>urls <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> login<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 放在 url.py 中</span></code></pre><h3 id="views-py"><a href="#views-py" class="headerlink" title="views.py"></a><code>views.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"index"</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token keyword">def</span> <span class="token function">error</span><span class="token punctuation">(</span>env<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"404 error"</span></code></pre><h3 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a><code>main.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> urls<span class="token keyword">from</span> views <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> wsgiref<span class="token punctuation">.</span>simple_server <span class="token keyword">import</span> make_server<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>env<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""    :param env: 请求相关的所有数据    :param response: 响应相关的所有数据    :return: 返回给浏览器的数据    """</span>    <span class="token comment" spellcheck="true"># print(env) # 字典 wsgiref 模块处理了 http 格式的数据，封装成了字典更加方便操作</span>    response<span class="token punctuation">(</span><span class="token string">"200 OK"</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 响应首行 响应头</span>    current_path <span class="token operator">=</span> env<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"PATH_INFO"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># if current_path == "/index":</span>    <span class="token comment" spellcheck="true">#     return [b"index"]</span>    <span class="token comment" spellcheck="true"># elif current_path == "/login":</span>    <span class="token comment" spellcheck="true">#     return [b"login"]</span>    <span class="token comment" spellcheck="true">#</span>    <span class="token comment" spellcheck="true"># return [b"404 ERROR"]</span>    <span class="token comment" spellcheck="true"># 定义一个变量存储匹配到的函数名</span>    func <span class="token operator">=</span> None    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">.</span>urls<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># url 是 元组</span>        <span class="token keyword">if</span> url<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> current_path<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 匹配到的 url 函数赋值给 func</span>            func <span class="token operator">=</span> url<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token keyword">break</span> <span class="token comment" spellcheck="true"># 匹配到一个后，应该立马结束 for 循环</span>    <span class="token comment" spellcheck="true"># 判断 func 是否有值</span>    <span class="token keyword">if</span> func<span class="token punctuation">:</span>        res <span class="token operator">=</span> func<span class="token punctuation">(</span>env<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> error<span class="token punctuation">(</span>env<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>res<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 实时监听 127.0.0.1:8080 地址，只要有客户端来了就会交给 run 函数处理(加括号触发 run 函数的运行)</span>    server <span class="token operator">=</span> make_server<span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">,</span> run<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/eabecc4accb14e07b456627054529a6c.gif"></p><h2 id="优势"><a href="#优势" class="headerlink" title="优势"></a>优势</h2><p><code>按照功能的不同拆分之后，获取添加功能只需要在 urls.py 中书写对应关系然后取 views.py 书写业务逻辑即可</code></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DJango 学习（1）—— django引入：纯手撸最简易 web 框架</title>
      <link href="/2022/11/28/django-xue-xi-1-django-yin-ru-chun-shou-lu-zui-jian-yi-web-kuang-jia/"/>
      <url>/2022/11/28/django-xue-xi-1-django-yin-ru-chun-shou-lu-zui-jian-yi-web-kuang-jia/</url>
      
        <content type="html"><![CDATA[<h1 id="DJango-学习（1）——-django引入：纯手撸-最简易-web-框架"><a href="#DJango-学习（1）——-django引入：纯手撸-最简易-web-框架" class="headerlink" title="DJango 学习（1）—— django引入：纯手撸 最简易 web 框架"></a>DJango 学习（1）—— django引入：纯手撸 最简易 web 框架</h1><h2 id="HTTP-和-HTTPS-的区别"><a href="#HTTP-和-HTTPS-的区别" class="headerlink" title="HTTP 和 HTTPS 的区别"></a>HTTP 和 HTTPS 的区别</h2><pre class=" language-python"><code class="language-python">HTTP 协议 更多的是明码传输HTTPS 协议 数据传输是暗码如何做到后缀不同返回不同的内容——拿到用户输入的网址后缀，返回内容</code></pre><h2 id="手撸-web-框架"><a href="#手撸-web-框架" class="headerlink" title="手撸 web 框架"></a>手撸 web 框架</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''我们可以将 web 框架简单理解为服务端，所以我们在手写简单web 框架时使用的模块应该是 socket 模块。'''</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> socketserver <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># TCP 协议</span>server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># IP 协议，以太网协议</span>server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(data) # 二进制数据</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">"HTTP/1.1 200 OK\r\n\r\n"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 连接成功</span>    data <span class="token operator">=</span> data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 获取字符串中特定的内容    1.正则   2.切割</span>    current_path <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>current_path<span class="token punctuation">)</span>    <span class="token keyword">if</span> current_path <span class="token operator">==</span> <span class="token string">"/login"</span><span class="token punctuation">:</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">"login hahahaha"</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> current_path <span class="token operator">==</span> <span class="token string">"/index"</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># conn.send(b"index")</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"01-MyWeb.html"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>                conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 直接忽略 favicon.ico</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>b<span class="token string">"hello web"</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/088487aceacf471cb46c9371ce0f4e1e.gif"></p>]]></content>
      
      
      <categories>
          
          <category> DJango </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DJango </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（9）—— JQauery简介及事件</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-9-jqauery-jian-jie-ji-shi-jian/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-9-jqauery-jian-jie-ji-shi-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="JQuery简介"><a href="#JQuery简介" class="headerlink" title="JQuery简介"></a>JQuery简介</h1><h2 id="JQuery-介绍"><a href="#JQuery-介绍" class="headerlink" title="JQuery 介绍"></a>JQuery 介绍</h2><pre class=" language-python"><code class="language-python">内部封装了原生的 JS 代码能够写更少的代码，完成 JS 操作类似于 python 中的 模块，在前端中模块不叫模块，叫 ”类库“兼容多个浏览器，不需要考虑兼容问题宗旨：write less do morepython 导入模块发生了几件事？    导入模块需要消耗资源JQuery 在使用时也需要导入，但文件非常小，基本不影响</code></pre><h2 id="JQuery-导入"><a href="#JQuery-导入" class="headerlink" title="JQuery 导入"></a>JQuery 导入</h2><p>两种导入方式</p><ol><li><p>在官网将 JQuery 文件下载到本地，并且导入 <script src="JQuery3.6.0.js"></script></p></li><li><p>直接引入 JQuery 提供的 CDN 服务（基于网络直接加载）</p><p>CDN：内容分发网络</p><p>参考网站：bootcdn</p><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></li></ol><h2 id="JQuery-基本语法"><a href="#JQuery-基本语法" class="headerlink" title="JQuery 基本语法"></a>JQuery 基本语法</h2><pre class=" language-html"><code class="language-html">JQuery("选择器").action() 可以简写成$("选择器").action()</code></pre><h2 id="JQuery-查找标签"><a href="#JQuery-查找标签" class="headerlink" title="JQuery 查找标签"></a>JQuery 查找标签</h2><pre class=" language-html"><code class="language-html">JQuery 查找标签的返回结果都是 JQuery 对象。JQuery 标签对象转化为标签对象    $("span")[0]标签对象转换为 JQuery 标签对象    $(document.getElementById("d1"))id 选择器    $("#d1")class 选择器    $(".c1")标签选择器    $("span")组合、分组、嵌套    $("div.c1")    $("dic, .c1, p")    $("div span")基本筛选器    $("ul li");    $("ul li:first");    $("ul li:eq(2)"); // 索引第二的标签    $("ul li:even"); // 索引为偶数的标签    $("ul li:odd"); // 索引为奇数的标签    $("ul li:gt(2)"); // 索引大于 2 的标签    $("ul li:lt(2)"); // 索引小于 2 的标签     $("ul li:not('#d1')"); // 移除满足条件的标签    $("div:has('p')"); // 选取出包含一个或多个标签在内的标签属性选择器    $("[username='jason']");表单关键词，只适用于表单标签    $(":text");    $(":password");    还包括表单对象属性    $(":enabled");    $(":disabled");    $(":checked"); // 如果选中，拿所有被选中的标签，同时也会拿到 selected    $("input:checked");    $(":selected"); // selected 只拿 selected 的标签    </code></pre><h2 id="筛选器方法"><a href="#筛选器方法" class="headerlink" title="筛选器方法"></a>筛选器方法</h2><pre class=" language-html"><code class="language-html">    $("d1").next(); // 同级别的下一个标签$("d1").nextAll(); // 同级别下面所有的标签    $("d1").nextUntil("c1"); // 同级别的所有标签直到 c1 为止，不包含 c1    $(".c1").prev(); // 上一个标签$(".c1").prevAll(); // 上面所有标签    $(".c1").prevUntil("#d2);    $("#d3").parent(); // 父标签     $("#d3").parent().parent();     $("#d3").parents(); // 所有的父标签，一直到 HTML     $("#d3").parentsUntil("body");     $("#d2").children(); // 所有的子标签     $("#d2").siblings(); // 同级别的所有标签     $("div p");     等价于     $("div").find("p");     $("div span:first);     等价于     $("div span").first();     $("div span").last();</code></pre><h2 id="JQuery-操作标签"><a href="#JQuery-操作标签" class="headerlink" title="JQuery 操作标签"></a>JQuery 操作标签</h2><pre class=" language-html"><code class="language-html">操作类        JS 版本            classList.add()            classList.remove()            classList.contains()            classList.toggle()        JQuery            addClass;            removeClass;            hasClass;            toggleClass;                一行代码让第一个 P 标签内容文字变成红色，第二个 P 标签内容文字变成蓝色        JQuery 的链式操作，JQuery对象调用一个JQuery方法之后返回的是JQuery对象，就意味着还可以继续调用方法        $("p").first().css("color", "red").next().css("color","blue");            位置操作        offset(); // 当前标签和页面的定位距离        position(); // 当前标签和父标签的距离        $(window).scrollTop(); // 滚动条离页面顶部的距离        scrollLeft();             尺寸        $("p").height() // 文本高度        $("p").width() // 文本宽度        $("p").innerHeight() // 文本 + padding        $("p").innerWidth() // 文本 + padding        $("p").outHeight() // 文本 + padding + border        $("p").outWidth() // 文本 + padding + border            文本操作        操作标签内部文本            JS 中                innerText                innerHtml            JQuery 中                text() // 括号内不加参数就是获取，叫参数就是赋值                html()                    获取值操作        JS 中            .value        JQuery 中            .val() // 不加参数是获取，加参数是赋值            文件获取 转成标签对象.files[0]                属性操作        JS 中            setAttribute            getAttribute        JQuery 中            对于标签上有的能够看到的属性和自定义属性用 attr            对于返回布尔值比如 checkbox radio option 是否被选中用 prop                    attr(name, value); // 设置属性            attr(name); // 获取属性            removeAttr(name); // 移除属性                           prop，如 .prop("checked"), .prop("checked", true);                在用变量存储变量的时候         标签对象：JS 中使用 xxxEle 命名        JQuery对象：JQuery 中使用 $xxxEle 命名            文档处理        创建标签            JS 中                createElement            JQuery 中                $("<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>");        添加标签            JS 中                appendChild();            JQuery 中                标签对象.append(); // 内部尾部追加                JQuery对象.append();                .prepend(); // 内部头部追加                                 .remove(); // 移除标签                .empty(); // 清空当前标签内部所有的内容                相当于                .html("");</code></pre><h1 id="JQuery-事件"><a href="#JQuery-事件" class="headerlink" title="JQuery 事件"></a>JQuery 事件</h1><h2 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h2><pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>!DOCTYPE html<span class="token operator">></span><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span><span class="token operator">&lt;</span>head<span class="token operator">></span>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>title<span class="token operator">></span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"JQuery3.6.0.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>    <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">"bootstrap-3.4.1-dist/css/bootstrap.min.css"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"bootstrap-3.4.1-dist/js/bootstrap.min.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span><span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span>button id<span class="token operator">=</span><span class="token string">"d1"</span><span class="token operator">></span>点我<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token operator">//</span> $<span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span>    <span class="token operator">//</span>     function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token operator">//</span>         alert<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">//</span>     <span class="token punctuation">}</span>    <span class="token operator">//</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token operator">//</span> <span class="token punctuation">(</span>功能更强大，支持事件委托<span class="token punctuation">)</span>    $<span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> function <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            alert<span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre><p><img src="https://img-blog.csdnimg.cn/9889f1161f0d4a0784fb03e28255ef04.gif"></p><h2 id="克隆事件"><a href="#克隆事件" class="headerlink" title="克隆事件"></a>克隆事件</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token id">#d1</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px solid red<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> grey<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>是兄弟就来砍我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// this 指代的永远是当前被操作的标签对象</span>        <span class="token comment" spellcheck="true">// console.log(this);</span>        <span class="token comment" spellcheck="true">// 标签对象变成 JQuery 对象</span>        <span class="token comment" spellcheck="true">// $(this);</span>        <span class="token comment" spellcheck="true">// 克隆对象并添加到 body 中</span>        <span class="token comment" spellcheck="true">// 克隆默认不克隆事件</span>        <span class="token comment" spellcheck="true">// $(this).clone().insertAfter($("body"));</span>        <span class="token comment" spellcheck="true">// 克隆事件</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insertAfter</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/3240ed3f1fc74cb0ab18484839b2cd93.gif"></p><h2 id="模态框"><a href="#模态框" class="headerlink" title="模态框"></a>模态框</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.cover</span> </span><span class="token punctuation">{</span>            <span class="token property">position</span><span class="token punctuation">:</span>fixed<span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#4e4e4e</span><span class="token punctuation">;</span>            <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">99</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.modal</span> </span><span class="token punctuation">{</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> wheat<span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span><span class="token number">50%</span><span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span><span class="token number">50%</span><span class="token punctuation">;</span>            <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">300</span>px<span class="token punctuation">;</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span> -<span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.hide</span> </span><span class="token punctuation">{</span>            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>我是最下面的<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点我出来<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cover hide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modal hide<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username:        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username:        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>确认<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>取消<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">let</span> $coverEle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".cover"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> $modalEle <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".modal"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        $coverEle<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $modalEle<span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        $coverEle<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        $modalEle<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/7762e50a34e5472db2a1469642dda41e.gif"></p><h2 id="左侧菜单栏"><a href="#左侧菜单栏" class="headerlink" title="左侧菜单栏"></a>左侧菜单栏</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> darkgrey<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">30%</span><span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.title</span> </span><span class="token punctuation">{</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">33</span>px<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.item</span> </span><span class="token punctuation">{</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span>px solid black<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.hide</span> </span><span class="token punctuation">{</span>            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>menu<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜单一            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜单二            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>菜单三            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>333<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/d69908f22e57445d849b66d051be2f37.gif"></p><h2 id="回到顶部"><a href="#回到顶部" class="headerlink" title="回到顶部"></a>回到顶部</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.hide</span> </span><span class="token punctuation">{</span>            <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">a </span><span class="token punctuation">{</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>            <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>            <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> red</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> green</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span> <span class="token property">background-color</span><span class="token punctuation">:</span> blue</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#d1<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hide d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>回到顶部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scroll</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">scrollTop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">300</span> <span class="token punctuation">)</span><span class="token punctuation">{</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".d2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".d2"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">"hide"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/ac68bd2e8b1b405b8097604b585ef9be.gif"></p><h2 id="自定义用户登录校验"><a href="#自定义用户登录校验" class="headerlink" title="自定义用户登录校验"></a>自定义用户登录校验</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">span </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>username:    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>password:    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>提交<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> username <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#password"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>username<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#username"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">"用户名不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>password<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#password"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">"密码不能为空"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"focus"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/2911bccca4fe4e0cb1975704327251c9.gif"></p><h2 id="input-框实时监控"><a href="#input-框实时监控" class="headerlink" title="input 框实时监控"></a>input 框实时监控</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/df0bd8c72f384f65a2007d2127445454.gif"></p><h2 id="hover-事件"><a href="#hover-事件" class="headerlink" title="hover 事件"></a>hover 事件</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token id">#d1</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#d1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hover</span><span class="token punctuation">(</span>        <span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"我来了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token keyword">function</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"我走了"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/409e2f702a004dc99ec442ec0641e2a5.gif"></p><h2 id="键盘按键事件"><a href="#键盘按键事件" class="headerlink" title="键盘按键事件"></a>键盘按键事件</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>JQuery3.6.0.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/css/bootstrap.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bootstrap-3.4.1-dist/js/bootstrap.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keydown</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"你按下了shift键"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/2f8367e2c3c941d3808b241f02abba58.gif"></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> JQauery </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（8）—— JavaScript 学习之 DOM 操作</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-8-javascript-xue-xi-zhi-dom-cao-zuo/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-8-javascript-xue-xi-zhi-dom-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="DOM-简单介绍"><a href="#DOM-简单介绍" class="headerlink" title="DOM 简单介绍"></a>DOM 简单介绍</h1><pre class=" language-javascript"><code class="language-javascript">DOM    文档对象模型 Document Object Model       JS 代码操作标签DOM 树的概念所有的标签都可以称之为是节点Javascript 可以通过 DOM 创建动态的 HTMLJavascript 能够改变页面中的所有 HTML 元素Javascript 能够改变页面中的所有 HTML 属性Javascript 能够改变页面中的所有 CSS 样式Javascript 能够改变页面中的所有事件作出反应DOM 操作需要 document 起手</code></pre><h1 id="查找标签"><a href="#查找标签" class="headerlink" title="查找标签"></a>查找标签</h1><h2 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h2><pre class=" language-javascript"><code class="language-javascript">命名规范——当你用变量名指代标签对象的时候，一般情况下推荐写成 xxxEle</code></pre><h2 id="直接查找"><a href="#直接查找" class="headerlink" title="直接查找"></a>直接查找</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">// id 查找</span>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 类 查找</span>    document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">"c1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// HTMLCollection?[p.c1];</span>    <span class="token comment" spellcheck="true">// 标签查找</span>    document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// HTMLCollection(2)?[p.c1, p];</span>        <span class="token comment" spellcheck="true">// 注意由于一个 HTML 文件的 id 值是唯一的，所以 id 查找的结果是标签本身，而 类和标签 是可以重复且多个的，所以使用类查找和标签查找返回的是一个数组</span></code></pre><h2 id="间接查找"><a href="#间接查找" class="headerlink" title="间接查找"></a>间接查找</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> divEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>divEle<span class="token punctuation">.</span>parentElement<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 父标签</span>divEle<span class="token punctuation">.</span>children<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 所有儿子标签 HTMLCollection(3)?[div, p.c1, p]</span>divEle<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 第一个子标签，相当于 divEle.children[0];</span>divEle<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 最后一个子标签</span>divEle<span class="token punctuation">.</span>nextElementSibling<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 同级别下面的一个标签</span>divEle<span class="token punctuation">.</span>previousElementSibling<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 同级别上面的第一个标签</span></code></pre><h1 id="节点操作，创建标签"><a href="#节点操作，创建标签" class="headerlink" title="节点操作，创建标签"></a>节点操作，创建标签</h1><h2 id="img-标签"><a href="#img-标签" class="headerlink" title="img 标签"></a>img 标签</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> divEle2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> imgEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>imgEle<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"04-奥特曼.jpg"</span><span class="token punctuation">;</span>imgEle<span class="token punctuation">.</span>alt <span class="token operator">=</span> <span class="token string">"奥特曼"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 采用 .属性 只能对本身存在的属性进行赋值，如果要自创属性，需要使用另一个方法</span>imgEle<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">,</span> <span class="token string">"aoteman"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 这个方法也可以对标签原本就有的属性赋值</span>divEle2<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>imgEle<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 添加到 div 标签尾部</span></code></pre><p><img src="https://img-blog.csdnimg.cn/6b009f42a92b4a4f8a9ae02edfb451d6.gif"></p><h2 id="a-标签"><a href="#a-标签" class="headerlink" title="a 标签"></a>a 标签</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> divEle3 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> aEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>aEle<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">,</span> <span class="token string">"https://www.baidu.com"</span><span class="token punctuation">)</span>aEle<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"点我"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 标签内部文字，相当于 &lt;a href="">点我&lt;/a></span>divEle3<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>aEle<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/e2afa28fc2664cf8b0bd73cd6f39214b.gif"></p><h1 id="innerText-和-innerHTML-的区别"><a href="#innerText-和-innerHTML-的区别" class="headerlink" title="innerText 和 innerHTML 的区别"></a>innerText 和 innerHTML 的区别</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// innerText 和 innerHTML 都可以添加标签内部文字，不同的是 innerHTML 识别 HTML语言</span><span class="token keyword">let</span> divEle4 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> pEle1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>pEle1<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">"&lt;h1>奥特曼&lt;/h1>"</span><span class="token punctuation">;</span>divEle4<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>pEle1<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> pEle2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>pEle2<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">"&lt;h1>奥特曼&lt;/h1>"</span><span class="token punctuation">;</span>divEle4<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>pEle2<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/4bc2ef64ef3a4bf588833f2392b752ae.gif"></p><h1 id="获取值操作"><a href="#获取值操作" class="headerlink" title="获取值操作"></a>获取值操作</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> inputEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"i1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>inputEle<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 123</span><span class="token keyword">let</span> fileEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"i2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>fileEle<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 只能获取上传文件路径  'C:\\fakepath\\exercise2.doc'</span>fileEle<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// File?{name: 'exercise2.doc', lastModified: 1651119519156, lastModifiedDate: Thu Apr 28 2022 12:18:39 GMT+0800 (中国标准时间), webkitRelativePath: '', size: 2878464,?…}</span></code></pre><h1 id="class-操作"><a href="#class-操作" class="headerlink" title="class 操作"></a>class 操作</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> divEle5 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d1"</span><span class="token punctuation">)</span>divEle5<span class="token punctuation">.</span>classList<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 查看标签的类</span>divEle5<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"bt_red"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 移除属性</span>divEle5<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"bt_red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>divEle5<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"c1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 判断是否有某种属性</span>divEle5<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">"bt_red"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 有则移除该属性，没有就添加</span></code></pre><h1 id="CSS-操作"><a href="#CSS-操作" class="headerlink" title="CSS 操作"></a>CSS 操作</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">let</span> pEle3 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>pEle3<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token string">"48px"</span><span class="token punctuation">;</span>pEle3<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/dc3cfbb074b147c1acf5dc7ddb0fc00e.gif"></p><h1 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h1><h2 id="两种绑定方式"><a href="#两种绑定方式" class="headerlink" title="两种绑定方式"></a>两种绑定方式</h2><h3 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>func1()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点我！！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">            <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>点我！！<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token keyword">let</span> btnEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        btnEle<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"asd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/1b8074d478bc4d45aeeb9f3dcb418f64.gif"></p><h2 id="开关灯案例"><a href="#开关灯案例" class="headerlink" title="开关灯案例"></a>开关灯案例</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">div </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.bt_red</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.bt_green</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bt_red bt_green<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>开关灯<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token keyword">let</span> divEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> btnEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        btnEle<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            divEle<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">"bt_green"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/9c4d2ff145364f709b1a22524f27888d.gif"></p><h2 id="input-框获取、失去焦点"><a href="#input-框获取、失去焦点" class="headerlink" title="input 框获取、失去焦点"></a>input 框获取、失去焦点</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>输入用户名<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">let</span> inputEle1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"d1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    inputEle1<span class="token punctuation">.</span>onfocus <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        inputEle1<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    inputEle1<span class="token punctuation">.</span>onblur <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        inputEle1<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">"输入用户名"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/45842192e9c544edb6de7b01266e14cd.gif"></p><h2 id="实时展示当地时间"><a href="#实时展示当地时间" class="headerlink" title="实时展示当地时间"></a>实时展示当地时间</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">button </span><span class="token punctuation">{</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token id">#btn1</span> </span><span class="token punctuation">{</span>            <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>开始<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>停止<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">let</span> inputEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> btnEle1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> btnEle2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"btn2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token keyword">function</span> <span class="token function">showTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        inputEle<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    btnEle1<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>            t <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>showTime<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    btnEle2<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">clearInterval</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>        t <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/be8fff1c03724ec48cf32686cfe965f7.gif"></p><h2 id="省市联动"><a href="#省市联动" class="headerlink" title="省市联动"></a>省市联动</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>province<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--  disabled 表示无法选中  --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span> <span class="token attr-name">selected</span><span class="token punctuation">></span></span>--请选择省份--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>city<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">disabled</span> <span class="token attr-name">selected</span><span class="token punctuation">></span></span>--请选择省份--<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">    <span class="token keyword">let</span> provinceEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"s1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">let</span> cityEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"s2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 模拟省市数据</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"河北省"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"廊坊"</span><span class="token punctuation">,</span><span class="token string">"邯郸"</span><span class="token punctuation">,</span><span class="token string">"唐山"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"北京"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"朝阳区"</span><span class="token punctuation">,</span><span class="token string">"海淀区"</span><span class="token punctuation">,</span> <span class="token string">"昌平区"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"山东"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"威海市"</span><span class="token punctuation">,</span><span class="token string">"烟台市"</span><span class="token punctuation">,</span><span class="token string">"日照"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"上海"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"浦东新区"</span><span class="token punctuation">,</span> <span class="token string">"静安区"</span><span class="token punctuation">,</span><span class="token string">"黄浦区"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token string">"深圳"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token string">"南山区"</span><span class="token punctuation">,</span><span class="token string">"宝安区"</span><span class="token punctuation">,</span><span class="token string">"福田区"</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> optEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"option"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        optEle<span class="token punctuation">.</span>value <span class="token operator">=</span> key<span class="token punctuation">;</span>        optEle<span class="token punctuation">.</span>innerText <span class="token operator">=</span> key<span class="token punctuation">;</span>        provinceEle<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>optEle<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    provinceEle<span class="token punctuation">.</span>onchange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> province <span class="token operator">=</span> provinceEle<span class="token punctuation">.</span>value<span class="token punctuation">;</span>        cityEle<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> cityNum <span class="token keyword">in</span> data<span class="token punctuation">[</span>province<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">let</span> optEle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"option"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            optEle<span class="token punctuation">.</span>value <span class="token operator">=</span> data<span class="token punctuation">[</span>province<span class="token punctuation">]</span><span class="token punctuation">[</span>cityNum<span class="token punctuation">]</span><span class="token punctuation">;</span>            optEle<span class="token punctuation">.</span>innerText <span class="token operator">=</span> data<span class="token punctuation">[</span>province<span class="token punctuation">]</span><span class="token punctuation">[</span>cityNum<span class="token punctuation">]</span><span class="token punctuation">;</span>            cityEle<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>optEle<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><p><img src="https://img-blog.csdnimg.cn/8d6fb35f7f2b45e38530202fa009bffb.gif"></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（7）—— JavaScript 学习之 BOM 操作</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-7-javascript-xue-xi-zhi-bom-cao-zuo/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-7-javascript-xue-xi-zhi-bom-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="BOM-操作简介"><a href="#BOM-操作简介" class="headerlink" title="BOM 操作简介"></a>BOM 操作简介</h1><pre class=" language-javascript"><code class="language-javascript">BOM 操作    浏览器对象模型 Browser Object Model       利用 JS 代码操作浏览器</code></pre><h1 id="当前页面操作"><a href="#当前页面操作" class="headerlink" title="当前页面操作"></a>当前页面操作</h1><h2 id="当前页面高度和宽度"><a href="#当前页面高度和宽度" class="headerlink" title="当前页面高度和宽度"></a>当前页面高度和宽度</h2><pre class=" language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 982</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 722</span></code></pre><h2 id="打开网站"><a href="#打开网站" class="headerlink" title="打开网站"></a>打开网站</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 打开一个网站,第二个参数为空即可，第三个参数写窗口的大小和位置</span>window<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">,</span><span class="token string">"height=800px width=400px"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id="关闭当前页面"><a href="#关闭当前页面" class="headerlink" title="关闭当前页面"></a>关闭当前页面</h2><pre class=" language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1 id="window-子对象"><a href="#window-子对象" class="headerlink" title="window 子对象"></a>window 子对象</h1><pre class=" language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>appName<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 当前浏览器位置</span>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 当前是否是一个浏览器</span>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>appVersion<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 当前浏览器版本</span>window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>platform<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 当前使用的平台，如：win32</span></code></pre><h1 id="history-对象"><a href="#history-对象" class="headerlink" title="history 对象"></a>history 对象</h1><pre class=" language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 后退到上一页</span>window<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 前进到下一页</span></code></pre><h1 id="location-对象"><a href="#location-对象" class="headerlink" title="location 对象"></a>location 对象</h1><pre class=" language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span>location<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 获取对象</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 当前网址</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token string">"http://www.baidu.com"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 赋值并跳转网址</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 刷新网页</span></code></pre><h1 id="弹框"><a href="#弹框" class="headerlink" title="弹框"></a>弹框</h1><h2 id="警告框"><a href="#警告框" class="headerlink" title="警告框"></a>警告框</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"asd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/28946ec11e034488b3d8a5368df92fb9.png"></p><h2 id="确认框"><a href="#确认框" class="headerlink" title="确认框"></a>确认框</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/8c22400d304e4132a738061afd299cd3.png"></p><h2 id="提示框"><a href="#提示框" class="headerlink" title="提示框"></a>提示框</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token string">"给我康康"</span><span class="token punctuation">,</span> <span class="token string">"奥特曼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>什么都不输入：<br><img src="https://img-blog.csdnimg.cn/7870754520b1453e8385ac83a4ac3dbc.png"><br>输入 aoteman ：<br><img src="https://img-blog.csdnimg.cn/5720c440f02c490694f8f6b28dfb4b76.png"></p><h1 id="计时器相关"><a href="#计时器相关" class="headerlink" title="计时器相关"></a>计时器相关</h1><h2 id="过几秒触发"><a href="#过几秒触发" class="headerlink" title="过几秒触发"></a>过几秒触发</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token keyword">function</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alter</span><span class="token punctuation">(</span><span class="token string">"三秒后触发"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span>fun1<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 如果要清除定时任务</span>    <span class="token comment" spellcheck="true">// let t = setTimeout(fun1, 3000);</span>    <span class="token comment" spellcheck="true">// clearTimeout(t);</span></code></pre><h2 id="每过一段时间循环触发"><a href="#每过一段时间循环触发" class="headerlink" title="每过一段时间循环触发"></a>每过一段时间循环触发</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token keyword">function</span> <span class="token function">fun2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"奥特曼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// setInterval(func2, 3000);</span>    <span class="token comment" spellcheck="true">// 在九秒时间内每三秒重复弹出警告框</span>    <span class="token keyword">function</span> <span class="token function">fun3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span>fun2<span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">function</span> <span class="token function">inner</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token function">clearInterval</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span>inner<span class="token punctuation">,</span> <span class="token number">9000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">fun3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（6）——JavaScript 学习（1）</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-6-javascript-xue-xi-1/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-6-javascript-xue-xi-1/</url>
      
        <content type="html"><![CDATA[<h1 id="JS-简单介绍"><a href="#JS-简单介绍" class="headerlink" title="JS 简单介绍"></a>JS 简单介绍</h1><pre class=" language-javascript"><code class="language-javascript">JS 是一种编程语言，也可以写后端代码JS 是一种轻量级的脚本语言，是可插入HTML页面的编程代码，可由浏览器执行</code></pre><h1 id="JS-注释"><a href="#JS-注释" class="headerlink" title="JS 注释"></a>JS 注释</h1><h2 id="单行注释"><a href="#单行注释" class="headerlink" title="单行注释"></a>单行注释</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 单行注释</span></code></pre><h2 id="多行注释"><a href="#多行注释" class="headerlink" title="多行注释"></a>多行注释</h2><pre class=" language-javascript"><code class="language-javascript">        <span class="token comment" spellcheck="true">/*        多行注释        多行注释        多行注释        多行注释         */</span></code></pre><h1 id="JS-引入方式"><a href="#JS-引入方式" class="headerlink" title="JS 引入方式"></a>JS 引入方式</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>script<span class="token operator">></span> 标签内直接书写 JS 代码<span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>script<span class="token operator">></span> 标签内 src 属性引入 JS 文件</code></pre><h1 id="JS-代码结构"><a href="#JS-代码结构" class="headerlink" title="JS 代码结构"></a>JS 代码结构</h1><pre class=" language-javascript"><code class="language-javascript">JS 以分号作为语句的结束但不写分号不会报错，但相当于没有结束符</code></pre><h1 id="JS-变量"><a href="#JS-变量" class="headerlink" title="JS 变量"></a>JS 变量</h1><h2 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h2><pre class=" language-javascript"><code class="language-javascript"> 在 JS 中首次定义变量，需要使用关键词声明        <span class="token number">1</span><span class="token punctuation">.</span> 关键词            <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>        <span class="token number">2</span><span class="token punctuation">.</span> es6  推出的新语法            <span class="token keyword">let</span> name <span class="token operator">=</span> <span class="token number">456</span><span class="token punctuation">;</span></code></pre><h2 id="变量命名规范"><a href="#变量命名规范" class="headerlink" title="变量命名规范"></a>变量命名规范</h2><pre class=" language-javascript"><code class="language-javascript">命名规范    JS 命名规范        <span class="token number">1</span><span class="token punctuation">.</span> JS中变量命名可以是数字、字母或$        <span class="token number">2</span><span class="token punctuation">.</span> JS中变量的命名方式采用驼峰命名，如：                 userName                 passWord    而在python中采用下划线的命名，如：         user_name         pass_word</code></pre><h1 id="JS-中常量"><a href="#JS-中常量" class="headerlink" title="JS 中常量"></a>JS 中常量</h1><pre class=" language-javascript"><code class="language-javascript">     python 默认没有真正意义上的常量，默认用全大写的变量表示常量          JS 中有真正意义上的常量         <span class="token keyword">const</span> pi <span class="token operator">=</span> <span class="token number">3.14</span></code></pre><h1 id="JS-书写位置"><a href="#JS-书写位置" class="headerlink" title="JS 书写位置"></a>JS 书写位置</h1><pre class=" language-javascript"><code class="language-javascript">JS 代码的书写位置     <span class="token number">1</span><span class="token punctuation">.</span> 单独写在 JS 文件中     <span class="token number">2</span><span class="token punctuation">.</span> 使用浏览器提供的 console 页面书写         在浏览器中书写 js 的时候 左上方的清空按钮只是清空当前页面 代码其实还在          如果你想要重新来 最好重新开设一个 页面         （在使用浏览器书写时 你自己书写的js代码推荐你在 自己的HTML页面打开）</code></pre><h1 id="JS-数值类型"><a href="#JS-数值类型" class="headerlink" title="JS 数值类型"></a>JS 数值类型</h1><h2 id="数值类型（number）"><a href="#数值类型（number）" class="headerlink" title="数值类型（number）"></a>数值类型（number）</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">// 整型</span>    <span class="token keyword">var</span> num1 <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 浮点型</span>    <span class="token keyword">var</span> num2 <span class="token operator">=</span> <span class="token number">11.11</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 查看变量数据类型</span>    <span class="token keyword">typeof</span> num1<span class="token punctuation">;</span>    <span class="token keyword">typeof</span> num2<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 注意：NaN 虽然表示 “不是一个数字” 的意思，但是也是数值类型</span>    <span class="token keyword">typeof</span> <span class="token number">NaN</span><span class="token punctuation">;</span></code></pre><h3 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h3><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">// 转换为浮点型</span>    <span class="token keyword">var</span> test1 <span class="token operator">=</span> <span class="token string">"123.12"</span><span class="token punctuation">;</span>    <span class="token function">parseFloat</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 转换为整型</span>    <span class="token function">parseInt</span><span class="token punctuation">(</span>test1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 只要字符串开头是数字就可以转化为 数值类型</span>    <span class="token keyword">var</span> test2 <span class="token operator">=</span> <span class="token string">"123abc456"</span><span class="token punctuation">;</span>    <span class="token function">parseInt</span><span class="token punctuation">(</span>test2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 结果是 123</span>    <span class="token keyword">var</span> test3 <span class="token operator">=</span> <span class="token string">"abc123456"</span><span class="token punctuation">;</span>    <span class="token function">parseInt</span><span class="token punctuation">(</span>test3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 结果是 NaN</span></code></pre><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><pre class=" language-javascript"><code class="language-javascript">注意：name 属性在 JS 语法中比较特殊，不论 <span class="token keyword">var</span> name <span class="token operator">=</span> 任何数据类型，最后的数据类型都是字符串</code></pre><h2 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token keyword">var</span> str1 <span class="token operator">=</span> <span class="token string">"奥特曼"</span><span class="token punctuation">;</span>    <span class="token keyword">typeof</span> str1<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 多行文本，模板字符</span>    <span class="token keyword">var</span> str2 <span class="token operator">=</span> <span class="token template-string"><span class="token string">`    asd    asd    asd`</span></span>    <span class="token comment" spellcheck="true">// 格式化字符串</span>    <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"奥特曼"</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> ss <span class="token operator">=</span> <span class="token template-string"><span class="token string">`My name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and my age is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> !`</span></span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ss<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 打印 ss。结果是 My name is 奥特曼 and my age is 18 !</span></code></pre><h3 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h3><pre class=" language-javascript"><code class="language-javascript">        <span class="token comment" spellcheck="true">// python 中一般使用 join 拼接字符串，不推荐使用 +号</span>        <span class="token comment" spellcheck="true">// JS 推荐使用 +号</span>            <span class="token keyword">var</span> nameAge <span class="token operator">=</span> name <span class="token operator">+</span> age<span class="token punctuation">;</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nameAge<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 注意：这里 name 是字符串类型，age 是 数值类型，却可以拼接                    这是因为 JS 是弱相关的编程语言                    在拼接时，不同的数据类型会自动转换成相同的数据类型操作             */</span></code></pre><h3 id="字符串中常用方法"><a href="#字符串中常用方法" class="headerlink" title="字符串中常用方法"></a>字符串中常用方法</h3><pre class=" language-python"><code class="language-python"> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>            字符串长度                    <span class="token punctuation">.</span>length<span class="token punctuation">(</span><span class="token punctuation">)</span>            消除字符串的空格               <span class="token punctuation">.</span>trim<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span>trimleft<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">.</span>trimeright<span class="token punctuation">(</span><span class="token punctuation">)</span>            返回第 N 个字符<span class="token punctuation">,</span>索引从<span class="token number">0</span>开始     <span class="token punctuation">.</span>chartAt<span class="token punctuation">(</span>n<span class="token punctuation">)</span>            拼接字符串                    <span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">)</span>            子序列在字符串的索引            <span class="token punctuation">.</span>indexOf<span class="token punctuation">(</span><span class="token punctuation">)</span>            根据索引取字符串子序列          <span class="token punctuation">.</span>substring<span class="token punctuation">(</span><span class="token punctuation">)</span>            切片                        <span class="token punctuation">.</span>slice<span class="token punctuation">(</span><span class="token punctuation">)</span>            字符串全小写                  <span class="token punctuation">.</span>toLowerCase<span class="token punctuation">(</span><span class="token punctuation">)</span>            字符串全大写                  <span class="token punctuation">.</span>toUpperCase<span class="token punctuation">(</span><span class="token punctuation">)</span>            切割                        <span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span></code></pre><pre class=" language-javascript"><code class="language-javascript">            <span class="token comment" spellcheck="true">// 计算字符串长度 .length</span>                <span class="token keyword">var</span> test4 <span class="token operator">=</span> <span class="token string">"aoteman"</span><span class="token punctuation">;</span>                test4<span class="token punctuation">.</span>length<span class="token punctuation">;</span>                            <span class="token comment" spellcheck="true">// 移除字符串的空白 .trim，只移除空白，不能移除指定的符号</span>                <span class="token keyword">var</span> test5 <span class="token operator">=</span> <span class="token string">"  aoteman  "</span><span class="token punctuation">;</span>                test5<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 移除字符串左边空白 .trimleft()</span>                <span class="token keyword">var</span> test6 <span class="token operator">=</span> <span class="token string">"  aoteman  "</span><span class="token punctuation">;</span>                test6<span class="token punctuation">.</span><span class="token function">trimLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 移除字符串右边空白 .trimright()</span>                <span class="token comment" spellcheck="true">// 只移除空白，不能传入参数</span>                <span class="token keyword">var</span> test7 <span class="token operator">=</span> <span class="token string">"ao|te|man|"</span><span class="token punctuation">;</span>                test7<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 'ao|te|man|'</span>                            <span class="token comment" spellcheck="true">// 返回第 N 个字符 .charAt(n)</span>                test7<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment" spellcheck="true">// 拼接，.concat()</span>                test7<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 'ao|te|man|a'</span>                            <span class="token comment" spellcheck="true">// 子序列的位置，.indexOf()</span>                test7<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 2</span>                test7<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"|te|m"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 返回第一个字母的位置</span>                            <span class="token comment" spellcheck="true">// 根据索引获取子序列，.substring(from, to)</span>                test7<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// '|te|m'</span>                            <span class="token comment" spellcheck="true">// 切片, .slice(start, end)</span>                test7<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// '|te|m'</span>                            <span class="token comment" spellcheck="true">// 字符串小写, .toLowerCase()</span>                <span class="token keyword">var</span> test8 <span class="token operator">=</span> <span class="token string">"abcABC"</span><span class="token punctuation">;</span>                test8<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment" spellcheck="true">// 字符串大写，.toUperCase();</span>                test8<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment" spellcheck="true">// 分割，.split()</span>                test7<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (4)?['ao', 'te', 'man', '']</span>                <span class="token comment" spellcheck="true">// 取切割后的前两个元素</span>                test7<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (2)?['ao', 'te']</span></code></pre><h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">// 跟 python 不同，在 JS 中布尔值都是小写的值，如：false, true</span>    <span class="token comment" spellcheck="true">// 在 JS 中表示 布尔值的值</span>        <span class="token comment" spellcheck="true">/*        0、null、undefined、NaN         */</span></code></pre><h2 id="null-和-undefined-的区别"><a href="#null-和-undefined-的区别" class="headerlink" title="null 和 undefined 的区别"></a>null 和 undefined 的区别</h2><pre class=" language-javascript"><code class="language-javascript">     <span class="token keyword">null</span> 表示 值为空 一般指定或者情况一个变量时使用        name <span class="token operator">=</span> <span class="token string">'json'</span>        name<span class="token operator">=</span> <span class="token keyword">null</span>             undefined         表示声明了一个变量但是没有做初始化操作（没有赋值）         函数没有指定返回值的时候 返回的也是 undefined</code></pre><h2 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h2><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><pre class=" language-javascript"><code class="language-javascript">    <span class="token keyword">var</span> lst <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">,</span> <span class="token string">"abc"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">typeof</span> lst<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// object</span></code></pre><h4 id="数组常见方法"><a href="#数组常见方法" class="headerlink" title="数组常见方法"></a>数组常见方法</h4><pre class=" language-javascript"><code class="language-javascript"><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">-</span>        数组长度                                <span class="token punctuation">.</span>length        尾部插入                                  <span class="token punctuation">.</span>push        尾部移除元素                                <span class="token punctuation">.</span>pop        头部添加元素                            <span class="token punctuation">.</span>unshift        头部移除元素                              <span class="token punctuation">.</span>shift        切片                                    <span class="token punctuation">.</span>slice        反转                                  <span class="token punctuation">.</span>reverse        拼接成字符串                               <span class="token punctuation">.</span>join        连接成数组                               <span class="token punctuation">.</span>concat        排序                                      <span class="token punctuation">.</span>sort        数组所有元素                             <span class="token punctuation">.</span>forEach        从索引 N 往后删除 M 个元素            <span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> M<span class="token punctuation">)</span>        <span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span><span class="token operator">--</span></code></pre><pre class=" language-javascript"><code class="language-javascript">            <span class="token comment" spellcheck="true">// 数组长度 .length</span>            lst<span class="token punctuation">.</span>length<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 4</span>                        <span class="token comment" spellcheck="true">// 尾部追加元素 .push</span>            lst<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            lst<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (5) [1, '123', 'abc', true, false]</span>                        <span class="token comment" spellcheck="true">// 弹出尾部元素</span>            lst<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// false</span>            lst<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (4) [1, '123', 'abc', true]</span>                        <span class="token comment" spellcheck="true">// 头部插入元素</span>            lst<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token string">"asd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 5</span>            lst<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (5) ['asd', 1, '123', 'abc', true]</span>                        <span class="token comment" spellcheck="true">// 头部移除元素</span>            lst<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "asd"</span>            lst<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (4)?[1, '123', 'abc', true]</span>                        <span class="token comment" spellcheck="true">// 切片</span>            lst<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// [true]</span>                        <span class="token comment" spellcheck="true">// 反转</span>            lst<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (4)?[true, 'abc', '123', 1]</span>                        <span class="token comment" spellcheck="true">// 连接成字符串</span>            lst<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 'true,abc,123,1';</span>                        <span class="token comment" spellcheck="true">// 连接成数组</span>            lst<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">222</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (6)?[true, 'abc', '123', 1, 111, 222]</span>                        <span class="token comment" spellcheck="true">// 排序</span>            <span class="token keyword">var</span> lst1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>            lst1<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// (5)?[1, 2, 3, 5, 9]</span>                        <span class="token comment" spellcheck="true">// 数组内部所有参数</span>            lst1<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> lst1<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 一个参数就是数组里面每一个元素对象</span>                l<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 第二个参数是 索引</span>                l<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span>index<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token comment" spellcheck="true">// 第三个参数表示 参数来自于哪个数组</span>                l<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>value<span class="token punctuation">,</span>index<span class="token punctuation">,</span>arr<span class="token punctuation">)</span> <span class="token punctuation">{</span>                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> index<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token punctuation">;</span>                            <span class="token comment" spellcheck="true">// 从索引 0 往后删除 3 个元素</span>            l<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// 先删除从索引 0 往后的 3 个元素，再增加一个元素 777</span>            l<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">777</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="自定义对象"><a href="#自定义对象" class="headerlink" title="自定义对象"></a>自定义对象</h3><h4 id="字典形式"><a href="#字典形式" class="headerlink" title="字典形式"></a>字典形式</h4><pre class=" language-javascript"><code class="language-javascript">        <span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token keyword">typeof</span> obj1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 'object'</span>        obj1<span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 'aoteman'</span>        obj1<span class="token punctuation">.</span>age<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 18</span></code></pre><h4 id="关键词声明"><a href="#关键词声明" class="headerlink" title="关键词声明"></a>关键词声明</h4><pre class=" language-javascript"><code class="language-javascript">        <span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        obj2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"123"</span><span class="token punctuation">;</span>        obj2<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>        obj2<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// {name: '123', age: 18}</span></code></pre><h4 id="其他-JS-内部对象"><a href="#其他-JS-内部对象" class="headerlink" title="其他 JS 内部对象"></a>其他 JS 内部对象</h4><h5 id="Date-对象"><a href="#Date-对象" class="headerlink" title="Date 对象"></a>Date 对象</h5><pre class=" language-javascript"><code class="language-javascript">            <span class="token keyword">var</span> d1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            d1<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            d6<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 日</span>            d6<span class="token punctuation">.</span><span class="token function">getDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 星期</span>            d6<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 月，0~11月</span>            d6<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//完整年份</span>            d6<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 小时</span>            d6<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 分钟</span>            d6<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 秒</span>            d6<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 毫秒</span>            d6<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 时间戳</span></code></pre><h5 id="JSON-对象"><a href="#JSON-对象" class="headerlink" title="JSON 对象"></a>JSON 对象</h5><pre class=" language-javascript"><code class="language-javascript">            <span class="token comment" spellcheck="true">// 在 python 中 序列化和反序列化</span>                <span class="token comment" spellcheck="true">/*                ----------------------------------                dumps                       序列化                loads                      反序列化                ----------------------------------                 */</span></code></pre><pre class=" language-javascript"><code class="language-javascript">        <span class="token comment" spellcheck="true">// 在js中也有序列化、反序列化</span>            JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// dumps</span>            JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// loads</span>            <span class="token keyword">let</span> obj3 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token string">"age"</span><span class="token punctuation">:</span><span class="token number">456</span><span class="token punctuation">}</span><span class="token punctuation">;</span>            res <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj3<span class="token punctuation">)</span><span class="token punctuation">;</span>            JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>obj3<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">/*判断==，弱等于，内部自动转化为相同的数据类型并进行比较===，强等于，内部数据类型不会自动转换 */</span><span class="token number">1</span> <span class="token operator">==</span> <span class="token string">"1"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// true</span><span class="token number">1</span> <span class="token operator">===</span> <span class="token string">"1"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// false</span></code></pre><h1 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// python 中 and, or, not</span><span class="token comment" spellcheck="true">// 在 JS 中</span>    <span class="token comment" spellcheck="true">/*    ----------------------    和                  &amp;&amp;    或                  ||    非                   ！    ----------------------     */</span>    <span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"5"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "5"</span>    <span class="token number">0</span> <span class="token operator">||</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 1</span>    <span class="token operator">!</span><span class="token number">5</span> <span class="token operator">&amp;&amp;</span> <span class="token string">"5"</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// false</span></code></pre><h1 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h1><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// + -= += *=</span></code></pre><h1 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h1><pre class=" language-javascript"><code class="language-javascript">    <span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 加号在后面，先赋值再自增 +1</span>    <span class="token keyword">var</span> res1 <span class="token operator">=</span> x<span class="token operator">++</span><span class="token punctuation">;</span>    res1<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 10</span>    <span class="token keyword">var</span> res2 <span class="token operator">=</span> <span class="token operator">++</span>x<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 加号在前面，先自增再赋值</span>    res2<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 12</span></code></pre><h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><h2 id="if-判断"><a href="#if-判断" class="headerlink" title="if 判断"></a>if 判断</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">/*    if (条件) {代码块}     */</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>age<span class="token operator">></span><span class="token number">18</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"来啊 来啊"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>age<span class="token operator">></span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"456"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">//if else if else</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>age<span class="token operator">&lt;</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>age<span class="token operator">&lt;</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"456"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"789"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">/*    for (开始条件；循环条件；每次循坏之后的操作) {代码块}     */</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        conlose<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><h2 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h2><pre class=" language-javascript"><code class="language-javascript">    <span class="token comment" spellcheck="true">/*    while (循环条件) {代码块}     */</span>    <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        conlose<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>        i<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span></code></pre><h2 id="switch-语句"><a href="#switch-语句" class="headerlink" title="switch 语句"></a>switch 语句</h2><pre class=" language-javascript"><code class="language-javascript">        <span class="token comment" spellcheck="true">// 提前列举好可能出现的条件和解决方式，之后来匹配</span>        <span class="token comment" spellcheck="true">// 不加 break，匹配到一个之后 就一直往下执行</span>        <span class="token comment" spellcheck="true">// default —- 条件没有匹配上，默认走的流程</span>        <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token keyword">switch</span> <span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span>                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"喝酒"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span>                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"唱歌"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">case</span> <span class="token number">2</span><span class="token punctuation">:</span>                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"再见"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token keyword">break</span><span class="token punctuation">;</span>                <span class="token keyword">default</span><span class="token punctuation">:</span>                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"条件没有匹配上，默认走的流程"</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span></code></pre><h2 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h2><pre class=" language-javascript"><code class="language-javascript">        <span class="token comment" spellcheck="true">// 在 python 中 三元运算符</span>            <span class="token comment" spellcheck="true">// res = 1 if 1>2 else 3</span>        <span class="token comment" spellcheck="true">// 在 JS 中 三元运算符</span>            <span class="token comment" spellcheck="true">// 条件成立取 ?后的值 ，否则取 :后的值</span>            <span class="token keyword">var</span> res <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">></span><span class="token number">2</span><span class="token operator">?</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// res 的值为 3</span></code></pre><h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><pre class=" language-javascript"><code class="language-javascript">在python中定义函数需要 def在 js 中定义函数需要 <span class="token keyword">function</span>格式<span class="token keyword">function</span> <span class="token punctuation">(</span>形参<span class="token number">1</span>，形参<span class="token number">2</span><span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>函数体代码<span class="token punctuation">}</span></code></pre><h2 id="无参函数"><a href="#无参函数" class="headerlink" title="无参函数"></a>无参函数</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//调用 加括号调用，跟 python 一样</span></code></pre><h2 id="有参函数"><a href="#有参函数" class="headerlink" title="有参函数"></a>有参函数</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// argumes 能够获取函数接收到的所有参数</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"传少了"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"传多了"</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">func2</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 传多了没关系，只要对应的数据；少了也没关系</span></code></pre><h2 id="函数返回"><a href="#函数返回" class="headerlink" title="函数返回"></a>函数返回</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token number">666</span> <span class="token comment" spellcheck="true">// 如果返回多个，只能拿到最后一个，所以应该返回一个元组或数组</span><span class="token punctuation">}</span></code></pre><h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 匿名函数 就是没有名字</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello world"</span><span class="token punctuation">)</span><span class="token punctuation">}</span></code></pre><h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><pre class=" language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// 箭头函数（要了解一下）,主要用于处理简单的业务逻辑</span><span class="token comment" spellcheck="true">// 箭头左边是形参，右边是返回值</span><span class="token keyword">var</span> func3 <span class="token operator">=</span> v <span class="token operator">=</span><span class="token operator">></span> v<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 等价于</span><span class="token keyword">var</span> func3 <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> v<span class="token punctuation">}</span><span class="token keyword">var</span> func4 <span class="token operator">=</span> <span class="token punctuation">(</span>arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> arg1<span class="token operator">+</span>arg2<span class="token comment" spellcheck="true">// 等价于</span><span class="token keyword">var</span> fun4 <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arg1<span class="token punctuation">,</span>arg2<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> arg1<span class="token operator">+</span>arg2<span class="token punctuation">}</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（5）—— 静态简易博客页面搭建</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-5-jing-tai-jian-yi-bo-ke-ye-mian-da-jian/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-5-jing-tai-jian-yi-bo-ke-ye-mian-da-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML-代码"><a href="#HTML-代码" class="headerlink" title="HTML 代码"></a>HTML 代码</h1><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gbk<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>博客页面搭建<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>08-博客页面搭建.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blog_user clearfix<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blog_photo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>06-奥特曼.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>头像<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user_msg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>世界的隐喻<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user_data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>interviewed_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>被访问<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>articles_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>原创<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rank<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>排名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>fans<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token entity" title="&nbsp;">&amp;nbsp;</span>粉丝<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>introduce<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我是一个在黑暗中大雪纷飞的人啊......<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reward_rank<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reward<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total_rank<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>原力等级<span class="token entity" title="&nbsp;">&amp;nbsp;</span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>total_score<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>总分<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mouth<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>当月<span class="token entity" title="&nbsp;">&amp;nbsp;</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>achievement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user_achievement<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>个人成就<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>praise<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        获得<span class="token entity" title="&nbsp;">&amp;nbsp;</span>108<span class="token entity" title="&nbsp;">&amp;nbsp;</span>次点赞    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>commen<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        内容获得<span class="token entity" title="&nbsp;">&amp;nbsp;</span>33<span class="token entity" title="&nbsp;">&amp;nbsp;</span>次评论    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>collection<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        获得<span class="token entity" title="&nbsp;">&amp;nbsp;</span>9<span class="token entity" title="&nbsp;">&amp;nbsp;</span>次收藏    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user_column<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>TA<span class="token entity" title="&nbsp;">&amp;nbsp;</span>的专栏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>HTML<span class="token entity" title="&nbsp;">&amp;nbsp;</span>前端开发学习<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>网络通信学习<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>FTP<span class="token entity" title="&nbsp;">&amp;nbsp;</span>项目<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>python<span class="token entity" title="&nbsp;">&amp;nbsp;</span>爬虫<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>python<span class="token entity" title="&nbsp;">&amp;nbsp;</span>动态规划<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>user_hobby<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>兴趣领域<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>数据结构与算法<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            排序算法        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>人工智能<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            回归        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>articles<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article_sort<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sort_link<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://baidu.com<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>按最近发布时间<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sort<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>按访问量<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>不知道写点什么好<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>!<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>time<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>发布博客<span class="token entity" title="&nbsp;">&amp;nbsp;</span>2022.04.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>read_num<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>304<span class="token entity" title="&nbsp;">&amp;nbsp;</span>阅读<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hr</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="CSS-代码"><a href="#CSS-代码" class="headerlink" title="CSS 代码"></a>CSS 代码</h1><pre class=" language-css"><code class="language-css"><span class="token comment" spellcheck="true">/*博客页面样式*/</span><span class="token comment" spellcheck="true">/*通用样式*/</span><span class="token selector">body </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url">url("08-简易博客背景.jpeg")</span> <span class="token punctuation">;</span>    <span class="token property">background-repeat</span><span class="token punctuation">:</span> repeat-x<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*background: black;*/</span><span class="token punctuation">}</span><span class="token selector">a </span><span class="token punctuation">{</span>    <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*color: black;*/</span><span class="token punctuation">}</span><span class="token selector">ul </span><span class="token punctuation">{</span>    <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>    <span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">margin-block-start</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">margin-block-end</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#eeeeee</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">span </span><span class="token punctuation">{</span>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#eeeeee</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/* 去除溢出 */</span><span class="token selector"><span class="token class">.clearfix</span><span class="token pseudo-element">:after</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*用户资料栏*/</span><span class="token selector"><span class="token class">.blog_user</span> </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">100</span>px <span class="token number">10%</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">80%</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">160</span>px<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: 3px black solid;*/</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*用户头像*/</span><span class="token selector"><span class="token class">.blog_photo</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>    <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>    <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">5</span>px solid white<span class="token punctuation">;</span>    <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>    <span class="token property">margin</span><span class="token punctuation">:</span> -<span class="token number">10</span>px <span class="token number">10</span>px <span class="token number">0</span> <span class="token number">10</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.blog_photo</span>>img </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*用户文章数据*/</span><span class="token selector"><span class="token class">.user_msg</span> </span><span class="token punctuation">{</span>    <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.user_data</span> </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.user_data</span> span </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">40</span>px <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> grey<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.interviewed_num</span><span class="token pseudo-element">:before</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"9,975"</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.articles_num</span><span class="token pseudo-element">:before</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">'58'</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.rank</span><span class="token pseudo-element">:before</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">'38,965'</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.fans</span><span class="token pseudo-element">:before</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"13"</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.introduce</span> </span><span class="token punctuation">{</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> grey<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*原力等级*/</span><span class="token selector"><span class="token class">.reward_rank</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">75</span>px<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10%</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: black 3px solid;*/</span>    <span class="token comment" spellcheck="true">/*position: fixed;*/</span>    <span class="token comment" spellcheck="true">/*top: 266px;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.reward</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.total_rank</span> </span><span class="token punctuation">{</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">8</span>px<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*padding-top: 5px;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.total</span> </span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">/*margin-top: 5px;*/</span>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#faeddc</span><span class="token punctuation">;</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span>px <span class="token number">8</span>px <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.total</span> span </span><span class="token punctuation">{</span>    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode">#faeddc</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.total_score</span><span class="token pseudo-element">:after</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"236"</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>    <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.mouth</span><span class="token pseudo-element">:after</span> </span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"20"</span><span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*个人成就*/</span><span class="token selector"><span class="token class">.achievement</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">120</span>px<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10%</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: black 3px solid;*/</span>    <span class="token comment" spellcheck="true">/*position: fixed;*/</span>    <span class="token comment" spellcheck="true">/*top: 352px;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.user_achievement</span> </span><span class="token punctuation">{</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">8</span>px<span class="token punctuation">;</span>    <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.praise</span>,<span class="token class">.commen</span>,<span class="token class">.collection</span> </span><span class="token punctuation">{</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.achievement</span> img </span><span class="token punctuation">{</span>    <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*专栏*/</span><span class="token selector"><span class="token class">.column</span> </span><span class="token punctuation">{</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10%</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: black 3px solid;*/</span>    <span class="token comment" spellcheck="true">/*position: fixed;*/</span>    <span class="token comment" spellcheck="true">/*top: 483px;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.user_column</span> </span><span class="token punctuation">{</span>    <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">8</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.column</span> img </span><span class="token punctuation">{</span>    <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">3</span>px<span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.column</span> li </span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.column</span> li a </span><span class="token punctuation">{</span>    <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.column</span> li a<span class="token pseudo-class">:hover</span></span><span class="token punctuation">{</span>    <span class="token property">color</span><span class="token punctuation">:</span> grey<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*兴趣领域*/</span><span class="token selector"><span class="token class">.hobby</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">180</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10%</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: 3px solid black;*/</span>    <span class="token comment" spellcheck="true">/*position: fixed;*/</span>    <span class="token comment" spellcheck="true">/*top: 694px;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.user_hobby</span> </span><span class="token punctuation">{</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">18</span>px<span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">8</span>px<span class="token punctuation">;</span>    <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.hobby</span> p </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.hobby</span> ul li </span><span class="token punctuation">{</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.hobby</span> li img</span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*用户文章展示*/</span><span class="token selector"><span class="token class">.articles</span> </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">59.5%</span><span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">30.5%</span><span class="token punctuation">;</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">265</span>px<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/*border: 3px black solid;*/</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.article_sort</span> </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">5</span>px <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.article_sort</span> a </span><span class="token punctuation">{</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>    <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.article</span> </span><span class="token punctuation">{</span>    <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.title</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">8</span>px<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.content</span> </span><span class="token punctuation">{</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.data</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span>    <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>    <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>    <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">14</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.time</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.read_num</span> </span><span class="token punctuation">{</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">/*用户文章展现方式排序*/</span><span class="token selector"><span class="token class">.sort_link</span> </span><span class="token punctuation">{</span>    <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.sort_link</span><span class="token pseudo-class">:link</span> </span><span class="token punctuation">{</span>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.sort_link</span><span class="token pseudo-class">:hover</span> </span><span class="token punctuation">{</span>    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#4e4e4e</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.sort_link</span><span class="token pseudo-class">:visited</span> </span><span class="token punctuation">{</span>    <span class="token property">color</span><span class="token punctuation">:</span> orangered<span class="token punctuation">;</span><span class="token punctuation">}</span></code></pre><h1 id="演示结果"><a href="#演示结果" class="headerlink" title="演示结果"></a>演示结果</h1><p><img src="https://img-blog.csdnimg.cn/04b54c80b3464ed9a89430ee4244f4a1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（4）—— CSS 属性相关</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-4-css-shu-xing-xiang-guan/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-4-css-shu-xing-xiang-guan/</url>
      
        <content type="html"><![CDATA[<h1 id="设置长宽"><a href="#设置长宽" class="headerlink" title="设置长宽"></a>设置长宽</h1><h2 id="块级标签设置长宽"><a href="#块级标签设置长宽" class="headerlink" title="块级标签设置长宽"></a>块级标签设置长宽</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''块级标签的宽度默认占浏览器一整行，默认情况下，块级标签的高度由标签内容决定，但可以利用 CSS 样式调整块级标签的高度和宽度'''</span></code></pre><pre class=" language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">            <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>                <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>                <span class="token property">background</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span>                <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>                <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="行内标签设置长宽"><a href="#行内标签设置长宽" class="headerlink" title="行内标签设置长宽"></a>行内标签设置长宽</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''行内标签的高度和宽度由标签内容决定，CSS 调整宽度和高度后不会报错，但浏览器不会执行该内容'''</span></code></pre><pre class=" language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        .s1 {            background: red;        }        .s2 {            background: yellowgreen;            height: 200px;            width: 100px;        }    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>       <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">background</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s1</span> </span><span class="token punctuation">{</span>            <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s2</span> </span><span class="token punctuation">{</span>            <span class="token property">background</span><span class="token punctuation">:</span> yellowgreen<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果"><a href="#演示结果" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/8bef73c8f43c4a69b8bbe7ff4bee37fd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="字体属性"><a href="#字体属性" class="headerlink" title="字体属性"></a>字体属性</h1><h2 id="字体样式"><a href="#字体样式" class="headerlink" title="字体样式"></a>字体样式</h2><pre class=" language-html"><code class="language-html">        .p1,.p2 {            /* font-family 代表的是字体样式，即选择什么字体，可以输入多个字体，如果浏览器没有第一个字体，就自动使用第二个字体 */            font-family: "Bitstream Vera Sans Mono", Monaco, "Courier New", Courier, monospace;        }</code></pre><h2 id="字体大小"><a href="#字体大小" class="headerlink" title="字体大小"></a>字体大小</h2><pre class=" language-html"><code class="language-html">        .p4 {            font-size: 48px;        }</code></pre><h2 id="字体颜色"><a href="#字体颜色" class="headerlink" title="字体颜色"></a>字体颜色</h2><pre class=" language-html"><code class="language-html">        .p3 {            /* 字体颜色 */            color: red;            /*颜色编号*/            /*color: #eeeeee;*/            /*三原色 数字 范围 0~255*/            /*color: rgb(128,23,45);*/            /*第四个参数是透明度，0~1*/            color: rgb(252, 252, 252);        }</code></pre><h2 id="字体粗细"><a href="#字体粗细" class="headerlink" title="字体粗细"></a>字体粗细</h2><pre class=" language-html"><code class="language-html">        .p5 {            /* 字体粗细 */            /* 加粗 */            font-weight: bolder;            /*boloder light 100-900 inherit继承父元素的标签值*/        }        .p6 {            /* 字体粗细 */            /* 细体 */            font-weight: lighter;        }        .p7 {            /*  字体粗细  */            /*  字体斜体  */            font-style: italic;        }</code></pre><h2 id="代码演示-1"><a href="#代码演示-1" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.p1</span>,<span class="token class">.p2</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* font-family 代表的是字体样式，即选择什么字体，可以输入多个字体，如果浏览器没有第一个字体，就自动使用第二个字体 */</span>            <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Bitstream Vera Sans Mono"</span>, Monaco, <span class="token string">"Courier New"</span>, Courier, monospace<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p3</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 字体颜色 */</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p4</span> </span><span class="token punctuation">{</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">48</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p5</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 字体粗细 */</span>            <span class="token comment" spellcheck="true">/* 加粗 */</span>            <span class="token property">font-weight</span><span class="token punctuation">:</span> bolder<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p6</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 字体粗细 */</span>            <span class="token comment" spellcheck="true">/* 细体 */</span>            <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p7</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  字体粗细  */</span>            <span class="token comment" spellcheck="true">/*  字体斜体  */</span>            <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-1"><a href="#演示结果-1" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/bdbd3ae6edd641ab96354e9a7668b1a9.png"></p><h1 id="文字属性"><a href="#文字属性" class="headerlink" title="文字属性"></a>文字属性</h1><h2 id="对齐方式"><a href="#对齐方式" class="headerlink" title="对齐方式"></a>对齐方式</h2><pre class=" language-html"><code class="language-html">        .p1 {            /*  对齐方式  */            /*  居中  */            text-align: center;        }        .p2 {            /*  对齐方式  */            /*  右对齐  */            text-align: right;        }        .p3 {            /*  对齐方式  */            /*  左对齐  */            text-align: left;        }        .p4 {            /*  对齐方式  */            /*  两端对齐  */            text-align: justify;        }</code></pre><h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><pre class=" language-html"><code class="language-html">        .p5 {            /*  装饰器  */            /*  下划线  */            text-decoration: underline;        }        .p6 {            /*  装饰器  */            /*  上划线  */            text-decoration: overline;        }        .p7 {            /*  装饰器  */            /*  删除线  */            text-decoration: line-through;        }        a {            /*  装饰器  */            /*  无装饰，一般用于a标签  */            text-decoration: none;        }</code></pre><h2 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h2><pre class=" language-html"><code class="language-html">        .p8 {            /*  缩进  */            /*  缩进两格  */            /*font-size: 16px;*/            /*text-indent: 32px;*/            text-indent: 2em;        }</code></pre><h2 id="代码演示-2"><a href="#代码演示-2" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.p1</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  对齐方式  */</span>            <span class="token comment" spellcheck="true">/*  居中  */</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p2</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  对齐方式  */</span>            <span class="token comment" spellcheck="true">/*  右对齐  */</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p3</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  对齐方式  */</span>            <span class="token comment" spellcheck="true">/*  左对齐  */</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p4</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  对齐方式  */</span>            <span class="token comment" spellcheck="true">/*  两端对齐  */</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> justify<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p5</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  装饰器  */</span>            <span class="token comment" spellcheck="true">/*  下划线  */</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> underline<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p6</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  装饰器  */</span>            <span class="token comment" spellcheck="true">/*  上划线  */</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> overline<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p7</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  装饰器  */</span>            <span class="token comment" spellcheck="true">/*  删除线  */</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> line-through<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">a </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  装饰器  */</span>            <span class="token comment" spellcheck="true">/*  无装饰，一般用于a标签  */</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p8</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  缩进  */</span>            <span class="token comment" spellcheck="true">/*  缩进两格  */</span>            <span class="token comment" spellcheck="true">/*font-size: 16px;*/</span>            <span class="token comment" spellcheck="true">/*text-indent: 32px;*/</span>            <span class="token property">text-indent</span><span class="token punctuation">:</span> <span class="token number">2</span>em<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p9<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-2"><a href="#演示结果-2" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/ade0d18842a84071ba0871b1a15ff0b4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="背景属性"><a href="#背景属性" class="headerlink" title="背景属性"></a>背景属性</h1><pre class=" language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">            <span class="token selector">div </span><span class="token punctuation">{</span>                <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">1600</span>px<span class="token punctuation">;</span>                <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">1600</span>px<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="背景颜色"><a href="#背景颜色" class="headerlink" title="背景颜色"></a>背景颜色</h2><pre class=" language-html"><code class="language-html">        .d1 {            background-color: yellowgreen;        }</code></pre><h2 id="背景图片"><a href="#背景图片" class="headerlink" title="背景图片"></a>背景图片</h2><pre class=" language-html"><code class="language-html">        .d1 {            /* 默认平铺，即一定要填满区域 */            background-image: url("04-奥特曼.jpg");            /*  不平铺  */            /*background-repeat: no-repeat;*/            /* 浏览器坐标系是三维的，                X轴——水平方向                Y轴——垂直方向                Z轴——指向用户方向             */            /*  沿 Y 轴 平铺，垂直方向  */            /*background-repeat: repeat-y;*/            /*  沿 X 轴 平铺，水平方向  */            background-repeat: repeat-x;        }</code></pre><h2 id="背景位置"><a href="#背景位置" class="headerlink" title="背景位置"></a>背景位置</h2><pre class=" language-html"><code class="language-html">.d1 {            /* position 只有两个参数，第一个参数是距离左的距离，第二个参数是距离上的距离，参数可以是负数 */            background-position: 100px 200px;        }</code></pre><h2 id="背景属性简写"><a href="#背景属性简写" class="headerlink" title="背景属性简写"></a>背景属性简写</h2><pre class=" language-html"><code class="language-html">        .d1 {            /* 简写，参数没有顺序要求 */            background: url("04-奥特曼.jpg") yellowgreen no-repeat 100px 200px;        }</code></pre><h2 id="代码演示-3"><a href="#代码演示-3" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html">        <span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">div </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">1600</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">1600</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/*.d1 {*/</span>        <span class="token comment" spellcheck="true">/*    background-color: yellowgreen;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*.d1 {*/</span>        <span class="token comment" spellcheck="true">/*    !* 默认平铺，即一定要填满区域 *!*/</span>        <span class="token comment" spellcheck="true">/*    background-image: url("04-奥特曼.jpg");*/</span>        <span class="token comment" spellcheck="true">/*    !*  不平铺  *!*/</span>        <span class="token comment" spellcheck="true">/*    background-repeat: no-repeat;*/</span>        <span class="token comment" spellcheck="true">/*    !* 浏览器坐标系是三维的，*/</span>        <span class="token comment" spellcheck="true">/*        X轴——水平方向*/</span>        <span class="token comment" spellcheck="true">/*        Y轴——垂直方向*/</span>        <span class="token comment" spellcheck="true">/*        Z轴——指向用户方向*/</span>        <span class="token comment" spellcheck="true">/*     *!*/</span>        <span class="token comment" spellcheck="true">/*    !*  沿 Y 轴 平铺，垂直方向  *!*/</span>        <span class="token comment" spellcheck="true">/*    !*background-repeat: repeat-y;*!*/</span>        <span class="token comment" spellcheck="true">/*    !*  沿 X 轴 平铺，水平方向  *!*/</span>        <span class="token comment" spellcheck="true">/*    !*background-repeat: repeat-x;*!*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*.d1 {*/</span>        <span class="token comment" spellcheck="true">/*    !* position 只有两个参数，第一个参数是距离左的距离，第二个参数是距离上的距离，参数可以是负数 *!*/</span>        <span class="token comment" spellcheck="true">/*    background-position: 100px 200px;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 简写，参数没有顺序要求 */</span>            <span class="token property">background</span><span class="token punctuation">:</span> <span class="token url">url("04-奥特曼.jpg")</span> yellowgreen no-repeat <span class="token number">100</span>px <span class="token number">200</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-3"><a href="#演示结果-3" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/95c73a78ce274ddcb4e910443ae97ed4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="边框"><a href="#边框" class="headerlink" title="边框"></a>边框</h1><h2 id="普通写法"><a href="#普通写法" class="headerlink" title="普通写法"></a>普通写法</h2><pre class=" language-html"><code class="language-html">        .d1 {            /*  边框，上下左右  */            /*  边框颜色  */            border-left-color: red;            /*  边框样式，实线  */            border-left-style: solid;            /*  边框宽度  */            border-left-width: 5px;            /*  上边框  */            border-top: ;            /*  下边框  */            border-bottom: ;            /*  右边框  */            border-right: ;        }</code></pre><h2 id="简写"><a href="#简写" class="headerlink" title="简写"></a>简写</h2><pre class=" language-html"><code class="language-html">        .d1 {            /*  简写，参数也没有顺序  */            border: 3px red solid;        }</code></pre><h2 id="弧度设置"><a href="#弧度设置" class="headerlink" title="弧度设置"></a>弧度设置</h2><pre class=" language-html"><code class="language-html">        .d1 {            border: red 3px solid;            /*  弧度设置，设置为 50%，如果长宽一样，那么边框就是圆形，否则是椭圆  */            border-radius: 50%;        }</code></pre><h2 id="代码演示-4"><a href="#代码演示-4" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">div </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/*.d1 {*/</span>        <span class="token comment" spellcheck="true">/*    !*  边框，上下左右  *!*/</span>        <span class="token comment" spellcheck="true">/*    !*  边框颜色  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-left-color: red;*/</span>        <span class="token comment" spellcheck="true">/*    !*  边框样式，实线  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-left-style: solid;*/</span>        <span class="token comment" spellcheck="true">/*    !*  边框宽度  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-left-width: 5px;*/</span>        <span class="token comment" spellcheck="true">/*    !*  上边框  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-top: ;*/</span>        <span class="token comment" spellcheck="true">/*    !*  下边框  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-bottom: ;*/</span>        <span class="token comment" spellcheck="true">/*    !*  右边框  *!*/</span>        <span class="token comment" spellcheck="true">/*    border-right: ;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*.d1 {*/</span>        <span class="token comment" spellcheck="true">/*    !*  简写，参数也没有顺序  *!*/</span>        <span class="token comment" spellcheck="true">/*    border: 3px red solid;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">border</span><span class="token punctuation">:</span> red <span class="token number">3</span>px solid<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*  弧度设置，设置为 50%，如果长宽一样，那么边框就是圆形，否则是椭圆  */</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-4"><a href="#演示结果-4" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/a5f4fda387e5474c9db6343a969b9995.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_17,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="display-属性"><a href="#display-属性" class="headerlink" title="display 属性"></a>display 属性</h1><p>标签转化为块级标签 ，行内标签，行内块标签</p><h2 id="代码演示-5"><a href="#代码演示-5" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 转换为行内标签 */</span>            <span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s1</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  转化为块级标签  */</span>            <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s2</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/*  既有块级元素的特征又有行内元素的特征  */</span>            <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-5"><a href="#演示结果-5" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/1fb2a9f8f3554606abe93c1425d49f82.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="盒子模型"><a href="#盒子模型" class="headerlink" title="盒子模型"></a>盒子模型</h1><h2 id="margin-属性"><a href="#margin-属性" class="headerlink" title="margin 属性"></a>margin 属性</h2><p>以快递作类比，<br>    快递盒与快递盒之间的距离，在 HTML 中表现为标签和标签之间的距离，即外边距，属性名为 margin</p><h3 id="代码演示-6"><a href="#代码演示-6" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 浏览器默认 body 自带 margin，所以我们一般先去除 body 的 margin*/</span>            <span class="token comment" spellcheck="true">/* margin 0 表示上下左右外边距都是 0 */</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*第一个上下 第二个左右*/</span>            <span class="token comment" spellcheck="true">/*margin: 10px 20px;*/</span>            <span class="token comment" spellcheck="true">/*第一个上，第二个左右，第三个下*/</span>            <span class="token comment" spellcheck="true">/*margin: 10px 20px 30px;*/</span>            <span class="token comment" spellcheck="true">/*上 右 下 左*/</span>            <span class="token comment" spellcheck="true">/*margin: 10px 20px 30px 40px;*/</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 上外边距 */</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 下外边距 */</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 左外边距 */</span>            <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 右外边距 */</span>            <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 此时 d2 的 margin-top 是 d1 的 margin-bottom，浏览器在渲染时选择数值较大的那个作为外边距，即 d1 和 d2 的距离仍是 10px */</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-6"><a href="#演示结果-6" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/b9311bdac72048909bb42a5eb0e90272.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="border-属性"><a href="#border-属性" class="headerlink" title="border 属性"></a>border 属性</h2><p>快递盒的厚度，在 HTML 中表现为标签的边框，属性名为 border</p><h2 id="padding-属性"><a href="#padding-属性" class="headerlink" title="padding 属性"></a>padding 属性</h2><p>快递盒内物体和快递盒之间的距离，即标签和标签内容之间的距离，属性名为 padding</p><h3 id="代码演示-7"><a href="#代码演示-7" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">span </span><span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">/* 简写和 margin 基本一致 */</span>            <span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token number">15</span>px<span class="token punctuation">;</span>            <span class="token property">padding-right</span><span class="token punctuation">:</span> <span class="token number">5</span>px<span class="token punctuation">;</span>            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token number">20</span>px<span class="token punctuation">;</span>            <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token number">10</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s1</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.s2</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#3CA6FF</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-7"><a href="#演示结果-7" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/ec09684ca7ce4e31a7b403d2e1f2e6c6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="content-属性"><a href="#content-属性" class="headerlink" title="content 属性"></a>content 属性</h2><p>快递盒内物品的大小，content</p><h1 id="浮动"><a href="#浮动" class="headerlink" title="浮动"></a>浮动</h1><p>在写一个网页页面时，我们常常使用 div 标签占位，显然易见，我们会有两个 div 在一行的情况出现。这种情况我们可以用 display 的属性进行解决，但一般情况下，我们不考虑这种方式，而是选择浮动。<br>    而且我们在实验时发现使用 display 实现 两个 div 在一行 会在两个 div 中出现 margin，使用浮动则不会有这种情况</p><h2 id="代码演示-8"><a href="#代码演示-8" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*display: inline-block;*/</span>            <span class="token comment" spellcheck="true">/* 向左浮动 */</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*display: inline-block;*/</span>            <span class="token comment" spellcheck="true">/*  向左浮动  */</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d3</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*  向右浮动  */</span>            <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="代码演示——display-和-浮动对比"><a href="#代码演示——display-和-浮动对比" class="headerlink" title="代码演示——display 和 浮动对比"></a>代码演示——display 和 浮动对比</h2><p><img src="https://img-blog.csdnimg.cn/a16a7d09f9354b5f89e4fc9cba17757f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br><img src="https://img-blog.csdnimg.cn/f75bba00a2df4886a12cf7b745f2698a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="浮动带来的塌陷"><a href="#浮动带来的塌陷" class="headerlink" title="浮动带来的塌陷"></a>浮动带来的塌陷</h1><p>浮动虽然很好用，但在使用过程中，浮动会造成父标签的塌陷——因为 div 的子标签浮动，所以父标签的 div 因为 没有设置长宽导致无法被撑开，上下边框直接重合。</p><h2 id="塌陷演示"><a href="#塌陷演示" class="headerlink" title="塌陷演示"></a>塌陷演示</h2><h3 id="塌陷代码演示"><a href="#塌陷代码演示" class="headerlink" title="塌陷代码演示"></a>塌陷代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px black solid<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d3</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="塌陷演示结果"><a href="#塌陷演示结果" class="headerlink" title="塌陷演示结果"></a>塌陷演示结果</h3><p><img src="https://img-blog.csdnimg.cn/ccf263fc047843a2ab3dd670ba67c3e3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="塌陷解决方法"><a href="#塌陷解决方法" class="headerlink" title="塌陷解决方法"></a>塌陷解决方法</h2><pre class=" language-python"><code class="language-python"> 解决方法        <span class="token number">1</span><span class="token punctuation">.</span> 在 父标签中添加一个和浮动的标签长宽相等的 子标签撑开父标签        <span class="token number">2</span><span class="token punctuation">.</span> 使用 clear 属性，作用是去除浮动        <span class="token number">3</span><span class="token punctuation">.</span> 通用方法，写一个 <span class="token punctuation">.</span>clearfix<span class="token punctuation">:</span>after 的 css，以后只要出现塌陷，就在 该标签的 <span class="token keyword">class</span> 中 添加该 类 就行了</code></pre><h3 id="代码演示-9"><a href="#代码演示-9" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.clearfix</span><span class="token pseudo-element">:after</span> </span><span class="token punctuation">{</span>            <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>            <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>            <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px black solid<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d3</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>            <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/*.d4 {*/</span>        <span class="token comment" spellcheck="true">/*    !*height: 200px;*!*/</span>        <span class="token comment" spellcheck="true">/*    !*width: 200px;*!*/</span>        <span class="token comment" spellcheck="true">/*    !* both 表示上下左右都清除浮动，除了 both，参数还可以是 top, left, right , bottom *!*/</span>        <span class="token comment" spellcheck="true">/*    !* left 表示只清楚左边浮动 *!*/</span>        <span class="token comment" spellcheck="true">/*    clear: left;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1 clearfix<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-8"><a href="#演示结果-8" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/6aa715e170244201b943e20a884c4a60.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h1><h2 id="静态（static）"><a href="#静态（static）" class="headerlink" title="静态（static）"></a>静态（static）</h2><p>默认情况下，所有的网页标签都是静态的（static），没法改变位置</p><h2 id="相对定位（relative）"><a href="#相对定位（relative）" class="headerlink" title="相对定位（relative）"></a>相对定位（relative）</h2><p>相对于标签原来的位置进行移动（relative）</p><h3 id="代码演示-10"><a href="#代码演示-10" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 相对定位 */</span>            <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 自上而下移动 200px ，如果是负数，方向相反 */</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*  自左向右，如果是负数，方向相反  */</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-9"><a href="#演示结果-9" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/ce3b5cc8ff794739aa4b547a43459d7a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="绝对定位（absolute）"><a href="#绝对定位（absolute）" class="headerlink" title="绝对定位（absolute）"></a>绝对定位（absolute）</h2><p>相对于已经定位过的父标签位置进行移动，如果没有父标签，那么就以 body 为参照<br>        eg. 小米购物车</p><h3 id="代码演示-11"><a href="#代码演示-11" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d3</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 绝对定位 */</span>            <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-10"><a href="#演示结果-10" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/8dddc951d785402a91717361a98db84f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="固定定位（fixed）"><a href="#固定定位（fixed）" class="headerlink" title="固定定位（fixed）"></a>固定定位（fixed）</h2><p>相对于浏览器固定在固定位置<br>    eg.网站右侧导航栏（如：回到顶部）</p><h3 id="代码演示-12"><a href="#代码演示-12" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d4</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">800</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d5</span> </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*border-radius: 50%;*/</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px <span class="token hexcode">#4e4e4e</span> solid<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#A00300</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/*  固定定位  */</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d4<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background-color</span><span class="token punctuation">:</span> red</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d4<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background-color</span><span class="token punctuation">:</span> yellow</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d4<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">background-color</span><span class="token punctuation">:</span> green</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>回到顶部<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="浮动、定位是否脱离文档流"><a href="#浮动、定位是否脱离文档流" class="headerlink" title="浮动、定位是否脱离文档流"></a>浮动、定位是否脱离文档流</h1><h2 id="脱离文档流"><a href="#脱离文档流" class="headerlink" title="脱离文档流"></a>脱离文档流</h2><p>移动后原位置被下面的标签所占据</p><h2 id="不脱离文档流"><a href="#不脱离文档流" class="headerlink" title="不脱离文档流"></a>不脱离文档流</h2><p>相对定位</p><h2 id="脱离文档流-1"><a href="#脱离文档流-1" class="headerlink" title="脱离文档流"></a>脱离文档流</h2><p>浮动<br>绝对定位<br>固定定位</p><h1 id="透明度-opacity"><a href="#透明度-opacity" class="headerlink" title="透明度 opacity"></a>透明度 opacity</h1><p>简单来说，opacity 调整不仅可以调整颜色透明度，还可以调整字体的透明度，而 rgba 只能调整颜色透明度</p><h2 id="代码演示-13"><a href="#代码演示-13" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>            <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d2</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span>, <span class="token number">255</span>, <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>111<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>222<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-11"><a href="#演示结果-11" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/37e8da30720d4473b3a2223f44681fe2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_15,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="溢出"><a href="#溢出" class="headerlink" title="溢出"></a>溢出</h1><h2 id="溢出现象"><a href="#溢出现象" class="headerlink" title="溢出现象"></a>溢出现象</h2><p>有时候由于标签内部内容太长，而标签本身大小过小，导致在页面渲染展示时会造成内容仍然展示，但内容在标签外部的情况</p><h3 id="代码演示-14"><a href="#代码演示-14" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">p </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px black solid<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>12345612345612345612345612345612345612335<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-12"><a href="#演示结果-12" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/8899b9b60f964ef1a25e9795e7b88a9d.png"></p><h2 id="溢出解决方法"><a href="#溢出解决方法" class="headerlink" title="溢出解决方法"></a>溢出解决方法</h2><p>overflow 属性的使用<br>        hidden：隐藏溢出部分<br>        auto：自动，溢出部分滚动条</p><h3 id="代码演示-15"><a href="#代码演示-15" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">p </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">50</span>px<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px black solid<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 隐藏溢出部分 */</span>            <span class="token comment" spellcheck="true">/*overflow: hidden;*/</span>            <span class="token comment" spellcheck="true">/* 自动，溢出部分滚动条 */</span>            <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>12345612345612345612345612345612345612335<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-13"><a href="#演示结果-13" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/6f722c8cee144363a28c1e058de08537.png"><br><img src="https://img-blog.csdnimg.cn/e8d9cc6c2cda43628a98ee37d3d907e0.png"></p><h2 id="溢出的应用"><a href="#溢出的应用" class="headerlink" title="溢出的应用"></a>溢出的应用</h2><h3 id="代码演示-16"><a href="#代码演示-16" class="headerlink" title="代码演示"></a>代码演示</h3><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#4e4e4e</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">div </span><span class="token punctuation">{</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">3</span>px white solid<span class="token punctuation">;</span>            <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> auto<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">div>img </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>04-奥特曼.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>头像<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h3 id="演示结果-14"><a href="#演示结果-14" class="headerlink" title="演示结果"></a>演示结果</h3><p><img src="https://img-blog.csdnimg.cn/1a26845e1b76496e8eb61afea8716fe6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h1 id="z-index-模态框"><a href="#z-index-模态框" class="headerlink" title="z-index 模态框"></a>z-index 模态框</h1><h2 id="代码演示-17"><a href="#代码演示-17" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">body </span><span class="token punctuation">{</span>            <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.cover</span> </span><span class="token punctuation">{</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span>,<span class="token number">0</span>,<span class="token number">0</span>,<span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 相当于z轴坐标为99，即更靠近用户 */</span>            <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">99</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.modal</span> </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>            <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">400</span>px<span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">/* 如果没有 z-index，modal 会被 cover 遮住，但由于浏览器优先展示文字内容，所以在运行时看起来像是颜色被遮住，事实上应该是全部被遮住 */</span>            <span class="token property">z-index</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>这是最底层<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cover<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>modal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>用户登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>用户名        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>密码        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>点我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h2 id="演示结果-15"><a href="#演示结果-15" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/f9404e045e9d4667b1e0fc204f97f0f2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（3）—— CSS 选择器</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-3-css-xuan-ze-qi/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-3-css-xuan-ze-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="CSS-注释"><a href="#CSS-注释" class="headerlink" title="CSS 注释"></a>CSS 注释</h1><pre class=" language-python"><code class="language-python"><span class="token operator">/</span><span class="token operator">*</span>单行注释<span class="token operator">*</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">*</span>    多行注释    多行注释    多行注释    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token operator">*</span><span class="token operator">/</span>通常我们在写 CSS 样式的时候也会用注释来划定样式区域（因为 HTML 代码多所以对应的CSS代码会很多）        <span class="token operator">/</span><span class="token operator">*</span> 这是首页的 CSS 样式文件 <span class="token operator">*</span><span class="token operator">/</span>        <span class="token operator">/</span><span class="token operator">*</span>顶部导航栏样式<span class="token operator">*</span><span class="token operator">/</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token operator">/</span><span class="token operator">*</span>左侧菜单栏注释<span class="token operator">*</span><span class="token operator">/</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        <span class="token operator">/</span><span class="token operator">*</span>右侧菜单栏注释<span class="token operator">*</span><span class="token operator">/</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><h1 id="CSS-语法结构"><a href="#CSS-语法结构" class="headerlink" title="CSS 语法结构"></a>CSS 语法结构</h1><pre class=" language-python"><code class="language-python">选择器 <span class="token punctuation">{</span>        属性<span class="token number">1</span><span class="token punctuation">:</span> 值<span class="token number">1</span><span class="token punctuation">;</span>        属性<span class="token number">2</span><span class="token punctuation">:</span> 值<span class="token number">2</span><span class="token punctuation">;</span>        属性<span class="token number">3</span><span class="token punctuation">:</span> 值<span class="token number">3</span><span class="token punctuation">;</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token punctuation">}</span></code></pre><h1 id="CSS-三种引入方式"><a href="#CSS-三种引入方式" class="headerlink" title="CSS 三种引入方式"></a>CSS 三种引入方式</h1><h2 id="行内式"><a href="#行内式" class="headerlink" title="行内式"></a>行内式</h2><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></code></pre><h2 id="link-引入"><a href="#link-引入" class="headerlink" title="link 引入"></a>link 引入</h2><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>03-MyCSS.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><h2 id="style"><a href="#style" class="headerlink" title="style"></a>style</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">            <span class="token selector">h1 </span><span class="token punctuation">{</span>                <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></code></pre><h1 id="CSS-基础选择器"><a href="#CSS-基础选择器" class="headerlink" title="CSS 基础选择器"></a>CSS 基础选择器</h1><h2 id="id-选择器"><a href="#id-选择器" class="headerlink" title="id 选择器"></a>id 选择器</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector"><span class="token id">#p1</span> </span><span class="token punctuation">{</span>                    <span class="token property">color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector"><span class="token class">.p2</span> </span><span class="token punctuation">{</span>                    <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫abc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="元素（标签）选择器"><a href="#元素（标签）选择器" class="headerlink" title="元素（标签）选择器"></a>元素（标签）选择器</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector">div </span><span class="token punctuation">{</span>                    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#A00300</span><span class="token punctuation">;</span>                <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="通用选择器"><a href="#通用选择器" class="headerlink" title="通用选择器"></a>通用选择器</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector">* </span><span class="token punctuation">{</span>                    <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>                <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫abc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="基础选择器代码演示"><a href="#基础选择器代码演示" class="headerlink" title="基础选择器代码演示"></a>基础选择器代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!--    &lt;link rel="stylesheet" href="03-MyCSS.css">--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">* </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token id">#p1</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.p2</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">div </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#A00300</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/*h1 {*/</span>        <span class="token comment" spellcheck="true">/*    color: red;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--行内式--></span>    <span class="token comment" spellcheck="true">&lt;!--&lt;h1 style="color: green;">123&lt;/h1>--></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>我叫abc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="CSS-组合选择器"><a href="#CSS-组合选择器" class="headerlink" title="CSS 组合选择器"></a>CSS 组合选择器</h1><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''    在前端 我们将标签的嵌套用亲戚关系来表述层级                &lt;div>div                    &lt;p>div&lt;/p>                    &lt;p>div p                        &lt;span>div p span&lt;/span>                    &lt;/p>                    &lt;span>span&lt;/span>                    &lt;span>span&lt;/span>                &lt;/div>    div 里面的 p span 都是 div 的后代    p 是 div 的儿子    p 里面的 span 是 p 的儿子 是 div 的孙子    div 是 p 的父亲'''</span></code></pre><h2 id="后代选择器"><a href="#后代选择器" class="headerlink" title="后代选择器"></a>后代选择器</h2><pre class=" language-html"><code class="language-html">        div span {                    color:red;                }</code></pre><h2 id="儿子选择器"><a href="#儿子选择器" class="headerlink" title="儿子选择器"></a>儿子选择器</h2><pre class=" language-html"><code class="language-html">        div>span {                    color: red;                }</code></pre><h2 id="毗邻选择器"><a href="#毗邻选择器" class="headerlink" title="毗邻选择器"></a>毗邻选择器</h2><pre class=" language-html"><code class="language-html">        div+span { /*同级别紧挨着的下面的第一个*/                    color: red;                }</code></pre><h2 id="弟弟选择器"><a href="#弟弟选择器" class="headerlink" title="弟弟选择器"></a>弟弟选择器</h2><pre class=" language-html"><code class="language-html">        div~span { /*同级别，下面所有的标签*/                    color: red;                }</code></pre><h2 id="组合选择器代码演示"><a href="#组合选择器代码演示" class="headerlink" title="组合选择器代码演示"></a>组合选择器代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token comment" spellcheck="true">/*!*后代选择器*!*/</span>        <span class="token comment" spellcheck="true">/*div span {*/</span>        <span class="token comment" spellcheck="true">/*    color:red;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*!*儿子选择器*!*/</span>        <span class="token comment" spellcheck="true">/*div>span {*/</span>        <span class="token comment" spellcheck="true">/*    color: red;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*!*毗邻选择器*!*/</span>        <span class="token comment" spellcheck="true">/*div+span { !*同级别紧挨着的下面的第一个*!*/</span>        <span class="token comment" spellcheck="true">/*    color: red;*/</span>        <span class="token comment" spellcheck="true">/*}*/</span>        <span class="token comment" spellcheck="true">/*弟弟选择器*/</span>        <span class="token selector">div~span </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*同级别，下面所有的标签*/</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>div        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>div<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>div p            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>div p span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="CSS-属性选择器"><a href="#CSS-属性选择器" class="headerlink" title="CSS 属性选择器"></a>CSS 属性选择器</h1><h2 id="含有某个属性值"><a href="#含有某个属性值" class="headerlink" title="含有某个属性值"></a>含有某个属性值</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector"><span class="token attribute">[aoteman]</span> </span><span class="token punctuation">{</span>                            <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>                        <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="指定属性值为特定值的标签样式"><a href="#指定属性值为特定值的标签样式" class="headerlink" title="指定属性值为特定值的标签样式"></a>指定属性值为特定值的标签样式</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                <span class="token selector"><span class="token attribute">[aoteman="1"]</span> </span><span class="token punctuation">{</span>                                <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>                            <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="某个标签的特定属性值"><a href="#某个标签的特定属性值" class="headerlink" title="某个标签的特定属性值"></a>某个标签的特定属性值</h2><pre class=" language-html"><code class="language-html">        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">                 <span class="token selector">span<span class="token attribute">[aoteman="3"]</span> </span><span class="token punctuation">{</span>                                        <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>                                    <span class="token punctuation">}</span>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><h2 id="属性选择器代码演示"><a href="#属性选择器代码演示" class="headerlink" title="属性选择器代码演示"></a>属性选择器代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token attribute">[aoteman]</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token attribute">[aoteman="1"]</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">span<span class="token attribute">[aoteman="3"]</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">aoteman</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="分组和嵌套"><a href="#分组和嵌套" class="headerlink" title="分组和嵌套"></a>分组和嵌套</h1><pre class=" language-html"><code class="language-html">            div,p,span { /*逗号表示并列关系*/                color: greenyellow;            }            #d1,.c1 {                color: blue;            }</code></pre><h2 id="分组和嵌套代码演示"><a href="#分组和嵌套代码演示" class="headerlink" title="分组和嵌套代码演示"></a>分组和嵌套代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">div,p,span </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*逗号表示并列关系*/</span>            <span class="token property">color</span><span class="token punctuation">:</span> greenyellow<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token id">#d1</span>,<span class="token class">.c1</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>div<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>p<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>span<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h1><pre class=" language-html"><code class="language-html">            a:link { /*访问之前的状态*/                color: red;            }            a:hover { /*鼠标悬浮态*/                color: aqua;            }            a:active { /*鼠标点击不松开的状态 激活态*/                color: black;            }            a:visited { /*访问之后的状态*/                color:grey;            }</code></pre><h2 id="伪类选择器代码演示"><a href="#伪类选择器代码演示" class="headerlink" title="伪类选择器代码演示"></a>伪类选择器代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">a<span class="token pseudo-class">:link</span> </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*访问之前的状态*/</span>                <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token selector">a<span class="token pseudo-class">:hover</span> </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*鼠标悬浮态*/</span>                <span class="token property">color</span><span class="token punctuation">:</span> aqua<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token selector">a<span class="token pseudo-class">:active</span> </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*鼠标点击不松开的状态 激活态*/</span>                <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>            <span class="token punctuation">}</span>            <span class="token selector">a<span class="token pseudo-class">:visited</span> </span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">/*访问之后的状态*/</span>                <span class="token property">color</span><span class="token punctuation">:</span>grey<span class="token punctuation">;</span>            <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>https://www.sougou.com<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="伪元素选择器"><a href="#伪元素选择器" class="headerlink" title="伪元素选择器"></a>伪元素选择器</h1><pre class=" language-html"><code class="language-html">            p:first-letter {                font-size: 48px;                color: orange;            }            p:before { /*在文本开头 同 CSS 添加内容 用户无法选中*/                content: "那就这样吧";                color: blue;            }</code></pre><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''before 和 after 通常都是来清楚浮动带来的影响，父标签塌陷的问题'''</span></code></pre><h2 id="伪元素选择器代码演示"><a href="#伪元素选择器代码演示" class="headerlink" title="伪元素选择器代码演示"></a>伪元素选择器代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector">p<span class="token pseudo-element">:first-letter</span> </span><span class="token punctuation">{</span>            <span class="token property">font-size</span><span class="token punctuation">:</span><span class="token number">48</span>px<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">p<span class="token pseudo-element">:after</span> </span><span class="token punctuation">{</span>            <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"123"</span><span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">p<span class="token pseudo-element">:before</span> </span><span class="token punctuation">{</span>            <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"456"</span><span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre><h1 id="选择器的优先级"><a href="#选择器的优先级" class="headerlink" title="选择器的优先级"></a>选择器的优先级</h1><h2 id="选择器相同的情况下"><a href="#选择器相同的情况下" class="headerlink" title="选择器相同的情况下"></a>选择器相同的情况下</h2><pre class=" language-html"><code class="language-html">            /*            1. 选择器相同，书写顺序不同                就近原则：谁离标签近就听谁的            */                p {                    color: red;                }                p {                    color:green;                }</code></pre><h2 id="选择器不相同的情况下"><a href="#选择器不相同的情况下" class="headerlink" title="选择器不相同的情况下"></a>选择器不相同的情况下</h2><pre class=" language-html"><code class="language-html">            /*            2. 选择器不同 ...                行内选择器 > id选择器 > 类选择器 > 标签选择器                精确度越高越有效            */                #c1 {                    color: red;                }                .d1 {                    color: green;                }                p {                    color: orange;                }</code></pre><h2 id="选择器优先级代码演示"><a href="#选择器优先级代码演示" class="headerlink" title="选择器优先级代码演示"></a>选择器优先级代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token comment" spellcheck="true">/*            1. 选择器相同，书写顺序不同                就近原则：谁离标签近就听谁的        */</span>        <span class="token selector">p </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">p </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span>green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">/*            2. 选择器不同 ...                行内选择器 > id选择器 > 类选择器 > 标签选择器                精确度越高越有效        */</span>        <span class="token selector"><span class="token id">#c1</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector"><span class="token class">.d1</span> </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token selector">p </span><span class="token punctuation">{</span>            <span class="token property">color</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> blue</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>奥特曼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span> blue</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>见了鬼<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（2）—— 表格、表单标签</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-2-biao-ge-biao-dan-biao-qian/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-2-biao-ge-biao-dan-biao-qian/</url>
      
        <content type="html"><![CDATA[<h1 id="表格标签"><a href="#表格标签" class="headerlink" title="表格标签"></a>表格标签</h1><pre class=" language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>table</span> <span class="token attr-name">border</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!-- border 相当于表格显现框架线 --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>thead</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!--相当于表头--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!--分行--></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>username<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!-- th 和 td 的区别在于 th 加粗 --></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>password<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>th</span><span class="token punctuation">></span></span>hobby<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>th</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>thead</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tbody</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!--相当于除去表头--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>aoteman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>abc123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span> <span class="token attr-name">rowspan</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span> <span class="token comment" spellcheck="true">&lt;!--rowspan 相当于竖向合并单元格，colspan为水平合并单元格,2 表示合并两个单元格--></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tr</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>td</span><span class="token punctuation">></span></span>456<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>td</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tr</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tbody</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>table</span><span class="token punctuation">></span></span></code></pre><h1 id="表单标签"><a href="#表单标签" class="headerlink" title="表单标签"></a>表单标签</h1><h2 id="form-标签和-label-标签"><a href="#form-标签和-label-标签" class="headerlink" title="form 标签和 label 标签"></a>form 标签和 label 标签</h2><pre class=" language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span> 在该 form 标签内部书写的获取用户的数据都会被 form 提交到后端    action 控制数据提交的后端路径（往哪个服务器提交数据）        1. 什么都不写——默认朝当前页面所在的 URL 提交数据        2. 写全路径：https://www.baidu.com 朝百度提交        3. 只写路径后缀： action="/index/" 自动识别当前服务端的 IP 和 PORT 拼接到前面，host:port/index/     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 第一种 直接将 input 框写在 label 内        username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span> 第二种 通过 id 链接即可 无需嵌套     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>     input 不跟 label 关联也没有问题     label 和 input 都是行内标签</code></pre><h2 id="input-标签介绍"><a href="#input-标签介绍" class="headerlink" title="input 标签介绍"></a>input 标签介绍</h2><pre class=" language-html"><code class="language-html">类似于前端的变形金刚 通过 type 属性变形    text：     普通文本    password： 密文展示    date：     日期    submit：   用来触发 form 表单提交数据的动作    button：   就是一个普通的按钮 本身没有任何功能 学完 js 之后给它自定义的功能    reset：    重置内容    radio:     单选框         默认选中要加 checked="checked"         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checked<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>男         当标签的属性名和属性值一样的时候可以简写         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>男    checkbox:  多选         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>abc    file:      获取文件        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    hidden:   隐藏当前 input 框        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre><h2 id="select-标签介绍"><a href="#select-标签介绍" class="headerlink" title="select 标签介绍"></a>select 标签介绍</h2><pre class=" language-html"><code class="language-html">默认是单选 可以加 multiple 实现多选 selected 默认选中    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">selected</span><span class="token punctuation">></span></span>迪迦<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>赛文<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>杰克<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></code></pre><h2 id="textarea-标签介绍"><a href="#textarea-标签介绍" class="headerlink" title="textarea 标签介绍"></a>textarea 标签介绍</h2><pre class=" language-html"><code class="language-html">获取大段文本    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span></code></pre><h2 id="表单标签其他内容"><a href="#表单标签其他内容" class="headerlink" title="表单标签其他内容"></a>表单标签其他内容</h2><pre class=" language-html"><code class="language-html"># 能够触发 form 表单提交数据的按钮有哪些    1. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>注册<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    2. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">></span></span>点我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span># 所有获取用户输入的标签 都应该有 name 标签    name 相当于 字典的 key    用户的数据类似于字典的 values    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>男    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>女    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>其他# form 表单默认提交的是 get 请求    http://127.0.0.1:5000/index/?gender=on# form 可以通过 method 设置请求为 post    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://127.0.0.1:5000/index<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span># 针对用户选择的标签，用户不需要输入内容，但是需要提前给这些标签添加内容，即：value 值# form 表单提交文件    1. method 必须是 post    2. enctype类似于数据提交的编码格式           默认是 urlencoded 只能够提交普通的文本数据           formdata 就可以支持提交文件数据     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://127.0.0.1:5000/index<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span># 针对用户的标签，如果加了 value 那就是默认值    username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>默认值<span class="token punctuation">"</span></span><span class="token punctuation">></span></span># disable 禁止用户对该输入框进行修改（禁用），readonly，只读</code></pre><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!--action表示数据提交的方式    1. 什么都不写，默认提交到本地    2. 写完整的 URL 路径    3. 写部分 URL ，比如：/index/--></span><span class="token comment" spellcheck="true">&lt;!--form 默认请求方式为 get，要选择 post 请求需要 method="post"--></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    label 和 input 连用，这样在 pycharm 中单独使用 input 不会被标黄，实际标黄也没事    label 中的 for 和 label 内 id 相一致，这样的效果是，点击在框架外的文字（如：“用户名：”光标也会跳转至输入框内部）    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>用户名：        <span class="token comment" spellcheck="true">&lt;!--        表单中所有标签都需要有 name 属性，不然在 post 提交数据时很有可能会造成此数据丢失，注意非用户输入标签，即选择框，除了 name 属性还需要 value 属性，不然后端接收数据时不清楚用户的选择是什么        placeholder 表示在一开始加载中输入框中的提示性信息，并且用户不需要将这些信息删除就可以输入信息        text 表示输入文本内容        --></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>用户名<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    password 即 密文输入    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>密码：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    date 日期选择    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>出生日期：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>date<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>     <span class="token comment" spellcheck="true">&lt;!--    radio 选择    如果要在加载完成后就选择一个选项，checked=“checked”，因为属性值一致，可以简写为 checked    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>性别：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>male<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>男        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>female<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>女        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>radio<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gender<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>else<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>其他    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>     <span class="token comment" spellcheck="true">&lt;!--    checkbox 多项选择    其他部分和 radio 一致    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>兴趣爱好：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>aoteman<span class="token punctuation">"</span></span> <span class="token attr-name">checked</span><span class="token punctuation">></span></span>奥特曼        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>alterman<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>alterman        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>checkbox<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hobby<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>abc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>abc    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    submit 提交数据    value 表示用户在 HTML 页面中看到的内容，因为不设置在不同浏览器中 submit 渲染的文字不同，所以最好设置 value    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>提交<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    button 按钮选项    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>点我<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    reset 重置用户输入内容    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reset<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>重置<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    file 用户上传文件，默认上传单个    multiple 允许上传多个文件    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>提交文件：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">multiple</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    hidden 隐藏输入框，用户看不见也无法输入，一般钓鱼网站会使用    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>这是隐藏的输入框：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hidden<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    select option 组合下拉框    和单选框一样，selected 实现预选    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>所在省份：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>province<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sh<span class="token punctuation">"</span></span> <span class="token attr-name">selected</span><span class="token punctuation">></span></span>上海<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bj<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>北京<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sz<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>深圳<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>居住地：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>place<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optgroup</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>上海<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>浦东<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>px<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>浦西<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optgroup</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>optgroup</span> <span class="token attr-name">label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>杭州<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xh<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>西湖区<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>yh<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>余杭<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>optgroup</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token comment" spellcheck="true">&lt;!--    textarea 大量文本    --></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>自我介绍：        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML 前端学习（1）—— 初识HTML</title>
      <link href="/2022/11/28/html-qian-duan-xue-xi-1-chu-shi-html/"/>
      <url>/2022/11/28/html-qian-duan-xue-xi-1-chu-shi-html/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML-前端学习（1）——-初识HTML"><a href="#HTML-前端学习（1）——-初识HTML" class="headerlink" title="HTML 前端学习（1）—— 初识HTML"></a>HTML 前端学习（1）—— 初识HTML</h1><h2 id="浏览器输入网址回车后发生了几件事？"><a href="#浏览器输入网址回车后发生了几件事？" class="headerlink" title="浏览器输入网址回车后发生了几件事？"></a>浏览器输入网址回车后发生了几件事？</h2><pre class=" language-python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span> 浏览器朝服务端发送请求<span class="token number">2</span><span class="token punctuation">.</span> 服务端接收请求（eg：请求百度首页）<span class="token number">3</span><span class="token punctuation">.</span> 服务端返回相应的响应（eg：返回一个百度首页）<span class="token number">4</span><span class="token punctuation">.</span> 浏览器接收响应，根据特定的规则渲染页面展示给用户看</code></pre><h2 id="如何做到浏览器能和多个客户端之间进行数据交互"><a href="#如何做到浏览器能和多个客户端之间进行数据交互" class="headerlink" title="如何做到浏览器能和多个客户端之间进行数据交互"></a>如何做到浏览器能和多个客户端之间进行数据交互</h2><pre class=" language-python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span> 浏览器可以自动识别不同服务端做出不同的处理<span class="token number">2</span><span class="token punctuation">.</span> 制定一个统一的标准，即 HTTP 协议</code></pre><h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2><h3 id="超文本传输协议"><a href="#超文本传输协议" class="headerlink" title="超文本传输协议"></a>超文本传输协议</h3><pre class=" language-python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span> 用来规定服务端和浏览器之间的数据交互格式<span class="token number">2</span><span class="token punctuation">.</span> 该协议可以不遵循，但是你的服务端不能被浏览器正常访问，就自己写客户端，用户使用就下载你专门的 APP</code></pre><h3 id="四大特性"><a href="#四大特性" class="headerlink" title="四大特性"></a>四大特性</h3><pre class=" language-python"><code class="language-python"><span class="token number">1</span><span class="token punctuation">.</span> 基于请求响应<span class="token number">2</span><span class="token punctuation">.</span> 基于 TCP<span class="token operator">/</span>IP 作用于应用层<span class="token number">3</span><span class="token punctuation">.</span> 无状态    不保存用户信息    eg：一个人来了一千次，你都记不住，当作是第一次见面    由于 HTML协议 是无状态的，所以后续出现了一些专门来记录用户状态的技术：session，cookie，token    <span class="token number">4</span><span class="token punctuation">.</span> 短<span class="token operator">/</span>无链接接    请求来一次响应一次    长链接：双方建立链接之后默认不断开，如 webstorm</code></pre><h3 id="请求数据格式"><a href="#请求数据格式" class="headerlink" title="请求数据格式"></a>请求数据格式</h3><pre class=" language-python"><code class="language-python">请求首行（标识 HTTP 协议版本，当前请求方式 ）请求头（一大堆 K<span class="token punctuation">,</span>V 键值对）\r\n请求体（并不是所有的请求方式都有。get没有post有，存放的是post请求提交的敏感数据）</code></pre><h3 id="响应数据格式"><a href="#响应数据格式" class="headerlink" title="响应数据格式"></a>响应数据格式</h3><pre class=" language-python"><code class="language-python">响应首行（标识 HTTP 协议版本，当前响应状态码）响应头（一大堆K<span class="token punctuation">,</span>V键值对）\r\n响应体（返回给浏览器展示给用户看的数据，及页面）</code></pre><h3 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h3><pre class=" language-python"><code class="language-python">Get 请求    从服务端（浏览器）获取数据    一般情况下不使用请求体存储数据，如果要存储数据一般使用URL后面直接加数据的方式        例如：url?username<span class="token operator">=</span>aoteman<span class="token operator">&amp;</span>password<span class="token operator">=</span>abc123        eg<span class="token punctuation">.</span>输入网址获取对应的内容Post 请求    向服务端（浏览器提供数据）    eg<span class="token punctuation">.</span>用户登录，输入用户名和密码，提交到服务端后端做身份校验</code></pre><h3 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a>响应状态码</h3><p>用一串简单的数字表达一段简单的状态或者描述性信息。</p><pre class=" language-python"><code class="language-python">1xx：服务端已经成功接收到你的数据正在受理，你可以继续提交额外的信息2xx：服务端成功响应了你想要的数据（<span class="token number">200</span> 表示请求成功）3xx：重定向（当你在访问一个需要登陆才能看的页面，你会发现自动跳转到登陆页面）4xx：请求错误     <span class="token number">404</span>：请求资源不存在     <span class="token number">403</span>：当前请求不合法或者不符合访问资源的条件5xx：服务器端出现问题，比如服务器崩溃</code></pre><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><p>超文本标记语言</p><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><pre class=" language-python"><code class="language-python">注释是代码之母    <span class="token number">1</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>单行注释<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span>    <span class="token number">2</span><span class="token punctuation">.</span> <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>        多行注释        多行注释        <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span>    <span class="token number">3</span><span class="token punctuation">.</span> 由于HTML代码非常的杂乱无章并且很多，所以我们习惯性的用注释来划定区域方便后续的查找        <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>导航条开始<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span>         导航条所有 HTML 代码         <span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>导航条结束<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></code></pre><h3 id="文档结构"><a href="#文档结构" class="headerlink" title="文档结构"></a>文档结构</h3><pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>html<span class="token operator">></span>    <span class="token operator">&lt;</span>head<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span> 写HTML文件配置内容，不是给用户展示的，即用户不需要看懂    <span class="token operator">&lt;</span>body<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span> 浏览器渲染展示给用户看的部分<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></code></pre><h2 id="标签分类"><a href="#标签分类" class="headerlink" title="标签分类"></a>标签分类</h2><h3 id="单标签和双标签"><a href="#单标签和双标签" class="headerlink" title="单标签和双标签"></a>单标签和双标签</h3><pre class=" language-python"><code class="language-python">单标签，如：<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span>双标签，如：<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></code></pre><h3 id="块级标签和行内标签"><a href="#块级标签和行内标签" class="headerlink" title="块级标签和行内标签"></a>块级标签和行内标签</h3><pre class=" language-python"><code class="language-python">常见的块级标签    独占一行    div标签，p标签，h1<span class="token operator">~</span>h6        <span class="token number">1</span><span class="token punctuation">.</span> 块级标签可以修改长宽，行内标签不可以，修改了也不会变化        <span class="token number">2</span><span class="token punctuation">.</span> 块级标签内部既可以嵌套块级标签也可以嵌套行内标签        ps<span class="token punctuation">:</span> p 标签只能嵌套行内标签，但如果嵌套了行内标签也没有问题，因为在运行的时候浏览器会自动解套常见的行内标签     自身文本多大就占多大位置    span标签 i u s b        行内标签可以嵌套行内标签</code></pre><h2 id="head内常用标签"><a href="#head内常用标签" class="headerlink" title="head内常用标签"></a>head内常用标签</h2><pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>title<span class="token operator">></span>Title<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>             定义页面名称<span class="token operator">&lt;</span>style<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span>                  CSS层叠样式<span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> href<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span>  href 调用本地的 CSS 文件进行渲染<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>                书写 js 命令 或是 调用 js 文件<span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"keywords"</span> content<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span> 当你在用浏览器搜索时，只要输入了 keywords 后面指定的关键词那么该网页就有可能被百度搜索出来展示给用户<span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token string">"description"</span> content<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span> 网页的描述信息</code></pre><h2 id="body内常用标签"><a href="#body内常用标签" class="headerlink" title="body内常用标签"></a>body内常用标签</h2><pre class=" language-python"><code class="language-python"><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">""</span> target<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>        超链接                                 href 可以输入网址也可以输入该HTML文件中的标签 id ，实现跳转                                    如：<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#hq"</span> target<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span>跳转<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>                                        <span class="token operator">&lt;</span>h1 id<span class="token operator">=</span><span class="token string">"hq"</span><span class="token operator">></span><span class="token number">123</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>                                 target 默认是 _blank 表示新打开一个网页跳转页面                                               _self  表示在原有网页的基础上跳转页面<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">""</span> alt<span class="token operator">=</span><span class="token string">""</span><span class="token operator">></span>              图片标签                                 src 可以输入本地图片路径                                     也可以输入 url （注意这里 url 既可以是图片的url 也可以是网址的 url）                                 alt 是图片加载不出来展示给用户的描述性信息                                 title 鼠标悬浮到图片上之后，自动展示的提示信息                                 height<span class="token operator">=</span><span class="token string">"800px"</span>                                 width<span class="token operator">=</span><span class="token string">""</span>                                     高度和宽度只修改一个参数时，另一个参数会等比例缩放<span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>                          段落标签，展示时自动换行<span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>                        标题标签，从 h1<span class="token operator">~</span>h6<span class="token operator">&lt;</span>b<span class="token operator">></span>加粗<span class="token operator">&lt;</span><span class="token operator">/</span>b<span class="token operator">></span><span class="token operator">&lt;</span>i<span class="token operator">></span>斜体<span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">></span><span class="token operator">&lt;</span>u<span class="token operator">></span>下划线<span class="token operator">&lt;</span><span class="token operator">/</span>u<span class="token operator">></span><span class="token operator">&lt;</span>s<span class="token operator">></span>删除线<span class="token operator">&lt;</span><span class="token operator">/</span>s<span class="token operator">></span></code></pre><h2 id="HTML-中特殊符号"><a href="#HTML-中特殊符号" class="headerlink" title="HTML 中特殊符号"></a>HTML 中特殊符号</h2><pre class=" language-python"><code class="language-python">    <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span> 空格    <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> 大于号    <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> 小于号    <span class="token operator">&amp;</span>amp<span class="token punctuation">;</span> <span class="token operator">&amp;</span>符号    <span class="token operator">&amp;</span>yen<span class="token punctuation">;</span> 羊角符?    <span class="token operator">&amp;</span>copy<span class="token punctuation">;</span> 版权?    <span class="token operator">&amp;</span>reg<span class="token punctuation">;</span> 商标?</code></pre><h2 id="标签的两个重要属性"><a href="#标签的两个重要属性" class="headerlink" title="标签的两个重要属性"></a>标签的两个重要属性</h2><pre class=" language-python"><code class="language-python">id 值    类似于身份证，在一个 HTML 文档中，不能有相同的 id 值    <span class="token keyword">class</span> 值    该值有点类似于面向对象里面的继承，一个标签可以继承多个 <span class="token keyword">class</span> 值</code></pre><h2 id="列表标签"><a href="#列表标签" class="headerlink" title="列表标签"></a>列表标签</h2><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程FTP项目（4）—— Mysql数据库 + FTP</title>
      <link href="/2022/11/25/duo-xian-cheng-ftp-xiang-mu-4-mysql-shu-ju-ku-ftp/"/>
      <url>/2022/11/25/duo-xian-cheng-ftp-xiang-mu-4-mysql-shu-ju-ku-ftp/</url>
      
        <content type="html"><![CDATA[<h2 id="项目开发目录"><a href="#项目开发目录" class="headerlink" title="项目开发目录"></a>项目开发目录</h2><p><img src="https://img-blog.csdnimg.cn/5d606e1d0eac49d4ac0170b3893e29b3.png"></p><h2 id="FTPClient"><a href="#FTPClient" class="headerlink" title="FTPClient"></a>FTPClient</h2><h3 id="bin文件夹-Client-py"><a href="#bin文件夹-Client-py" class="headerlink" title="bin文件夹 Client.py"></a>bin文件夹 Client.py</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding=gbk -*-</span><span class="token comment" spellcheck="true"># @author   : aoteman</span><span class="token comment" spellcheck="true"># @time     : 2022/7/10 10:36</span><span class="token keyword">import</span> socket<span class="token punctuation">,</span> os<span class="token punctuation">,</span> sysPATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>PATH<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">FTPclient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> optparse <span class="token keyword">import</span> OptionParser        opt <span class="token operator">=</span> OptionParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        opt<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-H"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"HOST"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"FTP Server HOST"</span><span class="token punctuation">)</span>        opt<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-P"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"PORT"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"int"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"FTP Serve PORT"</span><span class="token punctuation">)</span>        values<span class="token punctuation">,</span> args <span class="token operator">=</span> opt<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(values, args)</span>        self<span class="token punctuation">.</span>client <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 实例化 socket</span>        self<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>values<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 登录的用户名</span>        self<span class="token punctuation">.</span>user <span class="token operator">=</span> None        <span class="token comment" spellcheck="true"># 展示给用户的信息头</span>        self<span class="token punctuation">.</span>show <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">:</span>        HOST <span class="token operator">=</span> values<span class="token punctuation">.</span>HOST        PORT <span class="token operator">=</span> values<span class="token punctuation">.</span>PORT        <span class="token comment" spellcheck="true"># print(host, port)</span>        <span class="token keyword">if</span> HOST <span class="token operator">and</span> PORT<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 输入的 HOST 和 PORT 都不能为空</span>            self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connect succeed"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接完成后，进行用户登录</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            exit<span class="token punctuation">(</span><span class="token string">"ERROR: should supply HOST and PORT !"</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 退出并打印提示</span>    <span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        count <span class="token operator">=</span> <span class="token number">3</span>        <span class="token keyword">while</span> count <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>            username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"please enter your username>>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"enter your password>>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            sql <span class="token operator">=</span> <span class="token string">"select password from user where username = %s"</span>            <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database            cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>            rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> rows <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入的用户名不存在</span>                count <span class="token operator">-=</span> <span class="token number">1</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"用户名错误，请重新输入，您还有{}次机会重新输入"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> rows <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 密码错误</span>                res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> res <span class="token operator">!=</span> password<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 密码错误</span>                    count <span class="token operator">-=</span> <span class="token number">1</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"密码错误，请重新输入，您还有{}次机会重新输入"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登录成功</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"登录成功"</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>user <span class="token operator">=</span> username                    <span class="token keyword">from</span> log <span class="token keyword">import</span> log                    log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"login"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>user<span class="token punctuation">)</span>                    msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"log"</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token punctuation">)</span>                    msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>show <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"show"</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>handle<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">make_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        msg_dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"action"</span><span class="token punctuation">:</span> action        <span class="token punctuation">}</span>        msg_dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        <span class="token keyword">return</span> msg_dic    <span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>None<span class="token punctuation">:</span>        <span class="token keyword">import</span> struct<span class="token punctuation">,</span>json        str_msg <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>msg_dic<span class="token punctuation">)</span>        length <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>str_msg<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>length<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>str_msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">recv_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>dict<span class="token punctuation">:</span>        length_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>        <span class="token keyword">import</span> struct<span class="token punctuation">,</span>json        str_dic_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> length_dic<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        str_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>str_dic_length<span class="token punctuation">)</span>        dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""和服务端交互"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"{}>>: "</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>show<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            cmd_list <span class="token operator">=</span> cmd<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>cmd_list<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>                action <span class="token operator">=</span> cmd_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                content <span class="token operator">=</span> cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                action <span class="token operator">=</span> cmd_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                content <span class="token operator">=</span> <span class="token string">""</span>            <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 有该方法</span>                func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">)</span>                func<span class="token punctuation">(</span>content<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">md</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""在服务端家目录"""</span>        msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"md"</span><span class="token punctuation">,</span> content<span class="token operator">=</span>content<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>        recv_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stdout"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stderr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">from</span> log <span class="token keyword">import</span> log        log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"md"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看服务端用户当前路径"""</span>        msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"dir"</span><span class="token punctuation">,</span> content<span class="token operator">=</span>content<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>        recv_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stdout"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stderr"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">from</span> log <span class="token keyword">import</span> log        log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"dir"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""切换用户在服务端目录"""</span>        msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"cd"</span><span class="token punctuation">,</span> content<span class="token operator">=</span>content<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>        recv_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(recv_dic.get("stdout"), recv_dic.get("stderr"))</span>        <span class="token keyword">if</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">100</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>show <span class="token operator">=</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"show"</span><span class="token punctuation">)</span>            <span class="token keyword">from</span> log <span class="token keyword">import</span> log            log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"cd"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""从服务端下载文件"""</span>        msg_dic<span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"download"</span><span class="token punctuation">,</span> file_name<span class="token operator">=</span>content<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>        recv_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">102</span><span class="token punctuation">:</span>            file_path <span class="token operator">=</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_path"</span><span class="token punctuation">)</span>            file_size <span class="token operator">=</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_size"</span><span class="token punctuation">)</span>            <span class="token keyword">import</span> time            <span class="token keyword">from</span> config <span class="token keyword">import</span> setting            now <span class="token operator">=</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d-%H-%M-%S"</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            download_file_path <span class="token operator">=</span> setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now <span class="token operator">+</span> <span class="token string">".download"</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>download_file_path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                sql <span class="token operator">=</span> <span class="token string">"insert into UNDOWNLOAD_FILE(username, file_name, file_path, file_size) values(%s, %s, %s, %s)"</span>                <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database                cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> content <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now <span class="token operator">+</span> <span class="token string">".download"</span><span class="token punctuation">,</span> file_path<span class="token punctuation">,</span> file_size<span class="token punctuation">)</span><span class="token punctuation">)</span>                recv_size <span class="token operator">=</span> <span class="token number">0</span>                <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> file_size<span class="token punctuation">:</span>                    recv_content <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>recv_content<span class="token punctuation">)</span>                    recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>recv_content<span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载进度：{}{}%"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"\r"</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n下载完成！！！"</span><span class="token punctuation">)</span>            sql <span class="token operator">=</span> <span class="token string">"delete from UNDOWNLOAD_FILE where username = %s and file_name = %s"</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> content <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now <span class="token operator">+</span> <span class="token string">".download"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(content + "." + now + ".download")</span>            <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>download_file_path<span class="token punctuation">,</span> setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                download_file_path_ <span class="token operator">=</span> download_file_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">".download"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>download_file_path<span class="token punctuation">,</span> download_file_path_<span class="token punctuation">)</span>            <span class="token keyword">from</span> log <span class="token keyword">import</span> log            log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"download"</span><span class="token punctuation">,</span> content<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">download_bar</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> recv_size<span class="token punctuation">,</span> file_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># recv_size = recv_size</span>        recv_size <span class="token operator">=</span> int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>        file_size <span class="token operator">=</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span>        <span class="token keyword">if</span> recv_size <span class="token operator">&lt;</span> file_size<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载进度：{}{}%"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"\r"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">re_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断点续存"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database            cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>            sql <span class="token operator">=</span> <span class="token string">"select id,file_name from undownload_file where username = %s"</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>            tips <span class="token operator">=</span> <span class="token triple-quoted-string string">"""--------------------------            id            file_name"""</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>tips<span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span>                id <span class="token operator">=</span> i<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>                file_name <span class="token operator">=</span> i<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_name"</span><span class="token punctuation">)</span>                tips <span class="token operator">=</span> <span class="token triple-quoted-string string">"""--------------------------            {}            {}"""</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>id<span class="token punctuation">,</span> file_name<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>tips<span class="token punctuation">)</span>            input_id <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"please enter the id to download file(enter 'exit' to exit):>> "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> input_id <span class="token operator">==</span> <span class="token string">"exit"</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">elif</span> input_id<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果是数字</span>                input_id <span class="token operator">=</span> int<span class="token punctuation">(</span>input_id<span class="token punctuation">)</span>                sql <span class="token operator">=</span> <span class="token string">"select file_name,file_path,file_size from undownload_file where id = %d"</span> <span class="token operator">%</span> input_id                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>                res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                file_name <span class="token operator">=</span> res<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_name"</span><span class="token punctuation">)</span>                file_path <span class="token operator">=</span> res<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_path"</span><span class="token punctuation">)</span>                file_size <span class="token operator">=</span> res<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_size"</span><span class="token punctuation">)</span>                <span class="token keyword">from</span> config <span class="token keyword">import</span> setting                <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果未下载完成的文件未被删除</span>                    recv_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">)</span>                    msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>action<span class="token operator">=</span><span class="token string">"re_get"</span><span class="token punctuation">,</span> file_name<span class="token operator">=</span>file_name<span class="token punctuation">,</span> file_path<span class="token operator">=</span>file_path<span class="token punctuation">,</span> file_size<span class="token operator">=</span>file_size<span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>                    recv_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">102</span><span class="token punctuation">:</span>                        <span class="token keyword">with</span> open<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                            <span class="token keyword">while</span> int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">&lt;</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">:</span>                                recv_content <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>                                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>recv_content<span class="token punctuation">)</span>                                recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>recv_content<span class="token punctuation">)</span>                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载进度：{}{}%"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token operator">/</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"\r"</span><span class="token punctuation">)</span>                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n下载完成！！！"</span><span class="token punctuation">)</span>                        <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>file_name<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                            os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">,</span> setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> <span class="token string">"."</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>file_name<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            download_file_path_ <span class="token operator">=</span> <span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">".download"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                            os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">(</span>setting<span class="token punctuation">.</span>DOWNLOAD_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name<span class="token punctuation">)</span><span class="token punctuation">,</span> download_file_path_<span class="token punctuation">)</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span>recv_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                sql <span class="token operator">=</span> <span class="token string">"delete from undownload_file where id = %d"</span> <span class="token operator">%</span> input_id                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>                <span class="token keyword">from</span> log <span class="token keyword">import</span> log                log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span> <span class="token string">"re_get"</span><span class="token punctuation">,</span> file_name<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"enter wrong"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>client <span class="token operator">=</span> FTPclient<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="config-文件夹-setting-py-文件"><a href="#config-文件夹-setting-py-文件" class="headerlink" title="config 文件夹 setting.py 文件"></a>config 文件夹 setting.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> osDOWNLOAD_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> <span class="token string">"download"</span></code></pre><h3 id="core-文件夹-connect-database-py-文件"><a href="#core-文件夹-connect-database-py-文件" class="headerlink" title="core 文件夹 connect_database.py 文件"></a>core 文件夹 connect_database.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding=gbk -*-</span><span class="token comment" spellcheck="true"># @author   : aoteman</span><span class="token comment" spellcheck="true"># @time     : 2022/7/11 10:09</span><span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> pymysql    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>        host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>        port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>        database<span class="token operator">=</span><span class="token string">"FTP"</span><span class="token punctuation">,</span>        user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>        password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>        charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span>        autocommit<span class="token operator">=</span><span class="token boolean">True</span>    <span class="token punctuation">)</span>    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>    <span class="token keyword">return</span> cursor</code></pre><h3 id="log文件夹-log-py-文件"><a href="#log文件夹-log-py-文件" class="headerlink" title="log文件夹 log.py 文件"></a>log文件夹 log.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding=gbk -*-</span><span class="token comment" spellcheck="true"># @author   : aoteman</span><span class="token comment" spellcheck="true"># @time     : 2022/7/11 10:07</span><span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> action<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database    cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>    sql <span class="token operator">=</span> <span class="token string">"insert into user_log(username, action, msg) values(%s, %s, %s)"</span>    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> action<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> pymysql    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>        host<span class="token operator">=</span><span class="token string">"localhost"</span><span class="token punctuation">,</span>        port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>        database<span class="token operator">=</span><span class="token string">"FTP"</span><span class="token punctuation">,</span>        user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>        password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>        charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span>        autocommit<span class="token operator">=</span><span class="token boolean">True</span>    <span class="token punctuation">)</span>    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">import</span> xlwt    book <span class="token operator">=</span> xlwt<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">,</span> style_compression<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">"日志"</span><span class="token punctuation">,</span> cell_overwrite_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    col <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"用户名"</span><span class="token punctuation">,</span> <span class="token string">"进行的操作"</span><span class="token punctuation">,</span> <span class="token string">"操作的信息"</span><span class="token punctuation">,</span> <span class="token string">"操作时间"</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> col<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    sql <span class="token operator">=</span> <span class="token string">'select username,action,msg,time from user_log'</span>    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>    res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">import</span> datetime    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> j <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>                sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> j<span class="token punctuation">,</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"log.xls"</span><span class="token punctuation">)</span></code></pre><h2 id="FTPServer"><a href="#FTPServer" class="headerlink" title="FTPServer"></a>FTPServer</h2><h3 id="bin文件夹-main-py文件"><a href="#bin文件夹-main-py文件" class="headerlink" title="bin文件夹 main.py文件"></a>bin文件夹 main.py文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> sys<span class="token punctuation">,</span>ospath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># FTPServer 所在文件夹路径</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>path<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 添加到环境变量</span>    <span class="token keyword">from</span> lib <span class="token keyword">import</span> management    server <span class="token operator">=</span> management<span class="token punctuation">.</span>Management<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span></code></pre><h3 id="config-文件夹-setting-py-文件-1"><a href="#config-文件夹-setting-py-文件-1" class="headerlink" title="config 文件夹 setting.py 文件"></a>config 文件夹 setting.py 文件</h3><pre class=" language-python"><code class="language-python">HOST <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>PORT <span class="token operator">=</span> <span class="token number">8080</span><span class="token keyword">import</span> osUSER_HOME <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\home"</span><span class="token comment" spellcheck="true"># print(USER_HOME)</span></code></pre><h3 id="core-文件夹-connect-database-文件"><a href="#core-文件夹-connect-database-文件" class="headerlink" title="core 文件夹 connect_database 文件"></a>core 文件夹 connect_database 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> pymysql    conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>        host <span class="token operator">=</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>        port <span class="token operator">=</span> <span class="token number">3306</span><span class="token punctuation">,</span>        database <span class="token operator">=</span> <span class="token string">"FTP"</span><span class="token punctuation">,</span>        user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">,</span>        password <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>        charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">,</span>        autocommit<span class="token operator">=</span><span class="token boolean">True</span>    <span class="token punctuation">)</span>    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>    <span class="token keyword">return</span> cursor</code></pre><h3 id="core-文件夹-FTP-sql-文件"><a href="#core-文件夹-FTP-sql-文件" class="headerlink" title="core 文件夹 FTP.sql 文件"></a>core 文件夹 FTP.sql 文件</h3><pre class=" language-python"><code class="language-python">create database FTP<span class="token punctuation">;</span>use FTP<span class="token punctuation">;</span>create table USER<span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    username varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    password varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>create table LOG<span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    username varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    action varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    msg varchar<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    time timestamp <span class="token operator">not</span> null default CURRENT_TIMESTAMP<span class="token punctuation">)</span><span class="token punctuation">;</span>create table USER_LOG<span class="token punctuation">(</span>    id int primary key  auto_increment<span class="token punctuation">,</span>    username varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    action varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    msg varchar<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    time timestamp <span class="token operator">not</span> null default CURRENT_TIMESTAMP<span class="token punctuation">)</span><span class="token punctuation">;</span>create table UNDOWNLOAD_FILE<span class="token punctuation">(</span>    id int primary key  auto_increment<span class="token punctuation">,</span>    username varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    file_name varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    file_path varchar<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    file_size varchar<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="lib文件夹-managment-py文件"><a href="#lib文件夹-managment-py文件" class="headerlink" title="lib文件夹 managment.py文件"></a>lib文件夹 managment.py文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token keyword">class</span> <span class="token class-name">Management</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> argv<span class="token punctuation">)</span><span class="token punctuation">:</span>        cmd <span class="token operator">=</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果该命令存在</span>            func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span>            func<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 否则运行提示函数</span>            self<span class="token punctuation">.</span>tips<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">tips</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        tip <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        ----------------------------------------                  FTP Project Command List        ----------------------------------------        run                  start up FTP Server        ----------------------------------------        create                   create FTP User        ----------------------------------------        delete                   delete FTP User        ----------------------------------------        tips                     FTP Command tip        ----------------------------------------        """</span>        exit<span class="token punctuation">(</span>tip<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> lib <span class="token keyword">import</span> Server        <span class="token keyword">from</span> config <span class="token keyword">import</span> setting        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}FTPServer Run {} {} {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> setting<span class="token punctuation">.</span>HOST<span class="token punctuation">,</span> setting<span class="token punctuation">.</span>PORT<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        server <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Server<span class="token punctuation">.</span>FTPserver<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 开启 TCP服务 多线程</span>        server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database        cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"username: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要创建的用户的用户名</span>        password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"password: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要创建的用户的密码</span>        <span class="token comment" spellcheck="true"># print(username, password)</span>        sql <span class="token operator">=</span> <span class="token string">"select * from user where username = %s"</span>        res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 该用户不存在，可以创建</span>            sql <span class="token operator">=</span> <span class="token string">"insert into user(username, password) values(%s, %s)"</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"用户创建成功！！！"</span><span class="token punctuation">)</span>            <span class="token keyword">from</span> log <span class="token keyword">import</span> log            action <span class="token operator">=</span> <span class="token string">"login"</span>            log<span class="token punctuation">.</span>log<span class="token punctuation">(</span>username<span class="token punctuation">,</span> action<span class="token punctuation">,</span> username<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"该用户已存在!!!"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database        cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>        username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"username: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 要删除的用户的用户名</span>        sql <span class="token operator">=</span> <span class="token string">"select * from user where username = %s"</span>        rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> rows <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 要删除的用户存在</span>            sql <span class="token operator">=</span> <span class="token string">"delete from user where username = %s"</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"删除用户成功！！！"</span><span class="token punctuation">)</span>            <span class="token keyword">from</span> log <span class="token keyword">import</span> log            action <span class="token operator">=</span> <span class="token string">"delete"</span>            log<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">,</span> action<span class="token punctuation">,</span> username<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"要删除的用户不存在！！！"</span><span class="token punctuation">)</span></code></pre><h3 id="lib-文件夹-Server-py-文件"><a href="#lib-文件夹-Server-py-文件" class="headerlink" title="lib 文件夹 Server.py 文件"></a>lib 文件夹 Server.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token punctuation">,</span>timeSTATUS_MSG <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token number">000</span><span class="token punctuation">:</span> <span class="token string">"nothing"</span><span class="token punctuation">,</span>    <span class="token number">100</span><span class="token punctuation">:</span> <span class="token string">"cd dir success!!!"</span><span class="token punctuation">,</span>    <span class="token number">101</span><span class="token punctuation">:</span> <span class="token string">"the dir not exist!!!"</span><span class="token punctuation">,</span>    <span class="token number">102</span><span class="token punctuation">:</span> <span class="token string">"file exits!!!"</span><span class="token punctuation">,</span>    <span class="token number">103</span><span class="token punctuation">:</span> <span class="token string">"file not exits!!!"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">FTPserver</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 一定要是 handle</span>        <span class="token comment" spellcheck="true"># print(self.request) # 相当于 conn</span>        <span class="token comment" spellcheck="true"># print(self.client_address) # 相当于 addr</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}连接成功"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            action <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"action"</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action<span class="token punctuation">)</span><span class="token punctuation">:</span>                func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action<span class="token punctuation">)</span>                func<span class="token punctuation">(</span>msg_dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">recv_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>dict<span class="token punctuation">:</span>        length_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>        <span class="token keyword">import</span> struct<span class="token punctuation">,</span>json        str_dic_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> length_dic<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        str_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>str_dic_length<span class="token punctuation">)</span>        dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>str_dic<span class="token punctuation">)</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">make_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> status_code<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        msg_dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"status_code"</span><span class="token punctuation">:</span> status_code<span class="token punctuation">,</span>            <span class="token string">"status_msg"</span><span class="token punctuation">:</span> STATUS_MSG<span class="token punctuation">.</span>get<span class="token punctuation">(</span>status_code<span class="token punctuation">)</span>        <span class="token punctuation">}</span>        msg_dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        <span class="token keyword">return</span> msg_dic    <span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span>None<span class="token punctuation">:</span>        <span class="token keyword">import</span> struct<span class="token punctuation">,</span>json        str_msg <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>msg_dic<span class="token punctuation">)</span>        length <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>str_msg<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>length<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>str_msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        <span class="token keyword">from</span> config <span class="token keyword">import</span> setting        user_path <span class="token operator">=</span> setting<span class="token punctuation">.</span>USER_HOME <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>username        self<span class="token punctuation">.</span>current_path <span class="token operator">=</span> user_path <span class="token comment" spellcheck="true"># 用户此时在服务端的路径位置</span>        <span class="token keyword">import</span> os        <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>user_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 该路径不存在</span>            os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>user_path<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>show <span class="token operator">=</span> user_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>USER_HOME<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">000</span><span class="token punctuation">,</span> show<span class="token operator">=</span>self<span class="token punctuation">.</span>show<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_md</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        content <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(content)</span>        <span class="token keyword">import</span> subprocess        s <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"md {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                         stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                         stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>        stdout <span class="token operator">=</span> s<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        stderr <span class="token operator">=</span> s<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">000</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">import</span> subprocess        s <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"dir {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                             stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                             stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>        stdout <span class="token operator">=</span> s<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        stderr <span class="token operator">=</span> s<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">000</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        path <span class="token operator">=</span> self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span>        <span class="token keyword">import</span> os        path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>path<span class="token punctuation">)</span>        <span class="token keyword">from</span> config <span class="token keyword">import</span> setting        <span class="token keyword">if</span> <span class="token punctuation">(</span>setting<span class="token punctuation">.</span>USER_HOME <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>username<span class="token punctuation">)</span> <span class="token keyword">in</span> path <span class="token operator">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">import</span> subprocess            s <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"cd {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                 stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                 stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>            stdout <span class="token operator">=</span> s<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> s<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>show <span class="token operator">=</span> path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>USER_HOME <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> show<span class="token operator">=</span>self<span class="token punctuation">.</span>show<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>current_path <span class="token operator">=</span> path        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""下载文件"""</span>        file_name <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_name"</span><span class="token punctuation">)</span>        file_path <span class="token operator">=</span> self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name        <span class="token keyword">import</span> os        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果该文件存在</span>            file_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">,</span> file_path<span class="token operator">=</span>file_path<span class="token punctuation">,</span> file_size<span class="token operator">=</span>file_size<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">103</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_re_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断点续存"""</span>        file_path <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_path"</span><span class="token punctuation">)</span>        file_size <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_size"</span><span class="token punctuation">)</span>        recv_szie <span class="token operator">=</span> msg_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"recv_size"</span><span class="token punctuation">)</span>        <span class="token keyword">import</span> os        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token operator">and</span> int<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span> <span class="token operator">==</span> int<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>recv_szie<span class="token punctuation">)</span>                <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>make_dict<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">103</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>msg_dic<span class="token operator">=</span>msg_dic<span class="token punctuation">)</span></code></pre><h3 id="log-文件夹-log-py-文件"><a href="#log-文件夹-log-py-文件" class="headerlink" title="log 文件夹 log.py 文件"></a>log 文件夹 log.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> action<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> core <span class="token keyword">import</span> connect_database    cursor <span class="token operator">=</span> connect_database<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span>    sql <span class="token operator">=</span> <span class="token string">"insert into log(username, action, msg) values(%s, %s, %s)"</span>    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> action<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><h3 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h3><p><img src="https://img-blog.csdnimg.cn/fdb4415dbbc049ffabdcec09f301c1e3.gif"></p><h3 id="用户登录"><a href="#用户登录" class="headerlink" title="用户登录"></a>用户登录</h3><p><img src="https://img-blog.csdnimg.cn/08e40403f97b41b39abc5b2c9d8d7f27.gif"></p><h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><p><img src="https://img-blog.csdnimg.cn/513f220fff944334b6f91ae2eded7b90.gif"></p><h3 id="切换目录、下载文件、断点续存"><a href="#切换目录、下载文件、断点续存" class="headerlink" title="切换目录、下载文件、断点续存"></a>切换目录、下载文件、断点续存</h3><p><img src="https://img-blog.csdnimg.cn/1f8c02b5eff7463a8fa530106483f2cb.gif"></p><h3 id="生成日志文件"><a href="#生成日志文件" class="headerlink" title="生成日志文件"></a>生成日志文件</h3><p><img src="https://img-blog.csdnimg.cn/1b2c8cc189764a1f9097b3c1d935ced7.gif"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySql </tag>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
            <tag> 多线程 FTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程FTP项目（3）—— socketserver版本多线程FTP项目</title>
      <link href="/2022/11/25/duo-xian-cheng-ftp-xiang-mu-3-socketserver-ban-ben-duo-xian-cheng-ftp-xiang-mu/"/>
      <url>/2022/11/25/duo-xian-cheng-ftp-xiang-mu-3-socketserver-ban-ben-duo-xian-cheng-ftp-xiang-mu/</url>
      
        <content type="html"><![CDATA[<h1 id="多线程FTP项目（3）——-socketserver版本多线程FTP项目"><a href="#多线程FTP项目（3）——-socketserver版本多线程FTP项目" class="headerlink" title="多线程FTP项目（3）—— socketserver版本多线程FTP项目"></a>多线程FTP项目（3）—— socketserver版本多线程FTP项目</h1><h2 id="threading-版"><a href="#threading-版" class="headerlink" title="threading 版"></a>threading 版</h2><p>​        本来是想自己写一个实现多进程的 FTP 项目的，也就是说不使用 socketserver 模块实现多线程 FTP 项目，但是我写到一半调试的时候发现，虽然可以实现多用户同时登录，但是在输入命令之后，客户端很容易被 “远程计算机直接断开连接”。目前还是不清楚出了什么问题，不过看了 socketserver 模块源码后，发现该模块的多线程实现是比较复杂的，所以我觉得出现这个 bug 很大可能是因为我对于多线程的理解使用还不到家，所以还是使用 socketserver 模块实现多线程FTP项目。</p><h2 id="项目开发目录"><a href="#项目开发目录" class="headerlink" title="项目开发目录"></a>项目开发目录</h2><p><img src="https://img-blog.csdnimg.cn/36ae798c09854fed9b1d1cbaef480bff.png"><br><img src="https://img-blog.csdnimg.cn/929fdaf8753a4a4eaa1fa780897e26a4.png"></p><h2 id="项目可实现功能"><a href="#项目可实现功能" class="headerlink" title="项目可实现功能"></a>项目可实现功能</h2><ul><li>用户注册</li><li>多用户登录</li><li>用户查看家目录</li><li>用户切换家目录</li><li>用户在家目录下创建其他文件夹</li><li>用户从服务端下载文件，并且在下载过程中显示进度条</li><li>实现断点续存，文件下载过程中中断连接，可以继续下载，并显示进度条</li></ul><h2 id="不足之处"><a href="#不足之处" class="headerlink" title="不足之处"></a>不足之处</h2><ul><li>用户注册在服务端，其实是有问题的，从实际上来看，用户注册是用户做的事情，但是我们不可能在用户端注册用户然后将用户名和密码等信息传入服务端的文件中。<strong>目前能想到的解决方法是使用数据库，所以这样来看，FTP项目我大概到时候还要写一个含数据库的版本</strong>。</li><li>断点续存功能写完之后发现每次退出后都会删除未下载完的文件信息，所以这样好像一次只会存储一个未下载完成的文件信息。</li><li>本来想写一个注销用户的功能，比如启动服务端时可以选择删除操作，在删除前需要输入管理员密码，但最后没有写；</li><li>还有用户目录空间大小分配的功能，比如用户在上传文件时，判断分配的空间大小是否足够，因为没有写上传功能，所以也没有写判断空间大小的功能。</li><li>暂时能想到的不足之处只有这么多，但实际上应该还有挺多不足之处的，所以大概率之后还会再写一个优化后的含数据库的FTP项目。</li></ul><h2 id="项目代码"><a href="#项目代码" class="headerlink" title="项目代码"></a>项目代码</h2><h3 id="FTPclient-py-文件"><a href="#FTPclient-py-文件" class="headerlink" title="FTPclient.py 文件"></a>FTPclient.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token keyword">import</span> optparse<span class="token punctuation">,</span> struct<span class="token punctuation">,</span> json<span class="token punctuation">,</span> time<span class="token punctuation">,</span> os<span class="token keyword">from</span> optparse <span class="token keyword">import</span> OptionParser<span class="token keyword">from</span> configparser <span class="token keyword">import</span> ConfigParserSTR_RECV_LENGTH <span class="token operator">=</span> <span class="token number">8</span> <span class="token comment" spellcheck="true"># 接收信息头字典长度编码后的数据</span>MAX_RECV_LENGTH <span class="token operator">=</span> <span class="token number">1024</span> <span class="token comment" spellcheck="true"># 接收文件时一次性接收的数据长度</span>INI_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\conf\\download.ini"</span> <span class="token comment" spellcheck="true"># 因为没有专门写客户端的settings.py 所以ini的路径就直接写在 FTPclient.py 文件内部</span><span class="token keyword">class</span> <span class="token class-name">MyClient</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 记录登录的用户名</span>        self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 记录用户在服务端的当前目录</span>        self<span class="token punctuation">.</span>client <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 实例化 socket</span>        <span class="token comment" spellcheck="true"># 启动 FTPclient.py 文件时，用于解析命令行选项</span>        opt <span class="token operator">=</span> OptionParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        opt<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-H"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"HOST"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"FTP Server HOST"</span><span class="token punctuation">)</span>        opt<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-P"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"PORT"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"int"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"FTP Serve PORT"</span><span class="token punctuation">)</span>        values<span class="token punctuation">,</span> args <span class="token operator">=</span> opt<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>connection<span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 连接服务端</span>    <span class="token keyword">def</span> <span class="token function">connection</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> values<span class="token punctuation">:</span>optparse<span class="token punctuation">.</span>Values<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""和服务端连接"""</span>        <span class="token comment" spellcheck="true"># 服务器的端口</span>        HOST <span class="token operator">=</span> values<span class="token punctuation">.</span>HOST        PORT <span class="token operator">=</span> values<span class="token punctuation">.</span>PORT        <span class="token keyword">if</span> HOST <span class="token operator">and</span> PORT<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入的 HOST 和 PORT 都不能为空</span>            self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"connect succeed"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>login<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 连接完成后，进行用户登录</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            exit<span class="token punctuation">(</span><span class="token string">"ERROR: should supply HOST and PORT !"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 退出并打印提示</span>    <span class="token keyword">def</span> <span class="token function">create_msg_to_send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action_type<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""制作信息头"""</span>        <span class="token comment" spellcheck="true"># 信息头字典一定要有 action_type 的数据，方便服务端识别命令类型</span>        dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"action_type"</span><span class="token punctuation">:</span> action_type        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># 传入的 **kwargs 是键值形式，update 将 dic 和 **kwargs 整合成一个信息头字典</span>        dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""发送信息"""</span>        <span class="token comment" spellcheck="true"># 字典转换成字符串</span>        dic_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 对字符串传毒进行编码，编码后的编码长度恒为 8</span>        dic_str_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>dic_str<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>dic_str_length<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 发送编码</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>dic_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 发送字符串</span>    <span class="token keyword">def</span> <span class="token function">recv_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""接收信息"""</span>        <span class="token comment" spellcheck="true"># 解码获取字符串长度</span>        str_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>STR_RECV_LENGTH<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 根据字符串长度选择不同的方式接收消息</span>        <span class="token keyword">if</span> str_length <span class="token operator">&lt;</span> MAX_RECV_LENGTH<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 没有超过最大接收长度</span>            dic_str <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>str_length<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 字符串长度超过 1024</span>            recv_size <span class="token operator">=</span> <span class="token number">0</span>            dic_str <span class="token operator">=</span> <span class="token string">""</span>            <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> str_length<span class="token punctuation">:</span>                data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>MAX_RECV_LENGTH<span class="token punctuation">)</span>                dic_str <span class="token operator">+=</span> data                recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>dic_str<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 将字符串转化为字典，并返回字典</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""客户端登录"""</span>        num <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">while</span> num <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户可以尝试三次</span>            username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"username >>:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 去除输入后左右两边的空格，防止因为某些原因用户一开始输入时输入多个空格</span>            <span class="token keyword">if</span> <span class="token operator">not</span> username<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户名不能为空</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"username can not be empty"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"password >>:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> password<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 密码不能为空</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"password can not be empty"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"login"</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 制作信息头</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 发送信息头</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 接收服务端的反馈</span>            <span class="token keyword">if</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 根据状态码判断用户是否登录成功，200 代表登陆成功</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} login succeed !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 记录用户在服务端的当前目录</span>                self<span class="token punctuation">.</span>username <span class="token operator">=</span> username <span class="token comment" spellcheck="true"># 登录成功，记录用户登录的用户名</span>                self<span class="token punctuation">.</span>re_get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 登录成功后，首先让用户选择是否需要对未完成的文件进行断点续存</span>                self<span class="token punctuation">.</span>handle<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 和服务端进行交互</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                status_msg <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 登录失败，打印服务端反馈的状态信息</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> status_msg<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                num <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment" spellcheck="true"># 尝试次数减少一次</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""和服务端交互"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># 用户输入交互命令，输入时的提示信息是用户目前在客户端的当前目录，一样需要去除空格</span>                cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"[{}]>>："</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入命令的不能控</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} command should not be empty !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>                cmd_list <span class="token operator">=</span> cmd<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 对用户输入的内容进行按空格分割，分割之后的第一个词是交互命令名称</span>                <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果客户端存在该方法</span>                    func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    func<span class="token punctuation">(</span>cmd_list<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 执行该方法，并传入分割后的命令列表作为参数</span>                <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户输入的交互命令不存在</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} this command is not existed !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 打印报错</span>    <span class="token keyword">def</span> <span class="token function">parameter_num_judgment</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> parameter_length<span class="token punctuation">,</span> Min_num <span class="token operator">=</span> None<span class="token punctuation">,</span> Max_num <span class="token operator">=</span> None<span class="token punctuation">,</span> Exact_num <span class="token operator">=</span> None<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""命令参数个数判断"""</span>        <span class="token comment" spellcheck="true"># 判断参数个数时候符合规范，可以输入最大参数个数，最小参数个数，准确的参数个数</span>        <span class="token keyword">if</span> Min_num <span class="token operator">and</span> Min_num <span class="token operator">></span> parameter_length<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} the least number of parameter is {}, but you supply the {} parameter {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span>  Min_num<span class="token punctuation">,</span> parameter_length<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">if</span> Max_num <span class="token operator">and</span> Max_num <span class="token operator">&lt;</span> parameter_length<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} the most number of parameter is {}, but you supply the {} parameter {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span>  Max_num<span class="token punctuation">,</span> parameter_length<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">if</span> Exact_num <span class="token operator">and</span> Exact_num <span class="token operator">!=</span> parameter_length<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} the exact number of parameter is {}, but you supply the {} parameter {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span>  Exact_num<span class="token punctuation">,</span> parameter_length<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">def</span> <span class="token function">dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">:</span>list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看在服务端的当前目录"""</span>        <span class="token comment" spellcheck="true"># 首先判断查看目录方法参数是否准确，因为是查看当前目录，所以我们除了命令名称 dir 外，其他参数都是无关紧要的，所以最小需要一个参数</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_num_judgment<span class="token punctuation">(</span>parameter_length <span class="token operator">=</span> len<span class="token punctuation">(</span>cmd_list<span class="token punctuation">)</span><span class="token punctuation">,</span> Min_num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 制作信息头并发送</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"dir"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 接收服务端的反馈</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 根据服务端的反馈输出查看目录的结果</span>            stdout <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stdout"</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"stderr"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">,</span> stderr<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">:</span>list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""切换目录"""</span>        <span class="token comment" spellcheck="true"># 切换目录最少需要两个参数，分别是 命令名称 cd 和目标目录</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_num_judgment<span class="token punctuation">(</span>parameter_length<span class="token operator">=</span>len<span class="token punctuation">(</span>cmd_list<span class="token punctuation">)</span><span class="token punctuation">,</span> Min_num<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 制作信息头并发送</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type <span class="token operator">=</span> <span class="token string">"cd"</span><span class="token punctuation">,</span> path <span class="token operator">=</span> cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 接收服务端的反馈，并打印状态信息</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">300</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果切换目录成功，当前目录就变为切换后的目录</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">mkdir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_lsit<span class="token punctuation">:</span>list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""创造文件夹"""</span>        <span class="token comment" spellcheck="true"># 至少需要传入两个参数，命令名称和要创造的文件夹名称</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_num_judgment<span class="token punctuation">(</span>parameter_length<span class="token operator">=</span>len<span class="token punctuation">(</span>cmd_lsit<span class="token punctuation">)</span><span class="token punctuation">,</span> Min_num<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"mkdir"</span><span class="token punctuation">,</span> dirname <span class="token operator">=</span> cmd_lsit<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 打印服务端反馈的状态信息</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">:</span>list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""从用户端下载文件"""</span>        <span class="token comment" spellcheck="true"># 至少两个参数，命令名称和需要下载的文件名称</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_num_judgment<span class="token punctuation">(</span>parameter_length<span class="token operator">=</span>len<span class="token punctuation">(</span>cmd_list<span class="token punctuation">)</span><span class="token punctuation">,</span> Min_num<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"get"</span><span class="token punctuation">,</span> file_name <span class="token operator">=</span> cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 当前时间，下载的文件在本地有同命名文件时，将作为后缀添加到下载后的文件中</span>            now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>            now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 打开记录未下载完成的文件信息的 ini 文件</span>            conf <span class="token operator">=</span> ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>            conf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">)</span>            conf<span class="token punctuation">.</span>add_section<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">)</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">303</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 表示服务端文件存在，可以下载</span>                file_size <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_size"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要下载的文件总大小</span>                <span class="token comment" spellcheck="true"># 记录文件信息到 ini 中</span>                conf<span class="token punctuation">[</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>username <span class="token comment" spellcheck="true"># 此时登录的用户，因为一个客户端可以登录不同的用户，所以记录是什么用户未下载完成的文件，防止断点续存时出现 用户A 可以下载 用户B 的文件的情况</span>                conf<span class="token punctuation">[</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"total_size"</span><span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">(</span>file_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 下载文件总大小</span>                conf<span class="token punctuation">[</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"file_path"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>current_dir <span class="token comment" spellcheck="true"># 下载文件在服务端的路径</span>                f <span class="token operator">=</span> open<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>                conf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 将记录的信息写入 ini 文件</span>                <span class="token comment" spellcheck="true"># 下载了的大小</span>                recv_size <span class="token operator">=</span> <span class="token number">0</span>                bar <span class="token operator">=</span> self<span class="token punctuation">.</span>process_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>file_size<span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 实例化进度条，是一个迭代器</span>                bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 接收服务端传输的文件</span>                <span class="token keyword">with</span> open<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                    <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> file_size<span class="token punctuation">:</span>                        data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>MAX_RECV_LENGTH<span class="token punctuation">)</span>                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                        recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                        bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 进度条显示</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果没有相同命名的文件，就不添加时间</span>                    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">,</span> cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># os.remove(cmd_list[1] + "." + now_time)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>                    now_time_finally <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>                    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">,</span> cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span>now_time_finally<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 存在相同命名的文件，添加时间作为后缀</span>                    <span class="token comment" spellcheck="true"># os.remove(cmd_list[1] + "." + now_time)</span>                <span class="token comment" spellcheck="true"># 因为文件下载成功，删除断点续存 ini 文件中的文件信息</span>                conf<span class="token punctuation">.</span>remove_section<span class="token punctuation">(</span>cmd_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> now_time<span class="token punctuation">)</span>                f <span class="token operator">=</span> open<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>                conf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 要下载的文件在服务端中不存在，客户端打印服务端的反馈状态信息</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">process_bar</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> total_size<span class="token punctuation">,</span> recv_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""进度条"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            current_size <span class="token operator">=</span> <span class="token keyword">yield</span> recv_size            <span class="token keyword">if</span> current_size <span class="token operator">/</span> total_size <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> int<span class="token punctuation">(</span>current_size <span class="token operator">/</span> total_size <span class="token operator">*</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>current_size <span class="token operator">/</span> total_size <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%"</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"\r"</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> # 每次打印都会覆盖，end<span class="token operator">=</span><span class="token string">"\r"</span> 表示每次打印都从首行开头打印，flush<span class="token operator">=</span><span class="token boolean">True</span> 表示打印时覆盖    <span class="token keyword">def</span> <span class="token function">re_get</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断点续传"""</span>        files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 记录该用户未完成下载的文件文件名</span>        <span class="token comment" spellcheck="true"># 打开 ini 文件</span>        conf <span class="token operator">=</span> ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        conf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">)</span>        file_list <span class="token operator">=</span> conf<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>file_list<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> file <span class="token keyword">in</span> file_list<span class="token punctuation">:</span>                <span class="token keyword">if</span> conf<span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"username"</span><span class="token punctuation">]</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>username<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 判断在 ini 文件中哪些文件是登录用户的未完成下载的文件</span>                    files<span class="token punctuation">.</span>append<span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 文件添加到 files 列表中</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">while</span> len<span class="token punctuation">(</span>files<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果该用户有未下载完成的文件</span>                conf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">)</span>                file_list <span class="token operator">=</span> conf<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 打印该用户未下载完成的文件信息，包括 文件名称，要下载的文件总大小，文件在服务端的位置</span>                <span class="token keyword">for</span> file <span class="token keyword">in</span> files<span class="token punctuation">:</span>                    index <span class="token operator">=</span> <span class="token number">0</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token triple-quoted-string string">"""index: {}          file_name: {}                         total_size: {}              current_path: {}"""</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">,</span> file<span class="token punctuation">,</span> conf<span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"total_size"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> conf<span class="token punctuation">[</span>file<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"file_path"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    index <span class="token operator">+=</span> <span class="token number">1</span>                <span class="token comment" spellcheck="true"># 如果用户需要继续下载，就输入前面打印的 index，否则输入 “quit” 退出，在退出时会删除 ini 文件中未完成下载的文件信息（退出就删除在写完之后才发现其实不合理，但先这样吧，毕竟以后还要再修改成含数据库的版本的）</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span><span class="token string">"If you want to continue downloading the file that was not downloaded last time, please enter the index of the file."</span><span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">' Enter "quit" to exit the function. Unfinished files will be automatically deleted when you exit the function'</span><span class="token punctuation">)</span>                cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"[{}]>>："</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入不能为空</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} command should not be empty !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token keyword">continue</span>                <span class="token keyword">if</span> cmd<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 判断输入的是否是数字</span>                    <span class="token triple-quoted-string string">"""如果输入数字"""</span>                    <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> int<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span> <span class="token operator">&lt;</span> len<span class="token punctuation">(</span>files<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 因为是索引，所以索引必须要大于0，而且要小于 files 的长度</span>                        file_name <span class="token operator">=</span> files<span class="token punctuation">[</span>int<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">]</span>                        recv_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取未完成下载的文件已经下载的大小</span>                        <span class="token comment" spellcheck="true"># 制作信息头并发送</span>                        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"re_get"</span><span class="token punctuation">,</span> file_name<span class="token operator">=</span>file_name<span class="token punctuation">,</span> total_size<span class="token operator">=</span>conf<span class="token punctuation">[</span>file_name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"total_size"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">,</span> path<span class="token operator">=</span>conf<span class="token punctuation">[</span>file_name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"file_path"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>                        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token keyword">if</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">303</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 要下载的文件在服务端存在</span>                            self<span class="token punctuation">.</span>re_download<span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> conf<span class="token punctuation">[</span>file_name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"total_size"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> recv_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 继续下载</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 文件在服务端不存在</span>                            <span class="token keyword">print</span><span class="token punctuation">(</span>dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true"># 下载成功，移除在 ini 文件中的信息</span>                        conf<span class="token punctuation">.</span>remove_section<span class="token punctuation">(</span>files<span class="token punctuation">[</span>int<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                        f <span class="token operator">=</span> open<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>                        conf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token punctuation">)</span>                <span class="token keyword">elif</span> cmd <span class="token operator">==</span> <span class="token string">"quit"</span><span class="token punctuation">:</span>                    <span class="token comment" spellcheck="true"># 如果不想在退出时删除 ini 中未下载完成的文件信息，可以删除下面的 循环</span>                    <span class="token keyword">for</span> file <span class="token keyword">in</span> files<span class="token punctuation">:</span>                        conf<span class="token punctuation">.</span>remove_section<span class="token punctuation">(</span>file<span class="token punctuation">)</span>                        f <span class="token operator">=</span> open<span class="token punctuation">(</span>INI_PATH<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>                        conf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true"># os.remove(file)</span>                    <span class="token keyword">break</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} no this index(may you want to enter 'quit') {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">re_download</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> total_size<span class="token punctuation">,</span> recv_size<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断点续传的下载"""</span>        <span class="token comment" spellcheck="true"># 下载进度条</span>        bar <span class="token operator">=</span> self<span class="token punctuation">.</span>process_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>int<span class="token punctuation">(</span>total_size<span class="token punctuation">)</span><span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span>        bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> int<span class="token punctuation">(</span>total_size<span class="token punctuation">)</span><span class="token punctuation">:</span>                data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>MAX_RECV_LENGTH<span class="token punctuation">)</span>                recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">quit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> cmd_list<span class="token punctuation">:</span>list<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断开连接"""</span>        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"quit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        exit<span class="token punctuation">(</span><span class="token string">"{} Quit succeed !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    client <span class="token operator">=</span> MyClient<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="FTPServer-py-文件"><a href="#FTPServer-py-文件" class="headerlink" title="FTPServer.py 文件"></a>FTPServer.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span>syspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 这里的 path 是 FTPServer 文件夹</span><span class="token comment" spellcheck="true"># 选择 os.path.dirname 有一个好处就是不用管 FTPServer 文件夹到底在哪个路径，不需要因为FTPServer位置更改而更改路径代码</span><span class="token comment" spellcheck="true"># print(path)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 将目录添加到环境变量，这样就可以导入 lib 中的文件了</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> lib <span class="token keyword">import</span> Mangement    server <span class="token operator">=</span> Mangement<span class="token punctuation">.</span>management<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># sys.argv 解析命令行命令，比如说我们在命令行输入 python FTPServer.py start，那么此时的 sys.argv 就是 ["FTPServer", "start"] 这样一个列表</span>    <span class="token comment" spellcheck="true"># 将 sys.argv 传入Mangement文件中的management类，实例化该类</span></code></pre><h3 id="settings-py-文件"><a href="#settings-py-文件" class="headerlink" title="settings.py 文件"></a>settings.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token comment" spellcheck="true"># 服务端端口信息</span>HOST <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>PORT <span class="token operator">=</span> <span class="token number">8080</span><span class="token comment" spellcheck="true"># 存储用户信息的 ini 文件的路径</span>ACCOUNTS_INI <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\accounts.ini"</span><span class="token comment" spellcheck="true"># 存放用户家目录的文件夹目录</span>HOME_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\home"</span><span class="token comment" spellcheck="true"># 服务端日志文件夹目录</span>LOG_PATH <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\log"</span></code></pre><h3 id="Management-py-文件"><a href="#Management-py-文件" class="headerlink" title="Management.py 文件"></a>Management.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token keyword">from</span> lib <span class="token keyword">import</span> main<span class="token keyword">from</span> lib <span class="token keyword">import</span> Create<span class="token keyword">from</span> conf <span class="token keyword">import</span> settings<span class="token keyword">class</span> <span class="token class-name">management</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sys_argv<span class="token punctuation">)</span><span class="token punctuation">:</span>        sys_argv <span class="token operator">=</span> sys_argv        self<span class="token punctuation">.</span>verify_argv<span class="token punctuation">(</span>sys_argv<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">verify_argv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sys_argv<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""验证命令是否正确"""</span>        tips <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        ---------------------------------------------                    FTP Server command        ---------------------------------------------              start              -- 启动 FTP 服务端        ---------------------------------------------              create             -- 注册新用户        ---------------------------------------------              delete             -- 管理员注销用户        ---------------------------------------------        """</span>        command <span class="token operator">=</span> sys_argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果该命令存在，就执行改命令</span>            func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span>            func<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""启动服务端"""</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}FTP Server start {} {}{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> settings<span class="token punctuation">.</span>HOST<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>PORT<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        server <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>HOST<span class="token punctuation">,</span> settings<span class="token punctuation">.</span>PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> main<span class="token punctuation">.</span>MyServer<span class="token punctuation">)</span>        server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""创建用户"""</span>        create <span class="token operator">=</span> Create<span class="token punctuation">.</span>createUser<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""删除用户"""</span>        <span class="token keyword">pass</span></code></pre><h3 id="Create-py-文件"><a href="#Create-py-文件" class="headerlink" title="Create.py 文件"></a>Create.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> configparser <span class="token keyword">import</span> ConfigParser<span class="token keyword">from</span> conf <span class="token keyword">import</span> settings<span class="token keyword">import</span> hashlib<span class="token punctuation">,</span>os<span class="token keyword">class</span> <span class="token class-name">createUser</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 打开 ini 文件，记录创建的用户名和密码信息</span>        self<span class="token punctuation">.</span>conf <span class="token operator">=</span> ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>ACCOUNTS_INI<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"the username of the user what you want to create >>:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> username<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户名不能为空</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the username cannot be empty"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            <span class="token keyword">if</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>verify_username<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 判断该用户名是否已存在</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"this username is existed"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"the password of the user you want to create >>:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> username<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 密码不能为空</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"the password cannot be empty"</span><span class="token punctuation">)</span>                <span class="token keyword">continue</span>            self<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">def</span> <span class="token function">verify_username</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""检验用户名是否已存在"""</span>        username_list <span class="token operator">=</span> self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> username <span class="token keyword">in</span> username_list<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">def</span> <span class="token function">create_user</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""将用户名和密码写入配置文件"""</span>        self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>add_section<span class="token punctuation">(</span>username<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>set<span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span>        md5_password <span class="token operator">=</span> self<span class="token punctuation">.</span>md5_password<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 得到加密后的密码</span>                <span class="token comment" spellcheck="true"># 用户名和密加密后的密码写入 ini 文件</span>        self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>set<span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">,</span> md5_password<span class="token punctuation">)</span>        f <span class="token operator">=</span> open<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>ACCOUNTS_INI<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>f<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} create succeed !!! {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>create_dir<span class="token punctuation">(</span>username<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">md5_password</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""加密密码并写入配置文件"""</span>        md5_ <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>        md5_<span class="token punctuation">.</span>update<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        md5_password <span class="token operator">=</span> md5_<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(md5_password)</span>        <span class="token keyword">return</span> str<span class="token punctuation">(</span>md5_password<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">create_dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""创建用户时，创建用户家目录"""</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>HOME_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> username<span class="token punctuation">)</span></code></pre><h3 id="main-py-文件"><a href="#main-py-文件" class="headerlink" title="main.py 文件"></a>main.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token punctuation">,</span> json<span class="token punctuation">,</span> struct<span class="token punctuation">,</span>hashlib<span class="token punctuation">,</span> subprocess<span class="token punctuation">,</span> os<span class="token punctuation">,</span>time<span class="token keyword">from</span> configparser <span class="token keyword">import</span> ConfigParser<span class="token keyword">from</span> conf <span class="token keyword">import</span> settingsSTR_RECV_LENGTH <span class="token operator">=</span> <span class="token number">8</span>MAX_RECV_LENGTH <span class="token operator">=</span> <span class="token number">8096</span>STATUS <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token number">200</span><span class="token punctuation">:</span> <span class="token string">"Login succeed"</span><span class="token punctuation">,</span>    <span class="token number">201</span><span class="token punctuation">:</span> <span class="token string">"Error: wrong password or wrong username"</span><span class="token punctuation">,</span>    <span class="token number">202</span><span class="token punctuation">:</span> <span class="token string">"Check the current dir"</span><span class="token punctuation">,</span>    <span class="token number">300</span><span class="token punctuation">:</span> <span class="token string">"{} cd the path done {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token number">301</span><span class="token punctuation">:</span> <span class="token string">"{} the path is not existed {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token number">302</span><span class="token punctuation">:</span> <span class="token string">"{} dir create succeed {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token number">303</span><span class="token punctuation">:</span> <span class="token string">"{} the file is existed {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token number">304</span><span class="token punctuation">:</span> <span class="token string">"{} the file is not existed {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true"># 状态码，反馈给客户端，帮助客户端判断服务端的执行命令的结果</span><span class="token keyword">class</span> <span class="token class-name">MyServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span>        self<span class="token punctuation">.</span>client_name <span class="token operator">=</span> None        self<span class="token punctuation">.</span>HOME_PATH <span class="token operator">=</span> None        self<span class="token punctuation">.</span>current_path <span class="token operator">=</span> None        self<span class="token punctuation">.</span>show_to_client_path <span class="token operator">=</span> None        <span class="token keyword">print</span><span class="token punctuation">(</span>str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"connect succeed"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 客户端连接成功</span>        self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"connect succeed"</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                dic <span class="token operator">=</span> self<span class="token punctuation">.</span>recv_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> dic<span class="token punctuation">:</span>                    <span class="token keyword">break</span>                action_type <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"action_type"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 判断客户端的命令类型</span>                <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action_type<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果存在该命令，就执行，并将客户端发送的 dic 作为参数传入执行命令</span>                    func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action_type<span class="token punctuation">)</span>                    func<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>                <span class="token keyword">break</span>    <span class="token keyword">def</span> <span class="token function">create_msg_to_send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> status_code<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""制作信息头"""</span>        <span class="token comment" spellcheck="true"># 和客户端基本一致</span>        dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"status_code"</span><span class="token punctuation">:</span> status_code<span class="token punctuation">,</span>            <span class="token string">"status_msg"</span><span class="token punctuation">:</span> STATUS<span class="token punctuation">.</span>get<span class="token punctuation">(</span>status_code<span class="token punctuation">)</span>        <span class="token punctuation">}</span>        dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span>kwargs<span class="token punctuation">)</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span> dict<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""发送信息"""</span>        <span class="token comment" spellcheck="true"># 和客户端基本一致</span>        dic_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>        dic_str_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>dic_str<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>dic_str_length<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>dic_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">recv_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> dict<span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""接收信息"""</span>        <span class="token comment" spellcheck="true"># 和客户端基本一致</span>        pack_length <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>STR_RECV_LENGTH<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> pack_length<span class="token punctuation">:</span>            dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>            <span class="token keyword">return</span> dic        str_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> pack_length<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> str_length <span class="token operator">&lt;</span> MAX_RECV_LENGTH<span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 没有超过最大接收长度</span>            dic_str <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>str_length<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            recv_size <span class="token operator">=</span> <span class="token number">0</span>            dic_str <span class="token operator">=</span> <span class="token string">""</span>            <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> str_length<span class="token punctuation">:</span>                data <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>MAX_RECV_LENGTH<span class="token punctuation">)</span>                dic_str <span class="token operator">+=</span> data                recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>dic_str<span class="token punctuation">)</span>        <span class="token keyword">return</span> dic    <span class="token keyword">def</span> <span class="token function">_login</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""用户登录验证"""</span>        <span class="token comment" spellcheck="true"># 获取客户端传入的用户名和密码</span>        username <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 将客户端传入的密码进行加密并且和 ini 文件记录的加密密码进行匹配</span>        md5 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>        md5<span class="token punctuation">.</span>update<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        md5_password <span class="token operator">=</span> md5<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>        conf <span class="token operator">=</span> ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        conf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>ACCOUNTS_INI<span class="token punctuation">)</span>        <span class="token keyword">if</span> username <span class="token keyword">in</span> conf<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 该用户已注册，表示可以登录（这里写的多用户登录并不能防止一个用户同时在线，这也是需要修改的地方）</span>            password <span class="token operator">=</span> conf<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span>            <span class="token keyword">if</span> str<span class="token punctuation">(</span>password<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>md5_password<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 密码正确</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} login succeed, username: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"login succeed, username: {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>client_name <span class="token operator">=</span> username <span class="token comment" spellcheck="true"># 记录此时登录的用户名</span>                self<span class="token punctuation">.</span>HOME_PATH <span class="token operator">=</span> settings<span class="token punctuation">.</span>HOME_PATH <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> username <span class="token comment" spellcheck="true"># 登录的用户家目录</span>                self<span class="token punctuation">.</span>current_path <span class="token operator">=</span> self<span class="token punctuation">.</span>HOME_PATH <span class="token comment" spellcheck="true"># 登录的用户当前在服务端的路径位置</span>                self<span class="token punctuation">.</span>show_to_client_path <span class="token operator">=</span> self<span class="token punctuation">.</span>current_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>HOME_PATH<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 发送给用户的在服务端的位置，从 home 以后发送，比如说登录 用户为 aoteman，发送给客户端的目录为 “aoteman” 而不包括前面的路径</span>                                <span class="token comment" spellcheck="true"># 制作信息头并发送</span>                dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> current_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>show_to_client_path<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg<span class="token operator">=</span><span class="token string">"Error: wrong password or wrong username"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true"># 登录失败，密码不正确</span>                dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span><span class="token string">"Login succeed"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登陆失败，登录用户未注册，即用户不存在</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token operator">=</span>dic<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看用户当前目录"""</span>        <span class="token comment" spellcheck="true"># 执行终端命令，并储存运行结果</span>        obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"cd {} &amp; dir /s/b"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path<span class="token punctuation">)</span><span class="token punctuation">,</span>                               shell <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span>                               stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                               stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>        stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 制作信息头并发送</span>        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">202</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token operator">=</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} check the current dir {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client_name<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"check the current dir"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""切换用户目录"""</span>        full_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>HOME_PATH <span class="token keyword">in</span> full_path <span class="token operator">and</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">"""判断切换的路径存在并且需要保证用户切换的路径不会是用户家目录的父目录"""</span>            self<span class="token punctuation">.</span>current_path <span class="token operator">=</span> full_path            self<span class="token punctuation">.</span>show_to_client_path <span class="token operator">=</span> self<span class="token punctuation">.</span>current_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>HOME_PATH<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>            subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"cd %s"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>current_path<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> current<span class="token operator">=</span>self<span class="token punctuation">.</span>show_to_client_path<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} cd the dir {} {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client_name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_path<span class="token punctuation">,</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">301</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} cd the dir {} , but this path is not existed {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client_name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_path<span class="token punctuation">,</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"cd the dir {} , but this path is not existed "</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_mkdir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""制作文件夹"""</span>        <span class="token comment" spellcheck="true"># 允许用户在自己的家目录下新建新的文件夹</span>        dir_name <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"dirname"</span><span class="token punctuation">)</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> dir_name<span class="token punctuation">)</span>        dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">302</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} create the dir {} {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client_name<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> dir_name<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"create the dir {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_path<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""用户下载文件"""</span>        file_name <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_name"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 用户端想要下载的文件</span>        file_path <span class="token operator">=</span> self<span class="token punctuation">.</span>current_path <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name <span class="token comment" spellcheck="true"># 拼接文件路径，查看服务端是否存在该文件</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件存在</span>            file_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取文件总大小</span>                         <span class="token comment" spellcheck="true"># 制作信息头并发送</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">303</span><span class="token punctuation">,</span> file_size<span class="token operator">=</span>file_size<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true"># 打开文件发送给客户端，因为网络通信传输的数据类型是二进制数据，所以 "rb" 打开文件</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} get done {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"{} get done"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 要下载的文件不在服务端（或者不在服务端当前目录）</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">304</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_re_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断点续传"""</span>        <span class="token comment" spellcheck="true"># print(dic)</span>        file_name_list <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"file_name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span>         file_name_list<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 去除时间后缀</span>        file_name <span class="token operator">=</span> <span class="token string">"."</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>file_name_list<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 用户想要继续下载的文件名称</span>        path <span class="token operator">=</span> settings<span class="token punctuation">.</span>HOME_PATH <span class="token operator">+</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> file_name <span class="token comment" spellcheck="true"># 文件在服务端的路径（其实这里有一个问题，应该还要判断文件在服务端是否存在）</span>        total_size <span class="token operator">=</span> int<span class="token punctuation">(</span>dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"total_size"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 客户端记录的文件总大小</span>        recv_size <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"recv_size"</span><span class="token punctuation">)</span>        size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取服务端文件的总大小</span>        <span class="token keyword">if</span> total_size <span class="token operator">==</span> size<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 总大小进行对并，避免出现名称一致，但是大小不一致的情况（比如说文件在服务端被更新，这时候继续下载毫无意义）</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">303</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} {} re-get done {}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">,</span> file_name<span class="token punctuation">,</span> <span class="token string">"-"</span> <span class="token operator">*</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg<span class="token operator">=</span><span class="token string">"{} re-get done"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 服务端的文件和客户端想要继续下载的文件总大小并不一致</span>            dic <span class="token operator">=</span> self<span class="token punctuation">.</span>create_msg_to_send<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">304</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_msg<span class="token punctuation">(</span>dic<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_quit</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> dic<span class="token punctuation">:</span>dict<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""断开连接"""</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{} close"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>write_log<span class="token punctuation">(</span>msg <span class="token operator">=</span> <span class="token string">"close"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">write_log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""日志制作"""</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>settings<span class="token punctuation">.</span>LOG_PATH <span class="token operator">+</span> <span class="token string">"//"</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">".txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>            now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"{} {} {} {} \t{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client_name<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">25</span><span class="token punctuation">,</span> now_time<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></code></pre><h2 id="演示结果"><a href="#演示结果" class="headerlink" title="演示结果"></a>演示结果</h2><p><img src="https://img-blog.csdnimg.cn/b8d092e6f92b4af08e4f35a7528855ba.gif"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
            <tag> 多线程 FTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程FTP（2）—— socketserver 部分源码解读</title>
      <link href="/2022/11/25/duo-xian-cheng-ftp-2-socketserver-bu-fen-yuan-ma-jie-du/"/>
      <url>/2022/11/25/duo-xian-cheng-ftp-2-socketserver-bu-fen-yuan-ma-jie-du/</url>
      
        <content type="html"><![CDATA[<h1 id="多线程FTP（2）——-socketserver-部分源码解读"><a href="#多线程FTP（2）——-socketserver-部分源码解读" class="headerlink" title="多线程FTP（2）—— socketserver 部分源码解读"></a>多线程FTP（2）—— socketserver 部分源码解读</h1><p>前面我们用 socketserver 演示了 sockeserver 版本的多线程网络通信实现。但实际上我们对于 socketserver 现在处于 “<strong>知其然不知其所以然</strong>” 的情况，<strong>比如说，为什么自己写的类中方法一定要是“handle”？为什么我们只用写通信循环，为什么不用写链接循环？</strong></p><p>所有的这些问题其实都可以通过分析 socketserver 的源码来回答。</p><p>（pycharm可以通过导入 socket server，并且按住 Ctrl+鼠标点击跳转至模块源码）</p><p><img src="https://img-blog.csdnimg.cn/6dc1a6e95d8745bd8cdebf832e4e82c0.gif"></p><h2 id="socketserver-源码中的类"><a href="#socketserver-源码中的类" class="headerlink" title="socketserver 源码中的类"></a>socketserver 源码中的类</h2><p>首先我们看到的是一百多行的灰色的注释，这里的注释其实不需要太过于关注，大概就是对 socket server 模块的摘要和概述（突然想到论文，笑）。</p><p>唯一需要注意的是注释中<strong>这块对于模块中主要类的表示和关系</strong>：</p><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''        +------------+        | BaseServer |        +------------+              |              v        +-----------+        +------------------+        | TCPServer |------->| UnixStreamServer |        +-----------+        +------------------+              |              v        +-----------+        +--------------------+        | UDPServer |------->| UnixDatagramServer |        +-----------+        +--------------------+'''</span>这里显示的是五个类之间的继承关系，箭头代表“继承于”的关系。然后我们看到了的是socketserver 源码中所有类的名称。<span class="token triple-quoted-string string">'''__all__ = ["BaseServer", "TCPServer", "UDPServer",           "ThreadingUDPServer", "ThreadingTCPServer",           "BaseRequestHandler", "StreamRequestHandler",           "DatagramRequestHandler", "ThreadingMixIn"]'''</span>之后的代码就都是这些类的实现，在看这些源码之前，我们把所有的类收起，看一下这些类之间的关系。<span class="token keyword">class</span> <span class="token class-name">BaseServer</span><span class="token keyword">class</span> <span class="token class-name">TCPServer</span><span class="token punctuation">(</span>BaseServer<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">UDPServer</span><span class="token punctuation">(</span>TCPServer<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">_Threads</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">_NoThreads</span><span class="token keyword">class</span> <span class="token class-name">ThreadingMixIn</span><span class="token keyword">class</span> <span class="token class-name">ThreadingUDPServer</span><span class="token punctuation">(</span>ThreadingMixIn<span class="token punctuation">,</span> UDPServer<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ThreadingTCPServer</span><span class="token punctuation">(</span>ThreadingMixIn<span class="token punctuation">,</span> TCPServer<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">BaseRequestHandler</span><span class="token keyword">class</span> <span class="token class-name">StreamRequestHandler</span><span class="token punctuation">(</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">_SocketWriter</span><span class="token punctuation">(</span>BufferedIOBase<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">DatagramRequestHandler</span><span class="token punctuation">(</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''在源码中我们可以看到 类似于：if hasattr(socket, 'AF_UNIX')if hasattr(os, "fork") 的代码语句需要说明的是'AF_UNIX' 和 '"fork"' 的方法适用于 UNIX 系统服务端的搭建'''</span></code></pre><p>这里是对socketserver 源码中的类关系和功能的一个整理（可能图有点小，看不清可以私信我）。</p><p><img src="https://img-blog.csdnimg.cn/387a59f64e6946919c444dffc93951c7.png"></p><h2 id="socketserver-实现多线程-TCP-时的内部代码流程"><a href="#socketserver-实现多线程-TCP-时的内部代码流程" class="headerlink" title="socketserver 实现多线程 TCP 时的内部代码流程"></a>socketserver 实现多线程 TCP 时的内部代码流程</h2><p>多线程服务端实现代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token keyword">class</span> <span class="token class-name">server</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 一定要是 handle</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 conn</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 addr</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>            msg <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> now_time<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>now_time<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 开启 TCP服务 多线程</span>s<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="源码分析流程图"><a href="#源码分析流程图" class="headerlink" title="源码分析流程图"></a>源码分析流程图</h3><p>黑色部分是 初始化对象的分析流程，即 s &#x3D; socketserver.ThreadingTCPServer((“127.0.0.1”, 8080), server)。</p><p>红色部分和绿色部分分别是 s.serve_forever() 分析时的第一步和第二步。</p><p><img src="https://img-blog.csdnimg.cn/564eb1cc63c142f7a95d124a35079416.png"></p><h3 id="源码分析具体流程"><a href="#源码分析具体流程" class="headerlink" title="源码分析具体流程"></a>源码分析具体流程</h3><p>我们按照我们上面写的服务端代码了解源码内容。</p><pre class=" language-python"><code class="language-python">首先运行的代码是这行代码 s <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span></code></pre><p>我们跳转到源码关于 ThreadingTCPServer 的部分，只有这一行</p><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">ThreadingTCPServer</span><span class="token punctuation">(</span>ThreadingMixIn<span class="token punctuation">,</span> TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">pass</span></code></pre><p>这说明 ThreadingTCPServer 类本身并不接收任何参数，所以按照类继承的原理，接着跳转 ThreadingMixIn 类，但是 ThreadingMixIn 类只有三个方法</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">process_request_thread</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">process_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">server_close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span>这说明 ThreadingMixIn 类在初始实例化时也不需要传入参数</code></pre><p>所以我们接着查看父类 TCPServer 的内容，我们发现了 TCPServer 在初始化的代码</p><pre class=" language-python"><code class="language-python">    address_family <span class="token operator">=</span> socket<span class="token punctuation">.</span>AF_INET    socket_type <span class="token operator">=</span> socket<span class="token punctuation">.</span>SOCK_STREAM        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> server_address<span class="token punctuation">,</span> RequestHandlerClass<span class="token punctuation">,</span> bind_and_activate<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Constructor.  May be extended, do not override."""</span>        BaseServer<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> server_address<span class="token punctuation">,</span> RequestHandlerClass<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>socket <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>self<span class="token punctuation">.</span>address_family<span class="token punctuation">,</span>                                    self<span class="token punctuation">.</span>socket_type<span class="token punctuation">)</span>        <span class="token keyword">if</span> bind_and_activate<span class="token punctuation">:</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># 监听连接</span>                self<span class="token punctuation">.</span>server_bind<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 监听连接的个数</span>                self<span class="token punctuation">.</span>server_activate<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">except</span><span class="token punctuation">:</span>                <span class="token comment" spellcheck="true"># 关闭连接</span>                self<span class="token punctuation">.</span>server_close<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">raise</span></code></pre><p>我们会发现我们需要传入的参数是</p><pre class=" language-python"><code class="language-python">server_addressRequestHandlerClass和我们的代码对比后就是 server_address <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span>                   RequestHandlerClass <span class="token operator">=</span> server                        我们也可以打印一下                        <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>server_address<span class="token punctuation">)</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>RequestHandlerClass<span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/7ada4570a4614bd5b7968580d9b897f0.gif"></p><p>在这里我们也发现了其实 socket 的初始实例化就是在 TCPServer 类中实现的，这里我们就明白了为什么我们在使用 socketserver 时不需要实例化 socket了。</p><pre class=" language-python"><code class="language-python">    address_family <span class="token operator">=</span> socket<span class="token punctuation">.</span>AF_INET    socket_type <span class="token operator">=</span> socket<span class="token punctuation">.</span>SOCK_STREAM        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> server_address<span class="token punctuation">,</span> RequestHandlerClass<span class="token punctuation">,</span> bind_and_activate<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        self<span class="token punctuation">.</span>socket <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>self<span class="token punctuation">.</span>address_family<span class="token punctuation">,</span>                                    self<span class="token punctuation">.</span>socket_type<span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">def</span> <span class="token function">server_bind</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Called by constructor to bind the socket.        May be overridden.        """</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>allow_reuse_address<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span>self<span class="token punctuation">.</span>server_address<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>server_address <span class="token operator">=</span> self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>getsockname<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">server_activate</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Called by constructor to activate the server.        May be overridden.        """</span>        self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>listen<span class="token punctuation">(</span>self<span class="token punctuation">.</span>request_queue_size<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">server_close</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Called to clean-up the server.        May be overridden.        """</span>        self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>同时我们发现 TCPServer 在初始化的时候，也初识化了 BaseServer</p><pre class=" language-python"><code class="language-python">BaseServer<span class="token punctuation">.</span>__init__<span class="token punctuation">(</span>self<span class="token punctuation">,</span> server_address<span class="token punctuation">,</span> RequestHandlerClass<span class="token punctuation">)</span></code></pre><p>所以同时我们跳转至 BaseServer 类</p><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> server_address<span class="token punctuation">,</span> RequestHandlerClass<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Constructor.  May be extended, do not override."""</span>        self<span class="token punctuation">.</span>server_address <span class="token operator">=</span> server_address        self<span class="token punctuation">.</span>RequestHandlerClass <span class="token operator">=</span> RequestHandlerClass <span class="token comment" spellcheck="true"># 这句话值得注意，之后要用。之前有说RequestHandlerClass = server，所以在这里 self.RequestHandlerClass = server</span>        self<span class="token punctuation">.</span>__is_shut_down <span class="token operator">=</span> threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 跟多线程有关</span>        self<span class="token punctuation">.</span>__shutdown_request <span class="token operator">=</span> <span class="token boolean">False</span></code></pre><p>分析完 s &#x3D; socketserver.ThreadingTCPServer((“127.0.0.1”, 8080), server) 这句代码后，然后是 s.serve_forever 这句代码了。</p><p>还是和前面一下的方法，先找 ThreadingTCPServer 类 中是否有这个方法，然后是父类ThreadingMixIn 类和 TCPServer 类是否存在此方法，然后再回溯父类的父类。</p><p>最后我们在 BaseServer 类中找到了这个方法</p><pre class=" language-python"><code class="language-python"> <span class="token keyword">def</span> <span class="token function">serve_forever</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> poll_interval<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Handle one request at a time until shutdown.        Polls for shutdown every poll_interval seconds. Ignores        self.timeout. If you need to do periodic tasks, do them in        another thread.        """</span>        self<span class="token punctuation">.</span>__is_shut_down<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token triple-quoted-string string">'''            XXX: Consider using another file descriptor or connecting to the socket to wake this up instead of polling. Polling reduces our responsiveness to a shutdown request and wastes cpu at all other times.            '''</span>            <span class="token keyword">with</span> _ServerSelector<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> selector<span class="token punctuation">:</span>                selector<span class="token punctuation">.</span>register<span class="token punctuation">(</span>self<span class="token punctuation">,</span> selectors<span class="token punctuation">.</span>EVENT_READ<span class="token punctuation">)</span>                <span class="token keyword">while</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>__shutdown_request<span class="token punctuation">:</span>                    ready <span class="token operator">=</span> selector<span class="token punctuation">.</span>select<span class="token punctuation">(</span>poll_interval<span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># bpo-35017: shutdown() called during select(), exit immediately.</span>                    <span class="token keyword">if</span> self<span class="token punctuation">.</span>__shutdown_request<span class="token punctuation">:</span>                        <span class="token keyword">break</span>                    <span class="token keyword">if</span> ready<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>_handle_request_noblock<span class="token punctuation">(</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>service_actions<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">finally</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>__shutdown_request <span class="token operator">=</span> <span class="token boolean">False</span>            self<span class="token punctuation">.</span>__is_shut_down<span class="token punctuation">.</span>set<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>很复杂的代码，叫人摸不着头脑，看不懂没关系，我们可以看注释呀</p><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""大概是说处理请求Handle one request at a time until shutdown.是说处理请求的周期，以及说如果要处理有规律的周期性请求使用另一个线程。Polls for shutdown every poll_interval seconds. Ignoresself.timeout. If you need to do periodic tasks, do them inanother thread."""</span></code></pre><p>从注释来看，serve_forever 方法是和请求处理、多线程有关的方法。</p><p>此外，BaseServer 类serve_forever方法中有一行代码值得注意，是</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> ready<span class="token punctuation">:</span>    self<span class="token punctuation">.</span>_handle_request_noblock<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>如果我们跳转到方法 _handle_request_noblock()，也会发现一些很有意思的代码</p><pre class=" language-python"><code class="language-python">request<span class="token punctuation">,</span> client_address <span class="token operator">=</span> self<span class="token punctuation">.</span>get_request<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>self<span class="token punctuation">.</span>process_request<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span></code></pre><p>这时候我们发现了一个我们在自己定义类中出现过的两个变量 request, client_address，那么这两个变量是什么呢？我们接着跳转到 方法 get_request。（ get_request方法是 TCPServer 类中，也挺合理的，毕竟 TCPServer 继承于BaseServer，但还是觉得源码的结构挺牛的）。</p><p>然后我们就发现了我们很熟悉的代码</p><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">get_request</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Get the request and client address from the socket.        May be overridden.        """</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 熟悉的通信连接</span></code></pre><p>然后我们回到 self.process_request(request, client_address)代码，跳转</p><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">process_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""Call finish_request.        Overridden by ForkingMixIn and ThreadingMixIn.        """</span>        self<span class="token punctuation">.</span>finish_request<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>shutdown_request<span class="token punctuation">(</span>request<span class="token punctuation">)</span></code></pre><p>再跳转到 finish_request 方法</p><pre class=" language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">finish_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Finish one request by instantiating RequestHandlerClass."""</span>    self<span class="token punctuation">.</span>RequestHandlerClass<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> self<span class="token punctuation">)</span></code></pre><p>这里我们又看到了一个很熟悉的代码 self.RequestHandlerClass，这一行我们又回到了一开始初始化的部分</p><pre class=" language-python"><code class="language-python"> RequestHandlerClass <span class="token operator">=</span> server self<span class="token punctuation">.</span>RequestHandlerClass <span class="token operator">=</span> RequestHandlerClass所以self<span class="token punctuation">.</span>RequestHandlerClass<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token operator">==</span> server<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> self<span class="token punctuation">)</span>注意，这里 server<span class="token punctuation">(</span>request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> self<span class="token punctuation">)</span> 中的 self 是指我们初始实例化的 s，也就是 ThreadingTCPServer类。我们也可以打印一下。因为在 BaseRequestHandler初始化时，有<span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> server<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>        self<span class="token punctuation">.</span>server <span class="token operator">=</span> server        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>所以我们应该打印的是 self<span class="token punctuation">.</span>server</code></pre><p><img src="https://img-blog.csdnimg.cn/0dcd396eb70747fd84cddf29ee588ea0.gif"></p><p>分析到这里，代码就运行到我们自己定义的类的部分了，同时到这里我们基本了解了这两行代码的内部原理，可以说这两行代码完成了多线程和连接循环</p><pre class=" language-python"><code class="language-python">s <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>s<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>了解了这些，我们就可以再来看看我们自己写的类了，</p><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">server</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 一定要是 handle</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 conn</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 addr</span></code></pre><p>很显然这时候我们需要跳转到 BaseRequestHandler 类</p><pre class=" language-python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BaseRequestHandler</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">"""Base class for request handler classes.    This class is instantiated for each request to be handled.  The    constructor sets the instance variables request, client_address    and server, and then calls the handle() method.  To implement a    specific service, all you need to do is to derive a class which    defines a handle() method.    The handle() method can find the request as self.request, the    client address as self.client_address, and the server (in case it    needs access to per-server information) as self.server.  Since a    separate instance is created for each request, the handle() method    can define other arbitrary instance variables.    """</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> client_address<span class="token punctuation">,</span> server<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>request <span class="token operator">=</span> request        self<span class="token punctuation">.</span>client_address <span class="token operator">=</span> client_address        self<span class="token punctuation">.</span>server <span class="token operator">=</span> server        self<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>handle<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">finally</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>finish<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">setup</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">finish</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span></code></pre><p>这段代码就比较简单了，主要是帮助我们了解了为什么我们一定要定义一个 handle 的方法，说实话我们也可以覆盖初始代码，比如说把 handle 改成其他的名称</p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
            <tag> 多线程 FTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多线程FTP（1）——多线程网络通信简单实现</title>
      <link href="/2022/11/25/duo-xian-cheng-ftp-1-duo-xian-cheng-wang-luo-tong-xin-jian-dan-shi-xian/"/>
      <url>/2022/11/25/duo-xian-cheng-ftp-1-duo-xian-cheng-wang-luo-tong-xin-jian-dan-shi-xian/</url>
      
        <content type="html"><![CDATA[<h1 id="多线程FTP（1）——多线程网络通信简单实现"><a href="#多线程FTP（1）——多线程网络通信简单实现" class="headerlink" title="多线程FTP（1）——多线程网络通信简单实现"></a>多线程FTP（1）——多线程网络通信简单实现</h1><p>之前写了一个FTP项目，但实际上我们写的FTP项目只满足单线程——这就像是打电话一样，当一个客户端和服务端连接，其他客户端就会因为服务端占线而无法连接，必须等之前连接的客户端“挂断”才能连接通信。</p><p><img src="https://img-blog.csdnimg.cn/1bdcea791317446ba4120a92861501a3.gif"></p><p>就像演示的一样，</p><ol><li>当一个客户端完成连接（比如说登录，和查看当前目录时）</li><li>另一个客户端无法完成和服务端的通信，比如说登录；</li><li>而只有在前一个客户端断开连接，服务端才会去处理后一个客户端的信息（即完成登录）</li></ol><p>很显然，一次只满足一个用户登录并不满足我们需求，我们想要的肯定是可以允许多个用户登录，服务端同时处理多个用户命令的FTP项目。</p><p>于是，我们想到了<strong>多线程</strong>的的方法去实现多个用户同时登录。</p><h2 id="什么是多线程"><a href="#什么是多线程" class="headerlink" title="什么是多线程"></a>什么是多线程</h2><h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><p>threading ，利用 CPU 和 IO 可以同时执行的原来，让 CPU 不会干巴巴等待 IO 完成。</p><h3 id="个人理解"><a href="#个人理解" class="headerlink" title="个人理解"></a>个人理解</h3><h4 id="单线程"><a href="#单线程" class="headerlink" title="单线程"></a>单线程</h4><p><img src="https://img-blog.csdnimg.cn/59db9149414647b19a5ee388497aab0e.png"></p><h4 id="多线程-1"><a href="#多线程-1" class="headerlink" title="多线程"></a>多线程</h4><p><img src="https://img-blog.csdnimg.cn/4d4362c202f54e3b9bb7643a62219ea9.png"></p><p><strong>简单来说，多线程就是一个计算机的统筹处理事情的操作，遇到需要等待的事情，就“先去”（在等待的同时）做可以即时做的事情</strong>。（理论上，多线程会增加CPU的内存和计算操作，但具体会增加多少，我没有研究过）</p><h2 id="thread-版本"><a href="#thread-版本" class="headerlink" title="thread 版本"></a>thread 版本</h2><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">,</span> threading<span class="token punctuation">,</span> time<span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接循环</span>        conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>        t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>connection<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>        t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">connection</span><span class="token punctuation">(</span>conn<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>            data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>            now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>now_time<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># args 是函数的参数，如果有参数，传入的一定是一个元组</span>t <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>create<span class="token punctuation">)</span>t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 不要忘记 start，表示启动线程</span></code></pre><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><p>客户端没有什么变化</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token punctuation">,</span> timeclient <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 休息10秒,为了更好的演示，客户端B 并没有休眠 10 秒</span>    data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/530476e154bc4c5984f5c483af625697.gif"></p><h2 id="socketserver-版本"><a href="#socketserver-版本" class="headerlink" title="socketserver 版本"></a>socketserver 版本</h2><h3 id="服务端-1"><a href="#服务端-1" class="headerlink" title="服务端"></a>服务端</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketserver<span class="token punctuation">,</span>time<span class="token keyword">class</span> <span class="token class-name">server</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> None<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 一定要是 handle</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>request<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 conn</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>client_address<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相当于 addr</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>            msg <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>            now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> now_time<span class="token punctuation">)</span>            now <span class="token operator">=</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span><span class="token punctuation">)</span>            now_time <span class="token operator">=</span> time<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y年%m月%d日%H时%M分%S秒"</span><span class="token punctuation">,</span> now<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>send<span class="token punctuation">(</span>now_time<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>s <span class="token operator">=</span> socketserver<span class="token punctuation">.</span>ThreadingTCPServer<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 开启 TCP服务 多线程</span>s<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/fe47b7c6d95d47888e5bcc1c732ee9d3.gif"></p><h3 id="客户端-1"><a href="#客户端-1" class="headerlink" title="客户端"></a>客户端</h3><p>没有什么变化。</p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
            <tag> 多线程 FTP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（10）/ FTP项目（4） ——文件下载和下载断点续存功能</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-10-ftp-xiang-mu-4-wen-jian-xia-zai-he-xia-zai-duan-dian-xu-cun-gong-neng/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-10-ftp-xiang-mu-4-wen-jian-xia-zai-he-xia-zai-duan-dian-xu-cun-gong-neng/</url>
      
        <content type="html"><![CDATA[<h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><h3 id="lib-文件夹下-main-py"><a href="#lib-文件夹下-main-py" class="headerlink" title="lib 文件夹下 main.py"></a><code>lib 文件夹下 main.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dir<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""从服务端下载文件"""</span>        filename <span class="token operator">=</span> header_dir<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filename"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 判断当前路径是否存在该文件</span>            <span class="token comment" spellcheck="true"># 存在，上传文件</span>            <span class="token comment" spellcheck="true"># 不存在，返回状态码</span>        full_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true"># 文件存在</span>            total_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> total_size<span class="token operator">=</span>total_size<span class="token punctuation">,</span> current_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送文件</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>full_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">401</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_re_get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""下载断点续存"""</span>        filename <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filename"</span><span class="token punctuation">)</span>        current_dir <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span>        total_size <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"total_size"</span><span class="token punctuation">)</span>        recv_size <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"recv_size"</span><span class="token punctuation">)</span>        full_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>current_dir<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>full_path<span class="token punctuation">)</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件存在</span>            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span> <span class="token operator">==</span> total_size<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件大小一致，就认为是同一个文件</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">402</span><span class="token punctuation">)</span>                <span class="token keyword">with</span> open<span class="token punctuation">(</span>full_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                    f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 从下载中断的地方开始发送</span>                    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">401</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 文件不存在</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">401</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 文件不存在</span></code></pre><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><h3 id="client文件夹下-FTPClient-py-代码-interactive函数-增加部分"><a href="#client文件夹下-FTPClient-py-代码-interactive函数-增加部分" class="headerlink" title="client文件夹下 FTPClient.py 代码 interactive函数 增加部分"></a><code>client文件夹下 FTPClient.py 代码 interactive函数 增加部分</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">interactive</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""交互指令"""</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登陆成功</span>            self<span class="token punctuation">.</span>unfinished_download_check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 检查未下载完成的文件</span>            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre><h3 id="client文件夹下-FTPClient-py"><a href="#client文件夹下-FTPClient-py" class="headerlink" title="client文件夹下 FTPClient.py "></a><code>client文件夹下 FTPClient.py </code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">unfinished_download_check</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""下载断点续存功能"""</span>        <span class="token keyword">if</span> list<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果有未下载完成的文件</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------Unfinished download list------"</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> index<span class="token punctuation">,</span> filename <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s      %s      %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 第几个文件，文件名，文件总大小</span>            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                choice <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"[select file index to re-get]>>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> choice<span class="token punctuation">:</span> <span class="token keyword">continue</span> <span class="token comment" spellcheck="true"># 如果为空</span>                <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">"back"</span><span class="token punctuation">:</span> <span class="token keyword">break</span> <span class="token comment" spellcheck="true"># 退出</span>                <span class="token keyword">if</span> choice<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 判断是否是数字</span>                    choice <span class="token operator">=</span> int<span class="token punctuation">(</span>choice<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 转化为整型</span>                    <span class="token keyword">if</span> choice <span class="token operator">&lt;=</span> index<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 选择在范围内</span>                        filename <span class="token operator">=</span> list<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>choice<span class="token punctuation">]</span>                        current_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        total_size <span class="token operator">=</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                        recv_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 中断前下载的文件大小</span>                        self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"re_get"</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">,</span> current_dir<span class="token operator">=</span>current_dir<span class="token punctuation">,</span> total_size<span class="token operator">=</span>total_size<span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span>                        response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">402</span><span class="token punctuation">:</span>                            <span class="token comment" spellcheck="true"># 进度条</span>                            progress_bar <span class="token operator">=</span> self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>total_size<span class="token punctuation">,</span> res_size<span class="token operator">=</span>recv_size<span class="token punctuation">,</span> last_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span>                            progress_bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>                            <span class="token comment" spellcheck="true"># 循环接收文件</span>                            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># ”ab"表示追加写入</span>                                <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>                                    data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>MSG_SIZE<span class="token punctuation">)</span>                                    recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                                    progress_bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>                                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                                <span class="token keyword">else</span><span class="token punctuation">:</span>                                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>                                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"file %s has re-downloaded !"</span> <span class="token operator">%</span> filename<span class="token punctuation">)</span>                            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 如果同命名的文件存在，就加上时间戳作为后缀</span>                                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> <span class="token string">"%s.%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                            <span class="token keyword">else</span><span class="token punctuation">:</span>                                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>                            <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 删除，因为文件已下载完成</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                            <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 删除，因为文件不存在</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"choice does exist !"</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"please supply number !"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">progress_bar</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> total_size<span class="token punctuation">,</span> res_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> last_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""进度条功能"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            res_size <span class="token operator">=</span> <span class="token keyword">yield</span> total_size            percent <span class="token operator">=</span> int<span class="token punctuation">(</span>res_size <span class="token operator">/</span> total_size <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> res_size <span class="token operator">></span> last_size<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"#"</span> <span class="token operator">*</span> int<span class="token punctuation">(</span>percent <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"{percent}%"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>percent<span class="token operator">=</span>percent<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">"\r"</span><span class="token punctuation">,</span> flush<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> # <span class="token string">"\\r"</span> 表示打印时覆盖已打印的内容                last_size <span class="token operator">=</span> res_size    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""从服务端下载文件"""</span>        <span class="token comment" spellcheck="true"># 当前功能只实现一次一个文件下载，所以至少要传入一个参数，多余参数不予考虑</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_length_judgment<span class="token punctuation">(</span>command<span class="token punctuation">,</span> most_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            filename <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"get"</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">)</span>            response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">400</span><span class="token punctuation">:</span>                total_size <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"total_size"</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(self.current_dir)</span>                <span class="token comment" spellcheck="true"># 进度条</span>                progress_bar <span class="token operator">=</span> self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>total_size<span class="token punctuation">)</span>                progress_bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 记录未下载完成的文件，为断点续存做准备</span>                self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">,</span> total_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 记录文件在服务端的路径以及文件的总大小</span>                <span class="token comment" spellcheck="true"># 循环接收文件</span>                res_size <span class="token operator">=</span> <span class="token number">0</span>                <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                    <span class="token keyword">while</span> res_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>                        data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>MSG_SIZE<span class="token punctuation">)</span>                        res_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                        progress_bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>res_size<span class="token punctuation">)</span>                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"file %s has downloaded !"</span> <span class="token operator">%</span> filename<span class="token punctuation">)</span>                <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果同命名的文件存在，就加上时间戳作为后缀</span>                    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> <span class="token string">"%s.%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>filename<span class="token punctuation">,</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s.download"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> filename<span class="token punctuation">)</span>                <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_download<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 下载完成后删除</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><h3 id="终端命令结果"><a href="#终端命令结果" class="headerlink" title="终端命令结果"></a>终端命令结果</h3><p><img src="https://img-blog.csdnimg.cn/df9195e843644a4fae07ee4c01869a85.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h3 id="运行后项目目录"><a href="#运行后项目目录" class="headerlink" title="运行后项目目录"></a>运行后项目目录</h3><p><img src="https://img-blog.csdnimg.cn/98668455eefc4871b59b5ef6e95474db.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_13,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（11）/ FTP项目（5） ——文件上传和上传断点续存功能</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-11-ftp-xiang-mu-5-wen-jian-shang-chuan-he-shang-chuan-duan-dian-xu-cun-gong-neng/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-11-ftp-xiang-mu-5-wen-jian-shang-chuan-he-shang-chuan-duan-dian-xu-cun-gong-neng/</url>
      
        <content type="html"><![CDATA[<h2 id="服务端-lib-文件夹下的-main-py-状态码的变化"><a href="#服务端-lib-文件夹下的-main-py-状态码的变化" class="headerlink" title="服务端 lib 文件夹下的 main.py 状态码的变化"></a><code>服务端 lib 文件夹下的 main.py 状态码的变化</code></h2><pre class=" language-python"><code class="language-python">STATUS_CODE <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token number">200</span><span class="token punctuation">:</span> <span class="token string">"User login succeeded !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 用户登陆成功</span>        <span class="token number">201</span><span class="token punctuation">:</span> <span class="token string">"Error: wrong username or wrong password !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 错误用户名或密码</span>        <span class="token number">202</span><span class="token punctuation">:</span> <span class="token string">"Action_type does not exist !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 没有该函数可以执行</span>        <span class="token number">300</span><span class="token punctuation">:</span> <span class="token string">"Check Dir !"</span><span class="token punctuation">,</span>        <span class="token number">301</span><span class="token punctuation">:</span> <span class="token string">"Dir does not exist !"</span><span class="token punctuation">,</span>        <span class="token number">400</span><span class="token punctuation">:</span> <span class="token string">"Ready to send file !"</span><span class="token punctuation">,</span>        <span class="token number">401</span><span class="token punctuation">:</span> <span class="token string">"File does not exist !"</span><span class="token punctuation">,</span>        <span class="token number">402</span><span class="token punctuation">:</span> <span class="token string">"Ready to re_send !"</span><span class="token punctuation">,</span>        <span class="token number">500</span><span class="token punctuation">:</span> <span class="token string">"File upload done !"</span><span class="token punctuation">,</span>        <span class="token number">501</span><span class="token punctuation">:</span> <span class="token string">"File upload failed !"</span><span class="token punctuation">,</span>        <span class="token number">502</span><span class="token punctuation">:</span> <span class="token string">"File exist !"</span>    <span class="token punctuation">}</span></code></pre><h2 id="文件上传功能"><a href="#文件上传功能" class="headerlink" title="文件上传功能"></a>文件上传功能</h2><h3 id="服务端-lib-文件夹下的-main-py"><a href="#服务端-lib-文件夹下的-main-py" class="headerlink" title="服务端 lib 文件夹下的 main.py"></a><code>服务端 lib 文件夹下的 main.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""从客户端接收文件"""</span>        filename <span class="token operator">=</span> header_dic<span class="token punctuation">[</span><span class="token string">"filename"</span><span class="token punctuation">]</span>        total_size <span class="token operator">=</span> header_dic<span class="token punctuation">[</span><span class="token string">"file_size"</span><span class="token punctuation">]</span>        res_szie <span class="token operator">=</span> <span class="token number">0</span>        <span class="token comment" spellcheck="true"># 循环接收文件</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\%s.upload"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">while</span> res_szie <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>                data <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>MSG_SIZE<span class="token punctuation">)</span>                res_szie <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件存在，文件名加上时间戳</span>            os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\%s.upload"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> filename <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span>str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\%s.upload"</span> <span class="token operator">%</span> filename<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_dir <span class="token operator">+</span> <span class="token string">"\\"</span> <span class="token operator">+</span> filename<span class="token punctuation">)</span>       self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span></code></pre><h3 id="客户端-client-文件夹下的-FTPClient-py"><a href="#客户端-client-文件夹下的-FTPClient-py" class="headerlink" title="客户端 client 文件夹下的 FTPClient.py"></a><code>客户端 client 文件夹下的 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""向服务端上传文件"""</span>        <span class="token comment" spellcheck="true"># 当前功能只实现一次一个文件上传，所以至少要传入两个参数，一个参数是文件名，一个参数应该是文件在客户端的路径，多余参数不予考虑</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_length_judgment<span class="token punctuation">(</span>command<span class="token operator">=</span>command<span class="token punctuation">,</span> min_size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            filename <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 文件名</span>            file_path <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 文件路径</span>            <span class="token comment" spellcheck="true"># 判断文件是否存在</span>            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果存在，上传文件</span>                file_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"put"</span><span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">,</span> file_size<span class="token operator">=</span>file_size<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 记录未上传完成的文件</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> file_size<span class="token punctuation">,</span> self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 记录文件在客户端路径，文件总大小, 上传文件在服务端的路径</span>                <span class="token comment" spellcheck="true"># 进度条</span>                progress_bar <span class="token operator">=</span> self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>file_size<span class="token punctuation">)</span>                progress_bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>                send_size <span class="token operator">=</span> <span class="token number">0</span>                <span class="token comment" spellcheck="true"># 发送文件</span>                <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                        send_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>line<span class="token punctuation">)</span>                        progress_bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>send_size<span class="token punctuation">)</span>                        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>                response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 上传成功</span>                <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    <span class="token comment" spellcheck="true"># 上传成功，删除在  中的数据</span>                    <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 文件不存在</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"File does not exist !"</span><span class="token punctuation">)</span></code></pre><h2 id="文件上传断点续存功能"><a href="#文件上传断点续存功能" class="headerlink" title="文件上传断点续存功能"></a>文件上传断点续存功能</h2><h3 id="服务端-lib-文件夹下的-main-py-1"><a href="#服务端-lib-文件夹下的-main-py-1" class="headerlink" title="服务端 lib 文件夹下的 main.py"></a><code>服务端 lib 文件夹下的 main.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_re_put</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""重新上传"""</span>        filename <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"filename"</span><span class="token punctuation">)</span>        total_size <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"total_size"</span><span class="token punctuation">)</span>        server_path <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"server_path"</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token string">"%s\\%s.upload"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果未完成上传的文件存在</span>            recv_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span><span class="token string">"%s\\%s.upload"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">502</span><span class="token punctuation">,</span> recv_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 发送已接收的大小</span>            <span class="token comment" spellcheck="true"># 循环接收未上传完成的文件</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"%s\\%s.upload"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"ab"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>                    data <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>MSG_SIZE<span class="token punctuation">)</span>                    recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span><span class="token string">"%s\\%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件存在，文件名加上时间戳</span>                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s\\%s.upload"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%s\\%s.%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">,</span> str<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                os<span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token string">"%s\\%s.upload"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%s\\%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>server_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 文件不存在</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">401</span><span class="token punctuation">)</span></code></pre><h3 id="客户端-client-文件夹下的-FTPClient-py-1"><a href="#客户端-client-文件夹下的-FTPClient-py-1" class="headerlink" title="客户端 client 文件夹下的 FTPClient.py"></a><code>客户端 client 文件夹下的 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">interactive</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 代码增加部分</span>        <span class="token triple-quoted-string string">"""交互指令"""</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登陆成功</span>            self<span class="token punctuation">.</span>unfinished_download_check<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>unfinished_upload_check<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>    <span class="token keyword">def</span> <span class="token function">unfinished_upload_check</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""上传断点续存"""</span>        <span class="token keyword">if</span> list<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果有未上传完成的文件</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"-------Unfinished upload list------"</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> index<span class="token punctuation">,</span> filename <span class="token keyword">in</span> enumerate<span class="token punctuation">(</span>list<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"%s    %s    %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> filename<span class="token punctuation">,</span>                                          self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                choice <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"[select file index to re-put]>>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> choice<span class="token punctuation">:</span> <span class="token keyword">continue</span> <span class="token comment" spellcheck="true"># 如果为空</span>                <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">"back"</span><span class="token punctuation">:</span> <span class="token keyword">break</span> <span class="token comment" spellcheck="true"># 退出</span>                <span class="token keyword">if</span> choice<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 判断是否是数字</span>                    choice <span class="token operator">=</span> int<span class="token punctuation">(</span>choice<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 转化为整型</span>                    <span class="token keyword">if</span> choice <span class="token operator">&lt;=</span> index<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 选择在范围内</span>                        filename <span class="token operator">=</span> list<span class="token punctuation">(</span>self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span>choice<span class="token punctuation">]</span>                        file_path <span class="token operator">=</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        total_size <span class="token operator">=</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>                        server_path <span class="token operator">=</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>                        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span> <span class="token operator">and</span> total_size <span class="token operator">==</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果文件存在且文件大小相同</span>                            <span class="token comment" spellcheck="true"># 发送信息</span>                            self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"re_put"</span><span class="token punctuation">,</span> total_size<span class="token operator">=</span>total_size<span class="token punctuation">,</span> server_path<span class="token operator">=</span>server_path<span class="token punctuation">,</span> filename<span class="token operator">=</span>filename<span class="token punctuation">)</span>                            <span class="token comment" spellcheck="true"># 接收消息，包括已接收的文件大小</span>                            response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>                            <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">401</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 文件不存在</span>                                <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span>                            <span class="token keyword">else</span><span class="token punctuation">:</span>                                recv_size <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"recv_size"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 准备继续上传</span>                                <span class="token comment" spellcheck="true"># 进度条</span>                                progress_bar <span class="token operator">=</span> self<span class="token punctuation">.</span>progress_bar<span class="token punctuation">(</span>total_size<span class="token operator">=</span>total_size<span class="token punctuation">,</span> res_size<span class="token operator">=</span>recv_size<span class="token punctuation">,</span> last_size<span class="token operator">=</span>recv_size<span class="token punctuation">)</span>                                progress_bar<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>                                <span class="token comment" spellcheck="true"># 继续上传</span>                                <span class="token keyword">with</span> open<span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                                    f<span class="token punctuation">.</span>seek<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>                                    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                                        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>                                        recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>line<span class="token punctuation">)</span>                                        progress_bar<span class="token punctuation">.</span>send<span class="token punctuation">(</span>recv_size<span class="token punctuation">)</span>                                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"File re_upload done !"</span><span class="token punctuation">)</span>                                <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span>                        <span class="token keyword">else</span><span class="token punctuation">:</span>                            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"File does not exist !"</span><span class="token punctuation">)</span>                            <span class="token keyword">del</span> self<span class="token punctuation">.</span>shelve_obj_upload<span class="token punctuation">[</span>filename<span class="token punctuation">]</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/59c58d7c0d594ed397dc1e24b660a44f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br><img src="https://img-blog.csdnimg.cn/e6df0e0a5abf41a8bd1a5e0dc1ca455a.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（9）/ FTP项目（3） ——目录切换、目录查看功能</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-9-ftp-xiang-mu-3-mu-lu-qie-huan-mu-lu-cha-kan-gong-neng/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-9-ftp-xiang-mu-3-mu-lu-qie-huan-mu-lu-cha-kan-gong-neng/</url>
      
        <content type="html"><![CDATA[<h2 id="调用功能函数以及对参数数量进行判断"><a href="#调用功能函数以及对参数数量进行判断" class="headerlink" title="调用功能函数以及对参数数量进行判断"></a>调用功能函数以及对参数数量进行判断</h2><h3 id="客户端-server-文件夹下-FTPClient-py"><a href="#客户端-server-文件夹下-FTPClient-py" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">interactive</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""交互指令，调用功能函数"""</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登陆成功</span>            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                command <span class="token operator">=</span> input<span class="token punctuation">(</span>self<span class="token punctuation">.</span>show_to_client<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> command<span class="token punctuation">:</span><span class="token keyword">continue</span>                command <span class="token operator">=</span> command<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span>                action_type <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 用户输入的命令类似于终端命令</span>                <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> action_type<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果 客户端的类中有 action_type 的函数方法</span>                    func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> action_type<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 执行</span>                    func<span class="token punctuation">(</span>command<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 执行的函数传入的参数应为 action_type 之后的部分</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error: this command does not exist !"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parameter_length_judgment</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">,</span>min_size<span class="token operator">=</span>None<span class="token punctuation">,</span> most_size<span class="token operator">=</span>None<span class="token punctuation">,</span> exact_size<span class="token operator">=</span>None<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""判断命令中参数个数是否符合规范，比如说 下载功能 至少要提供文件名的参数"""</span>        <span class="token keyword">if</span> min_size<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 至少提供的参数个数</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token operator">&lt;</span> min_size<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error: supply parameter at least %s, but supply %s parameter"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>min_size<span class="token punctuation">,</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">if</span> most_size<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 可以提供的最多参数数量</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token operator">></span> most_size<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error: supply parameter at most %s, but supply %s parameter"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>most_size<span class="token punctuation">,</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">if</span> exact_size<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 应该提供的精确的参数数量</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span> <span class="token operator">!=</span> exact_size<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Error: should supply %s parameter, but supply %s parameter"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>exact_size<span class="token punctuation">,</span> len<span class="token punctuation">(</span>command<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span></code></pre><h2 id="状态码的变化"><a href="#状态码的变化" class="headerlink" title="状态码的变化"></a>状态码的变化</h2><h3 id="服务端-lib-文件夹下-main-py"><a href="#服务端-lib-文件夹下-main-py" class="headerlink" title="服务端 lib 文件夹下 main.py"></a>服务端 <code>lib 文件夹下 main.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 状态码</span>    STATUS_CODE <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token number">200</span><span class="token punctuation">:</span> <span class="token string">"User login succeeded !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 用户登陆成功</span>        <span class="token number">201</span><span class="token punctuation">:</span> <span class="token string">"Error: wrong username or wrong password !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 错误用户名或密码</span>        <span class="token number">202</span><span class="token punctuation">:</span> <span class="token string">"Action_type does not exist !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 没有该函数可以执行</span>        <span class="token number">300</span><span class="token punctuation">:</span> <span class="token string">"Check Dir !"</span><span class="token punctuation">,</span>        <span class="token number">301</span><span class="token punctuation">:</span> <span class="token string">"Dir does not exist !"</span>    <span class="token punctuation">}</span></code></pre><h2 id="查看服务端当前目录"><a href="#查看服务端当前目录" class="headerlink" title="查看服务端当前目录"></a>查看服务端当前目录</h2><h3 id="客户端-server-文件夹下-FTPClient-py-1"><a href="#客户端-server-文件夹下-FTPClient-py-1" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">ls</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看服务端当前目录"""</span>        <span class="token comment" spellcheck="true"># 因为该函数是查看服务端当前目录，所以不用管会传入多少参数，即最少传入 0 给参数</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_length_judgment<span class="token punctuation">(</span>command<span class="token operator">=</span>command<span class="token punctuation">,</span> min_size<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># if True</span>            self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"ls"</span><span class="token punctuation">)</span>            response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(response)</span>            <span class="token comment" spellcheck="true"># 消息的总大小</span>            total_size <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"size"</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 为断点续存做准备</span>            self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span>            recv_size <span class="token operator">=</span> <span class="token number">0</span>            res <span class="token operator">=</span> b<span class="token string">""</span>            <span class="token comment" spellcheck="true"># 循环接收信息</span>            <span class="token keyword">while</span> recv_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>                data <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>MSG_SIZE<span class="token punctuation">)</span>                res <span class="token operator">+=</span> data                recv_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="服务端-lib-文件夹下-main-py-1"><a href="#服务端-lib-文件夹下-main-py-1" class="headerlink" title="服务端 lib 文件夹下 main.py"></a>服务端 <code>lib 文件夹下 main.py</code></h3><p>用户登录成功时，增加的代码</p><pre class=" language-python"><code class="language-python">            <span class="token keyword">if</span> str<span class="token punctuation">(</span>md5_password<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>ini_password<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果密码正确</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_home<span class="token punctuation">,</span> username<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 增加的代码部分</span>                <span class="token comment" spellcheck="true"># print(self.current_dir)</span></code></pre><p>实现功能的代码</p><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_ls</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看当前目录"""</span>        <span class="token comment" spellcheck="true"># 执行终端命令，并获取结果</span>        obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"dir %s"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>current_dir<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                               stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                               stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>        stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span> size<span class="token operator">=</span>len<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">,</span> current_dir<span class="token operator">=</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 当前目录为断点续存做准备</span>        <span class="token comment" spellcheck="true"># 发送执行结果</span>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span></code></pre><h2 id="查看客户端目录"><a href="#查看客户端目录" class="headerlink" title="查看客户端目录"></a>查看客户端目录</h2><h3 id="客户端-server-文件夹下-FTPClient-py-2"><a href="#客户端-server-文件夹下-FTPClient-py-2" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python"> <span class="token keyword">def</span> <span class="token function">dir</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""查看客户端下的目录"""</span>        <span class="token comment" spellcheck="true"># 由于是查看客户端目录，所以可以不输入路径或是输入路径，即传入的参数最多为 1，1 是目录路径</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_length_judgment<span class="token punctuation">(</span>command<span class="token punctuation">,</span> most_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> command<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果 command 不为空</span>                path <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                path <span class="token operator">=</span> <span class="token string">""</span>            <span class="token comment" spellcheck="true"># 执行终端命令</span>            obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"dir %s"</span> <span class="token operator">%</span> path<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                   stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                   stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>            stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="切换目录"><a href="#切换目录" class="headerlink" title="切换目录"></a>切换目录</h2><h3 id="客户端-server-文件夹下-FTPClient-py-3"><a href="#客户端-server-文件夹下-FTPClient-py-3" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> command<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""切换服务端目录"""</span>        <span class="token comment" spellcheck="true"># 切换服务端目录，所以必须输入路径，即传入的参数最少为 1，1 是目录路径，多于 1 的部分不需要考虑</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>parameter_length_judgment<span class="token punctuation">(</span>command<span class="token punctuation">,</span> most_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> command<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"cd"</span><span class="token punctuation">,</span> cmd<span class="token operator">=</span>cmd<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取 response</span>            response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">300</span><span class="token punctuation">:</span>                show_to_client <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"show_to_client"</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>show_to_client <span class="token operator">=</span> <span class="token string">"[%s]"</span> <span class="token operator">%</span> show_to_client                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="服务端-lib-文件夹下-main-py-2"><a href="#服务端-lib-文件夹下-main-py-2" class="headerlink" title="服务端 lib 文件夹下 main.py"></a>服务端 <code>lib 文件夹下 main.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">_cd</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""切换目录，但最高一级只到 \\home\\username"""</span>        cmd <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"cmd"</span><span class="token punctuation">)</span>        full_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 拼接路径,返回绝对路径，避免出现 \\home\\username\\..\\.. 的情况出现</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>full_path<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果路径存在</span>            <span class="token keyword">if</span> full_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_home<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">and</span> self<span class="token punctuation">.</span>user_home <span class="token keyword">in</span> full_path<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 保证路径不会到达 home 一级</span>                obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span><span class="token string">"cd %s"</span> <span class="token operator">%</span> full_path<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                       stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                       stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> full_path                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>                                   show_to_client <span class="token operator">=</span> full_path<span class="token punctuation">.</span>replace<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_home<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                                   current_dir<span class="token operator">=</span>self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 当前目录为断点续存做准备</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">301</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 对用户来说路径不存在</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">301</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 对用户来说路径不存在</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/9c13f12ac83641b4b77c07e3ed22ed29.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（8）/ FTP项目（2） —— 项目辅助功能以及用户认证功能</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-8-ftp-xiang-mu-2-xiang-mu-fu-zhu-gong-neng-yi-ji-yong-hu-ren-zheng-gong-neng/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-8-ftp-xiang-mu-2-xiang-mu-fu-zhu-gong-neng-yi-ji-yong-hu-ren-zheng-gong-neng/</url>
      
        <content type="html"><![CDATA[<h2 id="辅助功能：报头发送以及回复"><a href="#辅助功能：报头发送以及回复" class="headerlink" title="辅助功能：报头发送以及回复"></a>辅助功能：报头发送以及回复</h2><h3 id="服务端-lib-文件夹下-main-py"><a href="#服务端-lib-文件夹下-main-py" class="headerlink" title="服务端 lib 文件夹下 main.py"></a>服务端 <code>lib 文件夹下 main.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">get_header</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""获取报头内容"""</span>        <span class="token comment" spellcheck="true"># 解码获取报头长度</span>        header_bytes_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>HEADER_STRUCT_SIZE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 接收报头字符串</span>        header_bytes <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>header_bytes_size<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 字符串转换为字典</span>        header_dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>header_bytes<span class="token punctuation">)</span>        <span class="token keyword">return</span> header_dic    <span class="token keyword">def</span> <span class="token function">send_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> status_code<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        服务端返回执行结果            如：要下载的文件大小，状态码等内容，也可以理解为 服务端向客户端发送的报头        """</span>        <span class="token comment" spellcheck="true"># 客户端通过 status_code 判断命令执行结果，如没有找到文件，如果执行和用户预期不同，如没有找到文件，客户端打印 status_msg 信息提示用户</span>        response <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"status_code"</span><span class="token punctuation">:</span> status_code<span class="token punctuation">,</span>            <span class="token string">"status_msg"</span><span class="token punctuation">:</span> <span class="token string">""</span>        <span class="token punctuation">}</span>        response<span class="token punctuation">[</span><span class="token string">"status_msg"</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>STATUS_CODE<span class="token punctuation">.</span>get<span class="token punctuation">(</span>status_code<span class="token punctuation">)</span>        response<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 字典转换成字符串</span>        response_bytes <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 编码字符串长度并发送</span>        response_bytes_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>response_bytes<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>response_bytes_size<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 发送字符串</span>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>response_bytes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="客户端-server-文件夹下-FTPClient-py"><a href="#客户端-server-文件夹下-FTPClient-py" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">create_header_send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action_type<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""制作报头并发送给服务端，防止粘包"""</span>        <span class="token comment" spellcheck="true"># 报头字典</span>        <span class="token comment" spellcheck="true"># action_typs 表示发送给服务端后需要执行的函数名字</span>        header_dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"action_type"</span><span class="token punctuation">:</span> action_type        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># 如果调用此函数时，输入的参数有 filename_size = "100", 那么执行 update 方法后，此时 header_dic["file_size"] = "100"</span>        header_dic<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token operator">**</span>kwargs<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 报头字典转化为 报头字典字符串</span>        header_bytes <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>header_dic<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 对字符串长度进行编码</span>        header_bytes_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>header_bytes<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 发送编码</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header_bytes_size<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 发送字典字符串</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header_bytes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_response</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""获取服务端发送的 response"""</span>        <span class="token comment" spellcheck="true"># 解码 response 字符串长度</span>        response_bytes_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>self<span class="token punctuation">.</span>HEADER_STRUCT_SIZE<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 获取 response 字符串</span>        response_bytes <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>response_bytes_size<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 字符串转换为字典</span>        response <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>response_bytes<span class="token punctuation">)</span>        <span class="token keyword">return</span> response</code></pre><h2 id="用户认证功能"><a href="#用户认证功能" class="headerlink" title="用户认证功能"></a>用户认证功能</h2><h3 id="conf-文件夹下-setting-py-增加部分"><a href="#conf-文件夹下-setting-py-增加部分" class="headerlink" title="conf 文件夹下 setting.py 增加部分"></a><code>conf 文件夹下 setting.py 增加部分</code></h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 用户信息文件所在的路径</span>ACCOUNT_DIR <span class="token operator">=</span> <span class="token string">"%s/conf/accounts.ini"</span> <span class="token operator">%</span> BASE_DIR</code></pre><h3 id="conf-文件夹下-accounts-ini"><a href="#conf-文件夹下-accounts-ini" class="headerlink" title="conf 文件夹下 accounts.ini"></a><code>conf 文件夹下 accounts.ini</code></h3><pre class=" language-python"><code class="language-python"><span class="token punctuation">[</span>aoteman<span class="token punctuation">]</span>username <span class="token operator">=</span> aotemanpassword <span class="token operator">=</span> b<span class="token string">'\xe9\x9a\x18\xc4(\xcb8\xd5\xf2`\x856x\x92.\x03'</span></code></pre><h3 id="服务端-lib-文件夹下-main-py-1"><a href="#服务端-lib-文件夹下-main-py-1" class="headerlink" title="服务端 lib 文件夹下 main.py"></a>服务端 <code>lib 文件夹下 main.py</code></h3><p>status_code 增加部分</p><pre class=" language-python"><code class="language-python">    MSG_SIZE <span class="token operator">=</span> <span class="token number">8192</span>  <span class="token comment" spellcheck="true"># 一次性接收的信息长度</span>    HEADER_STRUCT_SIZE <span class="token operator">=</span> <span class="token number">8</span>  <span class="token comment" spellcheck="true"># 报头字符串编码后的长度默认为 8</span>    <span class="token comment" spellcheck="true"># 状态码</span>    STATUS_CODE <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token number">200</span><span class="token punctuation">:</span> <span class="token string">"User login succeeded !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 用户登陆成功</span>        <span class="token number">201</span><span class="token punctuation">:</span> <span class="token string">"Error: wrong username or wrong password !"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 错误用户名或密码</span>        <span class="token number">202</span><span class="token punctuation">:</span> <span class="token string">"Action_type does not exist !"</span> <span class="token comment" spellcheck="true"># 没有该函数可以执行</span>    <span class="token punctuation">}</span></code></pre><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""处理与客户端的交互指令"""</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            header_dic <span class="token operator">=</span> self<span class="token punctuation">.</span>get_header<span class="token punctuation">(</span><span class="token punctuation">)</span>            action_type <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"action_type"</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action_type<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果类中有该函数，执行</span>                func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"_%s"</span> <span class="token operator">%</span> action_type<span class="token punctuation">)</span>                func<span class="token punctuation">(</span>header_dic<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 不存在该函数</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">202</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">log_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""获取 accounts.ini 文件中的用户信息"""</span>        config_obj <span class="token operator">=</span> configparser<span class="token punctuation">.</span>ConfigParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        config_obj<span class="token punctuation">.</span>read<span class="token punctuation">(</span>setting<span class="token punctuation">.</span>ACCOUNT_DIR<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># config_obj 结果类似于字典</span>        <span class="token comment" spellcheck="true"># key 值为 ini 文件中 【】 部分</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>config_obj<span class="token punctuation">.</span>sections<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> config_obj    <span class="token keyword">def</span> <span class="token function">authentication_judgment</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""判断是否存在该用户以及密码是否正确"""</span>        log_msg <span class="token operator">=</span> self<span class="token punctuation">.</span>log_msg<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获得用户信息</span>        <span class="token keyword">if</span> username <span class="token keyword">in</span> log_msg<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果存在该用户</span>            ini_password<span class="token operator">=</span> log_msg<span class="token punctuation">[</span>username<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"password"</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># ini 文件下的用户经过 md5 加密的密码</span>            <span class="token comment" spellcheck="true"># 对用户输入的密码进行 md5 加密并和 ini_password 匹配，判断密码是否正确</span>            <span class="token comment" spellcheck="true"># md5 加密</span>            md5_obj <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>            md5_obj<span class="token punctuation">.</span>update<span class="token punctuation">(</span>password<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            md5_password <span class="token operator">=</span> md5_obj<span class="token punctuation">.</span>digest<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 注意：由于 项目本身并没有创建用户的功能，所以 用户密码 我们可以先对真实密码加密后再写入 ini 文件中</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>md5_password<span class="token punctuation">)</span>            <span class="token keyword">if</span> str<span class="token punctuation">(</span>md5_password<span class="token punctuation">)</span> <span class="token operator">==</span> str<span class="token punctuation">(</span>ini_password<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 如果密码正确</span>                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_home<span class="token punctuation">,</span> username<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> current_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>current_dir<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>send_response<span class="token punctuation">(</span>status_code<span class="token operator">=</span><span class="token number">201</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">_auth</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> header_dic<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""用户认证"""</span>        username <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> header_dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>authentication_judgment<span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span></code></pre><h3 id="客户端-server-文件夹下-FTPClient-py-1"><a href="#客户端-server-文件夹下-FTPClient-py-1" class="headerlink" title="客户端 server 文件夹下 FTPClient.py"></a>客户端 <code>server 文件夹下 FTPClient.py</code></h3><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">auth</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""用户输入用户名，密码发送到服务端，判断是否正确"""</span>        <span class="token comment" spellcheck="true"># 三次尝试机会</span>        count <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">while</span> count <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 输入用户名，密码</span>            username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"username: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"password: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送用户名和密码</span>            self<span class="token punctuation">.</span>create_header_send<span class="token punctuation">(</span>action_type<span class="token operator">=</span><span class="token string">"auth"</span><span class="token punctuation">,</span> username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取服务端的回复</span>            response <span class="token operator">=</span> self<span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 如果登录成功，退出循环</span>            <span class="token keyword">if</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_code"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>show_to_client <span class="token operator">=</span> <span class="token string">"[\\%s]>>: "</span> <span class="token operator">%</span> username                self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"current_dir"</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> <span class="token boolean">True</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"status_msg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            count <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">def</span> <span class="token function">interactive</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""send 交互指令"""</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>auth<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 登陆成功</span>            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                command <span class="token operator">=</span> input<span class="token punctuation">(</span>self<span class="token punctuation">.</span>show_to_client<span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> <span class="token operator">not</span> command<span class="token punctuation">:</span><span class="token keyword">continue</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    client <span class="token operator">=</span> Client<span class="token punctuation">(</span><span class="token punctuation">)</span>    client<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p><img src="https://img-blog.csdnimg.cn/e2a69e726c314451a31e7c77b98911d4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><p><img src="https://img-blog.csdnimg.cn/a45d0f0e19c94634ad05717e48665929.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（7）/ FTP项目（1） —— 项目需求梳理以及基本框架搭建</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-7-ftp-xiang-mu-1-xiang-mu-xu-qiu-shu-li-yi-ji-ji-ben-kuang-jia-da-jian/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-7-ftp-xiang-mu-1-xiang-mu-xu-qiu-shu-li-yi-ji-ji-ben-kuang-jia-da-jian/</url>
      
        <content type="html"><![CDATA[<h2 id="项目需求梳理"><a href="#项目需求梳理" class="headerlink" title="项目需求梳理"></a>项目需求梳理</h2><pre class=" language-python"><code class="language-python">    <span class="token number">1</span><span class="token punctuation">.</span> 用户登录认证（目前只实现一次连接一个客户端，即单线程）        <span class="token number">1.1</span> 用户密码 md5 加密    <span class="token number">2</span><span class="token punctuation">.</span> 查看目录        <span class="token number">2.1</span> ls 命令 表示查看用户在服务端的目录，默认是家目录        <span class="token number">2.2</span> dir 命令 表示用户查看在客户端的目录    <span class="token number">3</span><span class="token punctuation">.</span> 切换目录        <span class="token number">3.1</span> 用户使用 cd 命令切换服务端目录            <span class="token number">3.1</span><span class="token punctuation">.</span><span class="token number">1</span> 实际上在服务端并没有真正切换目录            <span class="token number">3.1</span><span class="token punctuation">.</span><span class="token number">2</span> 而且服务端代码编写时要注意，对用户来说，家目录就是最高一级，即对用户而言，home<span class="token operator">/</span>username                  是可以达到的路径，但 server<span class="token operator">/</span>home 目录对用户来说是不存在路径            <span class="token number">3.1</span><span class="token punctuation">.</span><span class="token number">3</span> 在切换路径后，客户端要记录用户此时切换到的路径，为接下来的 断点续存 功能做准备，不然会出现客                  户端重新连接继续下载时找不到要下载文件在服务端路径的情况    <span class="token number">4</span><span class="token punctuation">.</span> 下载<span class="token operator">/</span>上传<span class="token operator">/</span>断点续存 进度条 创建    <span class="token number">5</span><span class="token punctuation">.</span> 下载功能        <span class="token number">5.1</span> 下载完成前，文件命名为 “filename<span class="token punctuation">.</span>download”            <span class="token number">5.1</span><span class="token punctuation">.</span><span class="token number">1</span> 在创建 “filename<span class="token punctuation">.</span>download” 文件前判断该文件是否存在，如果存在，就在 download 后面再                  加时间戳后缀            <span class="token number">5.1</span><span class="token punctuation">.</span><span class="token number">2</span> 若 FTP 在文件下载完成前崩溃导致文件未下载完成，创建 shelvel 对象，记录 文件名，未下载完                  成文件在服务端的路径，已下载的大小，为 断点续存 功能编写做准备            <span class="token number">5.1</span><span class="token punctuation">.</span><span class="token number">3</span> 文件下载完成后，将后缀部分去除，如果去除后缀后文件已存在，就增加时间戳后缀，即“filename<span class="token punctuation">.</span>时                  间戳”    <span class="token number">6</span><span class="token punctuation">.</span> 上传功能（基本和下载功能一致）        <span class="token number">6.1</span> 下载完成前，文件命名为 “filename<span class="token punctuation">.</span>upload”            <span class="token number">6.1</span><span class="token punctuation">.</span><span class="token number">1</span> 在创建 “filename<span class="token punctuation">.</span>upload” 文件前判断该文件是否存在，如果存在，就在 upload 后面再                  加时间戳后缀            <span class="token number">6.1</span><span class="token punctuation">.</span><span class="token number">2</span> 若 FTP 在文件上传完成前崩溃导致文件未上传完成，创建 shelvel 对象，记录 文件名，未上传完                  成文件在服务端的路径，已下载的大小，为 断点续存 功能编写做准备            <span class="token number">6.1</span><span class="token punctuation">.</span><span class="token number">3</span> 文件下载完成后，将后缀部分去除，如果去除后缀后文件已存在，就增加时间戳后缀，即“filename<span class="token punctuation">.</span>时                  间戳”     <span class="token number">7</span><span class="token punctuation">.</span> 下载<span class="token operator">/</span>上传 断点续存功能        <span class="token number">7.1</span> 在用户登陆成功后，打印未下载完成、未上传完成的文件名，供用户选择是否要继续上传或下载        <span class="token number">7.2</span> 在用户选择继续下载或上传后，仍出现进度条并且从上次断的百分比开始增加        <span class="token number">7.3</span> 文件命名仍和下载<span class="token operator">/</span>上传功能中文件命名一致</code></pre><h2 id="项目基本框架搭建"><a href="#项目基本框架搭建" class="headerlink" title="项目基本框架搭建"></a>项目基本框架搭建</h2><h3 id="项目文件说明"><a href="#项目文件说明" class="headerlink" title="项目文件说明"></a>项目文件说明</h3><pre class=" language-python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span> FTP （项目名称）    <span class="token operator">-</span><span class="token operator">-</span> client 客户端    <span class="token operator">-</span><span class="token operator">-</span> server 服务端        <span class="token operator">-</span><span class="token operator">-</span> bin <span class="token punctuation">(</span>存放可执行的二进制文件<span class="token punctuation">)</span>        <span class="token operator">-</span><span class="token operator">-</span> conf <span class="token punctuation">(</span>存放配置文件<span class="token punctuation">)</span>            <span class="token operator">-</span><span class="token operator">-</span> accounts<span class="token punctuation">.</span>ini <span class="token punctuation">(</span>包括用户名称和密码，在此文件中的密码使用 md5 加密，非明文显示<span class="token punctuation">)</span>            <span class="token operator">-</span><span class="token operator">-</span> setting<span class="token punctuation">.</span>py <span class="token punctuation">(</span>包括服务端接口、用户家目录等内容<span class="token punctuation">)</span>        <span class="token operator">-</span><span class="token operator">-</span> home<span class="token punctuation">(</span>存放用户家目录，比如 home\aoteman 是 用户 aoteman 的家目录<span class="token punctuation">)</span>        <span class="token operator">-</span><span class="token operator">-</span> lib （存放的是函数调用的信息，在windows操作系统中起到链接程序和函数的作用。其意义在于代码重用，程                序员将常用的功能写成函数，保存为lib文件，在以后编程要实现这些功能的时候，就不需要再重新编写代                码，而是直接调用写好的lib文件，这很大程度上减轻程序员的负担。）        <span class="token operator">-</span><span class="token operator">-</span> log <span class="token punctuation">(</span>项目日志<span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/b9e20b1c593c492e813cb301580fbd54.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_13,color_FFFFFF,t_70,g_se,x_16"></p><h3 id="bin-文件夹下-FTPServer-py-文件"><a href="#bin-文件夹下-FTPServer-py-文件" class="headerlink" title="bin 文件夹下 FTPServer.py 文件"></a>bin 文件夹下 FTPServer.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> os<span class="token punctuation">,</span>sys<span class="token comment" spellcheck="true"># 因为要调用 server 文件夹下的其他 python 文件，所以程序。路径应为 \..\..\server</span><span class="token comment" spellcheck="true"># 先返回 FTPServer.py 文件的绝对路径，在往上两级得到 server 文件夹的绝对路径</span>BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># print(BASE_DIR)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 从 lib 文件夹下 导入 management.py 文件</span>    <span class="token keyword">from</span> lib <span class="token keyword">import</span> management    <span class="token comment" spellcheck="true"># sys.argv 可以简单的理解为 将 终端命令 作为参数传入， sys.argv 的结果是列表</span>    <span class="token comment" spellcheck="true"># 比如说在终端输入 python server\bin\FTPServer.py start 运行，那么此时的 sys.argv 就是 ['server\\bin\\FTPServer.py', 'start']</span>    FTP <span class="token operator">=</span> management<span class="token punctuation">.</span>FTPManagement<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>    FTP<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="lib-文件夹下-management-py"><a href="#lib-文件夹下-management-py" class="headerlink" title="lib 文件夹下 management.py"></a>lib 文件夹下 management.py</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">from</span> lib <span class="token keyword">import</span> main<span class="token keyword">class</span> <span class="token class-name">FTPManagement</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> sys_argv<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>sys_argv <span class="token operator">=</span> sys_argv <span class="token comment" spellcheck="true"># 终端命令运行时传入的参数</span>        <span class="token comment" spellcheck="true"># print(self.sys_argv)</span>    <span class="token keyword">def</span> <span class="token function">help_msg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        帮助信息，为用户打印提示信息        """</span>        help_msg <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        start   start up server        """</span>        <span class="token comment" spellcheck="true"># 退出并打印</span>        exit<span class="token punctuation">(</span>help_msg<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parameter_verification</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        验证参数合法性            1. 项目启动时的命令设置为 python 文件路径 命令（如 start）                1.1 所以如果参数长度小于 2，应该向用户提示服务端可以接受的，命令                1.2 只需要判断长度是否小于2，如果大于2，程序只把 sys.argv 列表中的第二位参数视为命令        """</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sys_argv<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>help_msg<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">execute</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""解析指令"""</span>        self<span class="token punctuation">.</span>parameter_verification<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 如果未通过参数验证，退出并打印 帮助信息，不会再运行下面的代码</span>        parameter <span class="token operator">=</span> self<span class="token punctuation">.</span>sys_argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 取出代表命令的参数</span>        <span class="token comment" spellcheck="true"># print(parameter)</span>        <span class="token comment" spellcheck="true"># 判断 FTPManagement类 中是否有与命令参数相同的函数</span>        <span class="token comment" spellcheck="true"># 即如果命令是 start, 那么需要判断 FTPManagement类 中是否有 self.start 函数</span>            <span class="token comment" spellcheck="true"># 如果有此函数，调用函数</span>            <span class="token comment" spellcheck="true"># 如果没有此函数，打印 提示信息</span>        <span class="token keyword">if</span> hasattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># FTPManagement类 中有 self.start 函数</span>            func <span class="token operator">=</span> getattr<span class="token punctuation">(</span>self<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># func 赋值为 self.start 函数</span>            func<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 运行 self.start 函数</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" command does not exist !"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">" start   start up server !"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># print("------------")</span>        Server <span class="token operator">=</span> main<span class="token punctuation">.</span>Server<span class="token punctuation">(</span>self<span class="token punctuation">)</span>        Server<span class="token punctuation">.</span>run_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="lib-文件夹下-main-py"><a href="#lib-文件夹下-main-py" class="headerlink" title="lib 文件夹下 main.py"></a>lib 文件夹下 main.py</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">from</span> conf <span class="token keyword">import</span> setting<span class="token keyword">class</span> <span class="token class-name">Server</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    MSG_SIZE <span class="token operator">=</span> <span class="token number">8192</span>  <span class="token comment" spellcheck="true"># 一次性接收的信息长度</span>    <span class="token comment" spellcheck="true"># 状态码</span>    STATUS_CODE <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> management<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>management <span class="token operator">=</span> management        self<span class="token punctuation">.</span>user_home <span class="token operator">=</span> setting<span class="token punctuation">.</span>USER_HOME_DIR <span class="token comment" spellcheck="true"># 记录用户家目录</span>        self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> self<span class="token punctuation">.</span>user_home <span class="token comment" spellcheck="true"># 记录用户当前目录，用户切换目录时使用</span>        self<span class="token punctuation">.</span>shelve_obj <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 记录下载/上传未完成的文件信息</span>        <span class="token comment" spellcheck="true"># 建立服务端</span>        self<span class="token punctuation">.</span>sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 买手机</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>setting<span class="token punctuation">.</span>HOST<span class="token punctuation">,</span> setting<span class="token punctuation">.</span>PORT<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 装上手机卡</span>        self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 开机，最大监听数为 5</span>    <span class="token keyword">def</span> <span class="token function">run_forever</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""正式启动服务端"""</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"FTP Server start %s %s "</span> <span class="token operator">%</span> <span class="token punctuation">(</span>setting<span class="token punctuation">.</span>HOST<span class="token punctuation">,</span> setting<span class="token punctuation">.</span>PORT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>center<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>conn<span class="token punctuation">,</span> self<span class="token punctuation">.</span>addr <span class="token operator">=</span> self<span class="token punctuation">.</span>sock<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 等待电话</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connection from %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>addr<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># self.addr 是元组，所以选择 (self.addr, )的形式</span>            <span class="token keyword">try</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 防止报错而服务端退出程序</span>                self<span class="token punctuation">.</span>handle<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 处理客户端和服务端和交互问题</span>            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span></code></pre><h3 id="conf-文件夹下-setting-py-文件"><a href="#conf-文件夹下-setting-py-文件" class="headerlink" title="conf 文件夹下 setting.py 文件"></a>conf 文件夹下 setting.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> os<span class="token punctuation">.</span>path<span class="token comment" spellcheck="true"># 服务器端口</span>HOST <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span>PORT <span class="token operator">=</span> <span class="token number">9999</span><span class="token comment" spellcheck="true"># 用户家目录</span><span class="token comment" spellcheck="true"># 先切换到 server 目录，在切换到 home 目录</span>BASE_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>USER_HOME_DIR <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">"home"</span><span class="token punctuation">)</span></code></pre><h3 id="client-文件夹下-FTPClient-py-文件"><a href="#client-文件夹下-FTPClient-py-文件" class="headerlink" title="client 文件夹下 FTPClient.py 文件"></a>client 文件夹下 FTPClient.py 文件</h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> optparse<span class="token keyword">import</span> shelve<span class="token keyword">import</span> socket<span class="token keyword">class</span> <span class="token class-name">Client</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    MSG_SIZE <span class="token operator">=</span> <span class="token number">8192</span> <span class="token comment" spellcheck="true"># 一次性接收的信息长度</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>show_to_client <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 输入命令时显示给用户的信息，如 【\username】>>:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 记录用户名称</span>        self<span class="token punctuation">.</span>current_dir <span class="token operator">=</span> None <span class="token comment" spellcheck="true"># 记录用户下载文件时，文件在客户端的路径</span>        self<span class="token punctuation">.</span>shelve_obj <span class="token operator">=</span> shelve<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"FTP_Download"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 记录未下载完成的文件信息</span>        self<span class="token punctuation">.</span>shelve_obj <span class="token operator">=</span> shelve<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">"FTP_Upload"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 记录未上传完成的文件信息</span>        <span class="token comment" spellcheck="true"># 终端命令参数</span>        <span class="token comment" spellcheck="true"># 输入 python client/FTPClient.py -h 得到提示信息</span>        <span class="token comment" spellcheck="true"># 比如输入 python client/FTPClient.py -H 123 -P 12456 返回的结果是 self.option = {'serverHost': '123', 'port': 12456}, self.args = []</span>        <span class="token comment" spellcheck="true"># 比如输入 python client/FTPClient.py 123   456   789， 返回的结果是 self.option = {'serverHost': None, 'port': None}， self.args = ['123', '456', '789']</span>        parser <span class="token operator">=</span> optparse<span class="token punctuation">.</span>OptionParser<span class="token punctuation">(</span><span class="token punctuation">)</span>        parser<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-H"</span><span class="token punctuation">,</span> <span class="token string">"--serverHost"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"serverHost"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"ftp server ip_addr"</span><span class="token punctuation">)</span>        parser<span class="token punctuation">.</span>add_option<span class="token punctuation">(</span><span class="token string">"-P"</span><span class="token punctuation">,</span> <span class="token string">"--port"</span><span class="token punctuation">,</span> type<span class="token operator">=</span><span class="token string">"int"</span><span class="token punctuation">,</span> dest<span class="token operator">=</span><span class="token string">"port"</span><span class="token punctuation">,</span> help<span class="token operator">=</span><span class="token string">"ftp server port"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>options<span class="token punctuation">,</span> self<span class="token punctuation">.</span>args <span class="token operator">=</span> parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取出参数</span>        <span class="token comment" spellcheck="true"># print(self.options, self.args)</span>        self<span class="token punctuation">.</span>parameter_test<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>make_connection<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parameter_test</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""参数检验，保证用户输入了 -H 和 -P 内容，不然客户端无法连接服务端端口"""</span>        <span class="token keyword">if</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>serverHost <span class="token operator">or</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>port<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 其中一项为空</span>            exit<span class="token punctuation">(</span><span class="token string">"Error: must supply serverHost and port !"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">make_connection</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""客户端连接"""</span>        self<span class="token punctuation">.</span>client <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 买手机</span>        self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>serverHost<span class="token punctuation">,</span> self<span class="token punctuation">.</span>options<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 打电话</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Connection successful ！"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    client <span class="token operator">=</span> Client<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="当前运行结果（终端运行）"><a href="#当前运行结果（终端运行）" class="headerlink" title="当前运行结果（终端运行）"></a>当前运行结果（终端运行）</h2><h3 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h3><p><img src="https://img-blog.csdnimg.cn/584ff9967be04a22bc9c8833923e47d3.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h3 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h3><p><img src="https://img-blog.csdnimg.cn/788a84dbc5f5410d9d7ede17c1fa3d47.png"></p>]]></content>
      
      
      <categories>
          
          <category> FTP </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
            <tag> FTP 项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（6）—— 基于SOCKET实现文件传输功能</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-6-ji-yu-socket-shi-xian-wen-jian-chuan-shu-gong-neng/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-6-ji-yu-socket-shi-xian-wen-jian-chuan-shu-gong-neng/</url>
      
        <content type="html"><![CDATA[<h2 id="文件传输功能和执行终端命令功能的区别"><a href="#文件传输功能和执行终端命令功能的区别" class="headerlink" title="文件传输功能和执行终端命令功能的区别"></a>文件传输功能和执行终端命令功能的区别</h2><p>文件传输功能实现和实现执行终端命令功能的区别</p><ol><li>不需要执行命令，即不需要使用 <code>subprocess</code> 模块</li><li>判断文件大小方式不是文件内容的长度，而是使用 <code>os</code>模块</li></ol><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> osos<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span>文件路径<span class="token punctuation">)</span></code></pre><ol start="3"><li>上传文件时，为防止一次上传完整文件导致内存不足，上传时，一行行上传</li></ol><pre class=" language-python"><code class="language-python"><span class="token keyword">with</span> open<span class="token punctuation">(</span>文件<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span></code></pre><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>服务端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> os<span class="token punctuation">.</span>path<span class="token keyword">import</span> socket<span class="token keyword">import</span> struct<span class="token keyword">import</span> jsondir_path <span class="token operator">=</span> <span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\网络编程\\09-文件传输功能\\server\\share\\"</span>server <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 链接循环</span>    conn<span class="token punctuation">,</span>addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8096</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token comment" spellcheck="true"># 获取要下载的文件名</span>            filename <span class="token operator">=</span> cmd<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取文件大小，即字节长度</span>            total_size <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>getsize<span class="token punctuation">(</span><span class="token string">"%s%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>dir_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 报头字典</span>            header_dic <span class="token operator">=</span> <span class="token punctuation">{</span>                <span class="token string">"filename"</span><span class="token punctuation">:</span> filename<span class="token punctuation">,</span>                <span class="token string">"total_size"</span><span class="token punctuation">:</span> total_size            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true"># 字典转换为字符串</span>            header_bytes <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>header_dic<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 字符串长度编码并发送</span>            header_bytes_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>header_bytes<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送报头编码</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header_bytes_length<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送字典字符串</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header_bytes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送文件</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"%s%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>dir_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>line<span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>            <span class="token keyword">break</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> json<span class="token keyword">import</span> structdir_path <span class="token operator">=</span> <span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\网络编程\\09-文件传输功能\\client\\download\\"</span>client <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true"># 通信循环</span>    cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>        <span class="token keyword">continue</span>    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    filename <span class="token operator">=</span> cmd<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 接收报头并解码</span>    header_bytes_length <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 接收字典字符串</span>    header_bytes_size <span class="token operator">=</span> <span class="token number">0</span>    header_bytes <span class="token operator">=</span> b<span class="token string">""</span>    <span class="token keyword">while</span> header_bytes_size <span class="token operator">&lt;</span> header_bytes_length<span class="token punctuation">:</span>        data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        header_bytes <span class="token operator">+=</span> data        header_bytes_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 字典字符串转换成字典</span>    header_dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>header_bytes<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>header_dic<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 下载文件</span>    total_size <span class="token operator">=</span> header_dic<span class="token punctuation">[</span><span class="token string">"total_size"</span><span class="token punctuation">]</span>    file_size <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"%s%s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>dir_path<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">while</span> file_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>            data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>data<span class="token punctuation">)</span>            file_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载完成"</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/ec98a898740d4ad09e3434c296077dca.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（5）—— 基于SOCKET模拟SSH远程执行命令后出现的粘包问题及解决方案</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-5-ji-yu-socket-mo-ni-ssh-yuan-cheng-zhi-xing-ming-ling-hou-chu-xian-de-nian-bao-wen-ti-ji-jie-jue-fang-an/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-5-ji-yu-socket-mo-ni-ssh-yuan-cheng-zhi-xing-ming-ling-hou-chu-xian-de-nian-bao-wen-ti-ji-jie-jue-fang-an/</url>
      
        <content type="html"><![CDATA[<h2 id="粘包问题：问题出现"><a href="#粘包问题：问题出现" class="headerlink" title="粘包问题：问题出现"></a>粘包问题：问题出现</h2><p>前面我们已经实现了利用<code>socket</code>模拟远程执行命令，但是我们在代码运行中很有可能会遇到这样的问题，如下图。</p><p>客户端运行结果<br><img src="https://img-blog.csdnimg.cn/b27b0f329ec548a987c99d7be75a596b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>我们发现命令 <code>ipconfig</code>命令的结果长度显然已经超过了 1024 <code>phone.recv(1024)</code>,而这样的结果就是该命令的结果分成两部分发送，导致 <code>xxx</code>命令的结果在下一个命令发送后才能收到，可以说因为结果超过了 1024 而造成了堵塞。</p><p>上述情况我们称之为 <code>粘包现象</code></p><h2 id="粘包问题：分析"><a href="#粘包问题：分析" class="headerlink" title="粘包问题：分析"></a>粘包问题：分析</h2><p>需要注意的是，<code>粘包问题的本质并不是信息发送的堵塞，只是表现比较像</code>。</p><p>实际上粘包问题是由 socket 底层算法造成的——就简单来说就是在传输信息时底层算法会把要 <code>send</code>的信息打包在一起发送，而不管他们是否应该被打包在一起发送（<code>即把前后两次 send 时间间隔短，字节长度短的信息打包在一起发送</code>）</p><p>文字描述似乎不太好理解，我们可以简单写一段代码进行分析。</p><p>服务端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socketserver <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>res <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>res1 <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第一次收到的信息是："</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"第二次收到的信息是："</span><span class="token punctuation">,</span> res1<span class="token punctuation">)</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socketclient <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">" world!"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>在运行前，我们可以会认为运行结果是这样的</p><pre class=" language-html"><code class="language-html">第一次收到的信息是：hello第二次收到的信息是： world！</code></pre><p>但实际上我们的运行结果是这样的<br><img src="https://img-blog.csdnimg.cn/270b032f718f420594675ec21516db57.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_19,color_FFFFFF,t_70,g_se,x_16"><br>这其实就是粘包问题。在我们所举的例子里要想解决这个问题是比较简单的，比如说将 <code>conn.recv(1024)</code>改成<code>conn.recv(5)</code>就可以了。</p><p>实际上这就是我们解决粘包问题的方法。</p><h2 id="粘包问题：文字版解决方案"><a href="#粘包问题：文字版解决方案" class="headerlink" title="粘包问题：文字版解决方案"></a>粘包问题：文字版解决方案</h2><p>通过上面的分析我们了解到要想解决粘包问题的关键是知道传递给我们的消息的长度到底是多长。</p><p>所以我们的解决方法是<br><code>发消息端</code><br><code>第一步、编码信息的长度并发送</code><br><code>接收消息端</code><br><code>第一步、接收编码并解码获得信息长度数据</code><br><code>第二步、循环使用 conn.recv(1024) 直到信息全部接收完毕</code><br><code>注意、最好不要使用 conn.recv(真正信息的长度) 因为这意味着接收消息一方需要开‘信息长度’的缓存，如果长度过长，很有可能开不出这样大小的缓存</code></p><p>但这个方案也有一个问题，就是接收消息的一方在接受信息的时候怎么知道是长度是几位数？<code>即使用的代码是 conn.recv(4) 还是 conn.recv(5) 或是别的长度</code></p><p>面对这个问题，我们的解决方案是采用独特的编码方式，将长度——无论是几位数——都编码成固定长度（<code>即报头</code>），发送给接收端。而这就需要用到<code>struct模块</code>了。</p><h2 id="粘包问题：struct-模块补充"><a href="#粘包问题：struct-模块补充" class="headerlink" title="粘包问题：struct 模块补充"></a>粘包问题：struct 模块补充</h2><p>代码演示</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> structres <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token number">1230000</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># i 表示整型，编码后的长度固定为 4</span>res1 <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> type<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>res1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 但 i 对编码前的数字大小有要求</span><span class="token comment" spellcheck="true"># res2 = struct.pack("i", 12300000000) # 报错</span><span class="token comment" spellcheck="true"># q 表示 long 型，数字范围比 i 大，但也有范围限制</span><span class="token comment" spellcheck="true"># 编码后的长度固定为 8</span>res3 <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> <span class="token number">12300000000</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>res3<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 解码</span>data <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>data1 <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> res3<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>data1<span class="token punctuation">)</span></code></pre><p>运行结果<br><img src="https://img-blog.csdnimg.cn/cef1dcd94fc04b34ac4bf00f8296d1a6.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="粘包问题：简单代码解决"><a href="#粘包问题：简单代码解决" class="headerlink" title="粘包问题：简单代码解决"></a>粘包问题：简单代码解决</h2><p>分析到这里我们就可以试着解决粘包问题了</p><p>服务端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> struct<span class="token keyword">import</span> subprocessserver <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接循环</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通讯循环</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 收到消息</span>            cmd <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8096</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"收到客户端的消息是："</span><span class="token punctuation">,</span> cmd<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 执行命令</span>            obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                   stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                   stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取执行命令的结果</span>            stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 对结果长度形成报文，并发送</span>            total_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span><span class="token operator">+</span>len<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 形成固定的长度为 4 的报文</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>total_size<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送最终结果</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>            <span class="token keyword">break</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>serve<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> structclient <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token comment" spellcheck="true"># 发送命令</span>    cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>        <span class="token keyword">continue</span>    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 接收报文并解码</span>    total_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">,</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 循环直到接收到完整的结果</span>    res_size <span class="token operator">=</span> <span class="token number">0</span>    res <span class="token operator">=</span> b<span class="token string">""</span>    <span class="token keyword">while</span> res_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>        data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        res <span class="token operator">+=</span> data        res_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>运行结果</p><p>服务端<br><img src="https://img-blog.csdnimg.cn/1316bc47057d44ed963fa5a8ebdfb0d7.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>客户端<br><img src="https://img-blog.csdnimg.cn/231bec75976f45349b9efea53960ffc4.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="粘包问题：终极代码解决"><a href="#粘包问题：终极代码解决" class="headerlink" title="粘包问题：终极代码解决"></a>粘包问题：终极代码解决</h2><p>到目前我们似乎完美解决了粘包问题，但果真如此吗？如果我们要传递的消息长度超过了可以编码的长度又该怎么办？</p><p>所以我们应该要有一个通用的解决方案，即终结解决方案。<br><code>发消息端</code><br><code>第一步、计算信息的长度，为防止此数字不能编码，将数字放进字典</code><br><code>第二步、将字典转化为字符串，计算字符串的长度并编码发送</code><br><code>接收消息端</code><br><code>第一步、获得字典字符串长度编码并解码</code><br><code>第二步、循环接收完整字典字符串，将字符串转换成字典，获得真正信息的长度</code><br><code>第三步、循环接收真正信息</code></p><p>服务端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> struct<span class="token keyword">import</span> socket<span class="token keyword">import</span> json<span class="token keyword">import</span> subprocessserver <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>server<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接循环</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> server<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8096</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 若接收的命令为空</span>                <span class="token keyword">break</span>            <span class="token comment" spellcheck="true"># 执行命令</span>            obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                   stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                   stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取命令执行结果</span>            stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 报头字典</span>            header_dict <span class="token operator">=</span> <span class="token punctuation">{</span>                <span class="token string">"name"</span><span class="token punctuation">:</span> cmd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".txt"</span><span class="token punctuation">,</span>                <span class="token string">"dict_size"</span><span class="token punctuation">:</span> len<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span> <span class="token operator">+</span> len<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>            <span class="token punctuation">}</span>            <span class="token comment" spellcheck="true"># 字典转化为字符串</span>            header_bytes <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>header_dict<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 字符串长度编码并发送</span>            header <span class="token operator">=</span> struct<span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>header_bytes<span class="token punctuation">)</span><span class="token punctuation">)</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送字典字符串</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>header_bytes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 发送真实消息</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stdout<span class="token punctuation">)</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>stderr<span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>            <span class="token keyword">break</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>server<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> struct<span class="token keyword">import</span> jsonclient <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>client<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token comment" spellcheck="true"># 输入命令并发送</span>    cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>        <span class="token keyword">continue</span>    client<span class="token punctuation">.</span>send<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 接收字典长度编码并解码</span>    dic_total_size <span class="token operator">=</span> struct<span class="token punctuation">.</span>unpack<span class="token punctuation">(</span><span class="token string">"q"</span><span class="token punctuation">,</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 接收字典字符串</span>    dic_size <span class="token operator">=</span> <span class="token number">0</span>    dic_bytes <span class="token operator">=</span> b<span class="token string">""</span>    <span class="token keyword">while</span> dic_size <span class="token operator">&lt;</span> dic_total_size<span class="token punctuation">:</span>        data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        dic_bytes <span class="token operator">+=</span> data        dic_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 将字典字符串转换为字典</span>    header_dic <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>dic_bytes<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>header_dic<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 获取真实信息长度</span>    total_size <span class="token operator">=</span> header_dic<span class="token punctuation">[</span><span class="token string">"dict_size"</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 获取真实信息</span>    res_size <span class="token operator">=</span> <span class="token number">0</span>    res <span class="token operator">=</span> b<span class="token string">""</span>    <span class="token keyword">while</span> res_size <span class="token operator">&lt;</span> total_size<span class="token punctuation">:</span>        data <span class="token operator">=</span> client<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        res <span class="token operator">+=</span> data        res_size <span class="token operator">+=</span> len<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>client<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>运行结果<br><img src="https://img-blog.csdnimg.cn/0b8e859fdb3544e989a33bfa7b6e4b7f.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（4）—— 基于SOCKET实现模拟SSH远程执行命令</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-4-ji-yu-socket-shi-xian-mo-ni-ssh-yuan-cheng-zhi-xing-ming-ling/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-4-ji-yu-socket-shi-xian-mo-ni-ssh-yuan-cheng-zhi-xing-ming-ling/</url>
      
        <content type="html"><![CDATA[<h2 id="网络通信的应用"><a href="#网络通信的应用" class="headerlink" title="网络通信的应用"></a>网络通信的应用</h2><p>根据之前的网络通信的学习，我们可以很简单的想到网络通信可以用于搭建一个类似聊天室的程序。其实网络通信一个重要的应用是连接服务器执行命令，以 Windows 系统为例，比如说：<code>dir</code> 是查看本地文件目录的命令，<code>ipconfig</code> 是查看本地网卡 IP 地址命令，<code>tasklist</code> 是查看运行进程的命令……</p><h2 id="python-如何利用代码执行终端命令"><a href="#python-如何利用代码执行终端命令" class="headerlink" title="python 如何利用代码执行终端命令"></a>python 如何利用代码执行终端命令</h2><p>而要实现远程执行命令我们要做的是将相应命令传输给服务端，并让服务端将执行命令的结果返回客户端。</p><p>所以我们首先要解决的问题是如何利用代码执行终端命令。</p><h3 id="尝试一、os模块"><a href="#尝试一、os模块" class="headerlink" title="尝试一、os模块"></a>尝试一、<code>os</code>模块</h3><p>不出意外，我们首先想要的实现方法是 <code>os</code> 模块。运行代码及结果如下</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> osos<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"ipconfig"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/59eb19e7bbfc46bb967bae7c05d3bbdc.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>看运行结果，好像我们已经解决问题了，但仔细想想我们这段代码是写在 服务端的，我们需要做的是获取执行后得到的结果传递给客户端，但现在却是直接在服务端打印结果了。<br>那么面对这个问题我们可以通过赋值解决吗？<br>答案是否定的。</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> osres <span class="token operator">=</span> os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"ipconfig"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/b3fc3a5692dc49f4916b6e54ea958927.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>我们发现自己的赋值结果得到的是 0.其实这个零表示的是我们提供的命令可以执行并且执行成功。这也意味着利用 <code>os</code>模块并不能得到我们想要的结果。</p><h3 id="解决方法、subprocess-模块"><a href="#解决方法、subprocess-模块" class="headerlink" title="解决方法、subprocess 模块"></a>解决方法、<code>subprocess</code> 模块</h3><p>代码及实现</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> subprocesscmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># shell 一定不要忘记，不然该命令不会执行</span><span class="token comment" spellcheck="true"># stdout 表示可以执行并且执行成功后的结果，PIPE 表示结果送至管道</span><span class="token comment" spellcheck="true"># stderr 表示无法执行的结果</span>obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>cmd<span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                       stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                       stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span> stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 结果获取</span>stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>stdout<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># windows 系统上终端以 gbk 编码方式输出，所以打印的时候要转换成 gbk 编码</span><span class="token keyword">print</span><span class="token punctuation">(</span>stderr<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>成功的结果<br><img src="https://img-blog.csdnimg.cn/a35b214bdbf6413aa682345dea2581c1.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>失败的结果<br><img src="https://img-blog.csdnimg.cn/ad2a483ae44d475bbb40527541b04a0e.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>将 <code>subprocess</code>相关的代码加入服务端<br>服务端代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socket<span class="token keyword">import</span> subprocessphone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接循环</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> phone<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"starting……"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            cmd <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">,</span><span class="token string">"发出的命令是："</span><span class="token punctuation">,</span> cmd<span class="token punctuation">)</span>            obj <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> shell<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>                                   stdout <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span>                                   stderr <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">)</span>            stdout <span class="token operator">=</span> obj<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            stderr <span class="token operator">=</span> obj<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            res <span class="token operator">=</span> stdout <span class="token operator">+</span> stderr            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>res<span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>            <span class="token keyword">break</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socketphone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    cmd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>--: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> cmd<span class="token punctuation">:</span>        <span class="token keyword">continue</span>    phone<span class="token punctuation">.</span>send<span class="token punctuation">(</span>cmd<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> phone<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>服务端<br><img src="https://img-blog.csdnimg.cn/014d2be5e3ee47568693223a4d535bf0.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>客户端<br><img src="https://img-blog.csdnimg.cn/e97ab56ff5b84451ba9322d7fb10f437.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（3）—— 基于SOCKET实现简单套接字通信的链接循环</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-3-ji-yu-socket-shi-xian-jian-dan-tao-jie-zi-tong-xin-de-lian-jie-xun-huan/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-3-ji-yu-socket-shi-xian-jian-dan-tao-jie-zi-tong-xin-de-lian-jie-xun-huan/</url>
      
        <content type="html"><![CDATA[<h2 id="目前代码存在的问题"><a href="#目前代码存在的问题" class="headerlink" title="目前代码存在的问题"></a>目前代码存在的问题</h2><p>前面我们已经完成了基于 SOCKET 的实现了通信循环的简单套接字通信程序，并且还优化了其中的两个小问题，让程序更加稳定。</p><p>但俗话说的好，“旧的刚忘掉，新的就来到”，所以我们很无奈的发现了一个问题，就是我们的程序只能实现一个客户端同服务端 “对话” ，而很显然这和我们现实的要求肯定相去甚远——在现实中我们不可能有一个只服务一个客户的服务端（即要服务不同的客户就必须重启程序）。</p><p>所以这时候我们就需要使用所谓的 链接循环。</p><h2 id="解决方案——原代码分析"><a href="#解决方案——原代码分析" class="headerlink" title="解决方案——原代码分析"></a>解决方案——原代码分析</h2><p>因为我们的目的是让服务端可以同时服务多个客户端，所以我们的链接循环应该在服务端的代码上进行修改。而要添加 链接循环，首先就要明白什么是链接，或者说链接在客户端的代码里是怎么体现的。</p><p>这是我们之前服务端的代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token comment" spellcheck="true"># 买手机</span>phone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 表示端口可以重复使用</span><span class="token comment" spellcheck="true"># 装上手机卡</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 开机</span>phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 等待电话</span>conn<span class="token punctuation">,</span> client_addr <span class="token operator">=</span> phone<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 收发信息</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 若客户端发送的信息为空</span>            <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"客户端发送的消息："</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>        <span class="token keyword">break</span><span class="token comment" spellcheck="true"># 挂电话</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 关机</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>我们还是用 打电话 的例子来说明。链接嘛，顾名思义就是服务端和客户端产生联系，所以在打电话的类比中，打电话的双方产生联系的过程就是等待电话到挂电话的过程，而这个过程也就是我们需要添加循环的过程。</p><p>注意以下代码的含义</p><pre class=" language-python"><code class="language-python">phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></code></pre><p>这里的 5 是指该服务端可以一次性接通 5 个客户端，即第 6 个客户端无法连接。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>只需要修改服务端代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># coding=gbk</span><span class="token keyword">import</span> socketphone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接循环</span>    conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> phone<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"staring……"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"客户端的信息是"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>            <span class="token keyword">break</span>    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>值得注意的是，因为服务端的代码并没有实现多线程，所以服务端虽然同时连接了两个客户端，所以只有把其中一个客户端停止连接，另一个客户端的信息才能传到服务端。</p><p>运行结果如下</p><p>服务端<img src="https://img-blog.csdnimg.cn/8ff36405a6db44c0a6610d4fcf106ebd.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><p>客户端<br><img src="https://img-blog.csdnimg.cn/e42a2838e7954488a6f6ddbd85710415.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><p>客户端1<br><img src="https://img-blog.csdnimg.cn/d70d6fb8c0fb42d4962324fa4cea2687.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（2）—— 基于SOCKET简单套接字通信的 bug 修复</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-2-ji-yu-socket-jian-dan-tao-jie-zi-tong-xin-de-bug-xiu-fu/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-2-ji-yu-socket-jian-dan-tao-jie-zi-tong-xin-de-bug-xiu-fu/</url>
      
        <content type="html"><![CDATA[<h2 id="目前实现的添加了通信循环的套接字通信的一些问题"><a href="#目前实现的添加了通信循环的套接字通信的一些问题" class="headerlink" title="目前实现的添加了通信循环的套接字通信的一些问题"></a>目前实现的添加了通信循环的套接字通信的一些问题</h2><h3 id="客户端向服务端发送消息时发现地址已被使用"><a href="#客户端向服务端发送消息时发现地址已被使用" class="headerlink" title="客户端向服务端发送消息时发现地址已被使用"></a>客户端向服务端发送消息时发现地址已被使用</h3><p>在我们重启服务端时，可能会遇到这样的问题<br><img src="https://img-blog.csdnimg.cn/77252f94ee674f6d80583dd489ff0d94.png" alt="在这里插入图片描述"><br>当我们遇到这个问题时，可以在编写服务端代码时加入 一条 socket 配置，重新使用 IP 和 端口。</p><pre class=" language-python"><code class="language-python">phone<span class="token operator">=</span>socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>SOL_SOCKET<span class="token punctuation">,</span>SO_REUSEADDR<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#在bind前加</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="发空消息时程序进入死循环"><a href="#发空消息时程序进入死循环" class="headerlink" title="发空消息时程序进入死循环"></a>发空消息时程序进入死循环</h3><p>除了地址已被使用的错误，我们发现当客户端发送消息时直接发送，即什么都不输入就敲回车，会导致服务端和客户端直接卡在循环中，即只能看到光标在闪动。如下图：<br><img src="https://img-blog.csdnimg.cn/21626b45afb54311bbe126e6e62aaf8b.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br><img src="https://img-blog.csdnimg.cn/9cc91ea04cda4353b5b23aa3202d40b2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>考虑到是发送了空信息，即<code>&quot; &quot;</code>的消息，所以我们想到的第一个解决方案是在客户端输入要发送的消息时判断发送的消息是否为空。即：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span>    <span class="token keyword">continue</span></code></pre><p>这里要注意的，除了客户端需要判断消息是否为空，服务端也是要判断消息是否为空，否则在运行时我们就会看到这样的运行结果：<br><img src="https://img-blog.csdnimg.cn/7493406fbbdc45c283a772c02725a150.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>所以我们对于服务端的优化代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 若客户端发送的信息为空</span>            <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"客户端发送的消息："</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><h2 id="代码优化"><a href="#代码优化" class="headerlink" title="代码优化"></a>代码优化</h2><p>所以我们考虑到这些小 Bug 后优化的服务端和客户端代码如下：<br>服务端</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketphone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>setsockopt<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>SOL_SOCKET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SO_REUSEADDR<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 表示端口可以重复使用</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>conn<span class="token punctuation">,</span> client_addr <span class="token operator">=</span> phone<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 若客户端发送的信息为空</span>            <span class="token keyword">break</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"客户端发送的消息："</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>        <span class="token keyword">break</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socketphone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>phone<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    msg <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>: "</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token operator">not</span> msg<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 防止发送的信息为空</span>        <span class="token keyword">continue</span>    phone<span class="token punctuation">.</span>send<span class="token punctuation">(</span>msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> phone<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>服务端<br><img src="https://img-blog.csdnimg.cn/b2e8881e9a754365a97ab8d845c1aa88.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"><br>客户端<br><img src="https://img-blog.csdnimg.cn/53924b0ba06a4022a4d3a563c28c6da2.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p><h2 id="不知道原因的小坑"><a href="#不知道原因的小坑" class="headerlink" title="不知道原因的小坑"></a>不知道原因的小坑</h2><p>有一点需要说明，按照我学的课程是讲，windos系统下的服务端这样写就可以解决一直循环的问题</p><pre class=" language-python"><code class="language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通信循环</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"客户端发送的消息："</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>        conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> ConnectionResetError<span class="token punctuation">:</span>        <span class="token keyword">break</span></code></pre><p>而上述优化后的代码中</p><pre class=" language-python"><code class="language-python"><span class="token keyword">if</span> <span class="token operator">not</span> data<span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 若客户端发送的信息为空</span>    <span class="token keyword">break</span></code></pre><p>是linux系统下的解决方案</p><p>但不知道为什么我按照Windows系统的解决方案服务端仍然陷入了循环，加上了Linux系统解决方案那个代码才解决了问题。</p><p>原因至今也没有找到，如果有知道的大佬看到了我的这篇水平不怎么样的文章，希望可以抽出一点点时间帮忙解答，谢谢。</p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络通信编程学习（1）—— 基于SOCKET实现简单套接字通信</title>
      <link href="/2022/11/25/wang-luo-bian-cheng-xue-xi-1-ji-yu-socket-shi-xian-jian-dan-tao-jie-zi-tong-xin/"/>
      <url>/2022/11/25/wang-luo-bian-cheng-xue-xi-1-ji-yu-socket-shi-xian-jian-dan-tao-jie-zi-tong-xin/</url>
      
        <content type="html"><![CDATA[<h2 id="套接字通信简单理解"><a href="#套接字通信简单理解" class="headerlink" title="套接字通信简单理解"></a>套接字通信简单理解</h2><h3 id="网络通信简单理解"><a href="#网络通信简单理解" class="headerlink" title="网络通信简单理解"></a>网络通信简单理解</h3><p>要想实现网络通信，简单理解就是用户启动客户端并连接到服务端，用户使用客户端向服务端发送信息（请求），服务端响应客户端。</p><h3 id="简单套接字通信类比"><a href="#简单套接字通信类比" class="headerlink" title="简单套接字通信类比"></a>简单套接字通信类比</h3><p>我们可以将简单套接字通信的过程中类比成打电话。</p><p>对于服务端而言，实现通信的过程可以类比为以下七步：</p><ol><li>买手机</li><li>装上电话卡</li><li>开机</li><li>等待电话接通</li><li>收发消息</li><li>挂断电话</li><li>关机</li></ol><p>而对于客户端，实现通信的过程可以类比为以下四步：</p><ol><li>买手机</li><li>拨打电话</li><li>发收消息</li><li>挂断电话</li></ol><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>简单了解之后就让我们尝试来实现简单的套接字通信吧。<br>服务端</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token comment" spellcheck="true"># 1. 买手机</span>phone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 2. 装手机卡</span>phone<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 连接到本地服务器（如果运行时无法连接，可以将端口改为 8081）#0-65535:0_1024 给操作系统使用</span><span class="token comment" spellcheck="true"># 3. 开机</span>phone<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 5表示最大挂起的连接数</span><span class="token comment" spellcheck="true"># 4. 等待拨号</span>conn<span class="token punctuation">,</span>client <span class="token operator">=</span> phone<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 5. 收发信息</span>data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#1. 单位：bytes，2. 1024表示最大接收1024个bytes</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 6. 挂断电话</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 7. 关机</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> socket<span class="token comment" spellcheck="true"># 1. 买手机</span>phone <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 2. 拨号</span>phone<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token number">8080</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 端口一定要和服务端一致</span><span class="token comment" spellcheck="true"># 3. 发收消息</span>phone<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data <span class="token operator">=</span> phone<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 4. 关机</span>phone<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>运行时一定要注意先运行服务端，在运行客户端。<br>服务端运行结果<br><img src="https://img-blog.csdnimg.cn/b5f75c462cf94fcb97c4217e3585bc9d.png"><br>客户端运行结果<br><img src="https://img-blog.csdnimg.cn/7317e7655c954a048577e1d9cc991fdf.png"></p><h2 id="优化：通信循环"><a href="#优化：通信循环" class="headerlink" title="优化：通信循环"></a>优化：通信循环</h2><p>这样我们实现了简单的套接字通信，但我们发现按照我们上面的代码只能发送一次信息，显然这不符合我们的要求，那我们要怎么优化呢？很简单只需要在写客户端和服务端的“收发消息”的代码增加循环即可。</p><p>优化后的代码为<br>服务端</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 5. 收发信息</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#1. 单位：bytes，2. 1024表示最大接收1024个bytes</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>    conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span>data<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>客户端</p><pre class=" language-python"><code class="language-python"><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    mes <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">">>--"</span><span class="token punctuation">)</span>    phone<span class="token punctuation">.</span>send<span class="token punctuation">(</span>mes<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> phone<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></code></pre><p>运行结果<br>服务端<br><img src="https://img-blog.csdnimg.cn/edfa0b4cee3e4e938002134efbb1a6bb.png"></p><p>客户端<br><img src="https://img-blog.csdnimg.cn/27e08195fa1843d4a81c5a4417797e83.png?x-oss-process=image/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBA5LiW55WM55qE6ZqQ5Za7,size_20,color_FFFFFF,t_70,g_se,x_16"></p>]]></content>
      
      
      <categories>
          
          <category> 网络通信 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> socket </tag>
            
            <tag> 网络通信 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（9） -- 数据库课设（企业人事系统）</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-9-shu-ju-ku-ke-she-qi-ye-ren-shi-xi-tong/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-9-shu-ju-ku-ke-she-qi-ye-ren-shi-xi-tong/</url>
      
        <content type="html"><![CDATA[<h1 id="数据库课设"><a href="#数据库课设" class="headerlink" title="数据库课设"></a>数据库课设</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>这里两三天帮同学写了一个简单的包含 UI 界面的数据库课设作业。</p><p>由于本人美术能力有限，以及是第一次接触 pyqt5 ，所以实际的 UI 界面比较省略，并且时间有限，一些逻辑也没有优化，各位看看就好。</p><p>PS：这里的所有 UI 界面都是由 QtDesigner 画出来的，还记得以前有人告诉我一定要学会手写使用 pyqt5 再使用  QtDesigner 画图，所以做课设的时候有取巧。</p><h2 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h2><p>因为是给同学做的，项目目录也没有很好的分块而是直接放在一个文件夹里面，各位将就看一下。</p><p><img src="https://img-blog.csdnimg.cn/63cdf93a2ab8402a88c5058378d6a491.png"></p><h2 id="项目需求以及sql代码"><a href="#项目需求以及sql代码" class="headerlink" title="项目需求以及sql代码"></a>项目需求以及sql代码</h2><p>建立的是一个企业人事管理系统，表的关系如下：</p><p><img src="https://img-blog.csdnimg.cn/e2d4c5a491d548e6867f4a91085ce262.png"></p><ul><li>建表 sql 语句</li></ul><pre class=" language-mysql"><code class="language-mysql">create database classDesign;use classDesign;# 用户表create table user (    id int primary key auto_increment,    username varchar(16) unique,    password varchar(16));# 插入用户数据INSERT INTO USER (username, password)VALUES    ("admin", "12345"),    ("mcx", "qwe"),    ("lj", "asd"),    ("hn", "zxc");# 日志create table log (    username varchar(16),    action enum("login", "query", "delete", "add") not null,    msg varchar(16),    time timestamp not null default CURRENT_TIMESTAMP);# 部门表（和职员表一对多关系）create table dep (    id int primary key auto_increment,    name varchar(16) not null,    des varchar(32));# 插入数据INSERT INTO `dep` (`name`, `des`) VALUES ('运营', '好销售，不责任手段');INSERT INTO `dep` (`name`, `des`) VALUES ('销售', '什么都可以销售');INSERT INTO `dep` (`name`, `des`) VALUES ('教育', '教书育人');# 职员详细信息create table emp_detail (    id int primary key auto_increment,    addr varchar(16),    email varchar(16),    time timestamp not null default CURRENT_TIMESTAMP);# 插入数据（其实 id 和 time 会自动填入不用插入）INSERT INTO `classdesign`.`emp_detail` (`id`, `addr`, `email`, `time`) VALUES ('1', '东方', '123@qq.com', '2022-07-03 15:41:32');INSERT INTO `classdesign`.`emp_detail` (`id`, `addr`, `email`, `time`) VALUES ('2', '北方', '456@qq.com', '2022-07-03 15:42:19');INSERT INTO `classdesign`.`emp_detail` (`id`, `addr`, `email`, `time`) VALUES ('3', '西方', 'qwwer@qq.com', '2022-07-03 15:42:44');INSERT INTO `classdesign`.`emp_detail` (`id`, `addr`, `email`, `time`) VALUES ('4', '南方', 'asd@qq.com', '2022-07-03 15:43:23');# 职员表create table emp ( id int primary key auto_increment, name varchar(16) not null, dep_id int not null, detail_id int not null, foreign key(dep_id) references dep(id), foreign key(detail_id) references emp_detail(id));# 插入数据INSERT INTO `emp` (`name`, `dep_id`, `detail_id`) VALUES ('奥特曼', '1', '2');INSERT INTO `emp` (`name`, `dep_id`, `detail_id`) VALUES ('迪迦', '1', '3');INSERT INTO `emp` (`name`, `dep_id`, `detail_id`) VALUES ('戴拿', '2', '4');INSERT INTO `emp` (`name`, `dep_id`, `detail_id`) VALUES ('盖亚', '3', '1');# 项目表（和职员表，多对多关系，即一个项目可以有多个职员负责，一个职员可以负责多个项目）create table project(    id int primary key auto_increment,    name varchar(16));# 插入数据INSERT INTO `project` (`name`) VALUES ('数据库');INSERT INTO `project` (`name`) VALUES ('网络通信');# 多对多关系的第三方表create table emp2pro(    id int primary key auto_increment,    emp_id int,    pro_id int,    foreign key(emp_id) references emp(id)    on update cascade    on delete cascade,    foreign key(pro_id) references project(id)    on update cascade    on delete cascade);# 插入数据INSERT INTO `emp2pro` (`emp_id`, `pro_id`) VALUES ('1', '1');INSERT INTO `emp2pro` (`emp_id`, `pro_id`) VALUES ('1', '2');INSERT INTO `emp2pro` (`emp_id`, `pro_id`) VALUES ('3', '2');</code></pre><h2 id="python-代码实现"><a href="#python-代码实现" class="headerlink" title="python 代码实现"></a>python 代码实现</h2><h3 id="FirstWindow-py"><a href="#FirstWindow-py" class="headerlink" title="FirstWindow.py"></a>FirstWindow.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">646</span><span class="token punctuation">,</span> <span class="token number">453</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">441</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>login <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 登录按钮</span>        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"login"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_login<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>reg <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 注册按钮</span>        self<span class="token punctuation">.</span>reg<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"reg"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>reg<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>reg<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_reg<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:28pt; font-weight:600;\">\u6b22\u8fce\u4f7f\u7528 XXX \u7cfb\u7edf&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u767b\u5f55"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>reg<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6ce8\u518c"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">user_login</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户登录页面显示</span>        <span class="token keyword">from</span> PLogin <span class="token keyword">import</span> login_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> login_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">user_reg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 用户注册页面展示</span>        <span class="token keyword">from</span> PReg <span class="token keyword">import</span> reg_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> reg_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="main-py"><a href="#main-py" class="headerlink" title="main.py"></a>main.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">from</span> FirstWindow <span class="token keyword">import</span> Ui_Dialog<span class="token keyword">class</span> <span class="token class-name">Window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span>Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 实例化初始界面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">setup_ui</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span>app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>window <span class="token operator">=</span> Window<span class="token punctuation">(</span><span class="token punctuation">)</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="PLogin-py"><a href="#PLogin-py" class="headerlink" title="PLogin.py"></a>PLogin.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 用户名</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">441</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2 <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 密码</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>Password<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 密码输入星号显示</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 登录</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>login<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:28pt; font-weight:600;\">\u6b22\u8fce\u4f7f\u7528 XXX \u7cfb\u7edf&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u7528\u6237\u540d"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5bc6\u7801"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u767b\u5f55"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 验证登录</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql <span class="token operator">=</span> <span class="token string">"select id from user where username = (%s) and password = (%s)"</span>        username <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取用户名</span>        <span class="token comment" spellcheck="true"># print(username)</span>        password <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取密码</span>        res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(cursor.fetchall()[0].get("id"))</span>        <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 账号密码错误</span>            <span class="token keyword">from</span> login_err <span class="token keyword">import</span> err_window            self<span class="token punctuation">.</span>window <span class="token operator">=</span> err_window<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># time.sleep(2)</span>            <span class="token comment" spellcheck="true"># self.window.close()</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> id <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"登陆成功！！！！！"</span><span class="token punctuation">)</span>                sql <span class="token operator">=</span> <span class="token string">"insert into log(username, action) values(%s, 'login')"</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">from</span> PUserWindow <span class="token keyword">import</span> user_window                self<span class="token punctuation">.</span>window <span class="token operator">=</span> user_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"登陆成功！！！！！"</span><span class="token punctuation">)</span>                sql <span class="token operator">=</span> <span class="token string">"insert into log(username, action) values(%s, 'login')"</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">from</span> PAdminWindow <span class="token keyword">import</span> admin_window                self<span class="token punctuation">.</span>window <span class="token operator">=</span> admin_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 数据库密码</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit <span class="token operator">=</span> <span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor<span class="token keyword">class</span> <span class="token class-name">login_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Login<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开登录页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="log-err-py"><a href="#log-err-py" class="headerlink" title="log_err.py"></a>log_err.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>repaint<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:20pt; font-weight:600;\">\u8d26\u53f7\u6216\u5bc6\u7801\u9519\u8bef&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">err_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 登录失败页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PReg-py"><a href="#PReg-py" class="headerlink" title="PReg.py"></a>PReg.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">450</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"username"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">441</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>password <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"password"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">280</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>setEchoMode<span class="token punctuation">(</span>QLineEdit<span class="token punctuation">.</span>Password<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">290</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">350</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>reg<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:28pt; font-weight:600;\">\u6b22\u8fce\u4f7f\u7528 XXX \u7cfb\u7edf&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u7528\u6237\u540d"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5bc6\u7801"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6ce8\u518c"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">reg</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(username, password)</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql <span class="token operator">=</span> <span class="token string">"select id from user where username = '%s' "</span> <span class="token operator">%</span> username        res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">from</span> reg_err <span class="token keyword">import</span> err_window            self<span class="token punctuation">.</span>window <span class="token operator">=</span> err_window<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            sql <span class="token operator">=</span> <span class="token string">"insert into user(username, password) values(%s, %s)"</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"注册成功！！！！"</span><span class="token punctuation">)</span>            <span class="token keyword">from</span> PLogin <span class="token keyword">import</span> login_window            self<span class="token punctuation">.</span>window <span class="token operator">=</span> login_window<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">reg_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开注册页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="reg-err-py"><a href="#reg-err-py" class="headerlink" title="reg_err.py"></a>reg_err.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:20pt; font-weight:600;\">\u7528\u6237\u540d\u5df2\u5b58\u5728&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">err_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 登录失败页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PAdminWindow-py"><a href="#PAdminWindow-py" class="headerlink" title="PAdminWindow.py"></a>PAdminWindow.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">735</span><span class="token punctuation">,</span> <span class="token number">581</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget <span class="token operator">=</span> QTableWidget<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"tableWidget"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">501</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 删除</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">410</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>delete<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 添加</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_5"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>add<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 查询</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_6"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>search<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_7 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 查看日志</span>        self<span class="token punctuation">.</span>pushButton_7<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_7"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_7<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">460</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_7<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>log<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5220\u9664\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6dfb\u52a0\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u67e5\u8be2\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_7<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u67e5\u770b\u65e5\u5fd7"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        SELECT        emp.`name`,        dep.`name`,        dep.des,        emp_detail.addr,        emp_detail.email,        emp_detail.time,        project.`name`        FROM        emp        INNER JOIN dep ON emp.dep_id = dep.id        INNER JOIN emp2pro ON emp2pro.emp_id = emp.id        INNER JOIN emp_detail ON emp.detail_id = emp_detail.id        INNER JOIN project ON emp2pro.pro_id = project.id        """</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>        row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>        <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>        col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(rows)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PLogWindow <span class="token keyword">import</span> log_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> log_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PSearch <span class="token keyword">import</span> search_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> search_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PAdd <span class="token keyword">import</span> add_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> add_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PDelete <span class="token keyword">import</span> delete_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> delete_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">admin_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开管理员登录后的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PUserWindow-py"><a href="#PUserWindow-py" class="headerlink" title="PUserWindow.py"></a>PUserWindow.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">735</span><span class="token punctuation">,</span> <span class="token number">581</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget <span class="token operator">=</span> QTableWidget<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"tableWidget"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">501</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 删除</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">410</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>delete<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 添加</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_5"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>add<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 查询</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_6"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">630</span><span class="token punctuation">,</span> <span class="token number">310</span><span class="token punctuation">,</span> <span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>search<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_4<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5220\u9664\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_5<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6dfb\u52a0\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_6<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u67e5\u8be2\u4fe1\u606f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""        SELECT        emp.`name`,        dep.`name`,        dep.des,        emp_detail.addr,        emp_detail.email,        emp_detail.time,        project.`name`        FROM        emp        INNER JOIN dep ON emp.dep_id = dep.id        INNER JOIN emp2pro ON emp2pro.emp_id = emp.id        INNER JOIN emp_detail ON emp.detail_id = emp_detail.id        INNER JOIN project ON emp2pro.pro_id = project.id        """</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>        row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>        <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>        col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(rows)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PSearch <span class="token keyword">import</span> search_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> search_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PAdd <span class="token keyword">import</span> add_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> add_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> PDelete <span class="token keyword">import</span> delete_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> delete_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">user_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开普通用户登录后的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PSearch-py"><a href="#PSearch-py" class="headerlink" title="PSearch.py"></a>PSearch.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>            Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">741</span><span class="token punctuation">,</span> <span class="token number">740</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>lineEdit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">290</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 职工姓名查询</span>            self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_2 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 部门查询</span>            self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_2"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">330</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dep<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_3 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 项目查询</span>            self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_3"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>project<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>tableWidget <span class="token operator">=</span> QTableWidget<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"tableView"</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">511</span><span class="token punctuation">,</span> <span class="token number">371</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>            QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># setupUi</span>        <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>                QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8bf7\u8f93\u5165\u67e5\u8be2\u7684\u5185\u5bb9"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u804c\u5de5\u59d3\u540d\u67e5\u8be2"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u90e8\u95e8\u67e5\u8be2"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u9879\u76ee\u67e5\u8be2"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># retranslateUi</span>        <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>            <span class="token keyword">import</span> pymysql            conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>                host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>                port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>                user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>                password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>                database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>                charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>                autocommit<span class="token operator">=</span><span class="token boolean">True</span>            <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>            cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>            <span class="token keyword">return</span> cursor        <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>            name <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(name)</span>            sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""            SELECT            emp.`name`,            emp_detail.addr,            emp_detail.email,            emp_detail.time,            dep.`name`,            dep.des            FROM            emp            INNER JOIN emp_detail ON emp.detail_id = emp_detail.id            INNER JOIN dep ON emp.dep_id = dep.id            WHERE            emp.name = %s            """</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>                row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>                <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>                col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(rows)</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                        temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                        data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                        <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print("没有该条信息")</span>                <span class="token keyword">from</span> search_err <span class="token keyword">import</span> err_window                self<span class="token punctuation">.</span>window <span class="token operator">=</span> err_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>            sql <span class="token operator">=</span> <span class="token string">"insert into log(action, msg) values(%s, %s)"</span>            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">dep</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>            name <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>            sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""            SELECT            dep.`name`,            emp.`name`,            emp_detail.addr,            emp_detail.email,            emp_detail.time            FROM            dep            INNER JOIN emp ON emp.dep_id = dep.id            INNER JOIN emp_detail ON emp.detail_id = emp_detail.id            WHERE            dep.name = %s            """</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>                row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>                <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>                col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(rows)</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                        temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                        data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                        <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print("没有该条信息")</span>                <span class="token keyword">from</span> search_err <span class="token keyword">import</span> err_window                self<span class="token punctuation">.</span>window <span class="token operator">=</span> err_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">project</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>            cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>            name <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>            sql <span class="token operator">=</span> <span class="token triple-quoted-string string">"""            SELECT            project.`name`,            emp.`name`,            emp_detail.addr,            emp_detail.email,            emp_detail.time,            dep.`name`,            dep.des            FROM            project            INNER JOIN emp2pro ON emp2pro.pro_id = project.id            INNER JOIN emp ON emp2pro.emp_id = emp.id            INNER JOIN emp_detail ON emp.detail_id = emp_detail.id            INNER JOIN dep ON emp.dep_id = dep.id            WHERE            project.name = %s            """</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> res <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>                row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>                <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>                col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(rows)</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>                    <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                        temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                        data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                        <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"query"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print("没有该条信息")</span>                <span class="token keyword">from</span> search_err <span class="token keyword">import</span> err_window                self<span class="token punctuation">.</span>window <span class="token operator">=</span> err_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">search_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开查询的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="search-err-py"><a href="#search-err-py" class="headerlink" title="search_err.py"></a>search_err.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:20pt; font-weight:600;\">\u6ca1\u6709\u8be5\u6761\u4fe1\u606f\u5b58\u5728&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">err_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开查询失败的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PAdd-py"><a href="#PAdd-py" class="headerlink" title="PAdd.py"></a>PAdd.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">880</span><span class="token punctuation">,</span> <span class="token number">459</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 姓名</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2 <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># add</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_3"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">230</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_3 <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># email</span>        self<span class="token punctuation">.</span>lineEdit_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit_3"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">490</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_4 <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 部门姓名</span>        self<span class="token punctuation">.</span>lineEdit_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_5 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_5<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_5"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_5<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">490</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_5 <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 项目</span>        self<span class="token punctuation">.</span>lineEdit_5<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit_5"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_5<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">330</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>submit<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u804c\u5458\u59d3\u540d"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u804c\u5458\u5730\u5740"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u804c\u5458\u90ae\u7bb1"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_3<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6240\u5c5e\u90e8\u95e8"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_4<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_5<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u52a0\u5165\u9879\u76ee"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit_5<span class="token punctuation">.</span>setText<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u6dfb\u52a0\u6570\u636e"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">submit</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        emp_name <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        emp_add <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit_2<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        emp_email <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit_3<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 部门</span>        dep <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit_4<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        dep_id <span class="token operator">=</span> None        <span class="token comment" spellcheck="true"># 项目</span>        pro <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit_5<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        pro_id <span class="token operator">=</span> None        <span class="token comment" spellcheck="true"># print(emp_name,emp_add,emp_email, dep, pro)</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 判断部门是否存在，如果不存在，添加并且返回 部门的 id 值</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>dep<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            sql_dep <span class="token operator">=</span> <span class="token string">"select id from dep where name = %s"</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_dep<span class="token punctuation">,</span> dep<span class="token punctuation">)</span>            <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 不存在该部门</span>                sql_insert_dep <span class="token operator">=</span> <span class="token string">"insert into dep(name) values ('%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>dep<span class="token punctuation">)</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_insert_dep<span class="token punctuation">)</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_dep<span class="token punctuation">,</span> dep<span class="token punctuation">)</span>            dep_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># print(dep_id)</span>            self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> dep<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 判断 项目 是否存在，如果不存在，添加并且返回 项目的 id 值</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>pro<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            sql_pro <span class="token operator">=</span> <span class="token string">"select id from project where name = %s"</span>            res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_pro<span class="token punctuation">,</span> pro<span class="token punctuation">)</span>            <span class="token keyword">if</span> res <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 不存在该项目</span>                sql_insert_pro <span class="token operator">=</span> <span class="token string">"insert into project(name) values ('%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>pro<span class="token punctuation">)</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_insert_pro<span class="token punctuation">)</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_pro<span class="token punctuation">,</span> pro<span class="token punctuation">)</span>            pro_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># print(pro_id)</span>            self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> pro<span class="token punctuation">)</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>emp_name<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>            sql_detail <span class="token operator">=</span> <span class="token string">"insert into emp_detail(addr, email) values('%s', '%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>emp_add<span class="token punctuation">,</span> emp_email<span class="token punctuation">)</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_detail<span class="token punctuation">)</span>            sql_detail_id <span class="token operator">=</span> <span class="token string">"select id from emp_detail where addr = '%s'"</span> <span class="token operator">%</span> emp_add            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_detail_id<span class="token punctuation">)</span>            detail_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># print(detail_id)</span>            sql_emp <span class="token operator">=</span> <span class="token string">"insert into emp(name, dep_id, detail_id) values('%s', %d, %d)"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>emp_name<span class="token punctuation">,</span> dep_id<span class="token punctuation">,</span> detail_id<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(sql_emp)</span>            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_emp<span class="token punctuation">)</span>            <span class="token keyword">if</span> pro_id <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>                sql_emp_id <span class="token operator">=</span> <span class="token string">"select id from emp where name = '%s'"</span> <span class="token operator">%</span> emp_name                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_emp_id<span class="token punctuation">)</span>                emp_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                <span class="token comment" spellcheck="true"># print(emp_id, pro_id)</span>                <span class="token comment" spellcheck="true"># print(emp_id)</span>                sql_emp2project <span class="token operator">=</span> <span class="token string">"insert into emp2pro(emp_id, pro_id) values(%d, %d)"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>emp_id<span class="token punctuation">,</span> pro_id<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># print(sql_emp2project)</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_emp2project<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"add"</span><span class="token punctuation">,</span> emp_name<span class="token punctuation">)</span>        <span class="token keyword">from</span> add_success <span class="token keyword">import</span> success_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> success_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>        sql <span class="token operator">=</span> <span class="token string">"insert into log(action, msg) values(%s, %s)"</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">add_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 添加数据的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="add-success-py"><a href="#add-success-py" class="headerlink" title="add_success.py"></a>add_success.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">432</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">361</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:20pt; font-weight:600;\">\u4fe1\u606f\u6dfb\u52a0\u6210\u529f\uff01\uff01\uff01&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">success_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 添加数据成功的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PDelete-py"><a href="#PDelete-py" class="headerlink" title="PDelete.py"></a>PDelete.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">741</span><span class="token punctuation">,</span> <span class="token number">322</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit <span class="token operator">=</span> QLineEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"lineEdit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">290</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 按姓名删除</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_2 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 按部门删除</span>        self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">330</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>dep<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_3 <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 按项目删除</span>        self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton_3"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">520</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pro<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8bf7\u8f93\u5165\u5220\u9664\u7684\u5185\u5bb9"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u804c\u5de5\u59d3\u540d\u5220\u9664"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u90e8\u95e8\u5220\u9664"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton_3<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u9879\u76ee\u5220\u9664"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        name <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql <span class="token operator">=</span> <span class="token string">"delete from emp where name = '%s'"</span> <span class="token operator">%</span> name        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>        <span class="token keyword">from</span> delete_success <span class="token keyword">import</span> success_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> success_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">dep</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        dep <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql_pro_id <span class="token operator">=</span> <span class="token string">"select id from dep where name = %s"</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_pro_id<span class="token punctuation">,</span> dep<span class="token punctuation">)</span>        dep_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        sql <span class="token operator">=</span> <span class="token string">"delete from emp where dep_id = %d"</span> <span class="token operator">%</span> dep_id        sql2 <span class="token operator">=</span> <span class="token string">"delete from dep where name = '%s'"</span> <span class="token operator">%</span> dep        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql2<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">,</span> dep<span class="token punctuation">)</span>        <span class="token keyword">from</span> delete_success <span class="token keyword">import</span> success_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> success_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">pro</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        pro <span class="token operator">=</span> self<span class="token punctuation">.</span>lineEdit<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>        sql_pro_id <span class="token operator">=</span> <span class="token string">"select id from project where name = %s"</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql_pro_id<span class="token punctuation">,</span> pro<span class="token punctuation">)</span>        pro_id <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        sql <span class="token operator">=</span> <span class="token string">"delete from emp2pro where pro_id = %d"</span> <span class="token operator">%</span> pro_id        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token string">"delete"</span><span class="token punctuation">,</span> pro<span class="token punctuation">)</span>        <span class="token keyword">from</span> delete_success <span class="token keyword">import</span> success_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> success_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>        sql <span class="token operator">=</span> <span class="token string">"insert into log(action, msg) values(%s, %s)"</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>action<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">delete_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开删除的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="delete-success-py"><a href="#delete-success-py" class="headerlink" title="delete_success.py"></a>delete_success.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">431</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser <span class="token operator">=</span> QTextBrowser<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textBrowser"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">361</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textBrowser<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:20pt; font-weight:600;\">\u4fe1\u606f\u5220\u9664\u6210\u529f\uff01\uff01\uff01&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">success_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 删除成功的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h3 id="PLogWindow-py"><a href="#PLogWindow-py" class="headerlink" title="PLogWindow.py"></a>PLogWindow.py</h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5 <span class="token keyword">import</span> QtCore<span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">741</span><span class="token punctuation">,</span> <span class="token number">561</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget <span class="token operator">=</span> QTableWidget<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"tableWidget"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">571</span><span class="token punctuation">,</span> <span class="token number">501</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">connect_database</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 连接数据库</span>        <span class="token keyword">import</span> pymysql        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>            port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>            user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>            password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span>            database<span class="token operator">=</span><span class="token string">"classDesign"</span><span class="token punctuation">,</span>            charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true"># 编码千万不要加 -</span>            autocommit<span class="token operator">=</span><span class="token boolean">True</span>        <span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 连接数据库</span>        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 产生一个游标对象（cmd 的 光标）,帮助执行命令</span>        <span class="token keyword">return</span> cursor    <span class="token keyword">def</span> <span class="token function">load</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>connect_database<span class="token punctuation">(</span><span class="token punctuation">)</span>        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">'select * from log'</span><span class="token punctuation">)</span>        rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>        row <span class="token operator">=</span> cursor<span class="token punctuation">.</span>rowcount  <span class="token comment" spellcheck="true"># 取得记录个数，用于设置表格的行数</span>        <span class="token comment" spellcheck="true"># print(rows[0].keys())</span>        col <span class="token operator">=</span> len<span class="token punctuation">(</span>rows<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 取得字段数，用于设置表格的列数</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setRowCount<span class="token punctuation">(</span>row<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setColumnCount<span class="token punctuation">(</span>col<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(rows)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> range<span class="token punctuation">(</span>col<span class="token punctuation">)</span><span class="token punctuation">:</span>                temp_data <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 临时记录，不能直接插入表格</span>                data <span class="token operator">=</span> QTableWidgetItem<span class="token punctuation">(</span>str<span class="token punctuation">(</span>temp_data<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换后可插入表格</span>                <span class="token comment" spellcheck="true"># data = data.setGeometry(QRect(70, 30, 661, 501))</span>                self<span class="token punctuation">.</span>tableWidget<span class="token punctuation">.</span>setItem<span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">log_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 打开日志的页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h2 id="一些小-Bug"><a href="#一些小-Bug" class="headerlink" title="一些小 Bug"></a>一些小 Bug</h2><ol><li>用户登录成功后会展示该系统有的信息，但<em><strong>如果职员没有记录在部门或是项目中就不会显示，比如说初始数据中的盖亚就不会显示</strong></em></li><li><em><strong>按理来说管理员应该有注销普通用户或是有修改普通用户密码的权力，但由于时间关系并没有实现</strong></em></li><li>查询信息时，虽然可以按照职员名称、项目名称、部门名称进行查询，但<em><strong>如果该部门（或是项目）下没有任何职员，那么该系统会显示“该条信息不存在”</strong></em></li><li><em><strong>日志表会出现 username 为 Null 的情况，这时候操作的用户应该是上面最近登录的用户（因为是单线程）</strong></em>，出现这样的情况是因为进行 窗口信号传参的时候逻辑上并没有理清楚，加上对 pyqt5 信号操作还不太明白，就选择这样一种取巧、折中的方式实现该功能。</li></ol><p>除了上述已列出的问题之外，应该还存在其他的不足和 Bug，如果大家有发现，请告知。</p><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><p><img src="https://img-blog.csdnimg.cn/943e878ec77543749b8dba1d289d7b07.gif"><br><img src="https://img-blog.csdnimg.cn/c147294eb16d445a9402553adfdafaad.gif"></p><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>该项目相关代码已上传至 github 留作纪念 <a href="https://github.com/New-Ass/SmallDataBaseProject">SmallDataBaseProject</a></p>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
            <tag> PyQt5 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（8） -- mysql 内容补充</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-8-mysql-nei-rong-bu-chong/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-8-mysql-nei-rong-bu-chong/</url>
      
        <content type="html"><![CDATA[<h1 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h1><pre class=" language-python"><code class="language-python">什么是视图？    视图就是通过查询得到一张虚拟表，然后保存，下次可以直接使用    为什么要用视图？    如果要频繁的操作一张虚拟表（拼表组成），可以制作成视图，然后继续操作    <span class="token comment" spellcheck="true"># 语法</span>create view 视图名 <span class="token keyword">as</span> 虚拟表的查询sql语句<span class="token comment" spellcheck="true"># 举例</span>create view emp2dep <span class="token keyword">as</span> select <span class="token operator">*</span> <span class="token keyword">from</span> emp inner join dep on emp<span class="token punctuation">.</span>dep <span class="token operator">=</span> dep<span class="token punctuation">.</span>id<span class="token punctuation">;</span>注意    视图在保存时只会有表结果，没有数据（数据还是来自于之前的表）    视图一般只用来查询，里面的数据不需要修改，可能会影响真正的表    视图使用频率    使用不多，    当你创建了很多视图时，会造成表的维护困难</code></pre><h1 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h1><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''在满足对表数据进行增、删、改的情况下自动触发的功能使用触发器可以帮助我们实现监控、日志...触发器可以在 6 中情况下自动触发 增、删、改的前后'''</span>基本语法    create trigger 触发器的名字 before<span class="token operator">/</span>after insert<span class="token operator">/</span>update<span class="token operator">/</span>delete on 表名 <span class="token keyword">for</span> each row begin sql语句 end<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># 具体使用 针对触发器的名字 我们需要做到 见名知意</span>create trigger tri_before_insert_ti before insert on t1 <span class="token keyword">for</span> each row begin sql语句 end<span class="token punctuation">;</span>修改 MySQL 默认的语句结束符，只作用于当前窗口    delimiter $$  <span class="token comment" spellcheck="true"># 将默认的结束符号改为 $$</span>    delimiter <span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># 案例(类似于错误日志功能)</span>create table cmd<span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    user char<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    priv char<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    cmd char<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    sub_time datetime<span class="token punctuation">,</span>    success enum<span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">,</span> <span class="token string">"no"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 0代表执行失败</span><span class="token punctuation">)</span><span class="token punctuation">;</span>create table errlog<span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    err_cmd char<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    err_time datetime<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token triple-quoted-string string">'''当 cmd 表中记录的 success 字段是 no 那么就触发器的执行去 errlog 表中注入数据NEW 指代的就是一条条数据对象'''</span>delimiter $$create trigger tri_insert_after_cmd after insert on cmd <span class="token keyword">for</span> each rowbegin     <span class="token keyword">if</span> NEW<span class="token punctuation">.</span>success <span class="token operator">=</span> <span class="token string">"no"</span> then        insert into errlog<span class="token punctuation">(</span>err_cmd<span class="token punctuation">,</span> err_time<span class="token punctuation">)</span> values <span class="token punctuation">(</span>NEW<span class="token punctuation">.</span>cmd<span class="token punctuation">,</span> NEW<span class="token punctuation">.</span>sub_time<span class="token punctuation">)</span><span class="token punctuation">;</span>    end <span class="token keyword">if</span><span class="token punctuation">;</span>end $$delimiter <span class="token punctuation">;</span><span class="token comment" spellcheck="true"># 到 cmd 表插入数据</span>insert into cmd <span class="token punctuation">(</span>    user<span class="token punctuation">,</span>    priv<span class="token punctuation">,</span>    cmd<span class="token punctuation">,</span>    sub_time<span class="token punctuation">,</span>    success<span class="token punctuation">)</span>values    <span class="token punctuation">(</span><span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"0755"</span><span class="token punctuation">,</span> <span class="token string">"ls -1 /etc"</span><span class="token punctuation">,</span> NOW<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"0755"</span><span class="token punctuation">,</span> <span class="token string">"cat /etc/password"</span><span class="token punctuation">,</span> NOW<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"0755"</span><span class="token punctuation">,</span> <span class="token string">"useradd xxx"</span><span class="token punctuation">,</span> NOW<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"0755"</span><span class="token punctuation">,</span> <span class="token string">"ps aux"</span><span class="token punctuation">,</span> NOW<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true"># 删除触发器</span>drop trigger tri_insert_after_cmd<span class="token punctuation">;</span></code></pre><p><img src="https://img-blog.csdnimg.cn/7e01fcd921fe4388af6529eb35265aa4.gif"></p><h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><pre class=" language-python"><code class="language-python">什么是事务    开启一个事务可以包含多条SQL语句，这些 sql 语句要么同时成功，要么一个都别想成功，称之为事务的原子性    事务的作用    保证了对数据操作的安全性    事务的四大特性（ACID）A：原子性    一个事务是一个不可分割的单位，事务中包含的诸多操作，要么同时成功，要么同时失败    C<span class="token punctuation">:</span> 一致性    事务必须是使数据库从一个一致性的状态转变为另一个一致性的状态    I： 隔离性    一个事务的执行不能被其他事务干扰，    即一个事物内部的操作及使用的数据对并发的其他事务是隔离的，并发执行的事务之间也是互相不干扰的    D： 持久性    也叫永久性    一个事务一旦执行成功，对数据库数据的修改应该是永久的，接下来的其他操作或者故障不应该对齐有任何的影响    如何使用事务<span class="token number">1</span><span class="token punctuation">.</span> 关键字start transaction<span class="token punctuation">;</span><span class="token number">2</span><span class="token punctuation">.</span> 回滚操作，回到事务执行之前的状态rollback<span class="token punctuation">;</span><span class="token number">3</span><span class="token punctuation">.</span> 二次确认，确认之后无法回滚commit<span class="token punctuation">;</span><span class="token string">"模拟转账"</span>create table user<span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    name char<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    balance int<span class="token punctuation">)</span><span class="token punctuation">;</span>insert into user<span class="token punctuation">(</span>name<span class="token punctuation">,</span> balance<span class="token punctuation">)</span> values<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"># 先开启事务</span>start transaction<span class="token punctuation">;</span><span class="token comment" spellcheck="true"># 多条 sql 语句</span>update user set balance<span class="token operator">=</span><span class="token number">900</span> where name <span class="token operator">=</span> <span class="token string">"a"</span><span class="token punctuation">;</span>update user set balance<span class="token operator">=</span><span class="token number">1010</span> where name <span class="token operator">=</span> <span class="token string">"b"</span><span class="token punctuation">;</span>update user set balance<span class="token operator">=</span><span class="token number">1090</span> where name <span class="token operator">=</span> <span class="token string">"c"</span><span class="token punctuation">;</span>rollback<span class="token punctuation">;</span>commit<span class="token punctuation">;</span></code></pre><h1 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h1><pre class=" language-mysql"><code class="language-mysql">类似于 python 中的 自定义函数 内部包含一系列可以执行的 sql 语句，存储过程存放于 Mysql 服务端中，可以直接使用触发sql语句执行  delimiter $$  create procedure 存储过程的名字(形参1, 形参2) begin     sql 语句 end  delimiter ;  call 存储过程的名字();  三种开发模式     1. 应用程序程序员写代码开发，MySQL 提前编写存储过程，供应用程序调用——（优势）提升开发效率，执行效率提升；（缺点）考虑到人为元素、跨部门沟通的问题，后续存储的过程的扩展性差          2. 应用程序：程序员写代码开发之外，数据库操作也自己写——（优势）扩展性高；（缺点）开发效率降低，编写sql语句太过繁琐，还需要考虑sql优化的问题          3. 应用程序只写代码，不写sql语句，基于别人写好的MySQL的python框架（ORM框架）直接操作即可——（优势）开发效率高；（缺点）因为由别人封装，语句的扩展性差，可能会出现效率低下的问题</code></pre><h2 id="存储过程演示"><a href="#存储过程演示" class="headerlink" title="存储过程演示"></a>存储过程演示</h2><pre class=" language-mysql"><code class="language-mysql">delimiter $$create procedure d1(    in m int, # 只进不出， m 不能返回出去    in n int,    out res int # 此形参可以返回出去)begin    select * from emp where id > m and age > n;    set res=0; # 将 res 变量修改，用来标识当前存储过程代码确实执行end$$delimiter ;call d1(1, 28, 10); # 报错# 针对 形参 res 不能直接传数据 应该传一个变量名# 定义变量set @ret = 10;# 查看变量的值select @ret;call d1(1, 28, @ret)</code></pre><h2 id="在pyMySQL模块中如何调用"><a href="#在pyMySQL模块中如何调用" class="headerlink" title="在pyMySQL模块中如何调用"></a>在pyMySQL模块中如何调用</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pymysql<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token comment" spellcheck="true"># 调用存储过程</span>cursor<span class="token punctuation">.</span>callproc<span class="token punctuation">(</span>d1<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><pre class=" language-mysql"><code class="language-mysql">跟存储过程是有区别的，相当于存储过程是自定义函数，函数是内置函数比如说： NOW()create table blog(    id int primary key auto_increment,    name char(32),    sub_time datetime);insert into blog(name, sub_time)values    ("第1篇", "2015-03-01 11:31:21"),    ("第2篇", "2015-03-11 16:31:21"),    ("第3篇", "2016-07-01 10:21:21"),    ("第4篇", "2016-07-22 09:23:21"),    ("第5篇", "2016-07-23 10:11:11"),    ("第6篇", "2016-07-25 11:21:31"),    ("第7篇", "2017-03-01 15:33:21"),    ("第8篇", "2017-03-01 17:32:21"),    ("第9篇", "2017-03-01 18:31:21");    select date_format(sub_time, "%Y-%m"), count(id) from blog group by date_format(sub_time, "%Y-%m");</code></pre><p><img src="https://img-blog.csdnimg.cn/5298233c789045b7a97fb494bc30c624.gif"></p><h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># if 判断</span>delimiter <span class="token operator">//</span>create procedure proc_if<span class="token punctuation">(</span><span class="token punctuation">)</span>begin    declare i int defalut <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> i<span class="token operator">=</span><span class="token number">1</span> then        select <span class="token number">1</span><span class="token punctuation">;</span>    elseif i <span class="token operator">=</span><span class="token number">2</span> then        select <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token keyword">else</span>        select <span class="token number">7</span><span class="token punctuation">;</span>    end <span class="token keyword">if</span><span class="token punctuation">;</span>end <span class="token operator">//</span>delimiter <span class="token punctuation">;</span><span class="token comment" spellcheck="true"># while 循环</span>delimiter <span class="token operator">//</span>create procedure proc_while<span class="token punctuation">(</span><span class="token punctuation">)</span>begin    declare num int <span class="token punctuation">;</span>    set num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">while</span> num <span class="token operator">&lt;</span> <span class="token number">10</span> do        select             num<span class="token punctuation">;</span>        set num <span class="token operator">=</span> num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>    end <span class="token keyword">while</span><span class="token punctuation">;</span>end <span class="token operator">//</span> delimiter <span class="token punctuation">;</span></code></pre><h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><pre class=" language-python"><code class="language-python">数据都是存在于硬盘上的，查询数据不可避免地需要 IO操作索引：就是一种数据结构，类似于书的目录。意味着在查询数据的时候先找目录再找数据，从而提升查询速度而降低IO操作索引在MySQL中也叫“键”，是存储引擎快速查找记录的一种数据结构（innodb，）primary keyunique keyindex key注意 foreign key 不是用来加速查询用的上面的三种 key，前面两种除了增加查询速度各自还具有约束条件，而 index key 没有任何约束条件，只是用来帮助你快速查询数据本质    不断缩小想要的数据范围筛选出最终的结果，同时将随机事件（一页一页的翻）变成顺序事件（先找目录、找数据）    也就是说有了索引数据，我们可以总是用一中固定的方式查找数据    一张表中可以有多个索引（多个目录），比如说新华字典既可以用部首查，也可以用拼音查。索引虽然可以帮助你加快查询速度，也存在缺点<span class="token number">1</span><span class="token punctuation">.</span> 当表中有大量数据的前提下，创建索引速度会很慢<span class="token number">2</span><span class="token punctuation">.</span> 在索引创建完毕后，对表的查询性能大幅度提升，但是写的性能也会大幅度的降低索引不要随意的创建！！！</code></pre><h2 id="b-树"><a href="#b-树" class="headerlink" title="b+树"></a>b+树</h2><p><img src="https://img-blog.csdnimg.cn/2767eeb53312463c84fb6f9172049487.png"></p><pre class=" language-python"><code class="language-python">只有叶子节点是真实的数据，其他节点存放的数据是虚拟的数据，仅用来指路树的层级越高查询数据所需要经历的步骤越多（树有几层，查询数据就要几层）一个磁盘块存储是有限制的，在存储的时候希望存储的数据越大越好，所以推荐 id 作为主键，因为 整型占据的空间小一个磁盘块存储的数据多，降低了树的高度，从而减少查询次数</code></pre><h2 id="聚集索引-primary-key"><a href="#聚集索引-primary-key" class="headerlink" title="聚集索引(primary key)"></a>聚集索引(primary key)</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 聚集索引就是 主键</span><span class="token triple-quoted-string string">'''innodb  只有两个文件 直接将主键 存储在数据表（idb）MyIsam  三个文件 单独将搜因存在一个文件'''</span></code></pre><h2 id="辅助索引（unique-key）"><a href="#辅助索引（unique-key）" class="headerlink" title="辅助索引（unique key）"></a>辅助索引（unique key）</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''查询数据的时候不可能一直使用到主键吗，也有可能用到其他字段，没有办法利用聚集索引，这个时候剋以根据给其他去字段设置辅助索引（也是 b+树）辅助索引叶子节点存储的是数据对应的主键值    先按照辅助索引拿到数据的主键值    之后还是需要去主键的聚集索引里面查询数据'''</span></code></pre><h2 id="覆盖索引"><a href="#覆盖索引" class="headerlink" title="覆盖索引"></a>覆盖索引</h2><p>在辅助索引的叶子节点就已经拿到了需要的数据</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 给 name 设置辅助索引</span>select name <span class="token keyword">from</span> user where name <span class="token operator">=</span> <span class="token string">"aoteman"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"># 非覆盖索引</span>select age <span class="token keyword">from</span> user where name <span class="token operator">=</span> <span class="token string">"aoteman"</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（7） -- pymysql简单介绍</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-7-pymysql-jian-dan-jie-shao/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-7-pymysql-jian-dan-jie-shao/</url>
      
        <content type="html"><![CDATA[<h1 id="pymysql-基本语法及游标移动"><a href="#pymysql-基本语法及游标移动" class="headerlink" title="pymysql 基本语法及游标移动"></a>pymysql 基本语法及游标移动</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> pymysqlconn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>    host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 端口</span>    port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>    user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">,</span>    password<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 密码，该参数可以简写成 passwd=</span>    database<span class="token operator">=</span><span class="token string">"test"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 连接的库的名称</span>    charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 读取数据时的编码，一定不要加 “-”</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># cousor = conn.cursor() # 生成游标，类似于 cmd 中的光标</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># sql = "select * from dep"</span><span class="token triple-quoted-string string">"""+------+--------------+| id   | name         |+------+--------------+|  200 | 技术         ||  201 | 人力资源     ||  202 | 销售         ||  203 | 运营         ||  205 | sale         |+------+--------------+"""</span><span class="token comment" spellcheck="true"># res = cousor.execute(sql)</span><span class="token comment" spellcheck="true"># print(res) # 5  打印的是该 sql 命令影响的数据的行数</span><span class="token comment" spellcheck="true"># print(cousor.fetchone()) # 拿其中一条数据，元组形式。</span><span class="token comment" spellcheck="true"># 而实际上我们更希望拿出的数据是 字典形式</span>cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span>sql <span class="token operator">=</span> <span class="token string">"select * from dep"</span><span class="token triple-quoted-string string">"""+------+--------------+| id   | name         |+------+--------------+|  200 | 技术         ||  201 | 人力资源     ||  202 | 销售         ||  203 | 运营         ||  205 | sale         |+------+--------------+"""</span>res <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 5  打印的是该 sql 命令影响的数据的行数</span><span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 拿其中一条数据，此时是 字典形式。</span><span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 执行该命令，拿到的表中第二条数据，原因是因为在第一次执行该命令时，游(光)标 从第一条数据的位置移动到了 第二条数据 的位置，所以此时拿到的是第二条数据，同时游标移动到了第三条数据的位置</span><span class="token comment" spellcheck="true"># 光标的移动</span>cursor<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"relative"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 相对当前位置往后移动一条数据，即 游标来到了第四条数据</span><span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 第四条数据</span>cursor<span class="token punctuation">.</span>scroll<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"absolute"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 从头往后移动 一条数据</span><span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 拿所有数据，由于此时 游标在第二条数据上，所以只能拿到四条数据</span></code></pre><h1 id="sql-注入以及解决方法"><a href="#sql-注入以及解决方法" class="headerlink" title="sql 注入以及解决方法"></a>sql 注入以及解决方法</h1><h2 id="sql-注入"><a href="#sql-注入" class="headerlink" title="sql 注入"></a>sql 注入</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 在 test 库中先创建一张 user 表</span>create table user <span class="token punctuation">(</span>    id int primary key auto_increment<span class="token punctuation">,</span>    name char<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    password varchar<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>insert into user<span class="token punctuation">(</span>name<span class="token punctuation">,</span> password<span class="token punctuation">)</span> values<span class="token punctuation">(</span><span class="token string">"aoteman"</span><span class="token punctuation">,</span> <span class="token string">"asd"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">"alterman"</span><span class="token punctuation">,</span> <span class="token string">"asdzxc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">import</span> pymysqlconn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>    host<span class="token operator">=</span><span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>    port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>    database<span class="token operator">=</span><span class="token string">"test"</span><span class="token punctuation">,</span>    user<span class="token operator">=</span><span class="token string">"root"</span><span class="token punctuation">,</span>    passwd<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 数据库密码</span>    charset<span class="token operator">=</span><span class="token string">"utf8"</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""+----+----------+----------+| id | name     | password |+----+----------+----------+|  1 | aoteman  | asd      ||  2 | alterman | asdzxc   |+----+----------+----------+"""</span>cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 简易登录验证</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"username：>>"</span><span class="token punctuation">)</span>    password <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"password：>>"</span><span class="token punctuation">)</span>    sql <span class="token operator">=</span> <span class="token string">"select * from user where name='%s' and password='%s' "</span> <span class="token operator">%</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="正常登录情况"><a href="#正常登录情况" class="headerlink" title="正常登录情况"></a>正常登录情况</h3><p><img src="https://img-blog.csdnimg.cn/d194ed0f6a074f669720d93c01be7c79.gif"></p><h3 id="非正常登录情况"><a href="#非正常登录情况" class="headerlink" title="非正常登录情况"></a>非正常登录情况</h3><p><img src="https://img-blog.csdnimg.cn/f57dfb62a8fd41d9ab8b73066f61d5aa.gif"></p><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''在上述演示的非正常登陆情况下，我们发现    一种是只知道 用户名就可以实现登录，并且该登录用户的返回密码    一种是不知道账号和密码的情况下，完成登录，并且获取所有用户的用户名和密码'''</span>我们在分析 mysql 在上述两种情况中执行的代码分别是    select <span class="token operator">*</span> <span class="token keyword">from</span> user where name<span class="token operator">=</span><span class="token string">'aoteman'</span><span class="token comment" spellcheck="true">#' and password='' </span>    select <span class="token operator">*</span> <span class="token keyword">from</span> user where name<span class="token operator">=</span><span class="token string">''</span> <span class="token operator">or</span> <span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span> <span class="token comment" spellcheck="true">#' and password='' </span>    分析执行的 sql 语句我们会发现这些非正常登录的情况是因为 用户巧妙运用了 mysql 的逻辑运算（<span class="token operator">or</span>）和 注释符号 “<span class="token comment" spellcheck="true">#” 使得部分代码虽然存在但不执行，从而跳过了密码验证和用户名验证</span>数据库注入情况是比较常见的，比如说我们在注册一些账户的时候，会要求我们的用户名和密码不能包含一些特殊符号就是为了防止注入的情况出现。</code></pre><h2 id="sql-注入的解决方法"><a href="#sql-注入的解决方法" class="headerlink" title="sql 注入的解决方法"></a>sql 注入的解决方法</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 第一种方法就是在用户注册时明确不能包含特殊符号（适用性较差）</span><span class="token comment" spellcheck="true"># 第二种方法使用，pymysql 模块提供的方法</span>sql <span class="token operator">=</span> <span class="token string">"select * from user where name=%s and password=%s "</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">)</span>在演示中我们可以看到按照这种方法可以比较简单的避免 sql 注入的情况出现</code></pre><p><img src="https://img-blog.csdnimg.cn/03087f577b4a4bdc90c444d69a111c47.gif"></p><h1 id="pymysql补充内容"><a href="#pymysql补充内容" class="headerlink" title="pymysql补充内容"></a>pymysql补充内容</h1><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">'''增删改查中    删、改、增它们的操作涉及到数据的更改，没有办法直接执行，需要二次确认'''</span><span class="token comment" spellcheck="true"># 执行多条 sql 语句</span>rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>executemany<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"sekiro"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"ash"</span><span class="token punctuation">,</span> <span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">import</span> pymysqlconn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>    host <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>    port <span class="token operator">=</span> <span class="token number">3306</span><span class="token punctuation">,</span>    user <span class="token operator">=</span> <span class="token string">"root"</span><span class="token punctuation">,</span>    password <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">,</span>    charset <span class="token operator">=</span> <span class="token string">"utf8"</span><span class="token punctuation">,</span>    database <span class="token operator">=</span> <span class="token string">"test518"</span><span class="token punctuation">,</span>    autocommit <span class="token operator">=</span> <span class="token boolean">True</span> <span class="token comment" spellcheck="true"># 自动提交</span><span class="token punctuation">)</span>cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span>cursor <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 增加数据</span>sql <span class="token operator">=</span> <span class="token string">"insert into user(name, password) values(%s, %s)"</span><span class="token comment" spellcheck="true"># rows = cursor.execute(sql, ("sekiro", "123"))</span><span class="token comment" spellcheck="true"># 执行多条 sql 语句</span>rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>executemany<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"sekiro"</span><span class="token punctuation">,</span> <span class="token string">"123"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"ash"</span><span class="token punctuation">,</span> <span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># conn.commit() # 确认</span><span class="token comment" spellcheck="true"># 修改</span>sql <span class="token operator">=</span> <span class="token string">"update user set name='ash' where id = 1"</span>rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># conn.commit() # 确认</span><span class="token comment" spellcheck="true"># 删</span>sql <span class="token operator">=</span> <span class="token string">"delete from user where id = 1"</span>rows <span class="token operator">=</span> cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（6） -- 表查询关键词</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-6-biao-cha-xun-guan-jian-ci/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-6-biao-cha-xun-guan-jian-ci/</url>
      
        <content type="html"><![CDATA[<h1 id="前期表准备"><a href="#前期表准备" class="headerlink" title="前期表准备"></a>前期表准备</h1><pre class=" language-mysql"><code class="language-mysql"># 如果cmd窗口展示数据时，窗口最大，展示数据的虚表仍有错位，应使用 \G 分行显示select * from t1\G;# 个别电脑在插入中文的时候会出现乱码或者空白的现象，可以将字符编码统一设置成 gbkcreate table emp (    id int primary key auto_increment,    name varchar(20) not null,    sex enum("male", "female", "other") default "male", # 大部分是男的    age int unsigned not null default 28,    hire_date date not null,    post varchar(50),    post_comment varchar(100),    salary double(15, 2),    office int,    depart_id int);# 插入记录# 三个部门：教学，销售，运营insert into emp(name, sex, age, hire_date, post, salary, office, depart_id) values("jason", "male", 18, "20170301", "奥特曼", 7300.33, 401, 1), # 以下是教学部("tom", "male", 78, "20150302", "teacher", 1000000.31, 401, 1),("kevin", "male", 81, "20130305", "teacher", 8300, 401, 1),("tony", "male", 73, "20140701", "teacher", 3500, 401, 1),("owen", "male", 28, "20121101", "teacher", 2100, 401, 1),("jack", "female", 18, "20110211", "teacher", 9000, 401, 1),("jenny", "male", 18, "19000301", "teacher", 30000, 401, 1),("sank", "male", 48, "20101111", "teacher", 10000, 401, 1),("哈哈", "female", 48, "20150311", "sale", 3000.13, 402, 2), # 以下是销售部门("呵呵", "female", 38, "20101101", "sale", 2000.35, 402, 2),("西西", "female", 18, "20110312", "sale", 1000.37, 402, 2),("乐乐", "female", 18, "20160513", "sale", 3000.29, 402, 2),("拉拉", "female", 28, "20170127", "sale", 4000.33, 402, 2),("僧龙", "male", 28, "20160311", "opeartion", 10000.13, 403, 3), # 以下是运营部("程咬金", "male", 18, "19970312", "opeartion", 20000, 403, 3),("程咬银", "female", 18, "20130311", "opeartion", 19000, 403, 3),("程咬铜", "male", 18, "20150411", "opeartion", 18000, 403, 3),("程咬铁", "female", 18, "20140512", "opeartion", 17000.13, 403, 3)；</code></pre><h1 id="几个关键字的执行顺序"><a href="#几个关键字的执行顺序" class="headerlink" title="几个关键字的执行顺序"></a>几个关键字的执行顺序</h1><pre class=" language-mysql"><code class="language-mysql"># 书写顺序(英语语法)select id,name from emp where id > 3;# 执行顺序fromwhereselect# 执行顺序和书写顺序不一致，就按照书写顺序写 sql    select * 先用 * 来占位    之后补全后面的 sql 语句    最后将 * 号替换成想要的具体字符</code></pre><h1 id="where过滤"><a href="#where过滤" class="headerlink" title="where过滤"></a>where过滤</h1><pre class=" language-mysql"><code class="language-mysql"># 作用：对整体数据的一个筛选操作（可以理解为 python 中的 if）# 查询 id 大于等于 3 小于等于 6 的数据select id,name,age from emp where id >= 3 and id <= 6;select id,name,age from emp where id between 3 and 6; # 两种等价+----+-------+-----+| id | name  | age |+----+-------+-----+|  3 | kevin |  81 ||  4 | tony  |  73 ||  5 | owen  |  28 ||  6 | jack  |  18 |+----+-------+-----+# 查询薪资是 20000 或 18000 或 17000 的数据select id, name, salary from emp where salary = 20000 or salary = 18000 or salary = 17000;select id, name, salary from emp where salary in (20000, 18000, 17000);+----+-----------+----------+| id | name      | salary   |+----+-----------+----------+| 15 | 程咬金    | 20000.00 || 17 | 程咬铜    | 18000.00 |+----+-----------+----------+# 查询员工姓名中包含字母 o 的员工的姓名和薪资select name, salary from emp where name like "%o%";+-------+------------+| name  | salary     |+-------+------------+| jason |    7300.33 || tom   | 1000000.31 || tony  |    3500.00 || owen  |    2100.00 |+-------+------------+# 查询员工姓名是由 4 个字符组成的 姓名和薪资select name, salary from emp where name like "____";select name, salary from emp where char_length(name) = 4;+------+----------+| name | salary   |+------+----------+| tony |  3500.00 || owen |  2100.00 || jack |  9000.00 || sank | 10000.00 |+------+----------+# 查询薪资不在 20000，18000，17000范围的数据select * from emp where salary not in (20000, 18000, 17000);# 查询岗位描述的为空的员工姓名和岗位，针对 null 不能用等号，用 isselect name,post from emp where post_comment is Null;</code></pre><h1 id="group-by-分组"><a href="#group-by-分组" class="headerlink" title="group by 分组"></a>group by 分组</h1><pre class=" language-mysql"><code class="language-mysql"># 实际应用场景     分组应用场景非常多    男女比例    部门平均薪资    部门秃头率    国家之间数据统计    # 按照部门分组select * from emp group by post;# 分组之后最小的可操作单位是组  而不是组内的单个数据# 上述命令在你没有设置严格模式可正常执行，返回的分组之后每组的第一条数据 但是浙不符合分组的规范——分组之后不应该考虑单个数据而应该以组位操作单位（分组之后没办法获取组内单个数据）# 如果设置了严格模式，会直接报错set global sql_mode = "strict_trans, only_full_group_by";# 设置严格模式之后，分组默认只能拿到分组的依据select post from emp group by post;+-----------+| post      |+-----------+| opeartion || sale      || teacher   || 奥特曼    |+-----------+# 按照什么字段分组就只能拿到分组 其他字段不能直接获取 需要借助于其他方法# 什么时候需要分组 —— 每个，平均，最高，最低# 1. 获取每个部门的最高薪资select post, max(salary) from emp group by post;+-----------+-------------+| post      | max(salary) |+-----------+-------------+| opeartion |    20000.00 || sale      |     4000.33 || teacher   |  1000000.31 || 奥特曼    |     7300.33 |+-----------+-------------+# 可以使用 as 给字段起别名，也可以省略不写，但是不推荐不写，因为省略之后语义不明，容易错乱select post as "部门", max(salary) as "最高薪资" from emp group by post;+-----------+--------------+| 部门      | 最高薪资     |+-----------+--------------+| opeartion |     20000.00 || sale      |      4000.33 || teacher   |   1000000.31 || 奥特曼    |      7300.33 |+-----------+--------------+# 获取每个部门的最低薪资select post as "部门", min(salary) as "最低薪资" from emp group by post;+-----------+--------------+| 部门      | 最低薪资     |+-----------+--------------+| opeartion |     10000.13 || sale      |      1000.37 || teacher   |      2100.00 || 奥特曼    |      7300.33 |+-----------+--------------+# 获取每个部门的薪资总和select post as "部门", sum(salary) as "薪资总和" from emp group by post;+-----------+--------------+| 部门      | 薪资总和     |+-----------+--------------+| opeartion |     84000.26 || sale      |     13001.47 || teacher   |   1062900.31 || 奥特曼    |      7300.33 |+-----------+--------------+# 统计每个部门的人数select post as "部门", count(id) as "总人数" from emp group by post; # 常用 id 进行统计+-----------+-----------+| 部门      | 总人数    |+-----------+-----------+| opeartion |         5 || sale      |         5 || teacher   |         7 || 奥特曼    |         1 |+-----------+-----------+select post as "部门", count(post_comment) as "总人数" from emp group by post; # 对 Null 无法计数# 聚合函数——max，min，avg，sum，count# group_concat 不仅支持获取分组后的其他字段值，还支持拼接操作# 查询分组之后的部门名称和每个部门下所有的员工姓名select post as "部门", group_concat(name) as "员工名称" from emp group by post;+-----------+------------------------------------------------+| 部门      | 员工名称                                       |+-----------+------------------------------------------------+| opeartion | 僧龙,程咬金,程咬银,程咬铜,程咬铁               || sale      | 哈哈,呵呵,西西,乐乐,拉拉                       || teacher   | tom,kevin,tony,owen,jack,jenny,sank            || 奥特曼    | jason                                          |+-----------+------------------------------------------------+select post as "部门", group_concat(name, "：", salary) as "各个员工工资" from emp group by post\G;*************************** 1. row ***************************            部门: opeartion各个员工工资: 僧龙：10000.13,程咬金：20000.00,程咬银：19000.00,程咬铜：18000.00,程咬铁：17000.13*************************** 2. row ***************************            部门: sale各个员工工资: 哈哈：3000.13,呵呵：2000.35,西西：1000.37,乐乐：3000.29,拉拉：4000.33*************************** 3. row ***************************            部门: teacher各个员工工资: tom：1000000.31,kevin：8300.00,tony：3500.00,owen：2100.00,jack：9000.00,jenny：30000.00,sank：10000.00*************************** 4. row ***************************            部门: 奥特曼各个员工工资: jason：7300.33# concat 可以在不分组的情况下使用select concat("Name：", name), concat("SAL：", salary) from emp;+-------------------------+--------------------------+| concat("Name：", name)  | concat("SAL：", salary)  |+-------------------------+--------------------------+| Name：jason             | SAL：7300.33             || Name：tom               | SAL：1000000.31          || Name：kevin             | SAL：8300.00             || Name：tony              | SAL：3500.00             || Name：owen              | SAL：2100.00             || Name：jack              | SAL：9000.00             || Name：jenny             | SAL：30000.00            || Name：sank              | SAL：10000.00            || Name：哈哈              | SAL：3000.13             || Name：呵呵              | SAL：2000.35             || Name：西西              | SAL：1000.37             || Name：乐乐              | SAL：3000.29             || Name：拉拉              | SAL：4000.33             || Name：僧龙              | SAL：10000.13            || Name：程咬金            | SAL：20000.00            || Name：程咬银            | SAL：19000.00            || Name：程咬铜            | SAL：18000.00            || Name：程咬铁            | SAL：17000.13            |+-------------------------+--------------------------+# 查询每个人的年薪（12薪）select name, salary*12 from emp;</code></pre><h2 id="分组注意事项"><a href="#分组注意事项" class="headerlink" title="分组注意事项"></a>分组注意事项</h2><pre class=" language-mysql"><code class="language-mysql"># 关键词 where 和 group by 同时出现的时候 group by 必须在 where 的后面——where 先对整体数据过滤再进行分组# 聚合函数只能在分组之后使用，即 where 筛选田间不能使用聚合函数select name from emp where max(salary) > 3000; # 报错select max(salary) from emp; # 不分组默认整体是一个分组+-------------+| max(salary) |+-------------+|  1000000.31 |+-------------+# 统计各部门年龄在 30 岁以上的员工平均薪资select post as "部门", avg(salary) as "平均薪资" from emp where age > 30 group by post;+---------+---------------+| 部门    | 平均薪资      |+---------+---------------+| sale    |   2500.240000 || teacher | 255450.077500 |+---------+---------------+</code></pre><h1 id="having-分组之后的筛选条件"><a href="#having-分组之后的筛选条件" class="headerlink" title="having 分组之后的筛选条件"></a>having 分组之后的筛选条件</h1><pre class=" language-mysql"><code class="language-mysql"># having 的语法和 where 是一致的，只不过 having 是在分组之后进行的过滤操作，即 having 是可以直接使用聚合函数的# 统计各部门年龄在 30岁以上的员工平均薪资并且保留平均薪资大于 10000 的部门select post as "部门", avg(salary) as "平均薪资" from emp where age > 30 group by post having avg(salary) > 10000;+---------+---------------+| 部门    | 平均薪资      |+---------+---------------+| teacher | 255450.077500 |+---------+---------------+</code></pre><h1 id="distinct-去重"><a href="#distinct-去重" class="headerlink" title="distinct 去重"></a>distinct 去重</h1><pre class=" language-mysql"><code class="language-mysql"># 必须是完全一样的数据才能去重，一定不要忽视主键，存在主键的情况下一定无法去重select distinct id, age from emp;select distinct age from emp;</code></pre><h1 id="order-by-排序"><a href="#order-by-排序" class="headerlink" title="order by 排序"></a>order by 排序</h1><pre class=" language-mysql"><code class="language-mysql">select * from emp order by salary; # 默认升序， asc 可以省略不写，降序 descselect * from emp order by salary desc;select * from emp order by age asc, salary desc; # 先按照 age 升序排序，如果 age 相同再按照 salary 降序排序# 统计各部门年龄在 10 岁以上的员工平均薪资并且保留平均薪资大于 1000 的部门，并对平均工资降序select post as "部门", avg(salary) as "平均薪资" from emp where age > 10 group by post having avg(salary) > 1000 order by avg(salary) desc;+-----------+---------------+| 部门      | 平均薪资      |+-----------+---------------+| teacher   | 151842.901429 || opeartion |  16800.052000 || 奥特曼    |   7300.330000 || sale      |   2600.294000 |+-----------+---------------+</code></pre><h1 id="limit-限制展示条数"><a href="#limit-限制展示条数" class="headerlink" title="limit 限制展示条数"></a>limit 限制展示条数</h1><pre class=" language-mysql"><code class="language-mysql">select * from emp;# 针对数据过多的情况，通常分页处理select name, age, salary from emp limit 3;# 只展示前三条数据+-------+-----+------------+| name  | age | salary     |+-------+-----+------------+| jason |  18 |    7300.33 || tom   |  78 | 1000000.31 || kevin |  81 |    8300.00 |+-------+-----+------------+select name, age, salary from emp limit 0, 5; # 展示第一条到第五条的数据+-------+-----+------------+| name  | age | salary     |+-------+-----+------------+| jason |  18 |    7300.33 || tom   |  78 | 1000000.31 || kevin |  81 |    8300.00 || tony  |  73 |    3500.00 || owen  |  28 |    2100.00 |+-------+-----+------------+select name, age, salary from emp limit 5, 5; # 展示从 第6条开始的五条数据+--------+-----+----------+| name   | age | salary   |+--------+-----+----------+| jack   |  18 |  9000.00 || jenny  |  18 | 30000.00 || sank   |  48 | 10000.00 || 哈哈   |  48 |  3000.13 || 呵呵   |  38 |  2000.35 |+--------+-----+----------+# limit 第一个参数是起始位置，第二个参数是显示数量</code></pre><h1 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h1><pre class=" language-mysql"><code class="language-mysql"># 关键词 regexpselect name, age, salary from emp where name regexp "^j."; # 匹配 j 开头的数据+-------+-----+----------+| name  | age | salary   |+-------+-----+----------+| jason |  18 |  7300.33 || jack  |  18 |  9000.00 || jenny |  18 | 30000.00 |+-------+-----+----------+</code></pre><h1 id="连表操作"><a href="#连表操作" class="headerlink" title="连表操作"></a>连表操作</h1><pre class=" language-mysql"><code class="language-mysql"># 连表create table dep (    id int,    name varchar(20));create table emp(    id int primary key auto_increment,    name varchar(20),    sex enum("male", "female", "other") default "male",    age int,    dep_id int);# 插入数据insert into dep values(200, "技术"),(201, "人力资源"),(202, "销售"),(203, "运营");insert into emp(name, sex, age, dep_id) values("jason", "male", 18, 200),("egon", "female", 48, 201),("kevin", "male", 18 ,201),("nick", "male", 28, 202),("owen", "male", 18, 203),("jerry", "female", 18, 204);</code></pre><h2 id="表查询"><a href="#表查询" class="headerlink" title="表查询"></a>表查询</h2><pre class=" language-mysql"><code class="language-mysql">select * from dep, emp; # 结果 是 笛卡尔积select * from dep,emp where emp.dep_id = dep.id;+------+--------------+----+-------+--------+------+--------+| id   | name         | id | name  | sex    | age  | dep_id |+------+--------------+----+-------+--------+------+--------+|  200 | 技术         |  1 | jason | male   |   18 |    200 ||  201 | 人力资源     |  2 | egon  | female |   48 |    201 ||  201 | 人力资源     |  3 | kevin | male   |   18 |    201 ||  202 | 销售         |  4 | nick  | male   |   28 |    202 ||  203 | 运营         |  5 | owen  | male   |   18 |    203 |+------+--------------+----+-------+--------+------+--------+# MySQL 考虑到使用中会经常使用拼表操作，所以提供了很多方法inner join # 内连接left join # 左连接right join # 右连接union # 全连接select * from emp inner join dep on emp.dep_id = dep.id; # 只拼接两张表中公有的数据部分select * from emp left join dep on emp.dep_id = dep.id; # 左表的所有数据展示，没有对应的填入 null+----+-------+--------+------+--------+------+--------------+| id | name  | sex    | age  | dep_id | id   | name         |+----+-------+--------+------+--------+------+--------------+|  1 | jason | male   |   18 |    200 |  200 | 技术         ||  2 | egon  | female |   48 |    201 |  201 | 人力资源     ||  3 | kevin | male   |   18 |    201 |  201 | 人力资源     ||  4 | nick  | male   |   28 |    202 |  202 | 销售         ||  5 | owen  | male   |   18 |    203 |  203 | 运营         ||  6 | jerry | female |   18 |    204 | NULL | NULL         |+----+-------+--------+------+--------+------+--------------+# right join 和 left join 类似，显示右表所有内容，没有对应数据的填入 null# union 全连接，左右两表的数据全显示insert into dep values(205, "sale");select * from emp left join dep on emp.dep_id = dep.id union select * from emp right join dep on emp.dep_id = dep.id;  +------+-------+--------+------+--------+------+--------------+| id   | name  | sex    | age  | dep_id | id   | name         |+------+-------+--------+------+--------+------+--------------+|    1 | jason | male   |   18 |    200 |  200 | 技术         ||    2 | egon  | female |   48 |    201 |  201 | 人力资源     ||    3 | kevin | male   |   18 |    201 |  201 | 人力资源     ||    4 | nick  | male   |   28 |    202 |  202 | 销售         ||    5 | owen  | male   |   18 |    203 |  203 | 运营         ||    6 | jerry | female |   18 |    204 | NULL | NULL         || NULL | NULL  | NULL   | NULL |   NULL |  205 | sale         |+------+-------+--------+------+--------+------+--------------+</code></pre><h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><pre class=" language-mysql"><code class="language-mysql">"子查询就是我们平时解决问题的思路    分步骤解决问题        第一步        第二步        ...将一个查询语句的结果当作另外一个查询语句的条件去用"# 查询部门是技术或是人力资源的员工信息1. 获取部门的 id 号    select id from dep where name in ("技术", "人力资源");+------+| id   |+------+|  200 ||  201 |+------+2. 查询部门是技术或者人力资源的员工    select name from emp where dep_id in (200, 201);+-------+| name  |+-------+| jason || egon  || kevin |+-------+select name from emp where dep_id in(select id from dep where name in ("技术", "人力资源"));+-------+| name  |+-------+| jason || egon  || kevin |+-------+</code></pre><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><pre class=" language-mysql"><code class="language-mysql">表的查询结果可以作为其他表的查询条件也可以通过起别名的方式把它作为一张虚拟表和其他表进行关联"多表查询    1. 先拼接表再查询    2. 子查询一步一步来"</code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（5） -- 表与表之间的关系以及关于表的操作</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-5-biao-yu-biao-zhi-jian-de-guan-xi-yi-ji-guan-yu-biao-de-cao-zuo/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-5-biao-yu-biao-zhi-jian-de-guan-xi-yi-ji-guan-yu-biao-de-cao-zuo/</url>
      
        <content type="html"><![CDATA[<h1 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h1><h2 id="表与表之间的关系"><a href="#表与表之间的关系" class="headerlink" title="表与表之间的关系"></a>表与表之间的关系</h2><p><img src="https://img-blog.csdnimg.cn/0164ed35719543d78afb5c0a7210e989.png"></p><pre class=" language-mysql"><code class="language-mysql">定义一张员工表  表中有很多字段id     name    gender     dep_name    dep_desc该表的问题    1. 该表的组织结构不是很清晰    2. 有一定浪费空间    3. 数据扩展性极差（比如说，要修改 教学部 的 dep_desc，就需要一个一个修改，如果数据过大，会浪费大量时间和资源）    # 如何优化？    （上述问题就类似于将所有的代码都写在一个 py 文件中）    将上述的员工表拆分成员工表和部门表</code></pre><p><img src="https://img-blog.csdnimg.cn/8f72c097ea1845668f0e4ccec5b60f17.png" alt="[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-bT0KSsTe-1654001944619)(C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20220519213700591.png)]"></p><h2 id="外键-1"><a href="#外键-1" class="headerlink" title="外键"></a>外键</h2><pre class=" language-mysql"><code class="language-mysql">外键就是用来帮助我们描述表与表之间的关系的foreign key</code></pre><h2 id="表关系"><a href="#表关系" class="headerlink" title="表关系"></a>表关系</h2><pre class=" language-mysql"><code class="language-mysql">表与表之间最多只有四种关系    一对多关系（多对一关系也就是一对多关系）    多对多关系    一对一关系    没有关系</code></pre><h3 id="一对多关系"><a href="#一对多关系" class="headerlink" title="一对多关系"></a>一对多关系</h3><p><img src="https://img-blog.csdnimg.cn/1551449be5dd48729d15deec5f812313.png" alt="在这里插入图片描述"></p><pre class=" language-mysql"><code class="language-mysql">"判断表与表之间的关系换位思考，站在两张表的角度思考先站在员工表的角度    思考一条员工数据是否可以对应多条部门数据    不能！！！    （但不能直接得出结论）    站在部门表的角度    思考一条部门数据是否可以对应多条员工数据    能！！！    得出结论    员工表和部门表是单向的一对多关系    所以表关系就是一对多"# sql 语句建立表关系foreign key    一对多表关系 外键字段建在“多”的一方    在创建表的时候一定要先建被关联表    在录入数据的时候先录入被关联表    create table dep(    id int primary key auto_increment,    dep_name char(16),    dep_desc char(16));create table emp(    id int primary key auto_increment,    emp_name char(16),    emp_gender enum("male", "female", "others") default "male",    dep_id int,    foreign key(dep_id) references dep(id));insert into dep(dep_name, dep_desc)values("aoteman", "Tiga"),("alterman", "ash");insert into emp(emp_name, dep_id)values("123", 1),("456", 2);# 修改 dep 中的 id 字段update dep set id=200 where id=2; # 报错# 删除 dep delete from dep; # 报错# 真要删除和修改数据    # 1. 先删除对应的员工数据再删除部门，操作繁琐    # 2. 真正做到数据之间有关系        # 同步更新，同步删除        # 级联更新，级联删除        on update cascade # 同步更新         on delete cascade # 同步删除                create table dep(            id int primary key auto_increment,            dep_name char(8),            dep_desc char(8)        );                create table emp(            id int primary key auto_increment,            emp_name char(8),            emp_gender enum("male", "female", "other") default "male",            dep_id int,            foreign key(dep_id) references dep(id)            on update cascade # 同步更新            on delete cascade # 同步删除        );                insert into dep(dep_name, dep_desc)        values        ("aoteman", "Tiga"),        ("alterman", "ash");                insert into emp(emp_name, dep_id)        values        ("111", 1),        ("222", 2);                select * from dep;+----+----------+----------+| id | dep_name | dep_desc |+----+----------+----------+|  1 | aoteman  | Tiga     ||  2 | alterman | ash      |+----+----------+----------+                select * from emp;+----+----------+------------+--------+| id | emp_name | emp_gender | dep_id |+----+----------+------------+--------+|  1 | 111      | male       |      1 ||  2 | 222      | male       |      2 |+----+----------+------------+--------+        # 更新数据        update dep set id=200 where id=2;                select * from dep;+-----+----------+----------+| id  | dep_name | dep_desc |+-----+----------+----------+|   1 | aoteman  | Tiga     || 200 | alterman | ash      |+-----+----------+----------+                select * from emp;+----+----------+------------+--------+| id | emp_name | emp_gender | dep_id |+----+----------+------------+--------+|  1 | 111      | male       |      1 ||  2 | 222      | male       |    200 |+----+----------+------------+--------+</code></pre><h3 id="多对多关系"><a href="#多对多关系" class="headerlink" title="多对多关系"></a>多对多关系</h3><p><img src="https://img-blog.csdnimg.cn/fea71157d2154ab2ac847a263f4cdc75.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/a22ba6830fc440d8a8a2669e46d9a1e0.png" alt="在这里插入图片描述"></p><pre class=" language-mysql"><code class="language-mysql"># 针对多对多的表关系 不能在两张原有的表中创建外键，需要单独开设一张表，专门用来存储两张表数据之间的关系create table author (    id int primary key auto_increment,    name char(8),    age int);create table book(    id int primary key auto_increment,    title char(8),    price int);create table author2book(    id int primary key auto_increment,    book_id int,    author_id int,    foreign key(book_id) references book(id)    on update cascade    on delete cascade,    foreign key(author_id) references author(id)    on update cascade    on delete cascade);</code></pre><h3 id="一对一关系"><a href="#一对一关系" class="headerlink" title="一对一关系"></a>一对一关系</h3><pre class=" language-mysql"><code class="language-mysql">id  name  age  phone  hobby  email如果一张表的字段特别多，每次查询又不是所有的字段可以用到，可以将表一分为二用户表    用户表        id name age    用户详情表        id addr phonr hobby email            站在用户表的角度        一个用户能否对应多个详情表？        不能！！！            站在详情表的角度        一个详情能否对应多个用户？        不能！！！        结论：        单项的一对多不成立 那么这个时候两表之间的关系就是  一对一（或者是没有关系，没有关系的情况会很好判断）        # 一对一外键字段建在任意表都可以，但建议建在查询频率较高的表里（如：用户表）create userdetail(    id int primary key auto_increment,    phone int,    addr varchar(64));create table user(    id int primary key auto_increment,    name varchar(8),    age int,    foreign key(id) references userdetail(id)    on update cascade    on delete cascade);</code></pre><h1 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h1><pre class=" language-mysql"><code class="language-mysql"># MySQL 对大小写是不敏感的（不区分大小写）# 修改表alter table 表名 rename 新表名;# 增加字段（默认在尾部添加）alter table 表名 add 字段名 字段类型（宽度） 约束条件;alter table 表名 add 字段名 字段类型（宽度） 约束条件 first;alter table 表名 add 字段名 字段类型（宽度）约束条件 after 字段名;# 删除字段alter table 表名 drop 字段名;# 修改字段alter table 表名 modify 字段名 字段类型（宽度） 约束条件;alter table 表名 change 旧字段 新字段 字段类型（宽度） 约束条件;</code></pre><h1 id="复制表"><a href="#复制表" class="headerlink" title="复制表"></a>复制表</h1><pre class=" language-mysql"><code class="language-mysql"># sql 语句查询的结果其实也是一张虚拟表，言外之意就是针对这个表的查询结果还可以继续用查询的语法继续操作该虚拟表# 不能复制主键，外键....复制时也可以添加条件create table 新表名 select * from 旧表名;</code></pre><h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><pre class=" language-mysql"><code class="language-mysql">表与表之间如果有关系，可以有两种方式建立联系    1. 是通过外键强制建立关系        2. 就是通过 sql 语句逻辑层面上建立关系        delete from dep where id=1;        delete from emp where id=1;        即：如果要执行上面的第一个 sql 语句，那么就一定要执行第二个 sql 语句            创建外键会消耗一定的资源并且增加表与表的耦合度    在实际项目中，如果表特别多，可以不建立任何外键处理 直接通过 sql 语句</code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（4） -- 常用字符字段和约束条件</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-4-chang-yong-zi-fu-zi-duan-he-yue-shu-tiao-jian/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-4-chang-yong-zi-fu-zi-duan-he-yue-shu-tiao-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="创建表的完整语法"><a href="#创建表的完整语法" class="headerlink" title="创建表的完整语法"></a>创建表的完整语法</h1><pre class=" language-mysql"><code class="language-mysql"># 语法create table 表名 (    字段名1  类型（宽度） 约束条件,     字段名2  类型（宽度） 约束条件,     字段名3  类型（宽度） 约束条件)# 注意1. 在同一张表中字段名不能重复2. 宽度和字段约束条件可写可不写，但字段类型是必须的，约束条件可以写多个3. 最后一行不能有逗号# 宽度    一般情况下指的是对存储数据的限制    create table t1(name char); # 默认宽度为1    insert into t1 value("aoteman"); # 报错    insert into t1 value(Null); # 关键词 null        针对不同版本会出现不同的结果        5.6 版本默认没有开启严格模式，规定只能存一个字符串你给了多个字符串，不会报错，而是自动截取并存入。        5.7 及以上版本默认开启严格模式，超过规定的字符串长度，就会报错        # 约束条件 Null    not null 该字段不能为空create table t1(    id int not null,    name char(8) not null);    # 宽度和约束条件    宽度是用来限制数据的存储    约束条件是在宽度的基础上增加的额外的约束</code></pre><h1 id="整型字段"><a href="#整型字段" class="headerlink" title="整型字段"></a>整型字段</h1><h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><ul><li>tinyint       </li><li>samllint        </li><li>meduimint        </li><li>bigint</li></ul><h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p>存储年龄、等级、id、号码等</p><p><img src="https://img-blog.csdnimg.cn/b18ba9c11299463991ab5f5637092189.png"></p><pre class=" language-mysql"><code class="language-mysql">是否有符号    默认情况下是带符号的（即有政府）超出会如何    非严格模式下超出限制只存储最大可接受值，严格模式下报错    create table t1(id tinyint);insert into t9 values(-129),(256); # 严格模式下报错# 约束条件 unsigned 无正负符号create table t1(id tinyint unsigned);# 整型默认情况下都是带正负号的# 针对整型括号内 宽度 的作用create table t1(id int(8));insert into t1 values(123456789); # 不报错# 只有在 整型括号内的宽度的数字限制的不是表示位数而是长度create table t1(id int(8));如果数字没有出超出 8 位，用 空格 填充至 8 位如果超出了 8 位，有几位就存几位（但是还是遵循最大范围）</code></pre><h1 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h1><pre class=" language-mysql"><code class="language-mysql"># 查看严格模式show variables like "%mode";# 模糊匹配/查询关键词 like匹配任意多个字符 %匹配任意单个字符 _# 修改严格模式set session; # 只在当前窗口有效set global; # 全局有效set global sql_mode = 'STRICT_TRANS_TABLES';# 修改完，重启服务端就行</code></pre><h1 id="浮点类型"><a href="#浮点类型" class="headerlink" title="浮点类型"></a>浮点类型</h1><h2 id="分类-1"><a href="#分类-1" class="headerlink" title="分类"></a>分类</h2><ul><li>float         </li><li>double         </li><li>decimal</li></ul><h2 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h2><p>身高、体重、薪资<br><img src="https://img-blog.csdnimg.cn/f186c7b3be9042e3a7d9aca4d302a944.png"></p><pre class=" language-mysql"><code class="language-mysql"># 存储限制float(255,30) # 总共 255 位，小数占 35 位double(255, 30)decimal(65, 30)# 精确度不同create table t1(    id float(255, 30),     id2 double(255, 30),    id3 decimal(65, 30));insert into t1 values(1.111111111111111111111111111111, 1.111111111111111111111111111111, 1.111111111111111111111111111111);select * from t1\G;*************************** 1. row *************************** id: 1.111111164093017600000000000000id2: 1.111111111111111200000000000000id3: 1.111111111111111111111111111111# 精度 float < double < decimal# 结合实际场景，三者都可以使用</code></pre><h1 id="时间类型"><a href="#时间类型" class="headerlink" title="时间类型"></a>时间类型</h1><h2 id="分类-2"><a href="#分类-2" class="headerlink" title="分类"></a>分类</h2><ul><li>date: 年月日</li><li>datetime: 年月日时分秒</li><li>time: 时分秒</li><li>year: 年份</li></ul><pre class=" language-python"><code class="language-python">create table student<span class="token punctuation">(</span>    id int<span class="token punctuation">,</span>    name varchar<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    born year<span class="token punctuation">,</span>    birth date<span class="token punctuation">,</span>    study_time time<span class="token punctuation">,</span>    reg_time datetime<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h1 id="枚举和集合类型"><a href="#枚举和集合类型" class="headerlink" title="枚举和集合类型"></a>枚举和集合类型</h1><h2 id="分类-3"><a href="#分类-3" class="headerlink" title="分类"></a>分类</h2><pre class=" language-mysql"><code class="language-mysql">枚举（enum） 多选一集合（set）  多选多</code></pre><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><pre class=" language-mysql"><code class="language-mysql">create table user(    id int,    name char(16),    gender enum("male", "famale", "other"));insert into user values(1, "aoteman", "other");# 枚举字段 在存数据的时候只能从枚举里面选择一个存储create table teacher(    id int,    name char(16),    gender enum("male", "female", "other"),    hobby set("read", "run", "play"));insert into teacher values(1, "aoteman", "other", "reaad,run,play");# 集合可以只写一个，不能写没有列举</code></pre><h1 id="部分约束条件"><a href="#部分约束条件" class="headerlink" title="部分约束条件"></a>部分约束条件</h1><h2 id="default-默认值"><a href="#default-默认值" class="headerlink" title="default 默认值"></a>default 默认值</h2><pre class=" language-mysql"><code class="language-mysql"># 补充：插入数据的时候可以指定字段create table t1(    id int,    name char(16),    gender enum("male", "female", "other") default "male");insert into t1(id, name) values(1, "aoteman");selelct * from t1;+------+---------+--------+| id   | name    | gender |+------+---------+--------+|    1 | aoteman | male   |+------+---------+--------+</code></pre><h2 id="unique-唯一"><a href="#unique-唯一" class="headerlink" title="unique 唯一"></a>unique 唯一</h2><pre class=" language-mysql"><code class="language-mysql"># 单列唯一create table t1(    id int unique,    name varchar(16));insert into table (id, name) values(1, "aoteman"), (1, "alterman"); # 报错insert into table (id, name) values(1, "aoteman"), (2, "alterman");# 联合唯一举例：ip 和 port，单个可以重复，但加在一起是唯一的create table t1(    id int,    ip char(16),    post int,    unique (ip, post));insert into t4 values(1, "127.0.0.1", 8080);insert into t4 values(2, "127.0.0.1", 8081);insert into t4 values(3, "127.0.0.1", 8082);insert into t4 values(4, "127.0.0.1", 8080); # 报错</code></pre><h2 id="primary-key"><a href="#primary-key" class="headerlink" title="primary key"></a>primary key</h2><pre class=" language-mysql"><code class="language-mysql"># 单从约束效果上来看，primary key 相当于 not null + unique（非空且唯一）create table t1(    id int primary key);insert into t1 values(null); # 报错insert into t1 values(1), (1); # 报错insert into t1 values(1), (2);# 除了有约束条件外，它还是 innodb 存储引擎组织数据的依据，即 innodb 存储引擎在创建表时必须要有 primary key -- 类似于书的目录，能够帮助提升查询效率并且也是建表的依据# 1. 一张表中有且只有一个主键 如果没有设置主键那么会从上往下搜索直到遇到一个非空且唯一的字段将它自动升级成主键create table t1(    id int,    name char(16),    age int not null unique,    addr char(32) not null unique);describe t1;+-------+----------+------+-----+---------+-------+| Field | Type     | Null | Key | Default | Extra |+-------+----------+------+-----+---------+-------+| id    | int(11)  | YES  |     | NULL    |       || name  | char(16) | YES  |     | NULL    |       || age   | int(11)  | NO   | PRI | NULL    |       || addr  | char(32) | NO   | UNI | NULL    |       |+-------+----------+------+-----+---------+-------+这时候 主键 是 age# 2. 如果表中没有主键也没有任何的非空且唯一的字段，那么 innodb 会采用自己内部提供的一个隐藏字段作为主键，隐藏意味着无法使用到它，也无法提升查询速度# 联合字段主键（多个字段联合起来作为主键 本质还是一个主键）create table t1(    id int,    ip varchar(16),    port int,    primary key(ip, port));# 以后创建表的时候一定要加 primary key</code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（3） -- 基本 SQL 语句</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-3-ji-ben-sql-yu-ju/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-3-ji-ben-sql-yu-ju/</url>
      
        <content type="html"><![CDATA[<h1 id="库（文件夹）的增删查改"><a href="#库（文件夹）的增删查改" class="headerlink" title="库（文件夹）的增删查改"></a>库（文件夹）的增删查改</h1><pre class=" language-mysql"><code class="language-mysql"># 增create database 库名;create database 库名 charst="gbk";# 查show databases;show create database 表名; # 查单个库# 改alter database 库名 charset = "utf-8";# 删drop database 库名; </code></pre><p><img src="https://img-blog.csdnimg.cn/54a9e3e09f424841ab585bcd3551ff40.gif"></p><h1 id="表（文件）的增删查改（非完整版）"><a href="#表（文件）的增删查改（非完整版）" class="headerlink" title="表（文件）的增删查改（非完整版）"></a>表（文件）的增删查改（非完整版）</h1><pre class=" language-mysql"><code class="language-mysql"># 在操作表（文件）的时候要指定所在的库（文件夹）# 查看当前所在的 库select database();# 切换库use 库名;# 增create table 表名 (id int, name char(64));create table db2.t2(id int); # 也可以用绝对路径的形式操作# 查show table 表名;show create table 表名;describe 表名;desc 表名; # 简写# 改alter table 表名 modify name varchar(16);# 删drop table 表名;</code></pre><p><img src="https://img-blog.csdnimg.cn/d7313b706ebf4e3d943a751af349aca0.gif"></p><h1 id="数据的增删改查"><a href="#数据的增删改查" class="headerlink" title="数据的增删改查"></a>数据的增删改查</h1><pre class=" language-mysql"><code class="language-mysql"># 一定要有库，有表才能创建数据# 增insert into 表名 values("", ""); # into 可以省略，但因为语句连贯，一般习惯上不省略insert into 表名 values("", ""), ("", ""), ("", "") # 可以一次性插入多条数据# 查select * from 表名; # 查找表中所有数据，数量大是不建议使用select id from 表名;# 改update 表名 set name = "" where id = 1; # where 相当于 python 中的 if 条件# 删delete from 表名; # 清空数据delete from 表名 where id = 1; # 删除 id 为 1 的数据</code></pre><p><img src="https://img-blog.csdnimg.cn/e0f3528981f14c928d818ea1414e5701.gif"></p><h1 id="MySQL主要存储引擎"><a href="#MySQL主要存储引擎" class="headerlink" title="MySQL主要存储引擎"></a>MySQL主要存储引擎</h1><p>日常生活中文件格式有很多种，并且针对不同的文件格式会有对应不同存储方式和处理机制（txt，pdf, word, mp4）</p><p>针对不同的数据应该有对应的不同的处理机制来存储</p><p><strong>存储引擎就是不同的处理机制</strong></p><ul><li><p>innodb</p><p>是 5.5 版本之后默认的存储引擎</p><p>存储数据更加安全</p></li><li><p>myisam</p><p>是 5.5 版本之前默认的存储引擎</p><p>速度快，但安全性不如 innodb</p></li><li><p>memory</p><p>内存引擎（数据全部存放在内存中，断电数据丢失）</p></li><li><p>blackhole</p><p>无论存什么，都立刻消失（黑洞）</p><pre class=" language-mysql"><code class="language-mysql"># 查看所有的存储引擎show engines;# 创建表时可以指定存储引擎（一般不用）create table t1(id int) engine=innodb;</code></pre><p><img src="https://img-blog.csdnimg.cn/bc0f224a19c046bd9653e763fb4ec876.gif"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（2） -- MySQL 配置及 sql 语句初识</title>
      <link href="/2022/11/24/mysql-shu-ju-ku-xue-xi-2-mysql-pei-zhi-ji-sql-yu-ju-chu-shi/"/>
      <url>/2022/11/24/mysql-shu-ju-ku-xue-xi-2-mysql-pei-zhi-ji-sql-yu-ju-chu-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="环境变量配置"><a href="#环境变量配置" class="headerlink" title="环境变量配置"></a>环境变量配置</h1><pre class=" language-python"><code class="language-python">在前面的提到的启动过程中，我们难免会感到麻烦——需要切换到相应的文件；需要打开两个 cmd 窗口<span class="token comment" spellcheck="true"># 这时候我们可以选择将 mysql 所在的文件夹路径添加到 环境变量，这样启动时就不要切换路径</span></code></pre><h1 id="系统服务"><a href="#系统服务" class="headerlink" title="系统服务"></a>系统服务</h1><pre class=" language-python"><code class="language-python">我们发现添加环境变量后也挺麻烦的，因为还是需要一次打开两个 cmd 窗口。那么有没有更简单的方法呢？<span class="token comment" spellcheck="true"># 这时候我们将 mysqld 制作成系统服务(开机自启动)</span><span class="token triple-quoted-string string">"""步骤：    管理员身份运行 cmd 窗口，并输入        mysqld --install    然后打开 任务管理器查看服务，如下图"""</span></code></pre><p><img src="https://img-blog.csdnimg.cn/466886e6f2d944cd8936aa0c3a1a202a.png"></p><h1 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h1><pre class=" language-python"><code class="language-python">前面我们在启动 MySQL 客户端时发现无需密码就可以登录，显然这是不安全的，所以我们应该如何修改密码呢？<span class="token comment" spellcheck="true"># 在 终端输入以下语句 即可</span><span class="token comment" spellcheck="true"># mysqladmin -uroot -p原密码 password新密码</span></code></pre><h1 id="重置密码"><a href="#重置密码" class="headerlink" title="重置密码"></a>重置密码</h1><p>设置密码了之后最重要的就是如果忘记密码怎么办？</p><p>你可以将 mysql 获取用户名和密码校验的功能看成是一个装饰器，装饰在了客户端请求访问的功能上</p><p>我们如果将该装饰器移除，那么mysql服务端就不会校验用户名和密码了。</p><p>具体步骤：</p><pre class=" language-mysql"><code class="language-mysql">1. 先关闭当前 mysql 服务器(mysqld)    命令行方式启动（跳过用户名密码验证功能）    mysqld --skip-grant-tables    2. 直接以无密码的方式登录3. 修改当前用户的密码    update mysql.user set password=password（123456）where user=root and host="localhost";        真正存储用户的密码字段 存储的肯定是密文，密码比对也只能比对密文    4. 立刻将修改数据刷到硬盘    flush privileges;    5. 关闭当前服务器，然后以正常流程登录</code></pre><h1 id="配置文件修改"><a href="#配置文件修改" class="headerlink" title="配置文件修改"></a>配置文件修改</h1><p>MySQL 默认的配置文件为 .ini 文件</p><p>—— <strong>程序启动会先加载配置文件之后才真正启动</strong></p><pre class=" language-ini"><code class="language-ini"><span class="token selector">[mysqld]</span> # 一旦服务端启动立刻加载下面的配置<span class="token selector">[mysql]</span> # 一旦客户端启动立刻加载下面的配置<span class="token selector">[client]</span> # 其他客户端# 需要自己新建一个 my.ini 文件，也可以将用户名和密码直接写入配置文件，这样登陆时就不用输入密码和用户名了# 修改配置文件后一定要重启服务器才能生效# 具体写什么，可以直接百度，因为我也是百度的，就不复制了</code></pre><h1 id="sql-语句初识"><a href="#sql-语句初识" class="headerlink" title="sql 语句初识"></a>sql 语句初识</h1><pre class=" language-mysql"><code class="language-mysql"># MySQL 中的 sql 语句是以分号作为结束的标志show databases; -- 查看所有的库名连接服务端的命令可以简写    mysql -uroot -p取消命令    错误命令 \c    退出客户端，加不加分号都可以执行    quit    exit</code></pre>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQL数据库学习（1）-- 初识数据库</title>
      <link href="/2022/11/22/mysql-shu-ju-ku-xue-xi-1-chu-shi-shu-ju-ku/"/>
      <url>/2022/11/22/mysql-shu-ju-ku-xue-xi-1-chu-shi-shu-ju-ku/</url>
      
        <content type="html"><![CDATA[<h1 id="01-初识数据库"><a href="#01-初识数据库" class="headerlink" title="01-初识数据库"></a>01-初识数据库</h1><h2 id="存储数据的演变流程"><a href="#存储数据的演变流程" class="headerlink" title="存储数据的演变流程"></a>存储数据的演变流程</h2><p>目前所知并且我们能够实现的存储数据的方式有两种，一种是将数据存储到文件中（txt 文件或是 excel 文件），一种是类似于软件开发目录的情况，将数据保存到固定的文件夹位置，但实际上这两种存储方式存在一定的弊端。</p><h3 id="存储至文件的问题"><a href="#存储至文件的问题" class="headerlink" title="存储至文件的问题"></a>存储至文件的问题</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""将数据存储到随机的文件中，由于缺少标准，会造成存储数据时文件内容的千差万别，甚至影响他人对于该存储文件的使用和阅读"""</span></code></pre><h3 id="软件开发目录规范的问题"><a href="#软件开发目录规范的问题" class="headerlink" title="软件开发目录规范的问题"></a>软件开发目录规范的问题</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""bin     -- 启动文件conf    -- 配置文件core    -- 后端核心代码log     -- 日志文件lib     -- 公共方法db      -- 数据readme  -- 使用说明"""</span>软件开发规范目录虽然限制了存储数据的具体位置，但这样的数据只存储在本机中，就像是没有云存档的单机游戏一样，他人想要访问比较困难，或者说需要使用自己的电脑才能访问。</code></pre><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>对于文件存储标准不统一和软件开发目录多人操作困难的问题，提出了<strong>将数据按一种格式同意保存，并且允许所有人在同一个地方操作数据</strong>的解决方案——这也就是数据库的作用。</p><h2 id="数据库的本质"><a href="#数据库的本质" class="headerlink" title="数据库的本质"></a>数据库的本质</h2><p>数据库的<strong>本质就是一款与网络通信的应用程序</strong>——用户输入命令，和数据，服务端接收命令和数据，并根据命令在服务端实现对数据的操作。</p><h2 id="数据库的分类"><a href="#数据库的分类" class="headerlink" title="数据库的分类"></a>数据库的分类</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""关系型数据库    MySQL，oracle，db2，access，sql server非关系型数据库    redis，mongdb，mencache"""</span><span class="token comment" spellcheck="true"># 关系型</span>    <span class="token number">1</span><span class="token punctuation">.</span> 数据之间批次有关系或者约束    <span class="token number">2</span><span class="token punctuation">.</span> 存储数据的表现形式通常是以表格存储。每个字段还会有存储类型的限制，比如说姓名只能存在字符串    <span class="token comment" spellcheck="true"># 非关系型</span>    <span class="token number">1</span><span class="token punctuation">.</span> 存储数据通常是以 k<span class="token punctuation">,</span>v 键值对的形式存储</code></pre><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""人格基于网络通信的应用程序底层都是 socket- 服务端    - 基于 socket 实现通信    - 收发消息    - 客户端    - 基于socket 实现通信    - 收发消息"""</span>MySQL 不单支持 MySQL 自己的客户端 app 还支持 其他变成语言来充当客户端操作，同时为了解决不同语言充当客户端操作的沟通障碍，<span class="token comment" spellcheck="true"># MySQL 采用统一的语言（SQL 语言）</span></code></pre><h3 id="MySQL重要概念"><a href="#MySQL重要概念" class="headerlink" title="MySQL重要概念"></a>MySQL重要概念</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""库 --- 相当于 文件夹表 --- 相当于 文件记录 --- 相当于 文件内一行行的数据表头 --- 表格的第一行字段表单 --- 表头外的数据"""</span></code></pre><h3 id="MySQL安装"><a href="#MySQL安装" class="headerlink" title="MySQL安装"></a>MySQL安装</h3><p>官网安装：<a href="https://www.mysql.com/">MySQL</a></p><h3 id="MySQL服务端和客户端"><a href="#MySQL服务端和客户端" class="headerlink" title="MySQL服务端和客户端"></a>MySQL服务端和客户端</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""服务端mysqld.exe客户端mysql.exe"""</span></code></pre><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""在前期配置MySQL的时候尽量在 cmd 终端以管理员的身份运行window+r 进入的是普通用户终端，有一些命令无法执行搜索 cmd 右键，以管理员身份运行"""</span></code></pre><p><img src="https://img-blog.csdnimg.cn/19dd4f3faea94b84853add538798c168.gif"></p><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><ul><li>管理员运行cmd，先切换到 mysql 所在的 bin 目录下，然后输入 mysqld 启动 服务端 即可</li><li>然后保留原来的 cmd 窗口，重新打开一个</li></ul><pre class=" language-python"><code class="language-python"><span class="token triple-quoted-string string">"""常见软件的默认端口号    MySQL  3306    redis  6379    mongodb 27017    django  8000    flask   5000    ...    MySQL 第一次以管理员身份进入是没有密码的，直接回车即可进入相关目录 mysql -h 127.0.0.1 -P 3306 -uroot -p"""</span></code></pre><h3 id="登录成功"><a href="#登录成功" class="headerlink" title="登录成功"></a>登录成功</h3><p><img src="https://img-blog.csdnimg.cn/74daeb80df884f1c9fe55b34f0a58f24.png"></p>]]></content>
      
      
      <categories>
          
          <category> MySql 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 数据库 </tag>
            
            <tag> MySql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简易界面爬虫小项目</title>
      <link href="/2022/11/22/jian-yi-jie-mian-pa-chong-xiao-xiang-mu/"/>
      <url>/2022/11/22/jian-yi-jie-mian-pa-chong-xiao-xiang-mu/</url>
      
        <content type="html"><![CDATA[<h1 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h1><p><img src="https://img-blog.csdnimg.cn/6c4bfebab4934237ab85352a751b1ece.png"></p><h1 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h1><ol><li>本来是要再做一个界面在运行时显示正在爬取哪个内容</li><li>log 文件本来是要做一个日志文件，不过其实是单机版本其实好像没什么必要（实际上是嫌太麻烦了）</li></ol><h1 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h1><h2 id="lib-文件夹下-main-py-文件"><a href="#lib-文件夹下-main-py-文件" class="headerlink" title="lib 文件夹下 main.py 文件 "></a><code>lib 文件夹下 main.py 文件 </code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span>syspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 添加到环境变量</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> bin<span class="token punctuation">.</span>JingDongProject <span class="token keyword">import</span> jing_dong_project    jing_dong_project<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="bin-文件夹下-JingDongProject-py-文件"><a href="#bin-文件夹下-JingDongProject-py-文件" class="headerlink" title="bin 文件夹下 JingDongProject.py 文件"></a><code>bin 文件夹下 JingDongProject.py 文件</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">from</span> core<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>Start <span class="token keyword">import</span> Ui_Dialog<span class="token keyword">class</span> <span class="token class-name">Window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span>Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 实例化初始界面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">setup_ui</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">jing_dong_project</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        app <span class="token operator">=</span> QApplication<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        window <span class="token operator">=</span> Window<span class="token punctuation">(</span><span class="token punctuation">)</span>        window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>        app<span class="token punctuation">.</span>exec_<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="core-文件夹下-Spider-文件夹下-spider-py-文件"><a href="#core-文件夹下-Spider-文件夹下-spider-py-文件" class="headerlink" title="core 文件夹下 Spider 文件夹下 spider.py 文件"></a><code>core 文件夹下 Spider 文件夹下 spider.py 文件</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeOptions <span class="token keyword">import</span> EdgeOptions<span class="token keyword">from</span> conf <span class="token keyword">import</span> Settings<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">class</span> <span class="token class-name">Spider</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> goods_name<span class="token punctuation">,</span> paixu<span class="token punctuation">,</span> goods_page<span class="token punctuation">,</span> comment_page<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> goods_name        self<span class="token punctuation">.</span>paixu <span class="token operator">=</span> paixu        self<span class="token punctuation">.</span>goods_page <span class="token operator">=</span> goods_page        self<span class="token punctuation">.</span>comment_page <span class="token operator">=</span> comment_page        self<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>start_web<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>search_goods<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Paixu<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>goods_message<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">start_web</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""初始化浏览器"""</span>        <span class="token comment" spellcheck="true"># 1.创建Edge浏览器对象，这会在电脑上在打开一个浏览器窗口</span>        options <span class="token operator">=</span> EdgeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>        options<span class="token punctuation">.</span>add_arguments<span class="token punctuation">(</span><span class="token punctuation">[</span>r<span class="token string">"--headless"</span><span class="token punctuation">,</span> r<span class="token string">"--disable-gpu"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 无头浏览器</span>        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span>capabilities<span class="token operator">=</span>options<span class="token punctuation">.</span>to_capabilities<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># self.driver = webdriver.Edge()</span>        <span class="token comment" spellcheck="true"># 2.通过浏览器向服务器发送URL请求</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>URL<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">page_read</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""网页源码解析"""</span>        <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>        page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source        <span class="token comment" spellcheck="true"># xpath 解析</span>        self<span class="token punctuation">.</span>tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">search_goods</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""输入商品名称，并点击搜索"""</span>        name_input <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span>        name_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_name<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 点击搜索</span>        click <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="search"]/div/div[2]/button'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> click<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">goods_message</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""获取商品信息"""</span>        <span class="token triple-quoted-string string">"""        商品页翻页循环            每次循环获取商品价格、名称等信息（这也是一个循环，因为一页有多个商品）                获取一个商品信息后（即一个循环后）                    进入商品详情页获取评论，评论翻页也需要循环        """</span>        <span class="token comment" spellcheck="true"># 排序方式</span>        page <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> page <span class="token operator">&lt;=</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_page<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 滚动加载该页面所有信息</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>            sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>goods_price_name<span class="token punctuation">(</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>            page_list_length <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_bottomPage"]/span[1]/a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 页数条的长度，最后一个是下一页</span>            <span class="token comment" spellcheck="true"># 点击下一页</span>            next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_bottomPage"]/span[1]/a[{}]'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>page_list_length<span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> next_page<span class="token punctuation">)</span>            page <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">goods_price_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""爬取商品信息"""</span>        <span class="token comment" spellcheck="true"># 获取商品价格</span>        self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>        length <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 获取该页商品数量</span>        count <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> count <span class="token operator">&lt;=</span> length<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[3]/strong/i/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>goods_price <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[3]/strong/i/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token keyword">elif</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[2]/strong/i/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>goods_price <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[2]/strong/i/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_price<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 获取商品名称</span>            <span class="token comment" spellcheck="true"># //*[@id="J_goodsList"]/ul/li[1]/div/div[4]/a/em</span>            <span class="token comment" spellcheck="true"># //*[@id="J_goodsList"]/ul/li[1]/div/div[3]/a/em</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[4]/a/em/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[4]/a/em/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[3]/a/em/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span>                    <span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[3]/a/em/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>            num <span class="token operator">=</span> <span class="token string">""</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> self<span class="token punctuation">.</span>goods_name<span class="token punctuation">:</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                num <span class="token operator">+=</span> i            self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> num            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_name<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 进入商品详情页面</span>            xpath <span class="token operator">=</span> <span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[1]/a'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span>            good_detail <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> good_detail<span class="token punctuation">)</span>            sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>comment<span class="token punctuation">(</span><span class="token punctuation">)</span>            count <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">comment</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取商品评论</span>        self<span class="token punctuation">.</span>new_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 滑到底部，等待评论加载完成</span>        comment_box <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="detail"]/div[1]/ul/li[5]'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> comment_box<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>comment_page<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[@class="comment-item"]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 评论过少或没有评论，直接退出循环</span>                <span class="token keyword">break</span>            comment_counter <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[@class="comment-item"]'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            count <span class="token operator">=</span> <span class="token number">1</span>            <span class="token keyword">while</span> count <span class="token operator">&lt;=</span> comment_counter<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>content<span class="token punctuation">(</span>count<span class="token punctuation">)</span>                count <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token comment" spellcheck="true"># 点击下一页</span>            page_list_length <span class="token operator">=</span> len<span class="token punctuation">(</span>self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[12]/div/div/a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 页数条的长度，最后一个是下一页</span>            <span class="token comment" spellcheck="true"># 点击下一页</span>            <span class="token keyword">if</span> page_list_length <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>                next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>                    <span class="token string">'//*[@id="comment-0"]/div[12]/div/div/a[{}]'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>page_list_length<span class="token punctuation">)</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> next_page<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>close_window<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">break</span>        self<span class="token punctuation">.</span>close_window<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">new_window</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取窗口,返回为一个列表</span>        handles <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>window_handles        <span class="token comment" spellcheck="true"># 最后一个是新打开的窗口，跳转到这个窗口</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">close_window</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 关闭新打开的窗口</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        handles <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>window_handles        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">content</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>        self<span class="token punctuation">.</span>page_read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 用户名</span>        username <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[1]/div[1]/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 是否是会员</span>        huiyuan <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[1]/div[2]/a/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>huiyuan<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            huiyuan <span class="token operator">=</span> <span class="token string">"None"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            huiyuan <span class="token operator">=</span> huiyuan<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 评价内容</span>        content <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[2]/p/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 星级</span>        star <span class="token operator">=</span> self<span class="token punctuation">.</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[2]/div[1]/@class'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># print(star)</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>DOWNLOAD_PATH<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token keyword">as</span> f<span class="token punctuation">:</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_name <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>goods_price <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> huiyuan <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> star <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">Paixu</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        dic <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"综合"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>            <span class="token string">"销量"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>            <span class="token string">"评论数"</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>            <span class="token string">"新品"</span><span class="token punctuation">:</span> <span class="token number">4</span>        <span class="token punctuation">}</span>        num <span class="token operator">=</span> dic<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>paixu<span class="token punctuation">)</span>        xpath <span class="token operator">=</span> <span class="token string">'//*[@id="J_filter"]/div[1]/div[1]/a[{}]'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>num<span class="token punctuation">)</span>        sales_count <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> sales_count<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span>Settings<span class="token punctuation">.</span>SLEEP_TIME<span class="token punctuation">)</span></code></pre><h2 id="UI-文件夹下-Start-py-文件"><a href="#UI-文件夹下-Start-py-文件" class="headerlink" title="UI 文件夹下 Start.py 文件"></a><code>UI 文件夹下 Start.py 文件</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">421</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">301</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>user_select<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 用户选择界面</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:22pt; font-weight:600;\">\u5546\u54c1\u8bc4\u8bba\u722c\u53d6&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5f00\u59cb\u4f7f\u7528"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">user_select</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">from</span> core<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>User_Select <span class="token keyword">import</span> user_selelct_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> user_selelct_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="UI-文件夹下-User-Select-py"><a href="#UI-文件夹下-User-Select-py" class="headerlink" title="UI 文件夹下 User_Select.py"></a><code>UI 文件夹下 User_Select.py</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">619</span><span class="token punctuation">,</span> <span class="token number">464</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton <span class="token operator">=</span> QPushButton<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"pushButton"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">490</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>clicked<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>self<span class="token punctuation">.</span>run<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">391</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2 <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">260</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox <span class="token operator">=</span> QComboBox<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>addItem<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>addItem<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>addItem<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>addItem<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"comboBox"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_3"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_3 <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_3<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit_3"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_3<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">330</span><span class="token punctuation">,</span> <span class="token number">341</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4 <span class="token operator">=</span> QLabel<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"label_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">380</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_4 <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_4<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit_4"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_4<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">390</span><span class="token punctuation">,</span> <span class="token number">341</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>pushButton<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u5f00\u59cb\u722c\u53d6"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:24pt; font-weight:600;\">\u5546\u54c1\u8bc4\u8bba\u722c\u53d6&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8981\u722c\u53d6\u7684\u5546\u54c1\u540d\u79f0"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_2<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u9009\u62e9\u9875\u9762\u6392\u5e8f\u65b9\u5f0f"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setItemText<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u7efc\u5408"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setItemText<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u9500\u91cf"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setItemText<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8bc4\u8bba\u6570"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>setItemText<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u65b0\u54c1"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_3<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8981\u722c\u53d6\u7684\u5546\u54c1\u9875\u6570"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_3<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">\u6700\u597d\u4fdd\u8bc1\u8be5\u5546\u54c1\u9875\u6570 \u5927\u4e8e\u7b49\u4e8e \u586b\u5199\u7684\u9875\u6570&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>label_4<span class="token punctuation">.</span>setText<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"\u8981\u722c\u53d6\u7684\u5546\u54c1\u8bc4\u8bba\u6570\u9875\u6570"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_4<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">\u6700\u597d\u4fdd\u8bc1\u8be5\u5546\u54c1\u9875\u6570 \u5927\u4e8e\u7b49\u4e8e \u586b\u5199\u7684\u9875\u6570&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span>    <span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        name <span class="token operator">=</span> self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要爬取的商品名称</span>        paixu <span class="token operator">=</span> self<span class="token punctuation">.</span>comboBox<span class="token punctuation">.</span>currentText<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 页面商品的排序方式</span>        good_page <span class="token operator">=</span> self<span class="token punctuation">.</span>textEdit_3<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要爬取的商品页数</span>        comment_page <span class="token operator">=</span> self<span class="token punctuation">.</span>textEdit_4<span class="token punctuation">.</span>toPlainText<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 要爬取的商品评论数页数</span>        <span class="token keyword">from</span> core<span class="token punctuation">.</span>UI<span class="token punctuation">.</span>Wait <span class="token keyword">import</span> user_wait_window        self<span class="token punctuation">.</span>window <span class="token operator">=</span> user_wait_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>window<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">from</span> core<span class="token punctuation">.</span>Spider<span class="token punctuation">.</span>spider <span class="token keyword">import</span> Spider        Spider<span class="token punctuation">(</span>name<span class="token punctuation">,</span> paixu<span class="token punctuation">,</span> good_page<span class="token punctuation">,</span> comment_page<span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">user_selelct_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开用户选择页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h2 id="UI-文件夹下的-Wait-py"><a href="#UI-文件夹下的-Wait-py" class="headerlink" title="UI 文件夹下的 Wait.py "></a><code>UI 文件夹下的 Wait.py </code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtGui <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtCore <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> <span class="token operator">*</span>    <span class="token comment" spellcheck="true"># 导入PyQt5部件</span><span class="token keyword">from</span> PyQt5<span class="token punctuation">.</span>QtWidgets <span class="token keyword">import</span> QMainWindow<span class="token punctuation">,</span> QApplication<span class="token punctuation">,</span>QLabel<span class="token punctuation">,</span>QTableWidgetItem<span class="token punctuation">,</span>QPushButton<span class="token punctuation">,</span>QLineEdit<span class="token punctuation">,</span>QGridLayout<span class="token punctuation">,</span>QWidget<span class="token punctuation">,</span>QTableWidget<span class="token keyword">class</span> <span class="token class-name">Ui_Dialog</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">setupUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token operator">not</span> Dialog<span class="token punctuation">.</span>objectName<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            Dialog<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"Dialog"</span><span class="token punctuation">)</span>        Dialog<span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token number">614</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2 <span class="token operator">=</span> QTextEdit<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>setObjectName<span class="token punctuation">(</span>u<span class="token string">"textEdit_2"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>setGeometry<span class="token punctuation">(</span>QRect<span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">481</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>retranslateUi<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>        QMetaObject<span class="token punctuation">.</span>connectSlotsByName<span class="token punctuation">(</span>Dialog<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># setupUi</span>    <span class="token keyword">def</span> <span class="token function">retranslateUi</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span>        Dialog<span class="token punctuation">.</span>setWindowTitle<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"Dialog"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>textEdit_2<span class="token punctuation">.</span>setHtml<span class="token punctuation">(</span>QCoreApplication<span class="token punctuation">.</span>translate<span class="token punctuation">(</span><span class="token string">"Dialog"</span><span class="token punctuation">,</span> u<span class="token string">"&lt;!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"</span><span class="token string">"&lt;html>&lt;head>&lt;meta name=\"qrichtext\" content=\"1\" />&lt;style type=\"text/css\">\n"</span><span class="token string">"p, li { white-space: pre-wrap; }\n"</span><span class="token string">"&lt;/style>&lt;/head>&lt;body style=\" font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;\">\n"</span><span class="token string">"&lt;p align=\"center\" style=\" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\">&lt;span style=\" font-size:22pt; font-weight:600;\">\u6b63\u5728\u722c\u53d6\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85&lt;/span>&lt;/p>&lt;/body>&lt;/html>"</span><span class="token punctuation">,</span> None<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># retranslateUi</span><span class="token keyword">class</span> <span class="token class-name">user_wait_window</span><span class="token punctuation">(</span>QDialog<span class="token punctuation">,</span> Ui_Dialog<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开等待页面</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        super<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>setupUi<span class="token punctuation">(</span>self<span class="token punctuation">)</span></code></pre><h2 id="conf-文件夹下的-Settings-py"><a href="#conf-文件夹下的-Settings-py" class="headerlink" title="conf 文件夹下的 Settings.py"></a><code>conf 文件夹下的 Settings.py</code></h2><pre class=" language-python"><code class="language-python">URL <span class="token operator">=</span> <span class="token string">"https://www.jd.com/"</span><span class="token comment" spellcheck="true"># URL = "https://search.jd.com/Search?keyword=%E8%A1%80%E6%BA%90&amp;wq=%E8%A1%80%E6%BA%90&amp;pvid=068dc4b95f284265bec11485d5d227ab&amp;page=9&amp;s=241&amp;click=0"</span>SLEEP_TIME <span class="token operator">=</span> <span class="token number">5</span>DOWNLOAD_PATH <span class="token operator">=</span> r<span class="token string">'C:\Users\ASUS\Desktop\code\pyqt5_JingDong\download\download.txt'</span>EXCEL_PATH <span class="token operator">=</span> <span class="token string">"C:\Users\ASUS\Desktop\code\pyqt5_JingDong\download\data.xls"</span></code></pre><h2 id="download-文件夹下的-ToExcel-py-文件"><a href="#download-文件夹下的-ToExcel-py-文件" class="headerlink" title="download 文件夹下的 ToExcel.py 文件"></a><code>download 文件夹下的 ToExcel.py 文件</code></h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span>syspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> conf<span class="token punctuation">.</span>Settings <span class="token keyword">import</span> DOWNLOAD_PATH<span class="token punctuation">,</span>EXCEL_PATH    <span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook    book <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>    sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>active    title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"goods_name"</span><span class="token punctuation">,</span> <span class="token string">"price"</span><span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"huiyuan"</span><span class="token punctuation">,</span> <span class="token string">"star"</span><span class="token punctuation">,</span> <span class="token string">"comment content"</span><span class="token punctuation">)</span>    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>title<span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>DOWNLOAD_PATH<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>DOWNLOAD_PATH<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                line_list <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># self.goods_name + | + price + "|" + username + "|" + huiyuan + "|" + star + "|" + content</span>                sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line_list<span class="token punctuation">)</span>        book<span class="token punctuation">.</span>save<span class="token punctuation">(</span>EXCEL_PATH<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"can't find the DOANLOAD file!!!"</span><span class="token punctuation">)</span></code></pre><h1 id="运行演示"><a href="#运行演示" class="headerlink" title="运行演示"></a>运行演示</h1><p><img src="https://img-blog.csdnimg.cn/e4b2607cb07341888663897463453f7e.gif"><br><img src="https://img-blog.csdnimg.cn/bfda9eb25f1f4445ad14c1d2764deae1.gif"></p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><p>代码已经上传至 github 项目<br><a href="https://github.com/New-Ass/JingDongSpider/tree/master">JingDongSpider</a></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PyQt5 </tag>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>爬虫小项目 —— 京东商品评价内容爬取</title>
      <link href="/2022/11/22/pa-chong-xiao-xiang-mu-jing-dong-shang-pin-ping-jie-nei-rong-pa-qu/"/>
      <url>/2022/11/22/pa-chong-xiao-xiang-mu-jing-dong-shang-pin-ping-jie-nei-rong-pa-qu/</url>
      
        <content type="html"><![CDATA[<h1 id="爬虫小项目-——-京东商品评价内容爬取"><a href="#爬虫小项目-——-京东商品评价内容爬取" class="headerlink" title="爬虫小项目 —— 京东商品评价内容爬取"></a>爬虫小项目 —— 京东商品评价内容爬取</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>会写这么一个类似“小项目”的程序是因为在前年（去年？）的时候，一位老师需要用爬虫爬取京东某类商品的用户评论数据——不知道为什么会找学生写这种程序，淘宝找一个或许都比我靠谱吧？<br>虽然我最后写出了一个勉强可运行的程序，也爬取到了一些评论数据，但我一直认为那位老师只是不知道怎么说我写的东西不行，毕竟在隔了一两年的今天我再看这段代码，其实写的很差，封装性基本没有，适应性差的要命，所以我才会突然说再写一遍，但当然结果也就是比之前的代码好上一点。</p><h2 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h2><h3 id="前提准备-1"><a href="#前提准备-1" class="headerlink" title="前提准备"></a><code>前提准备</code></h3><p><strong>注意</strong>：因为谷歌浏览器的升级以及驱动器相关版本不对应，所以使用的是 edge 浏览器的 自动测试，并且使用无头浏览器，但是其实 <code>selenium.webdriver.edge.EdgeOptions</code>中并没有<code>EdgeOptions</code>模块，所以需要自己写，这是我百度使用的代码<br>我电脑的文件目录如下：<code>C:\Users\ASUS\AppData\Local\Programs\Python\Python39\Lib\site-packages\selenium\webdriver\edge</code><br><img src="https://img-blog.csdnimg.cn/e37f77c50a714b16ae1a0f3ca0d1bcc7.png"><br>文件代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>desired_capabilities <span class="token keyword">import</span> DesiredCapabilities<span class="token keyword">class</span> <span class="token class-name">EdgeOptions</span><span class="token punctuation">:</span>    KEY <span class="token operator">=</span> <span class="token string">"ms:edgeOptions"</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_arguments <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>_experimental_options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        self<span class="token punctuation">.</span>_caps <span class="token operator">=</span> DesiredCapabilities<span class="token punctuation">.</span>EDGE<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>    @property    <span class="token keyword">def</span> <span class="token function">arguments</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_arguments    @property    <span class="token keyword">def</span> <span class="token function">experimental_options</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_experimental_options    <span class="token keyword">def</span> <span class="token function">add_argument</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> argument<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        添加浏览器参数        :param argument: 启动参数        """</span>        <span class="token keyword">if</span> argument<span class="token punctuation">:</span>            <span class="token keyword">if</span> self<span class="token punctuation">.</span>_is_infobars<span class="token punctuation">(</span>argument<span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_enable_infobars<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_arguments<span class="token punctuation">.</span>append<span class="token punctuation">(</span>argument<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"argument参数不能为空"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">add_arguments</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> arguments<span class="token punctuation">:</span> list <span class="token operator">or</span> tuple<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        同时添加多个浏览器参数        :param arguments: 启动参数集        """</span>        <span class="token keyword">if</span> arguments<span class="token punctuation">:</span>            <span class="token keyword">if</span> isinstance<span class="token punctuation">(</span>arguments<span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span>arguments<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> arg <span class="token keyword">in</span> arguments<span class="token punctuation">:</span>                    <span class="token keyword">if</span> self<span class="token punctuation">.</span>_is_infobars<span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>_enable_infobars<span class="token punctuation">(</span><span class="token punctuation">)</span>                    <span class="token keyword">else</span><span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>_arguments<span class="token punctuation">.</span>append<span class="token punctuation">(</span>arg<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"argument参数不能为空"</span><span class="token punctuation">)</span>    @staticmethod    <span class="token keyword">def</span> <span class="token function">_is_infobars</span><span class="token punctuation">(</span>string<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> string <span class="token operator">==</span> <span class="token string">"--disable-infobars"</span>    <span class="token keyword">def</span> <span class="token function">_enable_infobars</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        启用'禁用浏览器正在被自动化程序控制的提示'启动参数        """</span>        self<span class="token punctuation">.</span>_experimental_options<span class="token punctuation">[</span><span class="token string">"excludeSwitches"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"enable-automation"</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">to_capabilities</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token triple-quoted-string string">"""        使用已设置的所有选项创建功能        :return: 返回包含所有内容的字典        """</span>        caps <span class="token operator">=</span> self<span class="token punctuation">.</span>_caps        edge_options <span class="token operator">=</span> <span class="token punctuation">{</span>            <span class="token string">"extensions"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token string">"args"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>arguments        <span class="token punctuation">}</span>        edge_options<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>experimental_options<span class="token punctuation">)</span>        caps<span class="token punctuation">[</span>self<span class="token punctuation">.</span>KEY<span class="token punctuation">]</span> <span class="token operator">=</span> edge_options        <span class="token keyword">return</span> caps</code></pre><h2 id="项目目录"><a href="#项目目录" class="headerlink" title="项目目录"></a>项目目录</h2><p><img src="https://img-blog.csdnimg.cn/23dc9dd0f49748fea379dcda8add619e.png"></p><h2 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h2><h3 id="lib文件夹下-main-py"><a href="#lib文件夹下-main-py" class="headerlink" title="lib文件夹下 main.py"></a><code>lib文件夹下 main.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span>sysFilePath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>FilePath<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 将 JingDongProject 的路径置入环境变量</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> bin <span class="token keyword">import</span> Spider_JingDong    Spider_JingDong<span class="token punctuation">.</span>spride<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h3 id="bin文件夹下-Spider-JingDong-py"><a href="#bin文件夹下-Spider-JingDong-py" class="headerlink" title="bin文件夹下 Spider_JingDong.py "></a><code>bin文件夹下 Spider_JingDong.py </code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> core <span class="token keyword">import</span> Really_Sprider<span class="token keyword">class</span> <span class="token class-name">spride</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"{}Running{}"</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">"-"</span><span class="token operator">*</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        Really_Sprider<span class="token punctuation">.</span>really_sprider<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="conf文件夹下-Setting-py"><a href="#conf文件夹下-Setting-py" class="headerlink" title="conf文件夹下 Setting.py "></a><code>conf文件夹下 Setting.py </code></h2><pre class=" language-python"><code class="language-python">URL <span class="token operator">=</span> <span class="token string">"https://www.jd.com/"</span><span class="token comment" spellcheck="true"># 休眠等待的问题，有时候要等待网页加载或者说怕被检验，但很有可能是我网速的问题</span>SLEEPTIME <span class="token operator">=</span> <span class="token number">2</span><span class="token comment" spellcheck="true"># 一开始下载的商品评论 txt 文件默认下载地址</span>DOWNLOAD_PATH <span class="token operator">=</span> r<span class="token string">'C:\Users\ASUS\Desktop\code\JingDongProject\download\download.txt'</span><span class="token comment" spellcheck="true"># 将下载的 txt文件 内容存储到 xlsx 文件中的下载地址</span>EXCEL_PATH <span class="token operator">=</span> r<span class="token string">'C:\Users\ASUS\Desktop\code\JingDongProject\download\data.xlsx'</span><span class="token comment" spellcheck="true"># 需要爬取的商品页数</span>PAGE <span class="token operator">=</span> <span class="token number">2</span><span class="token comment" spellcheck="true"># 每页搜索的商品数（最多到61，京东一页商品最多60个，因为使用 for 循环所有选择 60+1），最好保证爬取页数页面所有的商品数量 >= PURE_PAGE_NUM，否则会超出索引</span>PURE_PAGE_NUM <span class="token operator">=</span> <span class="token number">3</span><span class="token comment" spellcheck="true"># 评论页数</span>GOODS_PAGE <span class="token operator">=</span> <span class="token number">2</span></code></pre><h3 id="core文件夹下-really-spider-py-文件"><a href="#core文件夹下-really-spider-py-文件" class="headerlink" title="core文件夹下 really_spider.py 文件"></a><code>core文件夹下 really_spider.py 文件</code></h3><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 使用的是 edge 浏览器的 自动测试</span><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>common<span class="token punctuation">.</span>keys <span class="token keyword">import</span> Keys<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver<span class="token punctuation">.</span>edge<span class="token punctuation">.</span>EdgeOptions <span class="token keyword">import</span> EdgeOptions<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">from</span> conf <span class="token keyword">import</span> Setting<span class="token keyword">class</span> <span class="token class-name">really_sprider</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>search_name<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>search_option<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">search_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入商品名称</span>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"输入您想要搜素的商品名称："</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(name)</span>    <span class="token keyword">def</span> <span class="token function">search_option</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 选择商品排序方式</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            tip <span class="token operator">=</span> <span class="token triple-quoted-string string">"""---------------------------------------------            选择商品排序方式（输入数字）---------------------------------------------                1.    综合                2.    销量                3.    评论数----------------------------------------------            """</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>tip<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>num <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"选择商品排序方式（输入数字）:"</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token operator">not</span> self<span class="token punctuation">.</span>num<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            <span class="token keyword">elif</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">3</span> <span class="token operator">or</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">continue</span>            num <span class="token operator">=</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">def</span> <span class="token function">start_webdriver</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 启动浏览器</span>        <span class="token comment" spellcheck="true"># 1.创建Edge浏览器对象，这会在电脑上在打开一个浏览器窗口</span>        options <span class="token operator">=</span> EdgeOptions<span class="token punctuation">(</span><span class="token punctuation">)</span>        options<span class="token punctuation">.</span>add_arguments<span class="token punctuation">(</span><span class="token punctuation">[</span>r<span class="token string">"--headless"</span><span class="token punctuation">,</span> r<span class="token string">"--disable-gpu"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 无头浏览器</span>        self<span class="token punctuation">.</span>driver <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Edge<span class="token punctuation">(</span>capabilities<span class="token operator">=</span>options<span class="token punctuation">.</span>to_capabilities<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># self.driver = webdriver.Edge()</span>        <span class="token comment" spellcheck="true"># 2.通过浏览器向服务器发送URL请求</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>get<span class="token punctuation">(</span>Setting<span class="token punctuation">.</span>URL<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 点击搜索之后的页面</span>        self<span class="token punctuation">.</span>click_search<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>line_way<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>        page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        page <span class="token operator">=</span> int<span class="token punctuation">(</span>tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_topPage"]/span/i/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        page <span class="token operator">=</span> min<span class="token punctuation">(</span>page<span class="token punctuation">,</span> Setting<span class="token punctuation">.</span>PAGE<span class="token punctuation">)</span>        <span class="token keyword">for</span> page <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Setting<span class="token punctuation">.</span>PAGE <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>click_good<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 点击商品进入商品详情页</span>            <span class="token comment" spellcheck="true"># 点击下一页</span>            next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_bottomPage"]/span[1]/a[9]'</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> next_page<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">click_search</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 输入商品名称并点击搜索</span>        self<span class="token punctuation">.</span>start_webdriver<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 输入商品名称</span>        name_input <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span>        name_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>self<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 点击搜索</span>        click <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="search"]/div/div[2]/button'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> click<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 滚动加载该页面所有商品</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">line_way</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 点击排序方式</span>        xpath <span class="token operator">=</span> <span class="token string">'//*[@id="J_filter"]/div[1]/div[1]/a[{}]'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>self<span class="token punctuation">.</span>num<span class="token punctuation">)</span>        sales_count <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> sales_count<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">click_good</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 点击进入商品详情页</span>        <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Setting<span class="token punctuation">.</span>PURE_PAGE_NUM<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 获取商品名称</span>            <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>            page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source            <span class="token comment" spellcheck="true"># xpath 解析</span>            tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[4]/a/em/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>            num <span class="token operator">=</span> <span class="token string">""</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> self<span class="token punctuation">.</span>goods_name<span class="token punctuation">:</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                i <span class="token operator">=</span> i<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"\t"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>                num <span class="token operator">+=</span> i            self<span class="token punctuation">.</span>goods_name <span class="token operator">=</span> num            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_name<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 进入商品详情页面</span>            xpath <span class="token operator">=</span> <span class="token string">'//*[@id="J_goodsList"]/ul/li[{}]/div/div[1]/a'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span>            good_detail <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span>xpath<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> good_detail<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 商品评价下载</span>            self<span class="token punctuation">.</span>comment_download<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">comment_download</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 商品评价下载</span>        self<span class="token punctuation">.</span>new_window<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 滑到底部，等待评论加载完成</span>        comment_box <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="detail"]/div[1]/ul/li[5]'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> comment_box<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>        page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        page <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment"]/div[2]/div[2]/div[1]/ul/li[1]/a/em/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token string">"+"</span> <span class="token keyword">in</span> page <span class="token operator">and</span> <span class="token string">"万"</span> <span class="token keyword">in</span> page<span class="token punctuation">:</span>            page <span class="token operator">=</span> Setting<span class="token punctuation">.</span>GOODS_PAGE            <span class="token keyword">for</span> p <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> page <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>content<span class="token punctuation">(</span>i<span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 点击下一页</span>                <span class="token keyword">if</span> p <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                    next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[12]/div/div/a[7]'</span><span class="token punctuation">)</span>                <span class="token keyword">elif</span> p <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">:</span>                    next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[12]/div/div/a[8]'</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    next_page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[12]/div/div/a[8]'</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> next_page<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>Sleep<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>close_window<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">new_window</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 获取窗口,返回为一个列表</span>        handles <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>window_handles        <span class="token comment" spellcheck="true"># 最后一个是新打开的窗口，跳转到这个窗口</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">close_window</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 关闭新打开的窗口</span>        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        handles <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>window_handles        self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">content</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 获取评价，包括商品名称、用户名、是否是会员，评分星级，评价文字内容</span>        <span class="token triple-quoted-string string">"""        xpath 解析        //*[@id="comment-0"]/div[1]        """</span>        <span class="token comment" spellcheck="true"># 获取此时的页面源码</span>        page <span class="token operator">=</span> self<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>page_source        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 用户名</span>        username <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[1]/div[1]/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 是否是会员</span>        huiyuan <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[1]/div[2]/a/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> len<span class="token punctuation">(</span>huiyuan<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            huiyuan <span class="token operator">=</span> <span class="token string">"None"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            huiyuan <span class="token operator">=</span> huiyuan<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 评价内容</span>        content <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[2]/p/text()'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 星级</span>        star <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div[{}]/div[2]/div[1]/@class'</span><span class="token punctuation">.</span>format<span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># print(star)</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>Setting<span class="token punctuation">.</span>DOWNLOAD_PATH<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token keyword">as</span> f<span class="token punctuation">:</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>self<span class="token punctuation">.</span>goods_name <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> huiyuan <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> star <span class="token operator">+</span> <span class="token string">"|"</span> <span class="token operator">+</span> content<span class="token punctuation">)</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">Sleep</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        sleep<span class="token punctuation">(</span>Setting<span class="token punctuation">.</span>SLEEPTIME<span class="token punctuation">)</span></code></pre><h3 id="download-文件夹下-ToExcel-py"><a href="#download-文件夹下-ToExcel-py" class="headerlink" title="download 文件夹下 ToExcel.py"></a><code>download 文件夹下 ToExcel.py</code></h3><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> os<span class="token punctuation">,</span>syspath <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sys<span class="token punctuation">.</span>path<span class="token punctuation">.</span>append<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">from</span> conf<span class="token punctuation">.</span>Setting <span class="token keyword">import</span> DOWNLOAD_PATH<span class="token punctuation">,</span>EXCEL_PATH    <span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook    book <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>    sheet <span class="token operator">=</span> book<span class="token punctuation">.</span>active    title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"goods_name"</span><span class="token punctuation">,</span> <span class="token string">"username"</span><span class="token punctuation">,</span> <span class="token string">"huiyuan"</span><span class="token punctuation">,</span> <span class="token string">"star"</span><span class="token punctuation">,</span> <span class="token string">"comment content"</span><span class="token punctuation">)</span>    sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>title<span class="token punctuation">)</span>    <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isfile<span class="token punctuation">(</span>DOWNLOAD_PATH<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>DOWNLOAD_PATH<span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>                line_list <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"|"</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># self.goods_name + "|" + username + "|" + huiyuan + "|" + star + "|" + content</span>                sheet<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line_list<span class="token punctuation">)</span>        book<span class="token punctuation">.</span>save<span class="token punctuation">(</span>EXCEL_PATH<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"can't find the DOANLOAD file!!!"</span><span class="token punctuation">)</span></code></pre><h2 id="注意事项或者说是-Bug"><a href="#注意事项或者说是-Bug" class="headerlink" title="注意事项或者说是 Bug"></a>注意事项或者说是 Bug</h2><ol><li>所要爬取商品页数一定是存在的，不能超过该商品页面的总页数</li><li>保证每页要爬取的商品数量都存在，即：需要在该页面爬取5个商品，但实际上该页面只有3个商品</li><li>因为某些原因（当时没有找到解决方法，现在知道了不想在上面直接改了），目前爬取的商品评价是过万的商品的评价，所以未过万的商品评论并不会下载</li><li>商品名称的问题，后来才发现京东上一些商品是有缩略图的，如下图我圈起来的部分；所以一些商品在爬取过程中是没有名字下载的，因为我参考的姓名定位是有缩略图的名字，所以无缩略图的商品爬取过程中是没有名字的（当时没有找到解决方法，现在知道了不想在上面直接改了）</li></ol><h2 id="一个小坑"><a href="#一个小坑" class="headerlink" title="一个小坑"></a>一个小坑</h2><p>因为还存在这些小问题，并且一些问题已经找到解决办法了，所以在最近国庆前后会写一个修改版的代码，应该会加上简单的 PyQt5 界面。</p><h2 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h2><p><img src="https://img-blog.csdnimg.cn/f61070993fd7438db7a0494c34cd2a9f.gif"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十 —— scrapy 框架关于下载中间件的补充</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-guan-yu-xia-zai-zhong-jian-jian-de-bu-chong/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-guan-yu-xia-zai-zhong-jian-jian-de-bu-chong/</url>
      
        <content type="html"><![CDATA[<h1 id="下载中间件拦截请求"><a href="#下载中间件拦截请求" class="headerlink" title="下载中间件拦截请求"></a>下载中间件拦截请求</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>在《行百里者半九十 —— scrapy 框架（6）》一文中我们介绍了下载中间件的作用，并演示了其中拦截响应的代码实现。</p><p>现在我们来试着实现拦截请求的代码实现，也就是UA池和代理池的实现。因为免费 IP 总是失效，所以在这里只提供中间件部分的代码实现，不提供运行结果。</p><p>正因为此，代码可能有所疏漏，还望各位看官海涵。</p><h2 id="中间件部分代码实现"><a href="#中间件部分代码实现" class="headerlink" title="中间件部分代码实现"></a>中间件部分代码实现</h2><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your spider middleware</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/spider-middleware.html</span><span class="token keyword">from</span> scrapy <span class="token keyword">import</span> signals<span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> is_item<span class="token punctuation">,</span> ItemAdapter<span class="token comment" spellcheck="true"># class MidproSpiderMiddleware:</span><span class="token comment" spellcheck="true">#     # Not all methods need to be defined. If a method is not defined,</span><span class="token comment" spellcheck="true">#     # scrapy acts as if the spider middleware does not modify the</span><span class="token comment" spellcheck="true">#     # passed objects.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     @classmethod</span><span class="token comment" spellcheck="true">#     def from_crawler(cls, crawler):</span><span class="token comment" spellcheck="true">#         # This method is used by Scrapy to create your spiders.</span><span class="token comment" spellcheck="true">#         s = cls()</span><span class="token comment" spellcheck="true">#         crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)</span><span class="token comment" spellcheck="true">#         return s</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     def process_spider_input(self, response, spider):</span><span class="token comment" spellcheck="true">#         # Called for each response that goes through the spider</span><span class="token comment" spellcheck="true">#         # middleware and into the spider.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#         # Should return None or raise an exception.</span><span class="token comment" spellcheck="true">#         return None</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     def process_spider_output(self, response, result, spider):</span><span class="token comment" spellcheck="true">#         # Called with the results returned from the Spider, after</span><span class="token comment" spellcheck="true">#         # it has processed the response.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#         # Must return an iterable of Request, or item objects.</span><span class="token comment" spellcheck="true">#         for i in result:</span><span class="token comment" spellcheck="true">#             yield i</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     def process_spider_exception(self, response, exception, spider):</span><span class="token comment" spellcheck="true">#         # Called when a spider or process_spider_input() method</span><span class="token comment" spellcheck="true">#         # (from other spider middleware) raises an exception.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#         # Should return either None or an iterable of Request or item objects.</span><span class="token comment" spellcheck="true">#         pass</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     def process_start_requests(self, start_requests, spider):</span><span class="token comment" spellcheck="true">#         # Called with the start requests of the spider, and works</span><span class="token comment" spellcheck="true">#         # similarly to the process_spider_output() method, except</span><span class="token comment" spellcheck="true">#         # that it doesn’t have a response associated.</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#         # Must return only requests (not items).</span><span class="token comment" spellcheck="true">#         for r in start_requests:</span><span class="token comment" spellcheck="true">#             yield r</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true">#     def spider_opened(self, spider):</span><span class="token comment" spellcheck="true">#         spider.logger.info('Spider opened: %s' % spider.name)</span><span class="token keyword">import</span> random<span class="token keyword">class</span> <span class="token class-name">MidproDownloaderMiddleware</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 代理池</span>    proxy_http <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    proxy_https <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 拦截请求</span>    <span class="token keyword">def</span> <span class="token function">process_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># UA伪装</span>        user_agent_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># UA池</span>        request<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">"User-Agent"</span><span class="token punctuation">]</span> <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>user_agent_list<span class="token punctuation">)</span>        <span class="token keyword">return</span> None    <span class="token comment" spellcheck="true"># 拦截所有响应</span>    <span class="token keyword">def</span> <span class="token function">process_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># Called with the response returned from the downloader.</span>        <span class="token comment" spellcheck="true"># Must either;</span>        <span class="token comment" spellcheck="true"># - return a Response object</span>        <span class="token comment" spellcheck="true"># - return a Request object</span>        <span class="token comment" spellcheck="true"># - or raise IgnoreRequest</span>        <span class="token keyword">return</span> response    <span class="token comment" spellcheck="true"># 拦截所有异常</span>    <span class="token keyword">def</span> <span class="token function">process_exception</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> exception<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"http"</span><span class="token punctuation">:</span>            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">"proxy"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"http://"</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>self<span class="token punctuation">.</span>proxy_http<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            request<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">"proxy"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"https://"</span> <span class="token operator">+</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>self<span class="token punctuation">.</span>proxy_https<span class="token punctuation">)</span>        <span class="token keyword">return</span> request <span class="token comment" spellcheck="true"># 将修正之后的请求对象重新进行请求发送</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（7）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-7/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-7/</url>
      
        <content type="html"><![CDATA[<h1 id="CrawlSpider-实现全站数据爬取"><a href="#CrawlSpider-实现全站数据爬取" class="headerlink" title="CrawlSpider 实现全站数据爬取"></a>CrawlSpider 实现全站数据爬取</h1><h2 id="CrawlSpider-介绍"><a href="#CrawlSpider-介绍" class="headerlink" title="CrawlSpider 介绍"></a>CrawlSpider 介绍</h2><h3 id="全站数据爬取的方式"><a href="#全站数据爬取的方式" class="headerlink" title="全站数据爬取的方式"></a>全站数据爬取的方式</h3><pre class=" language-python"><code class="language-python">        <span class="token operator">-</span><span class="token operator">-</span> 基于 Spider：手动请求（递归实现）        <span class="token operator">-</span><span class="token operator">-</span> 基于 CrawlSpider</code></pre><h3 id="CrawlSpider（Spider-的一个子类）的使用"><a href="#CrawlSpider（Spider-的一个子类）的使用" class="headerlink" title="CrawlSpider（Spider 的一个子类）的使用"></a>CrawlSpider（Spider 的一个子类）的使用</h3><pre class=" language-python"><code class="language-python">        <span class="token operator">-</span><span class="token operator">-</span> 创建一个工程 scrapy startproject Pro        <span class="token operator">-</span><span class="token operator">-</span> cd Pro        <span class="token operator">-</span><span class="token operator">-</span> 创建爬虫文件（CrawlSpider）：            <span class="token operator">-</span><span class="token operator">-</span> scrapy genspider <span class="token operator">-</span>t crawl filename www<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>com            <span class="token operator">-</span><span class="token operator">-</span> 链接提取器（LinkExtractor）：                <span class="token operator">-</span><span class="token operator">-</span> 作用：根据指定的规则（allow，正则表达式）进行指定链接的提取            <span class="token operator">-</span><span class="token operator">-</span> 规则提取器（Rule）：                <span class="token operator">-</span><span class="token operator">-</span> 作用：将链接提取到的链接进行指定规则（callback）的解析</code></pre><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>使用 CrawlSpider 实现<a href="http://www.521609.com/ziliao/oumei/">校花网明星资料</a>的全站爬取</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>配置文件<code>settings.py</code></p><p><img src="https://img-blog.csdnimg.cn/c713db96a32f405da0f9a99216362748.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/85df6e6bad934071a5901531d6409ac0.png"><br>实例化对象 <code>items.py</code></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">CrawlspiderproItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    content <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p>主文件</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>linkextractors <span class="token keyword">import</span> LinkExtractor<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>spiders <span class="token keyword">import</span> CrawlSpider<span class="token punctuation">,</span> Rule<span class="token keyword">from</span> CrawlSpiderPro<span class="token punctuation">.</span>items <span class="token keyword">import</span> CrawlspiderproItem<span class="token keyword">class</span> <span class="token class-name">CrawlspiderSpider</span><span class="token punctuation">(</span>CrawlSpider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'CrawlSpider'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.521609.com/ziliao/oumei/'</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 作用：根据指定的规则（allow）进行指定链接的提取</span>    link_index <span class="token operator">=</span> LinkExtractor<span class="token punctuation">(</span>allow <span class="token operator">=</span> r<span class="token string">"/ziliao/oumei/.*?.html"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 翻页的网址</span>    link_message <span class="token operator">=</span> LinkExtractor<span class="token punctuation">(</span>allow <span class="token operator">=</span> r<span class="token string">"/ziliao/.*?.html"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 人物详情页的网址</span>    <span class="token comment" spellcheck="true"># 规则提取器：将链接提取器的链接提取到的链接进行指定规则（callback）的解析</span>    rules <span class="token operator">=</span> <span class="token punctuation">(</span>        Rule<span class="token punctuation">(</span>link_index<span class="token punctuation">,</span> callback <span class="token operator">=</span> <span class="token string">'parse_name'</span><span class="token punctuation">,</span> follow <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        Rule<span class="token punctuation">(</span>link_message<span class="token punctuation">,</span> callback <span class="token operator">=</span> <span class="token string">'parse_content'</span><span class="token punctuation">,</span> follow <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parse_name</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        name_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul/li//h3/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        item <span class="token operator">=</span> CrawlspiderproItem<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> name <span class="token keyword">in</span> name_list<span class="token punctuation">:</span>            item<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">=</span>name            <span class="token keyword">yield</span> item        <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">parse_content</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        content_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="info"]//text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        item <span class="token operator">=</span> CrawlspiderproItem<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> content <span class="token keyword">in</span> content_list<span class="token punctuation">:</span>            item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span> <span class="token operator">=</span> content            <span class="token keyword">yield</span> item        <span class="token keyword">pass</span></code></pre><p>管道文件<code>pipelines.py</code></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token keyword">class</span> <span class="token class-name">CrawlspiderproPipeline</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 如何判定 item 类型</span>        <span class="token comment" spellcheck="true"># 将数据写入数据库，如何保证数据的一致性</span>        <span class="token keyword">if</span> item<span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__name__ <span class="token operator">==</span> <span class="token string">"XiaohuaproItem"</span><span class="token punctuation">:</span>            name <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>        <span class="token keyword">return</span> item</code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/5b84223005d84324bd025bc5d346da80.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（6）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-6/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-6/</url>
      
        <content type="html"><![CDATA[<h1 id="中间件的使用——爬取网易新闻"><a href="#中间件的使用——爬取网易新闻" class="headerlink" title="中间件的使用——爬取网易新闻"></a>中间件的使用——爬取网易新闻</h1><h2 id="scrapy-五大核心组件"><a href="#scrapy-五大核心组件" class="headerlink" title="scrapy 五大核心组件"></a>scrapy 五大核心组件</h2><h3 id="引擎（Scrapy）"><a href="#引擎（Scrapy）" class="headerlink" title="引擎（Scrapy）"></a>引擎（Scrapy）</h3><p>用来处理整个系统的数据流量，触发事务（框架核心）</p><h3 id="调度器（Scheduler）"><a href="#调度器（Scheduler）" class="headerlink" title="调度器（Scheduler）"></a>调度器（Scheduler）</h3><p>用来接受引擎发送的请求，压入队列中，并在引擎再次请求的时候返回，可以想象成一个 URL （抓取网页的网址或者说是链接）的有限队列，由它来决定下一个要抓取的网址是什么，同时去除重复的网址。</p><h3 id="下载器（Downloader）"><a href="#下载器（Downloader）" class="headerlink" title="下载器（Downloader）"></a>下载器（Downloader）</h3><p>用于下载网页内容，并将网页内容返回给爬虫（Spiders），下载器是建立在 twisted 这个高效的异步模型上的。</p><h3 id="爬虫（Spider）"><a href="#爬虫（Spider）" class="headerlink" title="爬虫（Spider）"></a>爬虫（Spider）</h3><p>爬虫是主要干活的，用于从特定的网页中提取自己需要的信息，即所谓的实体（item），用户也可以从中提取出链接，让 引擎（Scrapy） 继续抓取下一个页面。</p><h3 id="项目管道（Pipeline）"><a href="#项目管道（Pipeline）" class="headerlink" title="项目管道（Pipeline）"></a>项目管道（Pipeline）</h3><p>负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体，验证实体的有效性，清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</p><p><img src="https://img-blog.csdnimg.cn/005247374f084154896fd9f11296d99c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="中间件（Middlewares）的介绍"><a href="#中间件（Middlewares）的介绍" class="headerlink" title="中间件（Middlewares）的介绍"></a>中间件（Middlewares）的介绍</h2><h3 id="下载中间件（Downloader-Middlewares）"><a href="#下载中间件（Downloader-Middlewares）" class="headerlink" title="下载中间件（Downloader Middlewares）"></a>下载中间件（Downloader Middlewares）</h3><p>位置：引擎和下载器之间</p><p>作用：批量拦截到整个工程中所有的请求和响应</p><p>拦截请求：<br>    1. UA伪装<br>    2. 代理IP</p><p>拦截响应：<br>    1.  篡改响应数据，响应对象</p><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>爬取网易新闻的新闻数据</p><h2 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h2><p>在开始写代码的时候，我们首先要到网易新闻网页中踩点，知己知彼，百战不殆。</p><p>网易首页稀疏平常，跟其他的网页差别不大，但我们点开随便一个模块，比如说 “国内”，在下拉网页的时候我们会发现这些网页都是动态加载的。</p><p>很显然，但目前为止，我们所学的 scrapy 框架解决不了这个问题。</p><p>对于动态加载的情况，我们首先想到的肯定是 selenium 爬取数据，那么在 scrapy 中我们要怎么和 selenium 结合呢？</p><p>没错，这就是中间件拦截响应的作用了。 </p><p>至于中间件具体怎么使用，大家还是看代码吧。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>配置文件<code>settings.py</code></p><p><img src="https://img-blog.csdnimg.cn/90d889922cae4f1895bea6da7744f74e.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>管道和下载中间件的开启（注意是下载中间件：<code>DOWNLOADER_MIDDLEWARES</code>）</p><p><img src="https://img-blog.csdnimg.cn/3f1786c81c5f45dc8fd4acde13546e42.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>主文件代码编写</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> newsPro<span class="token punctuation">.</span>items <span class="token keyword">import</span> NewsproItem<span class="token keyword">class</span> <span class="token class-name">NewsSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'news'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://news.163.com/'</span><span class="token punctuation">]</span>    all_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 起判断作用，其中要发送请求的网址包含动态加载的内容，需要下载中间件拦截，并使用 selenium 替换响应对象</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>bro <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">'C:\\Users\\ASUS\\Desktop\\CSDN\\selenium 模块\\chromedriver.exe'</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 获取国内、国际、军事新闻模块的网址</span>        guonei_url <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//li[@class="menu_guonei"]/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(guonei_url)</span>        self<span class="token punctuation">.</span>all_urls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>guonei_url<span class="token punctuation">)</span>        guoji_url <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//li[@class="menu_guoji"]/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(guoji_url)</span>        self<span class="token punctuation">.</span>all_urls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>guoji_url<span class="token punctuation">)</span>        war_url <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//li[@class="menu_war"]/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(war_url)</span>        self<span class="token punctuation">.</span>all_urls<span class="token punctuation">.</span>append<span class="token punctuation">(</span>war_url<span class="token punctuation">)</span>        <span class="token keyword">for</span> url <span class="token keyword">in</span> self<span class="token punctuation">.</span>all_urls<span class="token punctuation">:</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> callback <span class="token operator">=</span> self<span class="token punctuation">.</span>parse_news_url<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parse_news_url</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 通过对国内、国际、军事新闻模块的网址发送请求（此时响应对象已经被下载中间件替换了）获取新闻的详情页的网址</span>        new_urls <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="ndi_main"]/div/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> new_url <span class="token keyword">in</span> new_urls<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># print(new_url)</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> callback <span class="token operator">=</span> self<span class="token punctuation">.</span>parse_new<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">parse_new</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 获取新闻标题和内容</span>        item <span class="token operator">=</span> NewsproItem<span class="token punctuation">(</span><span class="token punctuation">)</span>        title <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="post_main"]/h1/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>        content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="post_body"]//text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(title)</span>        <span class="token comment" spellcheck="true"># print(content)</span>        item<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> title        item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span> <span class="token operator">=</span> content        <span class="token keyword">yield</span> item        <span class="token keyword">pass</span></code></pre><p>实例化对象 <code>items.py</code></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">NewsproItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    title <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    content <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p>下载中间件 <code>middlewares.py</code></p><p>下载中间件的类和函数方法很多，我们要注意选择是下载中间件和其中的 <code>process_response</code> 自定义函数</p><p><img src="https://img-blog.csdnimg.cn/787523404e1f4ac3babd351b72ba0118.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p> <code>process_response</code> 自定义函数的代码如下：</p><pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">process_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        bro <span class="token operator">=</span> spider<span class="token punctuation">.</span>bro        <span class="token comment" spellcheck="true"># spider 表示对应的爬虫对象</span>        <span class="token comment" spellcheck="true"># 挑选出指定的响应对象进行篡改</span>        <span class="token comment" spellcheck="true"># 通过 url 构造 request</span>        <span class="token keyword">if</span> request<span class="token punctuation">.</span>url <span class="token keyword">in</span> spider<span class="token punctuation">.</span>all_urls<span class="token punctuation">:</span>            bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>url<span class="token punctuation">)</span>            page <span class="token operator">=</span> bro<span class="token punctuation">.</span>page_source            sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 针对定位到的 reponse 进行篡改</span>            <span class="token comment" spellcheck="true"># 实例化一个新的响应对象（符合需求：包含动态加载的新闻数据），代替旧的响应对象</span>            new_response <span class="token operator">=</span> HtmlResponse<span class="token punctuation">(</span>url <span class="token operator">=</span> request<span class="token punctuation">.</span>url<span class="token punctuation">,</span> body <span class="token operator">=</span> page<span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">,</span> request <span class="token operator">=</span> request<span class="token punctuation">)</span>            <span class="token keyword">return</span> new_response        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> response</code></pre><p>管道 <code>pipelines.py</code></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token keyword">class</span> <span class="token class-name">NewsproPipeline</span><span class="token punctuation">:</span>    fp <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'网易新闻.txt'</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬虫开始……"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        title <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span>        content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> title <span class="token keyword">is</span> <span class="token operator">not</span> None<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"爬取成功！"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> item    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取结束！！！"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（5）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-5/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-5/</url>
      
        <content type="html"><![CDATA[<h1 id="scrapy爬取图片"><a href="#scrapy爬取图片" class="headerlink" title="scrapy爬取图片"></a>scrapy爬取图片</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>爬取<a href="https://sc.chinaz.com/tupian/">站长素材中的图片</a></p><h2 id="图片数据爬取之ImagesPipeline"><a href="#图片数据爬取之ImagesPipeline" class="headerlink" title="图片数据爬取之ImagesPipeline"></a>图片数据爬取之ImagesPipeline</h2><h3 id="scrapy爬取图片-1"><a href="#scrapy爬取图片-1" class="headerlink" title="scrapy爬取图片"></a>scrapy爬取图片</h3><p>xpath 解析出图片 src 的属性值。单独对图片地址发起请求获取图片二进制类型的数据。</p><h3 id="ImagesPipeline"><a href="#ImagesPipeline" class="headerlink" title="ImagesPipeline"></a>ImagesPipeline</h3><p>只需要将 img 中 src 的属性进行解析，提交到管道，管道就会对图片的 src 进行请求发送获取图片的二进制并进行持久化存储。</p><h3 id="使用流程"><a href="#使用流程" class="headerlink" title="使用流程"></a>使用流程</h3><ol><li>数据解析（获得图片的地址）</li><li>将存储地址的 item 提交到制定的管道类</li><li>在管道文件中自定制有一个基于 <code>ImagesPipeLine</code> 的管道类<br> — 函数方法 <code>get_media_request</code> 发送请求<br> — 函数方法 <code>fifle_path</code> 自定义图片名称<br> — 函数方法 <code>item_completed</code> 将 item 传递给下一个被执行的管道类</li><li>在配置文件中<br> — 指定图片存储的位置：<code>IMAGES_STORE = &quot;./photo&quot;</code><br> — 指定开启的管道：自定制的管道类</li></ol><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>当我们按照 xpath 解析图片地址的时候，发现自己爬取到的地址为空。</p><p>主文件如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">PhotoSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'photo'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://sc.chinaz.com/tupian/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        src_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="container"]/div/div/a/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>src_list<span class="token punctuation">)</span>        <span class="token keyword">for</span> src <span class="token keyword">in</span> src_list<span class="token punctuation">:</span>            src <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> src            <span class="token keyword">print</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/98964fe0d24d499a88df1b4907a1ebda.png"><br>这是为什么呢？</p><p>我们打开网页，检查代码会发现，这些图片地址所在的属性分为两种，一种是 src， 一种是 src2。</p><p><img src="https://img-blog.csdnimg.cn/ab389660feb441348b64e98f8f604101.png"><br><img src="https://img-blog.csdnimg.cn/1011741a853a41e4be8fdaa3cb071e7d.png"><br>那么这两种有什么区别呢？</p><p>我们打开检查代码下拉页面会发现，如果图片进入可视化区域那么属性就会从 src2 变为 src 。</p><p>所以在爬取数据 xpath 解析的时候我们属性的选择应该是 src2 。</p><p>主文件</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> photopro<span class="token punctuation">.</span>items <span class="token keyword">import</span> PhotoproItem<span class="token keyword">import</span> re<span class="token keyword">class</span> <span class="token class-name">PhotoSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'photo'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://sc.chinaz.com/tupian/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        src_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="container"]/div/div/a/img/@src2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> src <span class="token keyword">in</span> src_list<span class="token punctuation">:</span>            src <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> src            <span class="token keyword">print</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/33fa1f303d7c430e89d1893012bb5323.png"><br>同时我们通过点击详情页观看图片的方式，发现爬取到的地址只是缩略图，而原图和爬取到的地址相差了一个<code>_s</code>。</p><p>爬取到的地址 <code>https://scpic3.chinaz.net/Files/pic/pic9/202107/bpic23822_s.jpg</code><br>高清的地址 <code>https://scpic3.chinaz.net/Files/pic/pic9/202107/bpic23822.jpg</code></p><p>🆗，了解到了这两个注意事项，我们就可以来写代码了。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>自定制管道类 <code>pipelines.py</code></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token comment" spellcheck="true"># class PhotoproPipeline:</span><span class="token comment" spellcheck="true">#     def process_item(self, item, spider):</span><span class="token comment" spellcheck="true">#         return item</span><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> scrapy<span class="token punctuation">.</span>pipelines<span class="token punctuation">.</span>images <span class="token keyword">import</span> ImagesPipeline<span class="token keyword">class</span> <span class="token class-name">ImgPipeline</span><span class="token punctuation">(</span>ImagesPipeline<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 对 item 中的图片进行请求操作</span>    <span class="token keyword">def</span> <span class="token function">get_media_requests</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"src"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 定制图片的名称</span>    <span class="token keyword">def</span> <span class="token function">file_path</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response <span class="token operator">=</span> None<span class="token punctuation">,</span> info <span class="token operator">=</span> None<span class="token punctuation">)</span><span class="token punctuation">:</span>        url <span class="token operator">=</span> request<span class="token punctuation">.</span>url        file_name <span class="token operator">=</span> url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> file_name    <span class="token keyword">def</span> <span class="token function">item_completed</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> result<span class="token punctuation">,</span> item<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> item <span class="token comment" spellcheck="true"># 该返回值会传递给下一个即将被执行的管道类</span></code></pre><p><code>items.py</code> 的代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">PhotoproItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    src <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p>主文件代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> photopro<span class="token punctuation">.</span>items <span class="token keyword">import</span> PhotoproItem<span class="token keyword">import</span> re<span class="token keyword">class</span> <span class="token class-name">PhotoSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'photo'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://sc.chinaz.com/tupian/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        src_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@id="container"]/div/div/a/img/@src2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> src <span class="token keyword">in</span> src_list<span class="token punctuation">:</span>            src <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> src            src <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"_s"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> src<span class="token punctuation">)</span>            item <span class="token operator">=</span> PhotoproItem<span class="token punctuation">(</span><span class="token punctuation">)</span>            item<span class="token punctuation">[</span><span class="token string">"src"</span><span class="token punctuation">]</span> <span class="token operator">=</span> src            <span class="token comment" spellcheck="true"># print(src)</span>            <span class="token keyword">yield</span> item</code></pre><p>配置文件</p><p><img src="https://img-blog.csdnimg.cn/47838dc02887470ab1f8bdf75c95d76c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/268660c3ebff450e9abe471a090aa174.png"></p><p><code>photopro.pipelines.ImgPipeline</code> 中 <code>photopro.pipelines.</code>后面填写的一定是前面自定制的管道类。</p><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/2aad40fbbf8a4cc9aae161ea3714e35c.png"><br><img src="https://img-blog.csdnimg.cn/ab63258090574941a1211c154aab998c.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（4）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-4/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-4/</url>
      
        <content type="html"><![CDATA[<h1 id="深度爬取——请求传参"><a href="#深度爬取——请求传参" class="headerlink" title="深度爬取——请求传参"></a>深度爬取——请求传参</h1><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>爬取 <a href="http://www.521609.com/ziliao/gangtai/">校花网</a> 中港台明星的名字和简介</p><p>信息分别在两个页面里</p><p><img src="https://img-blog.csdnimg.cn/06a219fd98874296ba05a8ff39d82028.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/7994d22830674e9f9b3cd0f178c83be8.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h2><p>我们发现要实现这个目的，我们既要对原页面进行数据爬取，也要对详情页进行明星简介的爬取。</p><p>这时候我们似乎可以使用前面学的回调函数的方法，调用一个新的函数方法对详情页进行数据爬取。</p><p>不过这个方法还有一个问题，就是怎么保证在原页面爬取的名字数据可以和详情页的一一对应。（不考虑在详情页同时爬取名字和简介信息，不然还怎么介绍请求传参）</p><p>解决这个问题的方法就是请求传参，简单来说，就是在回调函数的时候，将已经爬取到的名字作为参数传到被调用的函数中。</p><p>听起来似乎听抽象的，那么就直接看代码好了。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>首先使前期准备工作。</p><p>配置文件。<br><img src="https://img-blog.csdnimg.cn/4f53e9f72ca5484ab1cacc9dc87bc9d7.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/a0683c1bea8845a28dbda8d2c8ce2476.png"><br><code>items.py</code> 文件的代码编写</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">DataproItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    content <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p>主文件的代码编写</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> DataPro<span class="token punctuation">.</span>items <span class="token keyword">import</span> DataproItem<span class="token keyword">class</span> <span class="token class-name">StardataSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'Data'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.521609.com/ziliao/gangtai/'</span><span class="token punctuation">]</span>    url <span class="token operator">=</span> <span class="token string">"http://www.521609.com/ziliao/gangtai/index_%s.html"</span>    page_num <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">def</span> <span class="token function">parse_detail</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 爬取详情页</span>        content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//span[@class="info"]/p//text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        item <span class="token operator">=</span> response<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'item'</span><span class="token punctuation">]</span>        content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>        item<span class="token punctuation">[</span><span class="token string">'content'</span><span class="token punctuation">]</span> <span class="token operator">=</span> content        <span class="token keyword">yield</span> item    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 明星姓名的列表</span>        start_name_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="page_starlist page_zllist"]/ul/li/a[2]/h3/text()'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>start_name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            item <span class="token operator">=</span> DataproItem<span class="token punctuation">(</span><span class="token punctuation">)</span>            start_name <span class="token operator">=</span> start_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            item<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> start_name            <span class="token comment" spellcheck="true"># 根据姓名的位置，判断对应的详情页位置的网址位置，实现一一对应</span>            path <span class="token operator">=</span> <span class="token string">'//div[@class="page_starlist page_zllist"]/ul/li[%s]/a[2]/@href'</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>            src <span class="token operator">=</span> <span class="token string">'http://www.521609.com/'</span> <span class="token operator">+</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>extract_first<span class="token punctuation">(</span><span class="token punctuation">)</span>                        <span class="token comment" spellcheck="true"># meta 实现请求传参，请求传参的形式是字典形式</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> src<span class="token punctuation">,</span> callback <span class="token operator">=</span> self<span class="token punctuation">.</span>parse_detail<span class="token punctuation">,</span> meta <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"item"</span><span class="token punctuation">:</span> item<span class="token punctuation">}</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>page_num <span class="token operator">&lt;=</span> <span class="token number">22</span><span class="token punctuation">:</span>            new_url <span class="token operator">=</span> self<span class="token punctuation">.</span>url <span class="token operator">%</span> str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>page_num<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>page_num <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token comment" spellcheck="true"># 对于翻页的情况，实现回调函数</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> callback <span class="token operator">=</span> self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span></code></pre><p><code>pipelines.py</code> 文件的代码编写</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token keyword">class</span> <span class="token class-name">DataproPipeline</span><span class="token punctuation">:</span>    fp <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"资料.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始爬取……"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>        name <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"name"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">"爬取成功！"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> item    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取结束！！！"</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/c76fd5ec367044c79bfd34ced06c1126.png"><br><img src="https://img-blog.csdnimg.cn/f1cea8357fea4adf85d253582dbef263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（3）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-3/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-3/</url>
      
        <content type="html"><![CDATA[<h1 id="全站数据爬取：以校花网为例"><a href="#全站数据爬取：以校花网为例" class="headerlink" title="全站数据爬取：以校花网为例"></a>全站数据爬取：以校花网为例</h1><h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>爬取 <a href="http://www.521609.com/tuku/shz/">校花网</a> 中全部照片的名称，以生活照为例。</p><h2 id="思路分析"><a href="#思路分析" class="headerlink" title="思路分析"></a>思路分析</h2><p>如果不用 scrapy 框架实现全站数据爬取其实是简单的，只要找到网址的规律一直遍历就行。那么如果要用scrapy框架实现全站数据爬取应该怎么办呢？</p><p>其实经过前面对 scrapy 框架的学习，我们发现 <code>parse</code> 函数方法的作用就是让我们对指定的网址网站数据解析，所以想要完成全站数据爬取，我们只需要循环调用 <code>parse</code> 函数方法。</p><p>我们首先也需要找到网址的规律，构造一个网址模板。</p><p>我们知道 scrapy 只会对 <code>start_urls</code> 列表内的内容进行发送请求，那么我们要怎么实现不停地调用  <code>parse</code> 函数方法呢？</p><p>这个方法就是 回调函数。</p><p>简单来说，就是在编写 <code>parse</code> 函数时，在函数的最后再调用一次该函数。简单来说就是递归使用 <code>parse</code> 函数。</p><p>明白了原理，那就试试吧，直接上代码。</p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><p>首先是配置文件。UA伪装、robots协议、日志的设置、管道的打开</p><p><img src="https://img-blog.csdnimg.cn/21b60097709746f795d38618493a7323.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/e4b0ab895fcb45e4859b54707af32292.png"><br>主文件代码的编写</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> photo<span class="token punctuation">.</span>items <span class="token keyword">import</span> PhotoItem<span class="token keyword">class</span> <span class="token class-name">NameSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'name'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.521609.com/tuku/shz/index.html'</span><span class="token punctuation">]</span>    url <span class="token operator">=</span> <span class="token string">"http://www.521609.com/tuku/shz/index_%s.html"</span>    index <span class="token operator">=</span> <span class="token number">2</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        name_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="inn"]/ul/li/a/@title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(name_list)</span>        <span class="token keyword">for</span> name <span class="token keyword">in</span> name_list<span class="token punctuation">:</span>            item <span class="token operator">=</span> PhotoItem<span class="token punctuation">(</span><span class="token punctuation">)</span>            item<span class="token punctuation">[</span><span class="token string">"photo_name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> name            <span class="token keyword">yield</span> item        <span class="token keyword">if</span> self<span class="token punctuation">.</span>index <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>            new_url <span class="token operator">=</span> self<span class="token punctuation">.</span>url <span class="token operator">%</span> str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>index<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 回调函数</span>            <span class="token keyword">yield</span> scrapy<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> callback <span class="token operator">=</span> self<span class="token punctuation">.</span>parse<span class="token punctuation">)</span>            self<span class="token punctuation">.</span>index <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">pass</span></code></pre><p><code>items.py</code> 文件的代码编写</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">PhotoItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    photo_name <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p><code>pipelines.py</code> 文件的代码编写</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token keyword">class</span> <span class="token class-name">PhotoPipeline</span><span class="token punctuation">:</span>    fp <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"照片名称.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬虫开始……"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        photo_name <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"photo_name"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo_name <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> item    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取数据结束！！！"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>运行结果</p><p><img src="https://img-blog.csdnimg.cn/07ecba61366b49b2b137220c4e93f65b.png"></p><p><img src="https://img-blog.csdnimg.cn/ab6afa842a2e4fbbbf805bdb18a1e366.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（2）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-2/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-2/</url>
      
        <content type="html"><![CDATA[<h1 id="scrapy-持久化存储（以糗事百科为例）"><a href="#scrapy-持久化存储（以糗事百科为例）" class="headerlink" title="scrapy 持久化存储（以糗事百科为例）"></a>scrapy 持久化存储（以糗事百科为例）</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>不知道大家还记得爬虫万能的三步骤吗？没错，那就是指定URL，发送请求，持久化保存数据。</p><p>我们前面在 scrapy框架（1）中简单了解了使用 scrapy 指定URL和发送请求，那么我们又要怎么使用 scrapy 实现数据的持久化存储呢？</p><p>scrapy 框架实现数据持久化存储的方法有两种，一种是基于终端命令的持久化存储；一种是基于管道的持久化存储。</p><h2 id="基于终端指令的持久化存储"><a href="#基于终端指令的持久化存储" class="headerlink" title="基于终端指令的持久化存储"></a>基于终端指令的持久化存储</h2><p>首先我们先创建相应的 scrapy 文件，用我们学过的方法完成指定URL和请求发送的步骤。</p><p>相关步骤如下<br><img src="https://img-blog.csdnimg.cn/20210710143834387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>scrapy 指定URL，发送指令的文件和代码如下：</p><p>配置文件 <code>setting.py</code></p><p><img src="https://img-blog.csdnimg.cn/20210710152408579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>主代码 <code>saveData.py</code></p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">SavedataSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'saveData'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.qiushibaike.com/text/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># xpath 解析。作者的列表</span>        author_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="col1 old-style-col1"]/div/div[1]/a[1]/img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 返回一个列表</span>        <span class="token comment" spellcheck="true"># print(author_list)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>author_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            path <span class="token operator">=</span> <span class="token string">'//div[@class="col1 old-style-col1"]/div[%s]/a[1]/div/span//text()'</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(content)</span>        <span class="token keyword">pass</span></code></pre><p>接下就是基于终端指令的持久化存储了</p><pre class=" language-python"><code class="language-python">基于终端指令的持久化存储：    —— 要求：只可以将 parse 方法中的返回值存储到本地的文本文件中    —— 注意：持久化存储的文本文件的类型只能是“json”，“jsonlines”，“jl”，“csv”，“xml”    —— 指令：scrapy crawl xxx <span class="token operator">-</span>o filePath    —— 好处：简洁高效便捷    —— 缺点：局限性比较强（数据只可以存储到指定后缀的文本文件中）</code></pre><p>相关文件代码如下：</p><p>相关文件<code>items.py</code>（其实自己加的代码并不多）</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define here the models for your scraped items</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># See documentation in:</span><span class="token comment" spellcheck="true"># https://docs.scrapy.org/en/latest/topics/items.html</span><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">QiushiItem</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Item<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># define the fields for your item here like:</span>    <span class="token comment" spellcheck="true"># name = scrapy.Field()</span>    author <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    content <span class="token operator">=</span> scrapy<span class="token punctuation">.</span>Field<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">pass</span></code></pre><p>主代码<code>saveData.py</code></p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">SavedataSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'saveData'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.qiushibaike.com/text/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># xpath 解析。作者的列表</span>        author_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="col1 old-style-col1"]/div/div[1]/a[1]/img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 返回一个列表</span>        <span class="token comment" spellcheck="true"># print(author_list)</span>        all_data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>author_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            path <span class="token operator">=</span> <span class="token string">'//div[@class="col1 old-style-col1"]/div[%s]/a[1]/div/span//text()'</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>            author <span class="token operator">=</span> author_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># print(content)</span>            data <span class="token operator">=</span> <span class="token punctuation">{</span>                <span class="token string">"author"</span><span class="token punctuation">:</span> author<span class="token punctuation">,</span>                <span class="token string">"content"</span><span class="token punctuation">:</span> content            <span class="token punctuation">}</span>            all_data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">return</span> all_data</code></pre><p>终端指令<br><img src="https://img-blog.csdnimg.cn/20210710200454256.png"><br>运行结果</p><p><img src="https://img-blog.csdnimg.cn/20210710200530207.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="基于管道的持久化存储"><a href="#基于管道的持久化存储" class="headerlink" title="基于管道的持久化存储"></a>基于管道的持久化存储</h2><p>我们可以发现基于终端指令的局限性其实很大，所以我们通常不使用基于终端命令的方法进行数据的持久化存储。那么就是基于管道的持久化存储了。</p><p>前期工作和基于终端的持久化存储一样。只是在配置文件要做出一点改变。</p><p>其中<code>items.py</code>不需要改变。配置文件<code>settings.py</code>基本不变，只需要打开管道就行<br><img src="https://img-blog.csdnimg.cn/20210712225023779.png"><br>先是管道文件 <code>pipelines.py</code> 的代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># Define your item pipelines here</span><span class="token comment" spellcheck="true">#</span><span class="token comment" spellcheck="true"># Don't forget to add your pipeline to the ITEM_PIPELINES setting</span><span class="token comment" spellcheck="true"># See: https://docs.scrapy.org/en/latest/topics/item-pipeline.html</span><span class="token comment" spellcheck="true"># useful for handling different item types with a single interface</span><span class="token keyword">from</span> itemadapter <span class="token keyword">import</span> ItemAdapter<span class="token keyword">class</span> <span class="token class-name">QiushiPipeline</span><span class="token punctuation">:</span>    fp <span class="token operator">=</span> None    <span class="token keyword">def</span> <span class="token function">open_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 打开爬虫，函数名一定要是这个。只被调用一次</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始爬虫……"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fp <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">"数据.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">process_item</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> item<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 每传入一个参数，就调用一次</span>        author <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"author"</span><span class="token punctuation">]</span>        content <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"作者："</span> <span class="token operator">+</span> author <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"内容："</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> item    <span class="token keyword">def</span> <span class="token function">close_spider</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> spider<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬虫结束！！！"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>fp<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>然后是主代码 <code>saveDate.py</code></p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">from</span> qiushi<span class="token punctuation">.</span>items <span class="token keyword">import</span> QiushiItem <span class="token comment" spellcheck="true"># 导入 items.py 文件中函数</span><span class="token keyword">class</span> <span class="token class-name">SavedateSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'saveDate'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'https://www.qiushibaike.com/text/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># xpath 解析。作者的列表</span>        author_list <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="col1 old-style-col1"]/div/div[1]/a[1]/img/@alt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 返回一个列表</span>        <span class="token comment" spellcheck="true"># print(author_list)</span>        item <span class="token operator">=</span> QiushiItem<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>author_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            path <span class="token operator">=</span> <span class="token string">'//div[@class="col1 old-style-col1"]/div[%s]/a[1]/div/span//text()'</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> response<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span>extract<span class="token punctuation">(</span><span class="token punctuation">)</span>            content <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>content<span class="token punctuation">)</span>            author <span class="token operator">=</span> author_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            item<span class="token punctuation">[</span><span class="token string">"author"</span><span class="token punctuation">]</span> <span class="token operator">=</span> author            item<span class="token punctuation">[</span><span class="token string">"content"</span><span class="token punctuation">]</span> <span class="token operator">=</span> content            <span class="token keyword">yield</span> item</code></pre><p>我们试着运行一下代码，结果如下：</p><p><img src="https://img-blog.csdnimg.cn/20210712231244482.png"><br><img src="https://img-blog.csdnimg.cn/20210712231305201.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>行百里者半九十——scrapy 框架（1）</title>
      <link href="/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-1/"/>
      <url>/2022/11/22/xing-bai-li-zhe-ban-jiu-shi-scrapy-kuang-jia-1/</url>
      
        <content type="html"><![CDATA[<h1 id="scrapy-框架初识"><a href="#scrapy-框架初识" class="headerlink" title="scrapy 框架初识"></a>scrapy 框架初识</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>如果没记错，python 3.6 及以上版本可以直接用 <code>pip install scrapy.</code>但具体是从哪个版本开始可以这样我也不是很清楚，因为我使用的 python 3.95，所以我是直接用<code>pip</code>安装的。也正因为如此，对于下载whl格式的包安装我是不太清楚的，所以不提。</p><h2 id="认识"><a href="#认识" class="headerlink" title="认识"></a>认识</h2><p>scrapy 安装成功后，我们来创建项目框架。</p><p>打开终端。cmd 或者从 pycharm 中打开终端。我以 pycharm 为例。</p><p>首先，进入到相应的目录</p><p><img src="https://img-blog.csdnimg.cn/2021070120590867.png"></p><p>创建项目框架文件夹</p><pre class=" language-cmd"><code class="language-cmd">scrapy startproject projectName</code></pre><p><img src="https://img-blog.csdnimg.cn/20210701210138855.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>在进入刚创建的文件夹，创建新的执行文件</p><pre class=" language-cmd"><code class="language-cmd">scrapy genspider fileName www.xxxx.com</code></pre><p><img src="https://img-blog.csdnimg.cn/20210701210414707.png"></p><p>然后我们打开我们创建的项目框架</p><p><img src="https://img-blog.csdnimg.cn/20210701210508359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>其中 <code>Blood.py</code>是主代码文件，<code>items.py</code> 是跟保存有关的文件，<code>middlewares.py</code>是中间件，<code>pipelines.py</code>是管道文件，<code>settings.py</code>是配置文件。这些以后会讲到的，暂且不提。</p><p>如果要执行代码，终端的命令是<code>scrapy crawl fileName</code><br>在这个案例里，就是<code>scrapy crawl Blood</code></p><h2 id="简单的代码实现"><a href="#简单的代码实现" class="headerlink" title="简单的代码实现"></a>简单的代码实现</h2><p>先打开 <code>Blood.py</code>文件<br>其中代码如下：<br><img src="https://img-blog.csdnimg.cn/20210701210943336.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>我圈起来的部分是允许爬虫爬取的网站的域名，而下面的列表是待爬取的网址。这就是说，如果待爬取的网址不属于我圈起来的域名，这些网址就不会被爬取。所以一般来说，我们直接是将这一行代码注释掉。</p><p>然后我们试着爬取百度首页。</p><p>首先代码如下:</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> scrapy<span class="token keyword">class</span> <span class="token class-name">BloodSpider</span><span class="token punctuation">(</span>scrapy<span class="token punctuation">.</span>Spider<span class="token punctuation">)</span><span class="token punctuation">:</span>    name <span class="token operator">=</span> <span class="token string">'Blood'</span>    <span class="token comment" spellcheck="true"># allowed_domains = ['www.xxx.com']</span>    start_urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'http://www.baidu.com/'</span><span class="token punctuation">]</span>    <span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>url<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 打印爬取的网址</span>        <span class="token keyword">pass</span></code></pre><p>执行代码<code>scrapy crawl Blood</code></p><p>运行结果：<br><img src="https://img-blog.csdnimg.cn/20210701211700447.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>好家伙，这一坨是什么东西？</p><p>先来看我圈起来的部分，先是说连接到百度首页，再说被 robots 协议禁止了。好家伙，原来这是日志啊，但是 robots 协议怎么办？</p><p>没事，是时候打开我们的配置文件了</p><p><img src="https://img-blog.csdnimg.cn/20210701212034397.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>这里我们看到，我们的 scrapy 框架遵守 robots 协议，所以我们将 True 改成 False。再运行一次，🆗，这次没有报错了。</p><p><img src="https://img-blog.csdnimg.cn/20210701212211474.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>但是这一坨日志可真是叫人恶心。那有什么方法吗？</p><p>简单，再次打开而配置文件。<br>添加一行代码</p><pre class=" language-python"><code class="language-python">LOG_LEVEL <span class="token operator">=</span> <span class="token string">"ERROR"</span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210701213120797.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>然后再次运行</p><p>看结果：<br><img src="https://img-blog.csdnimg.cn/20210701213147621.png"></p><p>那么使用 scrapy 框架之后怎么保存爬取的内容呢？</p><p>嘿嘿，且听下回分解。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> scrapy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（6）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-6/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-6/</url>
      
        <content type="html"><![CDATA[<h1 id="selenium-综合应用-（2）"><a href="#selenium-综合应用-（2）" class="headerlink" title="selenium 综合应用 （2）"></a>selenium 综合应用 （2）</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>模拟登录 12306</p><p>注意：目的在于验证码的识别。因为除了点击，12306在登录后还存在滑块验证码。本篇文章并不涉及滑块验证码。</p><h2 id="代码分析"><a href="#代码分析" class="headerlink" title="代码分析"></a>代码分析</h2><p><img src="https://img-blog.csdnimg.cn/202106291640446.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>首先需要定位并点击 “账号登陆”</p><p><img src="https://img-blog.csdnimg.cn/20210629164140492.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>然后问题就是账号密码和验证码的问题了。</p><p>我相信账号密码并不是什么大问题，实际上叫人无从下手的是验证码问题。这时候需要的就是我们的验证码网站了。</p><p><img src="https://img-blog.csdnimg.cn/20210629165131804.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>12306 网站的验证码基本是 1~4 个坐标，所以我们选择 type &#x3D; 27。</p><p>需要明白的是我们使用验证码识别的是坐标。</p><p>所以我们需要做的是获取验证码的图片，这时候我们不能使用以前用的方法，因为通过网址获取的验证码是动态更新的。所以我们需要对验证码部分使用代码进行截图。（这部分比较麻烦，如果有必要的话，甚至可以直接 CTRL + C 然后 CTRL + V）</p><p>需要注意的是因为我的电脑是文本显示大小是125%，所以相应的数据需要乘以或是除以 1.25。</p><p><img src="https://img-blog.csdnimg.cn/20210629165923440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">import</span> requests<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChains <span class="token comment" spellcheck="true"># 动作链</span><span class="token keyword">def</span> <span class="token function">base64_api</span><span class="token punctuation">(</span>uname<span class="token punctuation">,</span> pwd<span class="token punctuation">,</span> img<span class="token punctuation">,</span> typeid<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        base64_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        b64 <span class="token operator">=</span> base64_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"username"</span><span class="token punctuation">:</span> uname<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> pwd<span class="token punctuation">,</span><span class="token string">"typeid"</span><span class="token punctuation">:</span>typeid<span class="token punctuation">,</span> <span class="token string">"image"</span><span class="token punctuation">:</span> b64<span class="token punctuation">}</span>    result <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://api.ttshitu.com/predict"</span><span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token string">'success'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bor <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://kyfw.12306.cn/otn/resources/login.html"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 定位“账号登录”并点击</span>    btn <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'/html/body/div[2]/div[2]/ul/li[2]/a'</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> btn<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 输入账号密码</span>    user_name <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"J-userName"</span><span class="token punctuation">)</span>    user_name<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>    password <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"J-password"</span><span class="token punctuation">)</span>    password<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 对整个页面截图并保存</span>    bor<span class="token punctuation">.</span>maximize_window<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 窗口最大化</span>    photo <span class="token operator">=</span> bor<span class="token punctuation">.</span>save_screenshot<span class="token punctuation">(</span><span class="token string">"窗口截图.png"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 定位坐标位置</span>    img <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'J-loginImg'</span><span class="token punctuation">)</span>    location <span class="token operator">=</span> img<span class="token punctuation">.</span>location <span class="token comment" spellcheck="true"># 验证码图片左上角坐标。X, Y</span>    <span class="token comment" spellcheck="true"># print("location", location)</span>    size <span class="token operator">=</span> img<span class="token punctuation">.</span>size <span class="token comment" spellcheck="true"># 验证码标签对应的长宽</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"size"</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span>    rangle <span class="token operator">=</span> <span class="token punctuation">(</span>location<span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">1.25</span><span class="token punctuation">,</span> location<span class="token punctuation">[</span><span class="token string">"y"</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>location<span class="token punctuation">[</span><span class="token string">"x"</span><span class="token punctuation">]</span> <span class="token operator">+</span> size<span class="token punctuation">[</span><span class="token string">"width"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>location<span class="token punctuation">[</span><span class="token string">"y"</span><span class="token punctuation">]</span> <span class="token operator">+</span> size<span class="token punctuation">[</span><span class="token string">"height"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1.25</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 裁剪</span>    i <span class="token operator">=</span> Image<span class="token punctuation">.</span>open<span class="token punctuation">(</span><span class="token string">'窗口截图.png'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 对指定位置进行裁剪</span>    fram <span class="token operator">=</span> i<span class="token punctuation">.</span>crop<span class="token punctuation">(</span>rangle<span class="token punctuation">)</span>    fram<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">'验证码.png'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 识别验证码</span>    img_path <span class="token operator">=</span> <span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\selenium 模块\\验证码.png"</span>    result <span class="token operator">=</span> base64_api<span class="token punctuation">(</span>uname<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> pwd<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">,</span> img<span class="token operator">=</span>img_path<span class="token punctuation">,</span> typeid<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 确定要点击的位置</span>    <span class="token keyword">if</span> <span class="token string">"|"</span> <span class="token keyword">in</span> result<span class="token punctuation">:</span>        index_list <span class="token operator">=</span> result<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'|'</span><span class="token punctuation">)</span>        x_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        y_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> xy <span class="token keyword">in</span> index_list<span class="token punctuation">:</span>            xy_list <span class="token operator">=</span> xy<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>            x_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xy_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            y_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xy_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        x_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        y_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        xy_list <span class="token operator">=</span> result<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>        x_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xy_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        y_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>xy_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>x_list<span class="token punctuation">,</span> y_list<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>x_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>x_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1.25</span><span class="token punctuation">)</span>        y <span class="token operator">=</span> int<span class="token punctuation">(</span>int<span class="token punctuation">(</span>y_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">1.25</span><span class="token punctuation">)</span>        ActionChains<span class="token punctuation">(</span>bor<span class="token punctuation">)</span><span class="token punctuation">.</span>move_to_element_with_offset<span class="token punctuation">(</span>img<span class="token punctuation">,</span> int<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> int<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 点击登录</span>    btn_login <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'J-login'</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> btn_login<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（5）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-5/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-5/</url>
      
        <content type="html"><![CDATA[<h1 id="selenium-综合应用（1）"><a href="#selenium-综合应用（1）" class="headerlink" title="selenium 综合应用（1）"></a>selenium 综合应用（1）</h1><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>模拟浏览器，从京东首页开始输入关键词，爬取两页商品的名称、价格和一页评价（只包括文字，不包括视频）。评价包括用户的名称和星数。</p><h2 id="网页分析"><a href="#网页分析" class="headerlink" title="网页分析"></a>网页分析</h2><ol><li><p>首先定位搜索框的位置<br><img src="https://img-blog.csdnimg.cn/20210628212745696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p></li><li><p>前面说过商品页的商品是动态加载。不然我们只能得到 30 个商品的数据</p></li><li><p>定位商品的链接</p></li></ol><p><img src="https://img-blog.csdnimg.cn/20210628213048671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>4. 商品详情页的需要爬取的数据的定位</p><p><img src="https://img-blog.csdnimg.cn/20210628213319608.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210628213327510.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210628213333935.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>5.  翻页</p><p><img src="https://img-blog.csdnimg.cn/20210628213436926.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> rekey <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"请输入商品名称："</span><span class="token punctuation">)</span>page_index <span class="token operator">=</span> int<span class="token punctuation">(</span>input<span class="token punctuation">(</span><span class="token string">"请输入要爬取的页数："</span><span class="token punctuation">)</span><span class="token punctuation">)</span>bor <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>bor<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.jd.com/"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 定位搜索框</span>input_key <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span>input_key<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>key<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 定位按钮</span>btn <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="search"]/div/div[2]/button'</span><span class="token punctuation">)</span>bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> btn<span class="token punctuation">)</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>index <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> index <span class="token operator">&lt;</span> page_index<span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 滚轮到底，破解动态加载</span>    bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    page <span class="token operator">=</span> bor<span class="token punctuation">.</span>page_source    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 商品 li 标签的列表</span>    good_lists <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(len(good_lists))</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> len<span class="token punctuation">(</span>good_lists<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 商品的链接</span>        chain <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_goodsList"]/ul/li['</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">']//a[@target="_blank"]'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 点击，来到商品详情页</span>        bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> chain<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 跳转到新打开的窗口</span>        handles <span class="token operator">=</span> bor<span class="token punctuation">.</span>window_handles        bor<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 点击商品评价</span>        good_btn <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="detail"]/div[1]/ul/li[5]'</span><span class="token punctuation">)</span>        bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> good_btn<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 滚轮到底，破解动态加载</span>        bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        good_tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>bor<span class="token punctuation">.</span>page_source<span class="token punctuation">)</span>        good_name <span class="token operator">=</span> good_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="sku-name"]//text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        good_name <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"\s"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> good_name<span class="token punctuation">)</span>        good_price <span class="token operator">=</span> good_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="dd"]/span/span[2]//text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">" 元"</span>        <span class="token comment" spellcheck="true"># print(good_price, "\n", good_name)</span>        <span class="token comment" spellcheck="true"># print("正在爬取", good_name + "……")</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"商品.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"商品名称："</span> <span class="token operator">+</span> good_name <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"商品价格："</span> <span class="token operator">+</span> good_price <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        user_name_list <span class="token operator">=</span> good_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div/div[1]/div[1]/img/@alt'</span><span class="token punctuation">)</span>        star_list <span class="token operator">=</span> good_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div/div[2]/div[1]/@class'</span><span class="token punctuation">)</span>        conten_listt <span class="token operator">=</span> good_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comment-0"]/div/div[2]/p//text()'</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>user_name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            user_name <span class="token operator">=</span> user_name_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            star <span class="token operator">=</span> star_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            content <span class="token operator">=</span>conten_listt<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"商品.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"用户评价："</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\t"</span> <span class="token operator">+</span> <span class="token string">"用户名："</span> <span class="token operator">+</span> user_name <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\t"</span> <span class="token operator">+</span> <span class="token string">"星数："</span> <span class="token operator">+</span> star <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\t"</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(good_name, "爬取成功！！！")</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 关闭当前窗口，并跳转到一开始的窗口</span>        bor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        bor<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    index <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token comment" spellcheck="true"># 输入页数并翻页</span>    input_text <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_bottomPage"]/span[2]/input'</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> index <span class="token operator">+</span> <span class="token number">1</span>    input_text<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>    input_text<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>str<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>    btn <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="J_bottomPage"]/span[2]/a'</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> btn<span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>bor<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="https://img-blog.csdnimg.cn/20210629011314552.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（4）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-4/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-4/</url>
      
        <content type="html"><![CDATA[<h1 id="selenium-模块（4）"><a href="#selenium-模块（4）" class="headerlink" title="selenium 模块（4）"></a>selenium 模块（4）</h1><h2 id="几句题外话"><a href="#几句题外话" class="headerlink" title="几句题外话"></a>几句题外话</h2><p>因为准备期末考试的缘故，有一段时间没有写博文了，今天认真一看竟然已经有一个月没有写了。虽然我的博文只有零零总总几人看过，但期间有位大佬 “催更” ，真是叫我汗颜。</p><p>如果关注过我写的东西的时间，或许各位就会看到我中间大概有三四个月的时间没有写过博文。</p><p>明白了这一点，或许各位看官就大概能理解我的感动了，毕竟对于我这种非计算机专业的人来说，CSDN大佬的鼓励或是指正，就是激励我坚持的一个重要因素了吧。</p><p>闲话少说，今天我忙里偷闲写一篇博文，希望对各位看官有帮助。如若没有，绝对是因为我对其中的理解不够深刻。写这一篇博客，大概也有告诉那位 “大佬“ 我仍会继续坚持下去的意思。</p><p>与各位看官共勉。（似乎语气有些大了呢 <code>^_^</code>）</p><h2 id="搜索框的关键词输入（以京东为例）"><a href="#搜索框的关键词输入（以京东为例）" class="headerlink" title="搜索框的关键词输入（以京东为例）"></a>搜索框的关键词输入（以京东为例）</h2><p>在上一篇的博文中，我们提到了对商品页的商品点击以及使用滚轮的方法破解动态加载的问题。</p><p>那么问题来了，如果我既要对 “ 奥特曼 ” 这个关键词下的商品页面进行这个操作，又要对 “ 小怪兽 ”关键词下的商品页面进行同样的操作怎么办？难道要写两个程序吗？</p><p>正所谓爬虫（技术）的出现是为了一劳永逸，所以写两个程序这种笨办法绝不是我们最后会选择的办法。</p><p>既然我们使用 selenium 模块是为了模拟浏览器，那么我们就模拟到底，关键词的输入也通过程序来解决。</p><p>首先我们使用 xpath 定位定位到搜索框的位置</p><p><img src="https://img-blog.csdnimg.cn/202106261944290.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后输入关键词。使用<code>send_keys() 方法</code></p><p>话不多说，直接上代码。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bor <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    bor<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.jd.com/"</span><span class="token punctuation">)</span>    key_word_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"奥特曼"</span><span class="token punctuation">,</span> <span class="token string">"小怪兽"</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> key_word_list<span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 定位搜索框</span>        key_input <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 定位搜索按钮</span>        key_bot <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 输入关键词</span>        key_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 点击</span>        bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguments[0].click()"</span><span class="token punctuation">,</span> key_bot<span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 返回原始窗口</span>        bor<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>        sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 退出</span>    bor<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>其中</p><pre class=" language-python"><code class="language-python">bor<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于浏览器的后退功能bor<span class="token punctuation">.</span>forward<span class="token punctuation">(</span><span class="token punctuation">)</span> 相当于浏览器的前进功能</code></pre><h2 id="有关-iframe-框架的-xpath-定位-以-QQ-空间为例"><a href="#有关-iframe-框架的-xpath-定位-以-QQ-空间为例" class="headerlink" title="有关 iframe 框架的 xpath 定位(以 QQ 空间为例)"></a>有关 iframe 框架的 xpath 定位(以 QQ 空间为例)</h2><p>前面我们知道了输入关键词，然后我们就激动地想到了激动人心的使用selenium实现模拟登录了，话不多说我们直接上代码。</p><pre class=" language-python"><code class="language-python">rom time <span class="token keyword">import</span> sleep<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bor <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span><span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://qzone.qq.com/"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 首先定位到 “账号密码登录” 并点击</span>    btn <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"switcher_plogin"</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">"arguemnts[0].click()"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 定位到密码和账号输入框</span>    username <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"u"</span><span class="token punctuation">)</span>    username<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 输入账号</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    password <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span>    password<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"1213456"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 输入密码</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 点击登录</span>    login_button <span class="token operator">=</span> bor<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">"login_button"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    bor<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>但我们一运行就发现不对了，怎么报错了？<br><img src="https://img-blog.csdnimg.cn/20210626202302556.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这是怎么回事？难道没有定位到响应的元素？那这是为什么呢？</p><p>我们分析源码发现我们要定位的元素都在 iframe 的框架下</p><p><img src="https://img-blog.csdnimg.cn/2021062620245365.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>而直接使用 xpath 模块是无法直接定位框架下的元素的，所以我们要先进入这个框架</p><p>使用<code>bro.switch_to.frame(&quot;我们要定位的 iframe 的 ID&quot;) # 切换浏览器标签定位的作用域.</code></p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> selenium<span class="token punctuation">.</span>webdriver <span class="token keyword">import</span> ActionChainsbro <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path <span class="token operator">=</span> <span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 如果定位的标签是在 iframe 标签里面，则必须通过如下操作进行标签定位</span>bro<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token string">"我们要定位的 iframe 的 ID"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 切换浏览器标签定位的作用域</span>div <span class="token operator">=</span> bro<span class="token punctuation">.</span>find_element_by_xpath<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 实例化动作链</span>action <span class="token operator">=</span> ActionChains<span class="token punctuation">(</span>bro<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 点击长按指定标签</span>action<span class="token punctuation">.</span>click_and_hold<span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token comment" spellcheck="true"># perform() 表示立即执行动作链</span><span class="token comment" spellcheck="true"># move_by_offset(x, y)。 X 表示水平方向，Y 表示竖直方向</span>action<span class="token punctuation">.</span>move_by_offset<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># release 释放动作链</span>action<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>perform<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true"># 退出</span>bro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（3）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-3/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-3/</url>
      
        <content type="html"><![CDATA[<h1 id="selenium-模块自动化操作（2）（以京东为例）"><a href="#selenium-模块自动化操作（2）（以京东为例）" class="headerlink" title="selenium 模块自动化操作（2）（以京东为例）"></a>selenium 模块自动化操作（2）（以京东为例）</h1><h2 id="页面滚动"><a href="#页面滚动" class="headerlink" title="页面滚动"></a>页面滚动</h2><p>我们首先打开京东的页面，随便输入一个商品名称会看到如下的页面。</p><p>我们可以先数一数页面有多少商品。</p><p>如果我们使用滚轮滚动，我们就会发现在也页面滚动的时候页面同时也在不停地加载。</p><p>如果我们使用抓包工具，解析网页源码，在页面不滚动的情况下我们发现商品的数量是30个。</p><p><img src="https://img-blog.csdnimg.cn/20210526200651381.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>也就是这时候 li 标签只有 30 个，如果我们把页面拉到底部，再看页面有的商品我们就会发现这时候有 60 个 li 标签</p><p>这也意味着多出来的 30 个商品是动态加载的数据，是不能直接通过 selenium 的 xpath 直接解析得到的，需要手动让它加载之后再进行 xapth 解析。</p><p>这就需要代码模拟页面滚动的操作。</p><p>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bro <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path <span class="token operator">=</span> <span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://search.jd.com/Search?keyword=%E5%A5%A5%E7%89%B9%E6%9B%BC&amp;enc=utf-8&amp;wq=%E5%A5%A5%E7%89%B9%E6%9B%BC&amp;pvid=52ea37a1c5614b668de352ffb60c7960"</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 使用 javascript 命令 模拟页面滚动</span>    bro<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span></code></pre><h2 id="使用-javescript-命令实现鼠标点击"><a href="#使用-javescript-命令实现鼠标点击" class="headerlink" title="使用 javescript 命令实现鼠标点击"></a>使用 javescript 命令实现鼠标点击</h2><p>如果我们真的需要爬取京东的商品信息，一页信息肯定是不够的，这就需要我们模拟完成翻页。</p><p>按前面所学，我们可以先通过 xpath 解析得到按钮的信息，再使用 click() 方法实现模拟点击。</p><p>但实际上我们明明定位到了正确的元素，但程序会告诉我们此元素无法被点击。这是因为按钮上方有文字覆盖，比如说 “下一页” 。所以我们使用 javescript 命令实现按钮的点击。</p><p>接上述代码</p><pre class=" language-python"><code class="language-python">    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 定位到按钮（下一页）的位置</span>    btn <span class="token operator">=</span> bro<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'pn-next'</span><span class="token punctuation">)</span>    bro<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'arguments[0].click()'</span><span class="token punctuation">,</span> btn<span class="token punctuation">)</span></code></pre><h2 id="窗口的切换"><a href="#窗口的切换" class="headerlink" title="窗口的切换"></a>窗口的切换</h2><p>有时候我们可能需要商品详情页的信息，这样一来我们就需要对先打开的窗口进行 xpath 解析了。但现在我们的浏览器的页面其实一直停留在一开始打开的窗口，也就是说虽然向我们展示的是新打开的窗口，但实际上我们的自动化浏览器仍停留在原始的页面。</p><p>所以需要我们用代码实现窗口的转换</p><p>代码如下。接上述代码</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 获取窗口,返回为一个列表</span>    handles <span class="token operator">=</span> bro<span class="token punctuation">.</span>window_handles    <span class="token keyword">print</span><span class="token punctuation">(</span>handles<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 最后一个是新打开的窗口，跳转到这个窗口</span>    bro<span class="token punctuation">.</span>switch_to<span class="token punctuation">.</span>window<span class="token punctuation">(</span>handles<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 滑到底部</span>    bro<span class="token punctuation">.</span>execute_script<span class="token punctuation">(</span><span class="token string">'window.scrollTo(0,document.body.scrollHeight)'</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 关闭新打开的窗口</span>    bro<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 退出</span>    bro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（2）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-2/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-2/</url>
      
        <content type="html"><![CDATA[<h1 id="selenium-自动化操作（1）（以百度翻译为例）"><a href="#selenium-自动化操作（1）（以百度翻译为例）" class="headerlink" title="selenium 自动化操作（1）（以百度翻译为例）"></a>selenium 自动化操作（1）（以百度翻译为例）</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    bro <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path <span class="token operator">=</span> <span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 发起请求</span>    bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://fanyi.baidu.com/'</span><span class="token punctuation">)</span></code></pre><p>我们运行程序发现我们使用 selenium 请求到的网页和我们自己打开的网页有一点不同。</p><p>使用 selenium 请求到的网页多了一个页面窗口。</p><p><img src="https://img-blog.csdnimg.cn/20210524213534232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>那么我们要怎么使用 selenium 关闭这个窗口呢？</p><p>我们可以使用元素的 xpath 路径，元素的 id 名，或者说元素的属性定位到关闭的符号，并且使用 click() 方法模拟鼠标的点击。</p><p>这是定位元素的一些方法</p><p><img src="https://img-blog.csdnimg.cn/20210524214051535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 使用 class 属性定位到 “x” 符号</span>    btn <span class="token operator">=</span> bro<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'desktop-guide-close'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 模拟鼠标点击</span>    btn<span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>注意：<br>如果报错，很有可能是还没加载完成，可以使用 time.sleep() 让页面完成加载</p><p>接下来我们就看到页面来到我们熟悉的页面</p><p><img src="https://img-blog.csdnimg.cn/20210524214337671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>那么我们要怎么把我们想要翻译的文字输入到文本框中呢？</p><p>还是先定位到文本框的位置，再输入文字（使用 send_keys() 方法），点击翻译</p><pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># 定位到文本框</span>    translate_input <span class="token operator">=</span> bro<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'baidu_translate_input'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 传入文字</span>    translate_input<span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">"奥特曼"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 等待两秒</span>    sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></code></pre><p>结果如图</p><p><img src="https://img-blog.csdnimg.cn/20210524215153862.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>因为是动态加载的数据，所以我们不需要点击 “ 翻译 ”，结果就会自动出现。如果需要点击，我们也可以先定位按键的位置，再模拟点击。</p><p>那么我们要如何获取翻译的结果呢？</p><p>我们知道动态加载的数据需要找到相应的 API，那么现在我们需要吗？答案是不需要，我们只需要对现在的页面进行 xpath 解析就行。</p><p>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree……<span class="token comment" spellcheck="true"># 获取此时的页面源码</span>    page <span class="token operator">=</span> bro<span class="token punctuation">.</span>page_source    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    content <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="main-outer"]/div/div/div[1]/div[2]/div[1]/div[2]/div/div/div[1]/p[2]/span/text()'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span>    bro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>结果如下<br><img src="https://img-blog.csdnimg.cn/20210524220523678.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器 —— selenium模块（1）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-1/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-selenium-mo-kuai-1/</url>
      
        <content type="html"><![CDATA[<h2 id="简单介绍"><a href="#简单介绍" class="headerlink" title="简单介绍"></a>简单介绍</h2><p>selenium最初是一个自动化测试工具,而爬虫中使用它主要是为了解决requests无法直接执行JavaScript代码的问题</p><p>selenium本质是通过驱动浏览器，完全模拟浏览器的操作，比如跳转、输入、点击、下拉等，来拿到网页渲染之后的结果，可支持多种浏览器</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>首先是模块的安装</p><pre class=" language-cmd"><code class="language-cmd">pip3 install selenium</code></pre><p>因为使用的驱动浏览器，所以我们还需要下载响应浏览器的驱动浏览器。</p><p>以谷歌浏览器为例</p><p>这是驱动浏览器的网址<br><a href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a></p><p><img src="https://img-blog.csdnimg.cn/20210523204848280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>圈起来的部分是驱动浏览器对应的谷歌浏览器的版本号。我们选择一个和我们谷歌浏览器相符的文件夹下载下来就可以了。</p><p>下载的文件夹里会有一个可执行程序（.exe），我们可以每次复制粘贴对应的路径，也可以在写程序时将可执行程序和执行的代码放在同一个文件夹里。</p><p>我选择的是后者。</p><h2 id="简单测试"><a href="#简单测试" class="headerlink" title="简单测试"></a>简单测试</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 选择使用的浏览器，比如我用的谷歌，所以我选择 Chrome</span>    <span class="token comment" spellcheck="true"># 参数传入的是驱动浏览器的路径</span>    bro <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Chrome<span class="token punctuation">(</span>executable_path <span class="token operator">=</span> <span class="token string">"chromedriver.exe"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 传入网址。以百度翻译为例</span>    bro<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'https://fanyi.baidu.com/'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 等待5秒后，退出浏览器界面</span>    sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>    bro<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> selenium </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——协程（3）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-3/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-3/</url>
      
        <content type="html"><![CDATA[<h1 id="用-aiohttp-完成异步爬取图片"><a href="#用-aiohttp-完成异步爬取图片" class="headerlink" title="用 aiohttp 完成异步爬取图片"></a>用 aiohttp 完成异步爬取图片</h1><h2 id="代码演示"><a href="#代码演示" class="headerlink" title="代码演示"></a>代码演示</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> aiohttp<span class="token keyword">import</span> time<span class="token keyword">import</span> os<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_photo</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载："</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> <span class="token keyword">await</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>            photo <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">'C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\协程\\aiohttp 异步爬取图片\\'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载完成"</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 开始时间</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">'C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\协程\\aiohttp 异步爬取图片'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">'C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\协程\\aiohttp 异步爬取图片'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 指定url, 发送请求</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kfengjing/index.html"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">'https://pic.netbian.com/4kfengjing/index_%s.html'</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">)</span><span class="token punctuation">.</span>text        response <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'iso-8859-1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'gbk'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="main"]/div[3]/ul/li'</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>            src <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'a/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            name <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'a//text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span> get_photo<span class="token punctuation">(</span><span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> src<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">)</span>            tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 协程</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span>tasks<span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>看一下运行结果</p><p><img src="https://img-blog.csdnimg.cn/2021052210282593.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210522102533884.png"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 协程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——协程（2）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-2/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-2/</url>
      
        <content type="html"><![CDATA[<h2 id="resquests-协程的尝试"><a href="#resquests-协程的尝试" class="headerlink" title="resquests 协程的尝试"></a>resquests 协程的尝试</h2><p>前面我们学习了协程的简单的语法，以及写了一段代码实现了简单的协程。而我们的目的是为了实现异步爬虫。所以我们就用 requests 模块尝试一下协程</p><h3 id="flask服务"><a href="#flask服务" class="headerlink" title="flask服务"></a>flask服务</h3><p>首先我们用 flask 设置一个简单的框架，因为我们的重点是协程，所以选择的网站越简单越好</p><p>代码如下</p><pre class=" language-python"><code class="language-python">app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/bobo'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index_bobo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"hello bobo"</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">'/jay'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index_jay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"hello jay"</span>@app<span class="token punctuation">.</span>route<span class="token punctuation">(</span><span class="token string">"/tom"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index_tom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"hello tom"</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>threaded <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span></code></pre><p>运行结果如下</p><p><img src="https://img-blog.csdnimg.cn/20210520110054986.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们会看到一个 url ，那个就是我们通过 flask 框架得到的一个根目录</p><h3 id="resquests-模块的尝试"><a href="#resquests-模块的尝试" class="headerlink" title="resquests 模块的尝试"></a>resquests 模块的尝试</h3><p>有了前期的准备工作，我们就可以试着通过 requests 模块进行协程的实现。</p><p>根据之前所学进行代码的编写</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:5000/'</span> <span class="token operator">+</span> url<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载成功，"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'bobo'</span><span class="token punctuation">,</span> <span class="token string">"jay"</span><span class="token punctuation">,</span> <span class="token string">"tom"</span><span class="token punctuation">]</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">:</span>        task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span> get_url<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">)</span>        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span> tasks <span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>但我们一运行程序就发现不对劲了，</p><p><img src="https://img-blog.csdnimg.cn/20210520110617346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>明明我们使用了协程，为什么时间反而没有什么变化呢？这究竟是为什么呢？</p><h2 id="aiohttp-模块实现协程"><a href="#aiohttp-模块实现协程" class="headerlink" title="aiohttp 模块实现协程"></a>aiohttp 模块实现协程</h2><p>上面我们发现 requests 模块实现不了协程。这是为什么呢？</p><p>其实原因很简单，requests.get 是基于同步，要想实现协程必须使用基于异步的网络请求模块进行 url 的请求发送。所以我们使用 aiohttp模块，基于异步的网络请求模块。</p><p>至于怎么使用 aiohttp ，就直接看代码好了</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> aiohttp<span class="token keyword">import</span> time<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">get_url</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>    <span class="token keyword">async</span> <span class="token keyword">with</span> aiohttp<span class="token punctuation">.</span>ClientSession<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>        <span class="token keyword">async</span> <span class="token keyword">with</span> <span class="token keyword">await</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:5000/'</span> <span class="token operator">+</span> url<span class="token punctuation">)</span> <span class="token keyword">as</span> response<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># text() 返回字符串形式的数据类型</span>            <span class="token comment" spellcheck="true"># read() 返回二进制形式的数据类型</span>            <span class="token comment" spellcheck="true"># json() 返回json串形式的数据类型</span>            <span class="token comment" spellcheck="true"># 注意：获取响应数据类型之前一定要用 await 进行手动挂起</span>            page <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span>text<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载成功，"</span><span class="token punctuation">,</span> page<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'bobo'</span><span class="token punctuation">,</span> <span class="token string">"jay"</span><span class="token punctuation">,</span> <span class="token string">"tom"</span><span class="token punctuation">]</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">:</span>        task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span> get_url<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">)</span>        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span>    loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span> asyncio<span class="token punctuation">.</span>wait<span class="token punctuation">(</span> tasks <span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>让我们来看一些运行结果，看看是不是空欢喜一场</p><p><img src="https://img-blog.csdnimg.cn/20210520112612152.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>运行时间确实是两秒，说明我们使用 aiohttp 实现了协程。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 协程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——协程（1）</title>
      <link href="/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-1/"/>
      <url>/2022/11/22/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xie-cheng-1/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是协程"><a href="#什么是协程" class="headerlink" title="什么是协程"></a>什么是协程</h2><p>简单来说，协程就是同时开启多个任务，但一次只顺序执行一个。等到所执行的任务遭遇阻塞，就切换到下一个任务继续执行，以期节省下阻塞所占用的时间。</p><h2 id="简单说明"><a href="#简单说明" class="headerlink" title="简单说明"></a>简单说明</h2><p><img src="https://img-blog.csdnimg.cn/2021051216021149.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="简单的代码示例"><a href="#简单的代码示例" class="headerlink" title="简单的代码示例"></a>简单的代码示例</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> asyncio<span class="token keyword">import</span> time<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 定义一个协程函数</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载 url"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>    <span class="token keyword">await</span> asyncio<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 等待。等待的是一个协程函数</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载完成，"</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    urls <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">]</span>    tasks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> url <span class="token keyword">in</span> urls<span class="token punctuation">:</span>        task <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>ensure_future<span class="token punctuation">(</span> func<span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 创建协程任务</span>        tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>    loop <span class="token operator">=</span> asyncio<span class="token punctuation">.</span>get_event_loop<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 创建一个事件循环</span>        <span class="token comment" spellcheck="true"># 两种实现方式</span>    <span class="token comment" spellcheck="true"># 方式一</span>    <span class="token comment" spellcheck="true"># loop.run_until_complete( asyncio.wait(tasks) ) # 将任务注册到事件循环中</span>        <span class="token comment" spellcheck="true"># 方式二</span>    <span class="token keyword">for</span> task <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>        loop<span class="token punctuation">.</span>run_until_complete<span class="token punctuation">(</span>task<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>我们可以看看运行的结果</p><p><img src="https://img-blog.csdnimg.cn/20210512162245553.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 协程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——线程池的使用（2）</title>
      <link href="/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xian-cheng-chi-de-shi-yong-2/"/>
      <url>/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xian-cheng-chi-de-shi-yong-2/</url>
      
        <content type="html"><![CDATA[<p>好吧，我们前面爬取图片发现使用了线程池后，其实我们的效率提高不是这么明显。那我们就来试一试爬取视频吧。因为不同的网站对视频的反爬的策略都不尽相同，所以我们这里讲的示例并没有普世的意义。唯一普世的做法是好好分析视频网址的存放地址。</p><h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>首先来讲一讲我们这次爬取的视频。</p><p>我们这次爬取的视频是梨视频娱乐模块最热的视频</p><p>即图片里的前三个（但我们打开抓包工具时，又发现其实是 4 个视频，不管是几个，关系都不大）</p><p><img src="https://img-blog.csdnimg.cn/20210511163822795.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>首先我们先随便定位一个视频，得到如下的网页源码</p><p><img src="https://img-blog.csdnimg.cn/20210511164148109.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现这里的 a 标签下面有一个超链接，然后我们点击这个超链接，跳转网页，来到了视频播放页。注意这个超链接的内容，后面要用到。</p><p>接着我们再一次试图定位时，却发现我们找不到 .mp4 的网页。怎么办呢？</p><p><img src="https://img-blog.csdnimg.cn/2021051116464288.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>没事，我们可以试着播放视频再进行定位。下面就是见证奇迹的时候了。</p><p><img src="https://img-blog.csdnimg.cn/20210511165135797.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>当然，以我们目前所学是拿不到在这个动态加载的数据的，但这个步骤不是毫无用处的，我们要记住这串网址。</p><p><a href="https://video.pearvideo.com/mp4/third/20210508/cont-1728888-11721137-174842-hd.mp4">https://video.pearvideo.com/mp4/third/20210508/cont-1728888-11721137-174842-hd.mp4</a></p><p>因为是动态加载的数据，我们可以到 XHR 里面去找网址会不会在这里面。</p><p><img src="https://img-blog.csdnimg.cn/20210511165819832.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们一看，果然在！</p><p>不过先别太激动，我们把阿贾克斯加载的网址复制下来，就又发现问题了。</p><p><a href="https://video.pearvideo.com/mp4/third/20210508/1620721592006-11721137-174842-hd.mp4">https://video.pearvideo.com/mp4/third/20210508/1620721592006-11721137-174842-hd.mp4</a></p><p>我们两相对比后，发现相差的部分是：“ cont-1728888 ”。那么 count 后面的数字是从什么地方来的呢？</p><p>还记得我们一开始爬取的超链接吗？</p><p>video_1728888。这里的数字不就是我们要的吗？</p><p>欧克，分析了之后，我们还要阿贾克斯加载的参数。</p><p><img src="https://img-blog.csdnimg.cn/20210511181811947.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现其中的 contld 是已知的，那么剩下的 mrd 是什么呢？</p><p>很简单，什么都不是，只是一串随机数</p><p>到这里，我们就完成了对爬取梨视频的分析，剩下的就是代码的问题了。</p><h2 id="同步爬虫爬取梨视频"><a href="#同步爬虫爬取梨视频" class="headerlink" title="同步爬虫爬取梨视频"></a>同步爬虫爬取梨视频</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">import</span> time<span class="token keyword">import</span> random<span class="token keyword">import</span> re<span class="token keyword">def</span> <span class="token function">save_video</span><span class="token punctuation">(</span>videoNum_title<span class="token punctuation">)</span><span class="token punctuation">:</span>    video_num <span class="token operator">=</span> videoNum_title<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    title <span class="token operator">=</span> videoNum_title<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span><span class="token punctuation">,</span>        <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"https://www.pearvideo.com/"</span> <span class="token operator">+</span> <span class="token string">"video_"</span> <span class="token operator">+</span> video_num    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.pearvideo.com/videoStatus.jsp"</span>    <span class="token comment" spellcheck="true"># 传入参数</span>    param <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"contId"</span><span class="token punctuation">:</span> video_num<span class="token punctuation">,</span>        <span class="token string">"mrd"</span><span class="token punctuation">:</span> str<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 获取假网址</span>    json <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">,</span> params <span class="token operator">=</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    href <span class="token operator">=</span> json<span class="token punctuation">[</span><span class="token string">"videoInfo"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"videos"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"srcUrl"</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 获取真正的网址</span>    url <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"/.{13}-"</span><span class="token punctuation">,</span> <span class="token string">"/cont-"</span> <span class="token operator">+</span> video_num <span class="token operator">+</span> <span class="token string">"-"</span><span class="token punctuation">,</span> href<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 保存视频</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    video <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token punctuation">.</span>content    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬取梨视频\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".mp4"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬取梨视频\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".mp4"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"正在下载……"</span><span class="token punctuation">)</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>video<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬取梨视频"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬取梨视频"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.pearvideo.com/category_4"</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="listvideoListUl"]/li'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># li 标签列表</span>    List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>        title <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div//div[@class="vervideo-title"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        video_num <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        List<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>video_num<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> videoNum_title <span class="token keyword">in</span> List<span class="token punctuation">:</span>        save_video<span class="token punctuation">(</span>videoNum_title<span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210511195534468.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>同步用时 45 秒，现在让我们试试异步</p><h2 id="异步爬虫爬取梨视频"><a href="#异步爬虫爬取梨视频" class="headerlink" title="异步爬虫爬取梨视频"></a>异步爬虫爬取梨视频</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">import</span> time<span class="token keyword">import</span> random<span class="token keyword">import</span> re<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Pool<span class="token keyword">def</span> <span class="token function">save_video</span><span class="token punctuation">(</span>videoNum_title<span class="token punctuation">)</span><span class="token punctuation">:</span>    video_num <span class="token operator">=</span> videoNum_title<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    title <span class="token operator">=</span> videoNum_title<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span><span class="token punctuation">,</span>        <span class="token string">"Referer"</span><span class="token punctuation">:</span> <span class="token string">"https://www.pearvideo.com/"</span> <span class="token operator">+</span> <span class="token string">"video_"</span> <span class="token operator">+</span> video_num    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.pearvideo.com/videoStatus.jsp"</span>    <span class="token comment" spellcheck="true"># 传入参数</span>    param <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"contId"</span><span class="token punctuation">:</span> video_num<span class="token punctuation">,</span>        <span class="token string">"mrd"</span><span class="token punctuation">:</span> str<span class="token punctuation">(</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 获取假网址</span>    json <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">,</span> params <span class="token operator">=</span> param<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    href <span class="token operator">=</span> json<span class="token punctuation">[</span><span class="token string">"videoInfo"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"videos"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"srcUrl"</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 获取真正的网址</span>    url <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"/.{13}-"</span><span class="token punctuation">,</span> <span class="token string">"/cont-"</span> <span class="token operator">+</span> video_num <span class="token operator">+</span> <span class="token string">"-"</span><span class="token punctuation">,</span> href<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 保存视频</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    video <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token punctuation">.</span>content    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬取梨视频\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".mp4"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬取梨视频\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".mp4"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"正在下载……"</span><span class="token punctuation">)</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>video<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬取梨视频"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬取梨视频"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.pearvideo.com/category_4"</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="listvideoListUl"]/li'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># li 标签列表</span>    List <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>        title <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div//div[@class="vervideo-title"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        video_num <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div/a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token punctuation">]</span>        List<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>video_num<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 使用线程池</span>    pool <span class="token operator">=</span> Pool<span class="token punctuation">(</span><span class="token punctuation">)</span>    pool<span class="token punctuation">.</span>map<span class="token punctuation">(</span>save_video<span class="token punctuation">,</span> List<span class="token punctuation">)</span>    pool<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    pool<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 线程池 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——线程池的使用(1)</title>
      <link href="/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xian-cheng-chi-de-shi-yong-1/"/>
      <url>/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-xian-cheng-chi-de-shi-yong-1/</url>
      
        <content type="html"><![CDATA[<p>学到现在，我们可以说已经学习了爬虫的基础知识，如果没有那些奇奇怪怪的反爬虫机制，基本上只要有时间分析，一般的数据都是可以爬取的，那么到了这个时候我们需要考虑的就是爬取的效率了，关于提高爬虫效率，也就是实现异步爬虫，我们可以考虑以下两种方式：一是线程池的使用（也就是实现单进程下的多线程），一是协程的使用（如果没有记错，我所使用的协程模块是从python3.4以后引入的，我写博客时使用的python版本是3.9）。</p><p>今天我们先来讲讲线程池。</p><h2 id="同步代码演示"><a href="#同步代码演示" class="headerlink" title="同步代码演示"></a>同步代码演示</h2><p>我们先用普通的同步的形式写一段代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载："</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载完成："</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 开始时间</span>    url_list <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span>    <span class="token punctuation">]</span>    <span class="token keyword">for</span> url <span class="token keyword">in</span> url_list<span class="token punctuation">:</span>        func<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 结束时间</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>对于代码运行的结果我们心里都有数，但还是让我们来看一下吧</p><p><img src="https://img-blog.csdnimg.cn/2021051020454987.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>不出所料。运行时间果然是六秒</p><h2 id="异步，线程池代码"><a href="#异步，线程池代码" class="headerlink" title="异步，线程池代码"></a>异步，线程池代码</h2><p>那么如果我们使用线程池运行上述代码又会怎样呢？</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Pool<span class="token keyword">def</span> <span class="token function">func</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"正在下载："</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"下载完成："</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 开始时间</span>    url_list <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span>    <span class="token punctuation">]</span>    pool <span class="token operator">=</span> Pool<span class="token punctuation">(</span>len<span class="token punctuation">(</span>url_list<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 实例化一个线程池对象，并且设定线程池的上限数量为列表长度。不设置上限也可以。</span>    pool<span class="token punctuation">.</span>map<span class="token punctuation">(</span>func<span class="token punctuation">,</span> url_list<span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 结束时间</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>下面就是见证奇迹的时候了，让我们运行程序</p><p><img src="https://img-blog.csdnimg.cn/20210510205733844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现这次我们的运行时间只用2～3秒。其实我们可以将线程池简单的理解为将多个任务同时进行。</p><p>注意：</p><ol><li>我使用的是 pycharm，如果使用的是 VS 或者说是 python 自带的 idle，在运行时我们只能看到最后时间的输出。</li><li>我们输出结果可能并不是按 abc 的顺序输出的。</li></ol><h2 id="同步爬虫爬取图片"><a href="#同步爬虫爬取图片" class="headerlink" title="同步爬虫爬取图片"></a>同步爬虫爬取图片</h2><p>因为我们的重点是线程池的爬取效率提高，我们就简单的爬取一页的图片。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> os<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">def</span> <span class="token function">save_photo</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> title<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token punctuation">.</span>content    <span class="token comment" spellcheck="true"># 创建路径，避免重复下载</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬虫爬取4K美女图片\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬虫爬取4K美女图片\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"开始下载！！！"</span><span class="token punctuation">)</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬虫爬取4K美女图片"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\同步爬虫爬取4K美女图片"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>    <span class="token comment" spellcheck="true"># 发送请求，获取源码</span>    page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析，获取图片的下载地址的列表</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="main"]/div[3]/ul/li/a/@href'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 通过下载地址获取高清图片的地址和图片名称</span>    <span class="token keyword">for</span> href <span class="token keyword">in</span> url_list<span class="token punctuation">:</span>        new_url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> href        <span class="token comment" spellcheck="true"># 再一次发送请求</span>        page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># 再一次 xpath 解析</span>        new_tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        src <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        title <span class="token operator">=</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@title'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 编译文字</span>        title <span class="token operator">=</span> title<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 下载，保存</span>        save_photo<span class="token punctuation">(</span>src<span class="token punctuation">,</span> title<span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>让我们看看同步爬虫需要多长时间</p><p><img src="https://img-blog.csdnimg.cn/2021051021433347.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后再让我们看看使用线程池的异步爬虫爬取这些图片需要多久</p><h2 id="使用线程池的异步爬虫爬取4K美女图片"><a href="#使用线程池的异步爬虫爬取4K美女图片" class="headerlink" title="使用线程池的异步爬虫爬取4K美女图片"></a>使用线程池的异步爬虫爬取4K美女图片</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">import</span> os<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">from</span> multiprocessing <span class="token keyword">import</span> Pool<span class="token keyword">def</span> <span class="token function">save_photo</span><span class="token punctuation">(</span>src_title<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    url <span class="token operator">=</span> src_title<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    title <span class="token operator">=</span> src_title<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span><span class="token punctuation">.</span>content    <span class="token comment" spellcheck="true"># 创建路径，避免重复下载</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬虫爬取4K美女图片\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬虫爬取4K美女图片\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"开始下载！！！"</span><span class="token punctuation">)</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬虫爬取4K美女图片"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\高性能异步爬虫\\线程池\\异步爬虫爬取4K美女图片"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.93 Safari/537.36"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>    <span class="token comment" spellcheck="true"># 发送请求，获取源码</span>    page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析，获取图片的下载地址的列表</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>    url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="main"]/div[3]/ul/li/a/@href'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 存储最后的网址和标题的列表</span>    src_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    title_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token comment" spellcheck="true"># 通过下载地址获取高清图片的地址和图片名称</span>    <span class="token keyword">for</span> href <span class="token keyword">in</span> url_list<span class="token punctuation">:</span>        new_url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> href        <span class="token comment" spellcheck="true"># 再一次发送请求</span>        page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># 再一次 xpath 解析</span>        new_tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        src <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        src_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>src<span class="token punctuation">)</span>        title <span class="token operator">=</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@title'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 编译文字</span>        title <span class="token operator">=</span> title<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span>        title_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>title<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 下载，保存。使用线程池</span>    pool <span class="token operator">=</span> Pool<span class="token punctuation">(</span><span class="token punctuation">)</span>    src_title <span class="token operator">=</span> zip<span class="token punctuation">(</span>src_list<span class="token punctuation">,</span> title_list<span class="token punctuation">)</span>    pool<span class="token punctuation">.</span>map<span class="token punctuation">(</span>save_photo<span class="token punctuation">,</span> list<span class="token punctuation">(</span>src_title<span class="token punctuation">)</span><span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span></code></pre><p>让我们来看看运行的结果</p><p><img src="https://img-blog.csdnimg.cn/2021051022075983.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>只用了 17 秒，可不要小瞧这几秒，如果数据太大，这些差距后来就会更大了。</p><h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>不过我们必须要明白 线程池 是有上限的，这就是说数据太大，线程池的效率也会降低，所以这就要用到协程模块了。</p><p>欲知协程如何，且听下回分解。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 线程池 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——识别验证码（2）</title>
      <link href="/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-shi-bie-yan-zheng-ma-2/"/>
      <url>/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-shi-bie-yan-zheng-ma-2/</url>
      
        <content type="html"><![CDATA[<h2 id="模拟登录人人网"><a href="#模拟登录人人网" class="headerlink" title="模拟登录人人网"></a>模拟登录人人网</h2><p>前面我们学习了使用第三方平台实现验证码的识别，那现在就让我们来用验证码的识别实现人人网的登录。</p><p>首先我们先到人人网的登录页面去踩点。</p><p><img src="https://img-blog.csdnimg.cn/20210503195009957.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>人人网登录在三次失败后需要输入验证码，那我们现在需要做的就是通过数据解析将验证码保存到本地（为了更好的使用第三方验证码识别平台）。</p><p>有了验证码之后，我们又要怎么通过爬虫实现登录呢？首先我们打开抓包工具，看看登陆时会发生什么。</p><p><img src="https://img-blog.csdnimg.cn/20210503201139254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>首先我们先点击那个禁止符号的符号，将数据清空，然后再点击 “ preserve log ”，然后我们再实现登录。</p><p><img src="https://img-blog.csdnimg.cn/20210503201520822.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现这里有一个 login 的文件，我们点开它。</p><p><img src="https://img-blog.csdnimg.cn/20210503201643494.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现这个文件的 data 一栏里的 icode 是我们输入的验证码，那么我们就有理由怀疑这一栏需要动态改变的就是 icode 这一栏，这就是说我们前面保存的验证码在这里就有用武之地。</p><p>分析结束，就开始写代码了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">def</span> <span class="token function">base64_api</span><span class="token punctuation">(</span>uname<span class="token punctuation">,</span> pwd<span class="token punctuation">,</span> img<span class="token punctuation">,</span> typeid<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        base64_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        b64 <span class="token operator">=</span> base64_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"username"</span><span class="token punctuation">:</span> uname<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> pwd<span class="token punctuation">,</span><span class="token string">"typeid"</span><span class="token punctuation">:</span>typeid<span class="token punctuation">,</span> <span class="token string">"image"</span><span class="token punctuation">:</span> b64<span class="token punctuation">}</span>    result <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://api.ttshitu.com/predict"</span><span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token string">'success'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"http://www.renren.com/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>    src <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="verifyPic_login"]/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 验证码网址</span>    <span class="token comment" spellcheck="true"># 保存验证码</span>    photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> src<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./验证码.jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>    img_path <span class="token operator">=</span> <span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\验证码识别\\验证码.jpg"</span>    result <span class="token operator">=</span> base64_api<span class="token punctuation">(</span>uname<span class="token operator">=</span><span class="token string">'账号'</span><span class="token punctuation">,</span> pwd<span class="token operator">=</span><span class="token string">'密码'</span><span class="token punctuation">,</span> img<span class="token operator">=</span>img_path<span class="token punctuation">,</span> typeid<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 登录网址</span>    url <span class="token operator">=</span> <span class="token string">"http://www.renren.com/ajaxLogin/login?1=1&amp;uniqueTimestamp=20214120314"</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"email"</span><span class="token punctuation">:</span> <span class="token string">"15157485037"</span><span class="token punctuation">,</span>        <span class="token string">"icode"</span><span class="token punctuation">:</span> result<span class="token punctuation">,</span>        <span class="token string">"origURL"</span><span class="token punctuation">:</span> <span class="token string">"http://www.renren.com/home"</span><span class="token punctuation">,</span>        <span class="token string">"domain"</span><span class="token punctuation">:</span> <span class="token string">"renren.com"</span><span class="token punctuation">,</span>        <span class="token string">"key_id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>        <span class="token string">"captcha_type"</span><span class="token punctuation">:</span> <span class="token string">"web_login"</span><span class="token punctuation">,</span>        <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token string">"8a62222be07c2cf68e8d68f4617fe01d7dbc488427d0bc61666ab8a6e56e94f0"</span><span class="token punctuation">,</span>        <span class="token string">"rkey"</span><span class="token punctuation">:</span> <span class="token string">"07a9f1810ecf9b507634a45447a628e7"</span><span class="token punctuation">,</span>        <span class="token string">"f"</span><span class="token punctuation">:</span> <span class="token string">"http%3A%2F%2Fwww.renren.com%2F976706166%2Fprofile"</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 模拟登录</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 判断登录状态。 200 说明登录成功</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></code></pre><p>我们看一下运行结果</p><p><img src="https://img-blog.csdnimg.cn/20210503204354483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>说明登录成功。</p><p>注意：</p><p>我们一般用这种方法判断是否登录，其实也可以保存页面来判断，但有一些网站登录成功后返回的并非是网页而是 json 串，所以我们通常用 status code 来判断是否成功，200 表示和网页连接成功。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 爬虫识别验证码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>工欲善其事，必先利其器——识别验证码（1）</title>
      <link href="/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-shi-bie-yan-zheng-ma-1/"/>
      <url>/2022/11/21/gong-yu-shan-qi-shi-bi-xian-li-qi-qi-shi-bie-yan-zheng-ma-1/</url>
      
        <content type="html"><![CDATA[<h2 id="验证码识别"><a href="#验证码识别" class="headerlink" title="验证码识别"></a>验证码识别</h2><p>我们使用爬虫时很有可能需要登录，而现在的平台登陆时都需要验证码才能完成登录，所以我们使用爬虫模拟登录时验证码是必须要跨过的坎。一般情况下，我们使用第三方平台实现验证码的识别。</p><p>所以我在这里介绍一个识别验证码的平台——图鉴（比较常见的有超级鹰，反正其实这些平台注册、使用流程都差不多）。</p><p>首先我们打开图鉴的网址 “ <a href="http://www.ttshitu.com/">http://www.ttshitu.com/</a> ”，点击注册</p><p><img src="https://img-blog.csdnimg.cn/20210502163426391.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210502163508464.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>登录成功后，我们首先看一下“价格”，其实也可以在注册帐号前看一看价格，再决定是否注册。在登陆后，因为识别验证码需要登录，所以我们在使用前要确定自己的帐号里是否还有余额。我觉得这些平台的充值还是挺人性化的，，是允许我们在平台上充值一块五毛的。</p><p>我们的账号里有钱了，然后再打开开发文档。因为我们使用的是python，所以我们选择python的开发文档</p><p><img src="https://img-blog.csdnimg.cn/20210502164158248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210502164255701.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>将第一个脚本复制下来，用 IDLE 打开，我们看到代码部分的注释是提示我们 typeid 的参数选择。</p><p>在我们开始分析代码，代码自定义了一个函数，这个函数我们不需要看懂，重要的是下面的主程序，我们需要改的是我上面圈起来的部分，也就是运行程序时需要输入验证码的保存路径（也就是说我们需要将验证码先保存到本机），需要在程序中输入我们图鉴的账号和密码。</p><p>我这里有一张验证码，现在就让我们试试图鉴的脚本</p><p><img src="https://img-blog.csdnimg.cn/20210502164849608.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">import</span> requests<span class="token keyword">def</span> <span class="token function">base64_api</span><span class="token punctuation">(</span>uname<span class="token punctuation">,</span> pwd<span class="token punctuation">,</span> img<span class="token punctuation">,</span> typeid<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        base64_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        b64 <span class="token operator">=</span> base64_data<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"username"</span><span class="token punctuation">:</span> uname<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> pwd<span class="token punctuation">,</span> <span class="token string">"typeid"</span><span class="token punctuation">:</span> typeid<span class="token punctuation">,</span> <span class="token string">"image"</span><span class="token punctuation">:</span> b64<span class="token punctuation">}</span>    result <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token string">"http://api.ttshitu.com/predict"</span><span class="token punctuation">,</span> json<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>    <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token string">'success'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"result"</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> result<span class="token punctuation">[</span><span class="token string">"message"</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token string">""</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    img_path <span class="token operator">=</span> <span class="token string">"C:\\Users\\ASUS\\Desktop\\验证码.jpg"</span> <span class="token comment" spellcheck="true"># 这里填写验证码的路径</span>    result <span class="token operator">=</span> base64_api<span class="token punctuation">(</span>uname<span class="token operator">=</span><span class="token string">'账号'</span><span class="token punctuation">,</span> pwd<span class="token operator">=</span><span class="token string">'密码'</span><span class="token punctuation">,</span> img<span class="token operator">=</span>img_path<span class="token punctuation">,</span> typeid<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 因为验证码里有数字和中文，我们 typeid 选择 3</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></code></pre><p>结果如下</p><p><img src="https://img-blog.csdnimg.cn/20210502165649844.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后我们回到图鉴网站个人中心看看，结果如下</p><p><img src="https://img-blog.csdnimg.cn/20210502165922741.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>注意：<br>验证码的识别正确率并不是 100% 的，有时需要多次识别</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 爬虫识别验证码 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——xpath（4）</title>
      <link href="/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-4/"/>
      <url>/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-4/</url>
      
        <content type="html"><![CDATA[<h2 id="爬取全国的城市名称以及“或”的简单介绍"><a href="#爬取全国的城市名称以及“或”的简单介绍" class="headerlink" title="爬取全国的城市名称以及“或”的简单介绍"></a>爬取全国的城市名称以及“或”的简单介绍</h2><p>首先是爬取全国城市名称</p><p>网址如下：<a href="https://www.aqistudy.cn/historydata/">https://www.aqistudy.cn/historydata/</a></p><p>我们打开网页进行简单的数据分析</p><p><img src="https://img-blog.csdnimg.cn/20210501164316716.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现我们需要爬取的名称都在 li 标签里。根据这个我们可以很简单地写我们的代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.aqistudy.cn/historydata/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析。热门城市名称爬取</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    hot_city_name_li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="hot"]//li'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 热门城市名称的 li 标签的列表</span>    hot_city_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> li <span class="token keyword">in</span> hot_city_name_li_list<span class="token punctuation">:</span>        hot_city_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>hot_city_name<span class="token punctuation">,</span> len<span class="token punctuation">(</span>hot_city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># xpath 解析。全部城市名称爬取</span>    all_city_li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="all"]//li'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 全部城市名称的 li 标签的列表</span>    all_city_name <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> li <span class="token keyword">in</span> all_city_li_list<span class="token punctuation">:</span>        all_city_name<span class="token punctuation">.</span>append<span class="token punctuation">(</span>li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>all_city_name<span class="token punctuation">,</span> len<span class="token punctuation">(</span>all_city_name<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>看一下我们的运行结果</p><p><img src="https://img-blog.csdnimg.cn/20210501174210248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>我们这里爬取的名称是所有城市里包括热门城市的，要是不包括，我们要获取这些城市的名称，难道要把两个列表直接加起来吗？虽然不是不行，但实际上还是多写了几行代码的。</p><p>所以在这里介绍一下 xpath 里面的 “或”（“|”）和 “or” 的作用一样</p><p>闲话少说，直接看代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agnet"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.aqistudy.cn/historydata/"</span>        <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析。“|”的使用</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    city_name <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="hot"]//li/a/text() | //div[@class="all"]//li/a/text()'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>city_name<span class="token punctuation">,</span> len<span class="token punctuation">(</span>city_name<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>运行一下</p><p><img src="https://img-blog.csdnimg.cn/20210501175310824.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>名称个数正好是 394 &#x3D; 384 + 10</p><p>xpath 的 “或” 你学会了吗？</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——xpath（3）</title>
      <link href="/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-3/"/>
      <url>/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-3/</url>
      
        <content type="html"><![CDATA[<p>什么？我怎么又讲爬取图片？拜托，这可是 4k 图片，清晰度杠杠的。再说，爬取糗图算什么本事，做人要爬取的肯定是妹子图片，而且是 4k 的妹子图片，是不是很激动？放心，这次不晃你。</p><h1 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h1><p>首先让我们打开网页，好好欣赏一下美丽的妹子……哦不，我是说，好好的欣赏一下优美的网页源码。网址如下：<a href="https://pic.netbian.com/4kmeinv/">https://pic.netbian.com/4kmeinv/</a></p><p><img src="https://img-blog.csdnimg.cn/20210427102805472.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>看，是不是优美的妹子？……额咳咳，我是说优美的源码。</p><p>很好，我们注意一下定位到的源码数据，也就是我圈的地方，这里有图片的网址和图片的标题。我们就把原标题作为我们下载后的标题。注意，这里的网址没有域名，是需要我们自己加的，也就是 “<a href="https://pic.netbian.com”./">https://pic.netbian.com”。</a></p><p>欧克，是不是迫不及待了，让我们和小姐姐更进一步吧，咳咳，我是说，不说了，你懂的！</p><h1 id="文字编译"><a href="#文字编译" class="headerlink" title="文字编译"></a>文字编译</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定网址</span>    url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    new_url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@src'</span><span class="token punctuation">)</span>    title_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@alt'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 测试</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_url_ist<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>title_list<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>title_list<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>new_url_list<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>结果测试的时候发现不对了，我们的标题全都变成乱码了<br><img src="https://img-blog.csdnimg.cn/20210427104018346.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>再一看，哦，我们太激动忘记编译了，赶紧编译一下。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定网址</span>    url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>    response<span class="token punctuation">.</span>encode <span class="token operator">=</span> <span class="token string">"utf-8"</span>    response <span class="token operator">=</span> response<span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    new_url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@src'</span><span class="token punctuation">)</span>    title_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@alt'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 测试</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_url_list<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>title_list<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>title_list<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>new_url_list<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>这回总该可以了吧，再一看，怎么回事，还是乱码。<br><img src="https://img-blog.csdnimg.cn/20210427104924212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这是为什么？难道说所谓的 4k 美女图片只可远观不可亵玩吗？我不相信，赶紧去研究研究。正所谓，“X 是第一生产力”，我很快就研究出结果了，一般情况下，如果源码里有中文，我们可以有两种办法。一种是我们用的方法，另一种方法如下：</p><pre class=" language-python"><code class="language-python">response <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span></code></pre><p>我们再试一次</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定网址</span>    url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    response <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span>     <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    new_url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@src'</span><span class="token punctuation">)</span>    title_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@alt'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 测试</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>new_url_list<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>title_list<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>len<span class="token punctuation">(</span>title_list<span class="token punctuation">)</span> <span class="token operator">==</span> len<span class="token punctuation">(</span>new_url_list<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>测试一下<br><img src="https://img-blog.csdnimg.cn/20210427112301876.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>欧克，是中文了，接着可以爬取4k妹子图片了。</p><h1 id="爬取妹子图"><a href="#爬取妹子图" class="headerlink" title="爬取妹子图"></a>爬取妹子图</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻三页</span>        <span class="token comment" spellcheck="true"># 指定网址</span>        <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/index_%s.html"</span> <span class="token operator">%</span> index        <span class="token comment" spellcheck="true"># 获取源码</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        response <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        new_url_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@src'</span><span class="token punctuation">)</span>        title_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li/a/img/@alt'</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 测试</span>        <span class="token comment" spellcheck="true"># print(new_url_list)</span>        <span class="token comment" spellcheck="true"># print()</span>        <span class="token comment" spellcheck="true"># print(title_list)</span>        <span class="token comment" spellcheck="true"># print(len(title_list) == len(new_url_list))</span>        num <span class="token operator">=</span> len<span class="token punctuation">(</span>title_list<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>            new_url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> new_url_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            title <span class="token operator">=</span> title_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content            <span class="token comment" spellcheck="true"># 保存</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>完成后，我们激动地打开图片，滚烫的热血突然就冷下来了，不是说是4k高清图吗，怎么不仅是缩略图，而且画质还不行。</p><p><img src="https://img-blog.csdnimg.cn/20210427161904231.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>别着急，这可不是我骗你，是网址留了一手。</p><h1 id="爬取真正的4k妹子图"><a href="#爬取真正的4k妹子图" class="headerlink" title="爬取真正的4k妹子图"></a>爬取真正的4k妹子图</h1><p>现在我们知道了网址源码里的网址是缩略图，那么我们怎么办呢？很简单，我们点击一下会怎样？</p><p><img src="https://img-blog.csdnimg.cn/20210427162913212.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>然后我们来到了下载页面。</p><p><img src="https://img-blog.csdnimg.cn/20210427162227702.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>现在我们没有任何办法，那就试着看看现在的网页源码好了。</p><p>结果我们发现了两个图片的地址，点开，发现一个是缩略图，一个是4k妹子图。如图。</p><p><img src="https://img-blog.csdnimg.cn/20210427162537689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>是不是又感觉热血沸腾了？嘿嘿</p><p>闲话少说，赶紧改进代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片(4k)"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片(4k)"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻三页</span>        <span class="token comment" spellcheck="true"># 指定网址</span>        <span class="token keyword">if</span> index <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com/4kmeinv/index_%s.html"</span> <span class="token operator">%</span> index        <span class="token comment" spellcheck="true"># 获取源码</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        response <span class="token operator">=</span> response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span>         <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># li 标签所在的列表，下载页面的网址在 li 标签内</span>        li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="slist"]/ul/li'</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>            <span class="token comment" spellcheck="true"># 获取下载页面的网址</span>            new_url <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'a/@href'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 获取下载页面的网页源码</span>            new_response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text            new_response <span class="token operator">=</span> new_response<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"iso-8859-1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"gbk"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 编译文字</span>            <span class="token comment" spellcheck="true"># xpath 解析</span>            new_tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>new_response<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 下载的地址</span>            src <span class="token operator">=</span> <span class="token string">"https://pic.netbian.com"</span> <span class="token operator">+</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@src'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 图片标题</span>            title <span class="token operator">=</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="img"]/img/@title'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 获取图片</span>            photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> src<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content            <span class="token comment" spellcheck="true"># 保存</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\爬取 4k 图片\\4k图片(4k)\\"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">".jpg"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载成功！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>运行结束了，赶紧打开照片看一看，很好，这次真的是4k妹子图片了。</p><p><img src="https://img-blog.csdnimg.cn/2021042716474955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——xpath（2）</title>
      <link href="/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-2/"/>
      <url>/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-2/</url>
      
        <content type="html"><![CDATA[<h2 id="爬取二手房信息"><a href="#爬取二手房信息" class="headerlink" title="爬取二手房信息"></a>爬取二手房信息</h2><p>说到二手房信息，不知道你们心里最先跳出来的公司（网站）是什么，反正我心里第一个跳出来的是网站是 58 同城。哎呦，我这暴脾气，想到就赶紧去干。</p><p>但很显然，我失败了。说显然，而不是不幸，这是因为 58 同城是大公司，我这点本事爬不了数据是再正常不过的了。下面来看看 58 同城的反爬手段了。这是我爬取下来的网页源码。</p><p><img src="https://img-blog.csdnimg.cn/20210425210918311.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们看到爬取下来的源码有很多英文大写字母和数字是网页源码中没有的，后来我了解到 58 同城对自己的网站的源码进行了文本加密，所以就出现了我爬取到的情况。</p><p>然后我再打开 58 同城的 robots 协议。</p><p><img src="https://img-blog.csdnimg.cn/20210425211451911.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>好家伙，不愧是大公司，所有的动态网址都不让爬取，打扰了。我只好转头离开，去寻找可以让我这种小白爬取的二手房网站。于是我找到了这个网站<a href="https://bj.c21.com.cn/ershoufang/">https://bj.c21.com.cn/ershoufang/</a> 不知道是我的原因，还是别的原因，反正我是没有找到这个网站的 robots 协议。不管了，既然没找到，就默认没有吧，直接开始爬取。</p><p>我本来打算通过二手房的目录跳到一个具体信息，然后爬取二手房的一些基本信息和属性。</p><p><img src="https://img-blog.csdnimg.cn/20210425213046811.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210425213052882.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>像我红笔圈起来的部分。但很可惜我失败了，后来我看了看红笔圈起来的部分的爬取到的源码。</p><p><img src="https://img-blog.csdnimg.cn/20210425213736240.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>好家伙，还可以这样。不过这怎么可以难倒机智的我？（其实我真不知道怎么解决它）。没关系，之前的源码里不是有类似的信息吗？我只好将就一下了。</p><p><img src="https://img-blog.csdnimg.cn/20210425213956189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后是翻页。翻页问题很好解决，我们很快就发现网页都是 <a href="https://bj.c21.com.cn/ershoufang/pg2/">https://bj.c21.com.cn/ershoufang/pg2/</a><br>其中的页数和 pg 后面的数字有关。</p><p>然后就是分析这些数据源码的位置了。</p><p><img src="https://img-blog.csdnimg.cn/20210426161416707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>首先，我们发现我们要爬取的数据全在 li 标签里，所以我们可以先获得 li 标签的列表。伪代码就像这样。</p><pre class=" language-python"><code class="language-python">form lxml <span class="token keyword">import</span> etree……   ……tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>源码<span class="token punctuation">)</span>li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span> li 标签的路径<span class="token punctuation">)</span></code></pre><p>这时候我们获得的就是 li 标签的 etree 的类，可以继续使用 etree 类里的函数。然后我们就可以利用 for 循环提出不同房源的 li 标签，根据自己的需要获取文本信息。</p><p>欧克，了解了这些（感觉源码前前后后就是四个字 ”我是菜鸡“ ）我们就可以开始写代码了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> re<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token keyword">for</span> pg <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻两页</span>        <span class="token comment" spellcheck="true"># 指定 url</span>        url <span class="token operator">=</span> <span class="token string">"https://bj.c21.com.cn/ershoufang/pg%s/"</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>pg<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获取网页源码</span>        page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        li_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//ul[@id="availability"]/li'</span><span class="token punctuation">)</span>         <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>            title <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div[2]/div/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 房子的名称</span>            <span class="token comment" spellcheck="true"># print(title[0]) # 测试</span>            add <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div[2]/div/p//a/text()'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 地址</span>            add <span class="token operator">=</span> add<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token punctuation">]</span> <span class="token operator">+</span> add<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true"># 地址范围由大到小</span>            <span class="token comment" spellcheck="true"># print(add) # 测试</span>            div_list <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div[2]/div[2]/div'</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># 具体信息</span>            message_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"建筑面积"</span><span class="token punctuation">,</span> <span class="token string">"房屋户型"</span><span class="token punctuation">,</span> <span class="token string">"房屋朝向"</span><span class="token punctuation">,</span> <span class="token string">"所在楼层"</span><span class="token punctuation">,</span> <span class="token string">"装修情况"</span><span class="token punctuation">,</span> <span class="token string">"建成时间"</span><span class="token punctuation">]</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                div <span class="token operator">=</span> div_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span>                message <span class="token operator">=</span> div<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'span/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                message <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"\s"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 因为发现获取的文本有很多换行符和空格，所以需要去掉</span>                message <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span><span class="token string">"\\n"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> str<span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">)</span>                message_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> message_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"："</span> <span class="token operator">+</span> message            <span class="token comment" spellcheck="true"># print(message_list) # 测试</span>            <span class="token comment" spellcheck="true"># 交通情况</span>            traffic <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div[2]/div[4]//text()'</span><span class="token punctuation">)</span>            <span class="token comment" spellcheck="true"># print(traffic) # 测试</span>            <span class="token comment" spellcheck="true"># 价格情况</span>            price <span class="token operator">=</span> li<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'div[2]/div[3]//text()'</span><span class="token punctuation">)</span>            price <span class="token operator">=</span> price<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> price<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># print(price) # 测试</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\二手房\\"</span> <span class="token operator">+</span> <span class="token string">"二手房.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token keyword">for</span> message <span class="token keyword">in</span> message_list<span class="token punctuation">:</span>                    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>message <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token keyword">if</span> traffic <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">:</span>                    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"交通情况：无介绍"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"交通情况："</span> <span class="token operator">+</span> traffic<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"价格："</span> <span class="token operator">+</span> price <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>最后的运行结果就像这样<br><img src="https://img-blog.csdnimg.cn/20210426162555822.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70" alt="保存的二手房信息"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——xpath（1）</title>
      <link href="/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-1/"/>
      <url>/2022/11/21/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-xpath-1/</url>
      
        <content type="html"><![CDATA[<h1 id="xpah-的语法认识"><a href="#xpah-的语法认识" class="headerlink" title="xpah 的语法认识"></a>xpah 的语法认识</h1><p>闲话少说，直接上图<br><img src="https://img-blog.csdnimg.cn/20210424210554393.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70" alt="xpath 介绍"></p><h1 id="xpath-爬取图片"><a href="#xpath-爬取图片" class="headerlink" title="xpath 爬取图片"></a>xpath 爬取图片</h1><p>代码如下</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./糗图（xpath）"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"./糗图（xpath）"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻两页</span>        <span class="token comment" spellcheck="true"># 指定url</span>        url <span class="token operator">=</span> <span class="token string">"https://www.qiushibaike.com/imgrank/page/%s/"</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>index<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获取源码</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># xpath 解析</span>        tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        src_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="thumb"]/a/img/@src'</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(src_list) # 测试定位是否有错误</span>        <span class="token keyword">for</span> src <span class="token keyword">in</span> src_list<span class="token punctuation">:</span>            title <span class="token operator">=</span> src<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            <span class="token comment" spellcheck="true"># 新的url</span>            new_url <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> src            <span class="token comment" spellcheck="true"># 获取图片</span>            photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span>new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content            <span class="token comment" spellcheck="true"># 存储</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./糗图（xpath）/"</span> <span class="token operator">+</span> title<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载成功！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><h1 id="xpath-爬取三国演义"><a href="#xpath-爬取三国演义" class="headerlink" title="xpath 爬取三国演义"></a>xpath 爬取三国演义</h1><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url </span>    url <span class="token operator">=</span> <span class="token string">"http://sanguo.5000yan.com/"</span>    <span class="token comment" spellcheck="true"># 获取源码</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span>header<span class="token punctuation">)</span>    response<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span> <span class="token comment" spellcheck="true"># 编译源码，防止乱码</span>    response <span class="token operator">=</span> response<span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># xpath 解析</span>    tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>response<span class="token punctuation">)</span>    src_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="sidamingzhu-list-mulu"]//li[@class="menu-item"]/a/@href'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(src_list) # 测试是否正确</span>    title_list <span class="token operator">=</span> tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//div[@class="sidamingzhu-list-mulu"]//li[@class="menu-item"]/a/text()'</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(title_list) # 测试是否正确</span>        <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>src_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment" spellcheck="true"># 指定新的url</span>        new_url <span class="token operator">=</span> src_list<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        title <span class="token operator">=</span> title_list<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 获取新的网页源码</span>        page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>        page_text<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span>        page_text <span class="token operator">=</span> page_text<span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># xpath 解析</span>        new_tree <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>        page <span class="token operator">=</span> new_tree<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//section[@class="section-body"]//div[@class="grap"]//text()'</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 存储</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"C:\\Users\\ASUS\\Desktop\\CSDN\\数据解析\\xpath\\三国演义.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n\n"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span>            <span class="token keyword">for</span> i <span class="token keyword">in</span> page<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>i<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载成功！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> xpath </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——bs4</title>
      <link href="/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-bs4/"/>
      <url>/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-bs4/</url>
      
        <content type="html"><![CDATA[<h2 id="简单地使用bs4实现数据解析"><a href="#简单地使用bs4实现数据解析" class="headerlink" title="简单地使用bs4实现数据解析"></a>简单地使用bs4实现数据解析</h2><p>因为正则表达式本身有难度，所以在这里为大家介绍一下 bs4 实现数据解析。除此之外还有 xpath 解析。因为 xpath 不仅可以在 python 中使用，所以 bs4 和 正则解析一样，仅仅是简单地写两个案例（爬取可翻页的图片，以及爬取三国演义）。以后的重点会在 xpath 上。</p><p>闲话少说，我们先来安装 bs4 相关的外来库。比较简单，首先打开 cmd 命令面板，依次安装bs4 和 lxml。 命令分别是 pip install bs4 和 pip install lxml 。 安装完成后我们可以试着调用他们，看看会不会报错。因为本人水平有限，所以如果出现报错，兄弟们还是百度一下好啦。（总不至于 cmd 命令打错了吧 ~~） </p><p>闲话少说，先简单介绍一下 bs4 的用法。</p><p><img src="https://img-blog.csdnimg.cn/2021042418453326.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210424184537952.png"></p><h2 id="爬取图片"><a href="#爬取图片" class="headerlink" title="爬取图片"></a>爬取图片</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./糗图（bs4）"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"./糗图（bs4）"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻两页</span>        url <span class="token operator">=</span> <span class="token string">"https://www.qiushibaike.com/imgrank/page/%s/"</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 获取源码数据</span>        page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># 数据解析</span>        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token string">"lxml"</span><span class="token punctuation">)</span>        data_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">".thumb > a"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> data <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>            url <span class="token operator">=</span> data<span class="token punctuation">.</span>img<span class="token punctuation">[</span><span class="token string">"src"</span><span class="token punctuation">]</span>            title <span class="token operator">=</span> url<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            new_url <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> url            photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content            <span class="token comment" spellcheck="true"># 存储</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./糗图（bs4）/"</span> <span class="token operator">+</span> title<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><h2 id="爬取三国演义"><a href="#爬取三国演义" class="headerlink" title="爬取三国演义"></a>爬取三国演义</h2><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># URL</span>    url <span class="token operator">=</span> <span class="token string">"http://sanguo.5000yan.com/"</span>    <span class="token comment" spellcheck="true"># 请求命令</span>    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>    page_text<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span>    page_text <span class="token operator">=</span> page_text<span class="token punctuation">.</span>text    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>page_text<span class="token punctuation">,</span> <span class="token string">"lxml"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># bs4 解析</span>    li_list <span class="token operator">=</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">".sidamingzhu-list-mulu > ul > li"</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> li <span class="token keyword">in</span> li_list<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span>        new_url <span class="token operator">=</span> li<span class="token punctuation">.</span>a<span class="token punctuation">[</span><span class="token string">"href"</span><span class="token punctuation">]</span>        title <span class="token operator">=</span> li<span class="token punctuation">.</span>a<span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># 新的请求命令</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>        response<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span>        new_page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text        new_soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>new_page_text<span class="token punctuation">,</span> <span class="token string">"lxml"</span><span class="token punctuation">)</span>        page <span class="token operator">=</span> new_soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_ <span class="token operator">=</span> <span class="token string">"grap"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./三国演义.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> page<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> bs4 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——正则解析（2）</title>
      <link href="/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-zheng-ze-jie-xi-2/"/>
      <url>/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-zheng-ze-jie-xi-2/</url>
      
        <content type="html"><![CDATA[<h1 id="上一篇的翻页爬取图片代码"><a href="#上一篇的翻页爬取图片代码" class="headerlink" title="上一篇的翻页爬取图片代码"></a>上一篇的翻页爬取图片代码</h1><p>话不多说，直接上代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 创建文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./糗图（翻页）"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"./糗图（翻页）"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻两页</span>        url <span class="token operator">=</span> <span class="token string">"https://www.qiushibaike.com/imgrank/page/%s/"</span> <span class="token operator">%</span> str<span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 我们观察不同页数的网址会发现不同页数的网址的差异在于最后的数字</span>        <span class="token comment" spellcheck="true"># 发送请求</span>        page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text        <span class="token comment" spellcheck="true"># 正则解析</span>        ex <span class="token operator">=</span> <span class="token string">'&lt;div class="thumb">.*?&lt;img src="(.*?)" alt=".*?&lt;/div>'</span>        data_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> page<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># print(data_list) # 试着打印看看这是不是我们需要的东西</span>        <span class="token comment" spellcheck="true"># 指定图片的 url</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>            new_url <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> i            title <span class="token operator">=</span> i<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>            path <span class="token operator">=</span> <span class="token string">"./糗图（翻页）/"</span> <span class="token operator">+</span> title                        <span class="token comment" spellcheck="true"># 发送请求</span>            photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content            <span class="token comment" spellcheck="true"># 保存</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><h1 id="爬取《三国演义》"><a href="#爬取《三国演义》" class="headerlink" title="爬取《三国演义》"></a>爬取《三国演义》</h1><p>爬取图片难道就可以满足我们了吗？俗话说的好，书中自有黄金屋，书中自有颜如玉。只爬取妹子图怎么可以满足我？要来就干票大的，钱和美女我都要！！！那么说来就来，就让我们来爬取《三国演义》吧。</p><p>首先我们打开《三国演义》的目录发现所有的章节都是一个超链接，所以我们需要对该网址进行数据解析，得到所有章节的url，然后对新的 url 进行数据解析，得到网址中的所有文本信息。</p><p><img src="https://img-blog.csdnimg.cn/20210424161705238.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210424161717254.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>思路比较简单，了解之后，就可以直接写代码了</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"http://sanguo.5000yan.com/"</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>    page<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span> <span class="token comment" spellcheck="true"># 编译源码，不然我们得到的就是一些乱码</span>    page <span class="token operator">=</span> page<span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 正则解析</span>    ex <span class="token operator">=</span> <span class="token string">'&lt;li .*? href="(.*?)">(.*?)&lt;/a>&lt;/li>'</span>    new_url_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> page<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># print(new_url_list) # 测试是否为我们要的 url</span>    <span class="token keyword">for</span> new_url <span class="token keyword">in</span> new_url_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        title <span class="token operator">=</span> new_url<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        new_page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>        new_page<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span> <span class="token comment" spellcheck="true"># 编译源码，不然我们得到的就是一些乱码</span>        new_page <span class="token operator">=</span> new_page<span class="token punctuation">.</span>text        ex <span class="token operator">=</span> <span class="token string">'&lt;div>(.*?)&lt;/div>'</span>        page_text <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> new_page<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 存储</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./三国演义.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            <span class="token keyword">if</span> title <span class="token operator">==</span> <span class="token string">"第一回 宴桃园豪杰三结义 斩黄巾英雄首立功"</span><span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>title <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> title <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>                <span class="token comment" spellcheck="true"># 因为我们用正则表达式得到的数据里有超链接，所以我们需要把这些都替换掉</span>        <span class="token keyword">for</span> sencetence <span class="token keyword">in</span> page_text<span class="token punctuation">:</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"&lt;.*?>"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"&amp;mdash;"</span><span class="token punctuation">,</span> <span class="token string">"—"</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"&amp;nbsp;"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"&amp;ldquo;"</span><span class="token punctuation">,</span> <span class="token string">"“"</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"&amp;rdquo;"</span><span class="token punctuation">,</span> <span class="token string">"”"</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>            sencetence <span class="token operator">=</span> re<span class="token punctuation">.</span>sub<span class="token punctuation">(</span>r<span class="token string">"\s"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> sencetence<span class="token punctuation">)</span>                        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./三国演义.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                <span class="token keyword">if</span> sencetence <span class="token operator">!=</span> <span class="token string">""</span><span class="token punctuation">:</span>                    fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\t"</span> <span class="token operator">+</span> sencetence<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span></code></pre><p>运行结束后，我们打开文件，结果如下。</p><p><img src="https://img-blog.csdnimg.cn/20210424170658526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 正则解析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>冰冻三尺，非一日之寒。数据解析——正则解析（1）</title>
      <link href="/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-zheng-ze-jie-xi-1/"/>
      <url>/2022/11/20/bing-dong-san-chi-fei-yi-ri-zhi-han-shu-ju-jie-xi-zheng-ze-jie-xi-1/</url>
      
        <content type="html"><![CDATA[<h2 id="正则解析爬取图片"><a href="#正则解析爬取图片" class="headerlink" title="正则解析爬取图片"></a>正则解析爬取图片</h2><p>因为讲的是正则解析，而不是正则表达式，所以我就默认大家会正则表达式了。最多在这里给大家看一下正则的语法。</p><p><img src="https://img-blog.csdnimg.cn/20210420193405429.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这也是我从B站上截图截下来的。因为我自己都是学的半懂不懂的，实在没那脸说在这里讲正则表达式怎么写。</p><p>如果感觉学不会怎么办？没事，我们 python 的数据解析有正则解析、bs4解析和 xpath 解析。总有一款适合你。（这些后面都会讲到）</p><p>言归正传，什么是数据解析，在我看来，数据解析简单来说就是分析网页的源代码。</p><p>还记得像套娃一样的药监局吗？我似乎说过可以通过数据解析解决。欧克，那就让我们看一下，数据解析这么解决这个问题。</p><p>先点击左边圈起来的有鼠标样式的按键，将它移到我们的公司超链接上单击。神奇的事情发生了。<br><img src="https://img-blog.csdnimg.cn/20210420194645235.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210420194844157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们看到了一个网址，我们直接点击网址看看会发生什么。</p><p><img src="https://img-blog.csdnimg.cn/20210420194952502.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>哦豁，我们来到了这个页面，然后我们重复的步骤，将鼠标移到我们要爬取的数据上单击，然后我们就在网页上看到了我们要爬取的文本。</p><p><img src="https://img-blog.csdnimg.cn/20210420195144448.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>那我们是不是只要爬取我们在网页源码上看到的文本就可以了。是不是很简单？你要套娃？我直接开拆，是不是很有趣？</p><p>那我们前面学的 requests 模块是不是没什么用？</p><p>当然不是，爬取整张网页不是 requests 简单吗？再说就算有数据解析，有时候也不见得简单。比如说百度翻译，你可以试试用数据解析爬取，相信我，还不如分析它的 XHR 。</p><p>当然我们今天不搞药监局，天天看文字，不得恶心？今天我们来爬取图片。嘿嘿嘿嘿，图片~。我们今天的目标是妹子，哦不，是糗图网（<a href="https://www.qiushibaike.com/imgrank/%EF%BC%89%E3%80%82">https://www.qiushibaike.com/imgrank/）。</a></p><p><img src="https://img-blog.csdnimg.cn/20210420200837255.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>首先我们定位到一张图片，复制我们看到的链接，在前面加上 ” https: “ 会发现这就是我们需要的爬取东西。那么我们怎么爬取呢？很简单，在网页的源代码中查找。</p><p><img src="https://img-blog.csdnimg.cn/20210420201842147.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>如果我们试着去定位多个图片的源码位置，我们会发现所有我们需要的数据都在标签<code>&lt;div class= &quot;thumb&quot;</code>下面的<code>&lt;img src</code>里面，这时候我们就可以发挥正则表达式的强大作用了。</p><p>话不多说，直接上代码</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> re<span class="token keyword">import</span> os<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 如果不存在这个文件，创建一个文件夹</span>    <span class="token keyword">if</span> <span class="token operator">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span><span class="token string">"./糗图"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span><span class="token string">"./糗图"</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 url </span>    url <span class="token operator">=</span> <span class="token string">"https://www.qiushibaike.com/imgrank/"</span>    <span class="token comment" spellcheck="true"># 发送请求，获取网页源码</span>    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 对源代码进行正则解析</span>    ex <span class="token operator">=</span> <span class="token string">'&lt;div class="thumb".*?&lt;img src="(.*?)" alt=".*?&lt;/div>'</span>    data_list <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>ex<span class="token punctuation">,</span> page_text<span class="token punctuation">,</span> re<span class="token punctuation">.</span>S<span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># re.S 是必要的，因为我们是要单行查找</span>    <span class="token comment" spellcheck="true"># print(data_list)  我们可以先打印看看是否符合要求</span>        <span class="token comment" spellcheck="true"># 在爬取到的内容前加上 “https:”形成新的 url</span>    <span class="token keyword">for</span> data <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>        new_url <span class="token operator">=</span> <span class="token string">"https:"</span> <span class="token operator">+</span> data        title <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 请求命令</span>        photo <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> new_url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>content <span class="token comment" spellcheck="true"># conntent 命令是为了将爬取到的数据转换成数据流</span>        path <span class="token operator">=</span> <span class="token string">"./糗图/"</span> <span class="token operator">+</span> title        <span class="token comment" spellcheck="true"># 保存</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>photo<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">"下载完成！！！"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true"># 给一个下载完成的提示</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>然后我们查看新建的文件夹</p><p><img src="https://img-blog.csdnimg.cn/20210420215110158.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>这说明我们成功了。当然我们只爬取了一页网页的图片，如果我们要爬取动态的网页的图片要怎么做呢？</p><p>给个提示，观察一下第二页第三页网址的区别。</p><p>这不得自己试着写一下。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> 正则解析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（6）</title>
      <link href="/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-6/"/>
      <url>/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-6/</url>
      
        <content type="html"><![CDATA[<h1 id="药监局爬取"><a href="#药监局爬取" class="headerlink" title="药监局爬取"></a>药监局爬取</h1><p>是不是在看到 “ 药监局 ” 这三个字的时候，突然想到爬虫可能会进局子的事实？ 说到局子，我突然想到另一件事，因为前面写的是很基础的代码，没有代理池，所以在写的时候，特别是爬取翻页的时候，尽量减少爬取的页数，不然，额，后果自负。</p><p>开个玩笑，没什么大问题的，就是很有可能自己的 IP 会被对面拉入黑名单（目前学的代码而言）</p><p>欧克，言归正传，让我们回到药监局的爬取上吧。如果不出意外的话，这是 requests 模块的最后练习了，结束之后就是激动人心的数据解析了。</p><p>先说说药监局网站，我不清楚是因为我用的是学校局域网的原因，还是药监局网站本身的数据维护更新原因，我这边晚上八点半之后就打开不了药监局网站了。</p><p>闲话少说（其实说了很多），我们先打开药监局网站（<a href="http://scxk.nmpa.gov.cn:81/xk/%EF%BC%89%EF%BC%8C%E4%B8%80%E6%8E%A2%E7%A9%B6%E7%AB%9F%E3%80%82">http://scxk.nmpa.gov.cn:81/xk/），一探究竟。</a><br><img src="https://img-blog.csdnimg.cn/20210420150643122.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>当我们随便点击一家企业时，得到的界面如下：</p><p><img src="https://img-blog.csdnimg.cn/20210420150720521.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>而这些企业具体信息是我们今天要爬取的对象数据。</p><p>首先我们来爬取药监局的首页数据。<br>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 URL</span>    url <span class="token operator">=</span> <span class="token string">"http://scxk.nmpa.gov.cn:81/xk/"</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 保存</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./药监局.html"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>然后我们打开保存的文件一看。<br><img src="https://img-blog.csdnimg.cn/20210420151921155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>唉，为什么，明明已经加载完成了，但我们看不到任何企业的信息？</p><p>别着急，让我们现在回到药监局的首页，打开抓包工具的 “ Network ” 分析一波（当然其实我们可以使用 数据解析 解决这个问题，但实际上我们还没学不是吗？）。欧克，回到抓包工具，点击 response。</p><p><img src="https://img-blog.csdnimg.cn/20210420152351636.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后在按下 “ctrl” + “F”，开始查找</p><p><img src="https://img-blog.csdnimg.cn/20210420152537239.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现网页源码上并没有 “海南” ， 但我们的公司名称里却有，这说明，我们对应的 url 并不能获取我们需要的数据，那么这些数据在哪里呢？不知道你们有没有想到我们前面提到过的 AJAX。好吧，既然我们没有别的办法，那就试试喽。</p><p>结果这一看真是不得了。</p><p><img src="https://img-blog.csdnimg.cn/20210420153033526.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>response 里的 json 不就是我们想要的吗？赶紧兴奋地去在线解析一下<br><img src="https://img-blog.csdnimg.cn/20210420153306674.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们会发现这些数据里面的 ID 特别显眼，然后再回到我们公司的具体信息的页面，一看，我的天呀，这是什么啊。<br><img src="https://img-blog.csdnimg.cn/20210420153703282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这不就是我们要的 url 里的动态部分吗？别太激动了，试验一下。</p><p><img src="https://img-blog.csdnimg.cn/20210420153841806.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>一验证，发现果然如此，这不得仰天长啸一翻，天不亡我。</p><p>好了，既然得到了这些信息，我们是不是就可以写代码了吗？</p><p>当然你要写没有拦你，但你打开一看自己得到的数据或是网页，就会发现，结果和前面一样，没有任何数据。然后我们再一次重复上面的数据就会发现数据还是被保存在 XHR 的请求中，是不是特别想说一句 “ 禁止套娃 ”？</p><p>不管有多少脏话要骂，还是要写代码，唉，要不边写边骂？</p><p>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.72 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 指定 XHR 的 url</span>    url <span class="token operator">=</span> <span class="token string">"http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do?method=getXkzsList"</span>    <span class="token comment" spellcheck="true"># data</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"on"</span><span class="token punctuation">:</span> <span class="token string">"true"</span><span class="token punctuation">,</span>        <span class="token string">"page"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>        <span class="token string">"pageSize"</span><span class="token punctuation">:</span> <span class="token string">"15"</span><span class="token punctuation">,</span>        <span class="token string">"productName"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>         <span class="token string">"conditionType"</span><span class="token punctuation">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>        <span class="token string">"applyname"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token string">"applysn"</span><span class="token punctuation">:</span> <span class="token string">""</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 存储最后的 ID 数据</span>    id_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> page <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 翻两页</span>        data<span class="token punctuation">[</span><span class="token string">"page"</span><span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">(</span>page<span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 发送请求命令，获取 json 数据</span>        data_json <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 分析一下 json 数据的结构</span>        data_list <span class="token operator">=</span> data_json<span class="token punctuation">[</span><span class="token string">"list"</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> data_list<span class="token punctuation">:</span>            id_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">[</span><span class="token string">"ID"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 公司具体信息网页的 XHR 中的 url</span>    new_url <span class="token operator">=</span> <span class="token string">"http://scxk.nmpa.gov.cn:81/xk/itownet/portalAction.do?method=getXkzsById"</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"5eb10afc74a2462c8e86652ec8d90a48"</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> ID <span class="token keyword">in</span> id_list<span class="token punctuation">:</span>        data<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> ID        <span class="token comment" spellcheck="true"># 发送请求</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>new_url<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 这是一个json串，我们可以先在线解析，再保存我们想要的东西</span>        name <span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token string">"epsName"</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 保存</span>        <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">".公司信息.text"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>            fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"公司名称："</span> <span class="token operator">+</span> response<span class="token punctuation">[</span><span class="token string">"epsName"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"公司地址："</span> <span class="token operator">+</span> response<span class="token punctuation">[</span><span class="token string">"epsProductAddress"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"法定代表人："</span> <span class="token operator">+</span> response<span class="token punctuation">[</span><span class="token string">"legalPerson"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>        <span class="token comment" spellcheck="true"># 提示</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"的信息下载完成！！！"</span><span class="token punctuation">)</span></code></pre><p>我们运行一下程序，结果如下：<br><img src="https://img-blog.csdnimg.cn/20210420190105233.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>打开文件一看<br><img src="https://img-blog.csdnimg.cn/20210420190154657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（5）</title>
      <link href="/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-5/"/>
      <url>/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-5/</url>
      
        <content type="html"><![CDATA[<h1 id="肯德基餐厅地址查询"><a href="#肯德基餐厅地址查询" class="headerlink" title="肯德基餐厅地址查询"></a>肯德基餐厅地址查询</h1><p>前面我们学习了破解百度翻译，知道了 AJAX 的工作原理和爬取，那么我们今天就来巩固我们的学习成果吧。</p><p>首先我们打开肯德基的官网，点击 “餐厅查询”<br><img src="https://img-blog.csdnimg.cn/20210418212331439.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后是没有地址的网页，然后我们输入地址<br><img src="https://img-blog.csdnimg.cn/20210418212616822.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210418212546441.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现不论有没有搜索，网址都没有发生变化，这说明肯德基官网的地址查询是通过 AJAX 实现的，知道了这样一点我们就可以使用抓包工具进行分析了。</p><p>我们可以从抓包工具中找到请求的 url 和相对应的请求命令和数据类型。<br><img src="https://img-blog.csdnimg.cn/20210418214041202.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210418214055199.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210418231617567.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>我们发现这是一个 json 串，我们还需要像上次破解百度翻译一样先把 json 串爬取下来，再在线解析吗？答案当然是否定的，我们可以在抓包工具的 response 中得到目前的 json，然后在线解析。</p><p><img src="https://img-blog.csdnimg.cn/20210418213447336.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br><img src="https://img-blog.csdnimg.cn/20210418213609839.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>欧克，那么我就可以开始写爬取肯德基餐厅地址的代码了</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 指定 URL</span>    url <span class="token operator">=</span> <span class="token string">"http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=keyword"</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true"># 数据</span>    kd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"需要查询的地点："</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"cname"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token string">"pid"</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>         <span class="token string">"keyword"</span><span class="token punctuation">:</span> kd <span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 要搜索的地址</span>        <span class="token string">"pageIndex"</span><span class="token punctuation">:</span> <span class="token string">"1"</span> <span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 要爬取的网页的页码</span>        <span class="token string">"pageSize"</span><span class="token punctuation">:</span> <span class="token string">"10"</span> <span class="token comment" spellcheck="true"># 每一页的数量</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment" spellcheck="true"># 爬取两页</span>        data<span class="token punctuation">[</span><span class="token string">"pageIndex"</span><span class="token punctuation">]</span> <span class="token operator">=</span> str<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>        page <span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token string">"Table1"</span><span class="token punctuation">]</span>        <span class="token comment" spellcheck="true"># 存储</span>        <span class="token keyword">for</span> detail <span class="token keyword">in</span> page<span class="token punctuation">:</span>            <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./肯德基地址.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>                fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"storeName:"</span> <span class="token operator">+</span> detail<span class="token punctuation">[</span><span class="token string">"storeName"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"addressDetail:"</span> <span class="token operator">+</span> detail<span class="token punctuation">[</span><span class="token string">"addressDetail"</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"\n"</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"over!!!"</span><span class="token punctuation">)</span></code></pre><p>打开保存的文件如下</p><p><img src="https://img-blog.csdnimg.cn/20210418231504846.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>说明爬取成功</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（4）</title>
      <link href="/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-4/"/>
      <url>/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-4/</url>
      
        <content type="html"><![CDATA[<h1 id="“破解”百度翻译"><a href="#“破解”百度翻译" class="headerlink" title="“破解”百度翻译"></a>“破解”百度翻译</h1><p>翻译是一件麻烦的事情，如果可以写一个爬虫程序直接爬取百度翻译的翻译结果就好了，可当我打开百度翻译的页面，输入要翻译的词时突然发现不管我要翻译什么，网址都没有任何变化，那么百度翻译要怎么爬取呢？</p><p>爬取百度翻译之前，我们先要明白百度翻译是怎么在不改变网址的情况下实现翻译的。百度做到这一点是用 AJAX 实现的，简单地说，AJAX的作用是在不重新加载网页的情况下进行局部的刷新。</p><p>了解了这一点，那么我们要怎么得到 AJAX 工作时请求的URL呢？老规矩，使用抓包工具。步骤如下：</p><ol><li>在 “百度翻译” 页面右键，选择“Notework”</li><li>选择 “ XHR ”</li></ol><p><img src="https://img-blog.csdnimg.cn/2021041717220450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><ol start="3"><li>如果画面没有任何数据，可以试着输入要翻译的词，比如说我输入“dog”时，就发生了如下的变化</li></ol><p><img src="https://img-blog.csdnimg.cn/20210417172456378.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们看到此时的 kw 是我要翻译的词，说明这是我们要找的东西。</p><p>（注意：我们发现其中有三个 sug ，我选的只是其中一个。如果我们全都带点开看，就会发现，他们的 kw 分别是：d 和 do。这是因为我打 dog 时一个单词一个单词打的，而 AJAX 是时时刷新。如果输入中文就不会出现这种情况。翻译中文时，我们找的也不是 sug 了，具体是什么，就看哪个包的 data 的值是我们要翻译的词。）</p><p>然后我们在回到上面，找到我们需要指定的 URL 、我们要选择的请求命令以及爬取到的数据的类型。</p><p><img src="https://img-blog.csdnimg.cn/2021041719215232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"></p><p>欧克，做到这里我们的前期准备就完成了，下面就可以开始着手写代码了。</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 指定 url</span>    url <span class="token operator">=</span> <span class="token string">"https://fanyi.baidu.com/sug"</span>    <span class="token comment" spellcheck="true"># 要翻译的词</span>    keyword <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"需要翻译的词："</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"kw"</span><span class="token punctuation">:</span> keyword        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> data <span class="token operator">=</span> data<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span></code></pre><p>我们运行程序发现结果是这样的：<br><img src="https://img-blog.csdnimg.cn/2021041719410599.png"><br>因为请求到的数据比较短，所以我们比较容易地看出数据的结构是字典里有列表，列表里又有字典结构。如果比较长，我们可以使用在线 json 转换,转换后的数据是这样的</p><p><img src="https://img-blog.csdnimg.cn/20210417194625764.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们只需要 dog 的释义，所以我们还可以对我们代码进行优化</p><pre class=" language-python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">"data"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">"v"</span><span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre><p>注意：<br>关于 data 的字典，并不是说只需要 “ kw ”: dog, data 的字典里要存储的是抓包工具里 from data 里所有的值，如果没有值，那么相对应的值就是空字符串。</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（3）</title>
      <link href="/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-3/"/>
      <url>/2022/11/20/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-3/</url>
      
        <content type="html"><![CDATA[<h1 id="简易网页搜集器（2）"><a href="#简易网页搜集器（2）" class="headerlink" title="简易网页搜集器（2）"></a>简易网页搜集器（2）</h1><p>前面我们学会了如何用 UA 伪装骗过服务器爬取我们想要的网页数据，不知道你们会不会和我一样在学会 UA 伪装的兴奋后突然想到另一个问题——就是我们爬取一个页面就要改一次 url 吗？</p><p>答案当然是否定的。</p><p>我们观察下面两个网址<br><img src="https://img-blog.csdnimg.cn/2021041616565422.png"><br><img src="https://img-blog.csdnimg.cn/20210416165736945.png"><br>一个显然易见的区别是我圈起来的部分，即“wd &#x3D; ”<br>那我就怀疑搜索不同的关键词，“wd” 都不同，那么是不是这么一回事呢？我们可以试试。</p><p>结果就像这样<br><img src="https://img-blog.csdnimg.cn/20210416170212646.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>欧克，这就说明关键在于 “wd”的值，那么我们就可以根据这点写一个动态的URL</p><p>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 要搜索的内容</span>    kd <span class="token operator">=</span> input<span class="token punctuation">(</span><span class="token string">"百度一下，你就知道："</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/s?"</span>    param <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"wd"</span><span class="token punctuation">:</span> kd        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># UA 伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"User-Agent"</span><span class="token punctuation">:</span> <span class="token string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36"</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    page_text <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">=</span> url<span class="token punctuation">,</span> params <span class="token operator">=</span> param<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span><span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 存储</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"."</span><span class="token operator">+</span>kd<span class="token operator">+</span><span class="token string">".html"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取数据成功！！！"</span><span class="token punctuation">)</span></code></pre><p>当然，url 还可以写成这样的</p><pre class=" language-python"><code class="language-python">url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/s?"</span> <span class="token operator">+</span> <span class="token string">"wd="</span> <span class="token operator">+</span> kd</code></pre><p>我们打开保存的文件，看看结果<br><img src="https://img-blog.csdnimg.cn/20210416172140334.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这说明我们的代码没有问题，我们可以不改变代码实现关键词搜索爬取网页了</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（2）</title>
      <link href="/2022/11/19/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-2/"/>
      <url>/2022/11/19/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-2/</url>
      
        <content type="html"><![CDATA[<h1 id="简易网页搜集器"><a href="#简易网页搜集器" class="headerlink" title="简易网页搜集器"></a>简易网页搜集器</h1><p>前面我们已经学会了简单爬取浏览器页面的爬虫。但事实上我们的需求当然不是爬取搜狗首页或是B站首页这么简单，再不济，我们都希望可以爬取某个特定的有信息的页面。</p><p>不知道在学会了爬取之后，你有没有跟我一样试着去爬取一些搜索页面，比如说百度。像这样的页面</p><p><img src="https://img-blog.csdnimg.cn/20210415104803318.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70" alt="要爬取的网页"></p><p>注意我红笔划的部分，这是我打开的网页。现在我希望能爬取这一页的数据，按我们前面学的代码，应该是这样写的：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 指定URL</span>    url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=2&amp;tn=93923645_hao_pg&amp;wd=%E5%A5%A5%E7%89%B9%E6%9B%BC&amp;rsv_spt=1&amp;oq=%25E7%2588%25AC%25E5%258F%2596%25E7%2599%25BE%25E5%25BA%25A6%25E9%25A6%2596%25E9%25A1%25B5&amp;rsv_pq=b233dcfd0002d2d8&amp;rsv_t=ccdbEuqbJfqtjnkFvevj%2BfxQ0Sj2UP88ixXHTNUNsmTa9yWEWTUEgxTta9r%2Fj3mXxDs%2BT1SU&amp;rqlang=cn&amp;rsv_dl=tb&amp;rsv_enter=1&amp;rsv_sug3=8&amp;rsv_sug1=5&amp;rsv_sug7=100&amp;rsv_sug2=0&amp;rsv_btype=t&amp;inputT=1424&amp;rsv_sug4=1424"</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 获取数据</span>    page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 存储</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./奥特曼.html"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取成功！！！"</span><span class="token punctuation">)</span></code></pre><p>然而打开我们保存的文件，发现结果跟我们想的不太一样<br><img src="https://img-blog.csdnimg.cn/20210415110105396.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现我们保存的文件是一个空白的页面，这是为什么呢？</p><p>其实上我们把网址改成搜狗的可能或更直观一些（不知道为什么我这边的搜狗总是打不开，所以就用百度做例子，可以自己写写有关搜狗搜索的代码），同样的代码改成搜狗的网址结果是这样的</p><p><img src="https://img-blog.csdnimg.cn/20210415110721166.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>我们发现其中有句话是 “ 网络中存在异常访问 ”，那么这句话是什么意思呢？这句话的意思就是说，搜狗或是百度注意到发送请求的是爬虫程序，而不是人工操作。</p><p>那么这其中的原理又是什么呢？简单来说，就是程序访问和我们使用浏览器访问是有区别的，被请求的服务器都是靠 user-agent 来判断访问者的身份，如果是浏览器就接受请求，否则就拒绝。这就是一个很常见的反爬机制。</p><p>那是不是我们就没有办法呢？非也~所谓魔高一尺，道高一丈。既然要识别 user-agent ，那么我们就让爬虫模拟 user-agent 好了。</p><p>在 python 中模拟输入数据或是 user-agent ，我们一般用字典<br>就这样子写：</p><pre class=" language-python"><code class="language-python">header <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"user-agent"</span><span class="token punctuation">:</span> <span class="token string">""</span> <span class="token comment" spellcheck="true"># user-agent 的值 是一个长字符串</span>    <span class="token punctuation">}</span></code></pre><p>那么  user-agent 的值又是怎么得到的呢？<br>    1. 打开任意网页，右键点击，选择“检查”<br><img src="https://img-blog.csdnimg.cn/20210415112140584.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>    2. 选择“ Network ”（谷歌浏览器）（如果是中文，就选择 “网络” 这一项）<br><img src="https://img-blog.csdnimg.cn/20210415112339671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>    3. 如果发现点开是空白的，像这样，那就刷新网页<br>    <img src="https://img-blog.csdnimg.cn/2021041511261560.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>    刷新后是这样的：<br>    <img src="https://img-blog.csdnimg.cn/20210415112717305.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>然后随机选择红笔圈起来的一项，我们会看到这样的东西，然后在里面找到“user-agent”，把它的值复制下来就行了<br><img src="https://img-blog.csdnimg.cn/20210415113039196.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>有了 “user-agent”， 我们在重新写我们的爬取网页的代码，就可以了</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 指定URL</span>    url <span class="token operator">=</span> <span class="token string">"https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=2&amp;tn=93923645_hao_pg&amp;wd=%E5%A5%A5%E7%89%B9%E6%9B%BC&amp;rsv_spt=1&amp;oq=%25E7%2588%25AC%25E5%258F%2596%25E7%2599%25BE%25E5%25BA%25A6%25E9%25A6%2596%25E9%25A1%25B5&amp;rsv_pq=b233dcfd0002d2d8&amp;rsv_t=ccdbEuqbJfqtjnkFvevj%2BfxQ0Sj2UP88ixXHTNUNsmTa9yWEWTUEgxTta9r%2Fj3mXxDs%2BT1SU&amp;rqlang=cn&amp;rsv_dl=tb&amp;rsv_enter=1&amp;rsv_sug3=8&amp;rsv_sug1=5&amp;rsv_sug7=100&amp;rsv_sug2=0&amp;rsv_btype=t&amp;inputT=1424&amp;rsv_sug4=1424"</span>    <span class="token comment" spellcheck="true"># 模拟 “user-agent”，即 UA伪装</span>    header <span class="token operator">=</span> <span class="token punctuation">{</span>        <span class="token string">"user-agent"</span> <span class="token punctuation">:</span> <span class="token string">""</span> <span class="token comment" spellcheck="true"># 复制的 user-agent 的值</span>        <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># 发送请求</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers <span class="token operator">=</span> header<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 获取数据</span>    page_text <span class="token operator">=</span> response<span class="token punctuation">.</span>text    <span class="token comment" spellcheck="true"># 存储</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./奥特曼(UA伪装).html"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>page_text<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取成功！！！"</span><span class="token punctuation">)</span></code></pre><p>再次运行，然后打开文件<br><img src="https://img-blog.csdnimg.cn/20210415113826866.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70"><br>这次成功了，说明我们的爬虫程序完美地骗过了服务器</p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>千里之行，始于足下。python 爬虫 requestes模块（1）</title>
      <link href="/2022/11/19/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-1/"/>
      <url>/2022/11/19/qian-li-zhi-xing-shi-yu-zu-xia-python-pa-chong-requestes-mo-kuai-1/</url>
      
        <content type="html"><![CDATA[<h1 id="爬虫的流程："><a href="#爬虫的流程：" class="headerlink" title="爬虫的流程："></a>爬虫的流程：</h1><p>在开始学习爬虫，我们必须了解爬虫的流程框架。在我看来爬虫的流程大概就是三步，即不论我们爬取的是什么数据，总是可以把爬虫的流程归纳总结为这三步：</p><ol><li>指定 url， 可以简单的理解为指定要爬取的网址</li><li>发送请求。requests 模块的请求一般为 get 和 post</li><li>将爬取的数据存储</li></ol><h1 id="requests-模块的下载导入："><a href="#requests-模块的下载导入：" class="headerlink" title="requests 模块的下载导入："></a>requests 模块的下载导入：</h1><p>因为 requests 模块属于外部库，所以需要我们自己导入库</p><p>导入的步骤：</p><ol><li>右键Windows图标</li><li>点击“运行”</li><li>输入“cmd”打开命令面板</li><li>输入“pip install requests”,等待下载完成</li></ol><p>如图：</p><p><img src="https://img-blog.csdnimg.cn/20210413165648257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_1,color_FFFFFF,t_70"></p><p><img src="https://img-blog.csdnimg.cn/20210413165904237.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70" alt="打开cmd"></p><p><img src="https://img-blog.csdnimg.cn/20210413165910162.png" alt="下载 requests 模块 "></p><p>如果还是下载失败，我的建议是”百度一下，你就知道“（我也是边学边写，是在是水平有限）</p><p>欧克，既然导入成功后我们就简单的来爬取一下搜狗的首页吧！<br>代码如下：</p><pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token comment" spellcheck="true"># 指定url</span>    url <span class="token operator">=</span> <span class="token string">"https://www.sougou.com/"</span>    <span class="token comment" spellcheck="true"># 发起请求</span>    <span class="token comment" spellcheck="true"># get方法会返回一个响应数据</span>    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true"># 获取响应数据</span>    page_txt <span class="token operator">=</span> response<span class="token punctuation">.</span>text <span class="token comment" spellcheck="true"># text返回一个字符串的响应数据</span>    <span class="token comment" spellcheck="true"># print(page_txt)</span>    <span class="token comment" spellcheck="true"># 存储</span>    <span class="token keyword">with</span> open<span class="token punctuation">(</span><span class="token string">"./sougou.html"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> encoding <span class="token operator">=</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> fp<span class="token punctuation">:</span>        fp<span class="token punctuation">.</span>write<span class="token punctuation">(</span>page_txt<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"爬取数据结束！！！"</span><span class="token punctuation">)</span></code></pre><p>我们打开保存的文件，如图<br><img src="https://img-blog.csdnimg.cn/2021041317282155.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1NoaUppZURlWWluWXU=,size_16,color_FFFFFF,t_70" alt="成功保存的网页"></p>]]></content>
      
      
      <categories>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
            <tag> request </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2022/11/18/hello-world/"/>
      <url>/2022/11/18/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class=" language-bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class=" language-bash"><code class="language-bash">$ hexo server</code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class=" language-bash"><code class="language-bash">$ hexo generate</code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class=" language-bash"><code class="language-bash">$ hexo deploy</code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
